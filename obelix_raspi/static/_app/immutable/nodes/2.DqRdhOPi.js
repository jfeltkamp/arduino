var Bi=Object.defineProperty;var mn=e=>{throw TypeError(e)};var Vi=(e,t,n)=>t in e?Bi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var wn=(e,t,n)=>Vi(e,typeof t!="symbol"?t+"":t,n),Ie=(e,t,n)=>t.has(e)||mn("Cannot "+n);var xt=(e,t,n)=>(Ie(e,t,"read from private field"),n?n.call(e):t.get(e)),Gt=(e,t,n)=>t.has(e)?mn("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Re=(e,t,n,i)=>(Ie(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n),yn=(e,t,n)=>(Ie(e,t,"access private method"),n);import{b as bn,e as Xi,a as I,t as F,n as oe,c as Tt}from"../chunks/disclose-version.IuAJDzkW.js";import{M as Hi,h as si,k as ct,C as _e,D as Ve,R as Ui,K as oi,a7 as Zi,a8 as Sn,B as ze,l as Dt,ar as me,a5 as li,i as fn,a6 as Wi,N as En,as as xn,at as dn,au as Gi,U as Ji,$ as Mn,av as vn,aw as Ki,J as Qi,ax as tr,j as ci,y as ui,F as er,S as nr,ab as ir,ay as fi,az as rr,z as di,G as ar,A as sr,aA as or,a4 as kn,aB as lr,aC as cr,aD as ur,aa as fr,a9 as hn,b as dr,p as nt,V as R,q as $,w as D,v as k,t as et,o as it,aE as $n,g,aq as B,f as Lt,m as gt}from"../chunks/runtime.BzVitypH.js";import{a as le,b as we,c as ne,o as rt,l as vr,e as be,s as bt,p as mt,f as De,g as fe,h as Ne,v as Se,t as Xe,d as pn}from"../chunks/obelix-api.SzBhQFH9.js";import{d as at,s as St,a as ot}from"../chunks/store.C2RJHuW2.js";import{c as hr,d as ht,a as J,p as kt,o as ce,i as G,b as pr,s as vi}from"../chunks/index-client.C4f2BDb5.js";import{s as _t}from"../chunks/render.DojA1F6S.js";import{i as hi}from"../chunks/lifecycle.C2xTx8cU.js";import{g as gr}from"../chunks/index.118zOlTO.js";let Oe=null;function Vt(e,t){return t}function _r(e,t,n,i){for(var r=[],a=t.length,s=0;s<a;s++)Ki(t[s].e,r,!0);var l=a>0&&r.length===0&&n!==null;if(l){var f=n.parentNode;Qi(f),f.append(n),i.clear(),Ct(e,t[0].prev,t[a-1].next)}tr(r,()=>{for(var v=0;v<a;v++){var o=t[v];l||(i.delete(o.k),Ct(e,o.prev,o.next)),ci(o.e,!l)}})}function Pt(e,t,n,i,r,a=null){var s=e,l={flags:t,items:new Map,first:null},f=(t&fi)!==0;if(f){var v=e;s=ct?_e(ui(v)):v.appendChild(Hi())}ct&&Ve();var o=null,c=!1;si(()=>{var u=n(),h=Ui(u)?u:u==null?[]:oi(u),d=h.length;if(c&&d===0)return;c=d===0;let b=!1;if(ct){var m=s.data===Zi;m!==(d===0)&&(s=Sn(),_e(s),ze(!1),b=!0)}if(ct){for(var S=null,y,p=0;p<d;p++){if(Dt.nodeType===8&&Dt.data===er){s=Dt,b=!0,ze(!1);break}var w=h[p],E=i(w,p);y=pi(Dt,l,S,null,w,E,p,r,t),l.items.set(E,y),S=y}d>0&&_e(Sn())}if(!ct){var C=nr;mr(h,l,s,r,t,(C.f&me)!==0,i)}a!==null&&(d===0?o?li(o):o=fn(()=>a(s)):o!==null&&Wi(o,()=>{o=null})),b&&ze(!0),n()}),ct&&(s=Dt)}function mr(e,t,n,i,r,a,s){var L,_,j,X;var l=(r&rr)!==0,f=(r&(dn|vn))!==0,v=e.length,o=t.items,c=t.first,u=c,h,d=null,b,m=[],S=[],y,p,w,E;if(l)for(E=0;E<v;E+=1)y=e[E],p=s(y,E),w=o.get(p),w!==void 0&&((L=w.a)==null||L.measure(),(b??(b=new Set)).add(w));for(E=0;E<v;E+=1){if(y=e[E],p=s(y,E),w=o.get(p),w===void 0){var C=u?u.e.nodes_start:n;d=pi(C,t,d,d===null?t.first:d.next,y,p,E,i,r),o.set(p,d),m=[],S=[],u=d.next;continue}if(f&&wr(w,y,E,r),w.e.f&me&&(li(w.e),l&&((_=w.a)==null||_.unfix(),(b??(b=new Set)).delete(w))),w!==u){if(h!==void 0&&h.has(w)){if(m.length<S.length){var z=S[0],A;d=z.prev;var x=m[0],T=m[m.length-1];for(A=0;A<m.length;A+=1)Tn(m[A],z,n);for(A=0;A<S.length;A+=1)h.delete(S[A]);Ct(t,x.prev,T.next),Ct(t,d,x),Ct(t,T,z),u=z,d=T,E-=1,m=[],S=[]}else h.delete(w),Tn(w,u,n),Ct(t,w.prev,w.next),Ct(t,w,d===null?t.first:d.next),Ct(t,d,w),d=w;continue}for(m=[],S=[];u!==null&&u.k!==p;)(a||!(u.e.f&me))&&(h??(h=new Set)).add(u),S.push(u),u=u.next;if(u===null)continue;w=u}m.push(w),d=w,u=w.next}if(u!==null||h!==void 0){for(var M=h===void 0?[]:oi(h);u!==null;)(a||!(u.e.f&me))&&M.push(u),u=u.next;var N=M.length;if(N>0){var P=r&fi&&v===0?n:null;if(l){for(E=0;E<N;E+=1)(j=M[E].a)==null||j.measure();for(E=0;E<N;E+=1)(X=M[E].a)==null||X.fix()}_r(t,M,P,o)}}l&&ir(()=>{var H;if(b!==void 0)for(w of b)(H=w.a)==null||H.apply()}),En.first=t.first&&t.first.e,En.last=d&&d.e}function wr(e,t,n,i){i&dn&&xn(e.v,t),i&vn?xn(e.i,n):e.i=n}function pi(e,t,n,i,r,a,s,l,f){var v=Oe;try{var o=(f&dn)!==0,c=(f&Gi)===0,u=o?c?Ji(r):Mn(r):r,h=f&vn?Mn(s):s,d={i:h,v:u,k:a,a:null,e:null,prev:n,next:i};return Oe=d,d.e=fn(()=>l(e,u,h),ct),d.e.prev=n&&n.e,d.e.next=i&&i.e,n===null?t.first=d:(n.next=d,n.e.next=d.e),i!==null&&(i.prev=d,i.e.prev=d.e),d}finally{Oe=v}}function Tn(e,t,n){for(var i=e.next?e.next.e.nodes_start:n,r=t?t.e.nodes_start:n,a=e.e.nodes_start;a!==i;){var s=di(a);r.before(a),a=s}}function Ct(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function yr(e,t,n,i,r){var a=e,s="",l;si(()=>{if(s===(s=t()??"")){ct&&Ve();return}l!==void 0&&(ci(l),l=void 0),s!==""&&(l=fn(()=>{if(ct){Dt.data;for(var f=Ve(),v=f;f!==null&&(f.nodeType!==8||f.data!=="");)v=f,f=di(f);if(f===null)throw ar(),sr;bn(Dt,v),a=_e(f);return}var o=s+"",c=Xi(o);bn(ui(c),c.lastChild),a.before(c)}))})}let Cn=!1;function gi(){Cn||(Cn=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const n of e.target.elements)(t=n.__on_r)==null||t.call(n)})},{capture:!0}))}function Ot(e){if(ct){var t=!1,n=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var i=e.value;V(e,"value",null),e.value=i}if(e.hasAttribute("checked")){var r=e.checked;V(e,"checked",null),e.checked=r}}};e.__on_r=n,cr(n),gi()}}function V(e,t,n,i){var r=e.__attributes??(e.__attributes={});ct&&(r[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||r[t]!==(r[t]=n)&&(t==="style"&&"__styles"in e&&(e.__styles={}),t==="loading"&&(e[or]=n),n==null?e.removeAttribute(t):typeof n!="string"&&br(e).includes(t)?e[t]=n:e.setAttribute(t,n))}var An=new Map;function br(e){var t=An.get(e.nodeName);if(t)return t;An.set(e.nodeName,t=[]);for(var n,i=kn(e),r=Element.prototype;r!==i;){n=lr(i);for(var a in n)n[a].set&&t.push(a);i=kn(i)}return t}function _i(e,t,n,i=n){e.addEventListener(t,n);const r=e.__on_r;r?e.__on_r=()=>{r(),i()}:e.__on_r=i,gi()}function Ft(e,t,n=t){var i=ur();_i(e,"input",()=>{var r=Ln(e)?jn(e.value):e.value;n(r),i&&r!==(r=t())&&(e.value=r??"")}),fr(()=>{var r=t();if(ct&&e.defaultValue!==e.value){n(e.value);return}Ln(e)&&r===jn(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function Ln(e){var t=e.type;return t==="number"||t==="range"}function jn(e){return e===""?null:+e}function mi(e,t,n){if(e.multiple)return Er(e,t);for(var i of e.options){var r=ie(i);if(hr(r,t)){i.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Sr(e,t){hn(()=>{var n=new MutationObserver(()=>{var i=e.__value;mi(e,i)});return n.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{n.disconnect()}})}function Dn(e,t,n=t){var i=!0;_i(e,"change",()=>{var r;if(e.multiple)r=[].map.call(e.querySelectorAll(":checked"),ie);else{var a=e.querySelector(":checked");r=a&&ie(a)}n(r)}),hn(()=>{var r=t();if(mi(e,r,i),i&&r===void 0){var a=e.querySelector(":checked");a!==null&&(r=ie(a),n(r))}e.__value=r,i=!1}),Sr(e)}function Er(e,t){for(var n of e.options)n.selected=~t.indexOf(ie(n))}function ie(e){return"__value"in e?e.__value:e.value}var At,Bt,se,Le,wi;const je=class je{constructor(t){Gt(this,Le);Gt(this,At,new WeakMap);Gt(this,Bt);Gt(this,se);Re(this,se,t)}observe(t,n){var i=xt(this,At).get(t)||new Set;return i.add(n),xt(this,At).set(t,i),yn(this,Le,wi).call(this).observe(t,xt(this,se)),()=>{var r=xt(this,At).get(t);r.delete(n),r.size===0&&(xt(this,At).delete(t),xt(this,Bt).unobserve(t))}}};At=new WeakMap,Bt=new WeakMap,se=new WeakMap,Le=new WeakSet,wi=function(){return xt(this,Bt)??Re(this,Bt,new ResizeObserver(t=>{for(var n of t){je.entries.set(n.target,n);for(var i of xt(this,At).get(n.target)||[])i(n)}}))},wn(je,"entries",new WeakMap);let He=je;var xr=new He({box:"border-box"});function Pn(e,t,n){var i=xr.observe(e,()=>n(e[t]));hn(()=>(dr(()=>n(e[t])),i))}var Mr=F('<div id="horizon-wrapper" class="svelte-14er9jv"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 220" width="220" height="220" class="svelte-14er9jv"><defs><path id="altitude" d="M32 0 108 0" stroke-width="2" stroke-linecap="round"></path><path id="altitudeText" d="M40 -4 108 -4" stroke="#000" stroke-linecap="round"></path></defs><g id="compass" transform="translate(110 110)"><circle r="32" class="compass svelte-14er9jv" stroke-width="2"></circle><circle r="30" class="compass--scale svelte-14er9jv" stroke-dasharray="2 21.5619449019" stroke-dashoffset="1" stroke-width="6"></circle><g><polygon class="compass--needle svelte-14er9jv" points="-10,10 0,-30 0,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" fill="#000"></polygon><polygon class="compass--needle svelte-14er9jv" points="10,10 0,-30 0,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" fill="#FFF"></polygon></g><g><use class="compass--alt svelte-14er9jv" href="#altitude"></use><text class="compass--text svelte-14er9jv" font-size="20"><textPath href="#altitudeText"> </textPath></text></g><text class="compass--text svelte-14er9jv" font-size="20" text-anchor="middle" y="50"> </text></g></svg></div>');function kr(e,t){nt(t,!1);let n=$n(),i=$n();const r=le.subscribe(b=>{R(n,b.deg_x),R(i,b.deg_y)});ht(()=>{r&&r()}),hi();var a=Mr(),s=$(a),l=D($(s)),f=D($(l),2),v=D(f),o=D($(v)),c=$(o),u=$(c);k(c),k(o),k(v);var h=D(v),d=$(h);k(h),k(l),k(s),k(a),et(()=>{V(f,"transform",`rotate(${g(n)??""})`),V(v,"transform",`rotate(${-g(i)})`),_t(u,`${g(i)??""}°`),_t(d,`${g(n)??""}°`)}),I(e,a),it()}class It{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const a=n[r],s=t+a,l=Math.abs(t)<Math.abs(a)?t-(s-a):a-(s-t);l&&(n[i++]=l),t=s}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,a,s=0;if(n>0){for(s=t[--n];n>0&&(i=s,r=t[--n],s=i+r,a=r-(s-i),!a););n>0&&(a<0&&t[n-1]<0||a>0&&t[n-1]>0)&&(r=a*2,i=s+r,r==i-s&&(s=i))}return s}}function*$r(e){for(const t of e)yield*t}function yi(e){return Array.from($r(e))}function Yt(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(r);++i<r;)a[i]=e+i*n;return a}var O=1e-6,Tr=1e-12,q=Math.PI,ft=q/2,In=q/4,vt=q*2,Mt=180/q,st=q/180,U=Math.abs,Cr=Math.atan,Xt=Math.atan2,W=Math.cos,de=Math.ceil,Z=Math.sin,Ar=Math.sign||function(e){return e>0?1:e<0?-1:0},jt=Math.sqrt;function Lr(e){return e>1?0:e<-1?q:Math.acos(e)}function Rt(e){return e>1?ft:e<-1?-ft:Math.asin(e)}function dt(){}function Ee(e,t){e&&zn.hasOwnProperty(e.type)&&zn[e.type](e,t)}var Rn={Feature:function(e,t){Ee(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)Ee(n[i].geometry,t)}},zn={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){Ue(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)Ue(n[i],t,0)},Polygon:function(e,t){Nn(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)Nn(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)Ee(n[i],t)}};function Ue(e,t,n){var i=-1,r=e.length-n,a;for(t.lineStart();++i<r;)a=e[i],t.point(a[0],a[1],a[2]);t.lineEnd()}function Nn(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)Ue(e[n],t,1);t.polygonEnd()}function Nt(e,t){e&&Rn.hasOwnProperty(e.type)?Rn[e.type](e,t):Ee(e,t)}function Ze(e){return[Xt(e[1],e[0]),Rt(e[2])]}function Ht(e){var t=e[0],n=e[1],i=W(n);return[i*W(t),i*Z(t),Z(n)]}function ve(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function xe(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Fe(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function he(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function We(e){var t=jt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Ge(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function Je(e,t){return U(e)>q&&(e-=Math.round(e/vt)*vt),[e,t]}Je.invert=Je;function jr(e,t,n){return(e%=vt)?t||n?Ge(Fn(e),Yn(t,n)):Fn(e):t||n?Yn(t,n):Je}function On(e){return function(t,n){return t+=e,U(t)>q&&(t-=Math.round(t/vt)*vt),[t,n]}}function Fn(e){var t=On(e);return t.invert=On(-e),t}function Yn(e,t){var n=W(e),i=Z(e),r=W(t),a=Z(t);function s(l,f){var v=W(f),o=W(l)*v,c=Z(l)*v,u=Z(f),h=u*n+o*i;return[Xt(c*r-h*a,o*n-u*i),Rt(h*r+c*a)]}return s.invert=function(l,f){var v=W(f),o=W(l)*v,c=Z(l)*v,u=Z(f),h=u*r-c*a;return[Xt(c*r+u*a,o*n+h*i),Rt(h*n-o*i)]},s}function Dr(e,t,n,i,r,a){if(n){var s=W(t),l=Z(t),f=i*n;r==null?(r=t+i*vt,a=t-f/2):(r=qn(s,r),a=qn(s,a),(i>0?r<a:r>a)&&(r+=i*vt));for(var v,o=r;i>0?o>a:o<a;o-=f)v=Ze([s,-l*W(o),-l*Z(o)]),e.point(v[0],v[1])}}function qn(e,t){t=Ht(t),t[0]-=e,We(t);var n=Lr(-t[1]);return((-t[2]<0?-n:n)+vt-O)%vt}function bi(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:dt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function ye(e,t){return U(e[0]-t[0])<O&&U(e[1]-t[1])<O}function pe(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Si(e,t,n,i,r){var a=[],s=[],l,f;if(e.forEach(function(d){if(!((b=d.length-1)<=0)){var b,m=d[0],S=d[b],y;if(ye(m,S)){if(!m[2]&&!S[2]){for(r.lineStart(),l=0;l<b;++l)r.point((m=d[l])[0],m[1]);r.lineEnd();return}S[0]+=2*O}a.push(y=new pe(m,d,null,!0)),s.push(y.o=new pe(m,null,y,!1)),a.push(y=new pe(S,d,null,!1)),s.push(y.o=new pe(S,null,y,!0))}}),!!a.length){for(s.sort(t),Bn(a),Bn(s),l=0,f=s.length;l<f;++l)s[l].e=n=!n;for(var v=a[0],o,c;;){for(var u=v,h=!0;u.v;)if((u=u.n)===v)return;o=u.z,r.lineStart();do{if(u.v=u.o.v=!0,u.e){if(h)for(l=0,f=o.length;l<f;++l)r.point((c=o[l])[0],c[1]);else i(u.x,u.n.x,1,r);u=u.n}else{if(h)for(o=u.p.z,l=o.length-1;l>=0;--l)r.point((c=o[l])[0],c[1]);else i(u.x,u.p.x,-1,r);u=u.p}u=u.o,o=u.z,h=!h}while(!u.v);r.lineEnd()}}}function Bn(e){if(t=e.length){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function Ye(e){return U(e[0])<=q?e[0]:Ar(e[0])*((U(e[0])+q)%vt-q)}function Pr(e,t){var n=Ye(t),i=t[1],r=Z(i),a=[Z(n),-W(n),0],s=0,l=0,f=new It;r===1?i=ft+O:r===-1&&(i=-ft-O);for(var v=0,o=e.length;v<o;++v)if(u=(c=e[v]).length)for(var c,u,h=c[u-1],d=Ye(h),b=h[1]/2+In,m=Z(b),S=W(b),y=0;y<u;++y,d=w,m=C,S=z,h=p){var p=c[y],w=Ye(p),E=p[1]/2+In,C=Z(E),z=W(E),A=w-d,x=A>=0?1:-1,T=x*A,M=T>q,N=m*C;if(f.add(Xt(N*x*Z(T),S*z+N*W(T))),s+=M?A+x*vt:A,M^d>=n^w>=n){var P=xe(Ht(h),Ht(p));We(P);var L=xe(a,P);We(L);var _=(M^A>=0?-1:1)*Rt(L[2]);(i>_||i===_&&(P[0]||P[1]))&&(l+=M^A>=0?1:-1)}}return(s<-O||s<O&&f<-Tr)^l&1}function Ei(e,t,n,i){return function(r){var a=t(r),s=bi(),l=t(s),f=!1,v,o,c,u={point:h,lineStart:b,lineEnd:m,polygonStart:function(){u.point=S,u.lineStart=y,u.lineEnd=p,o=[],v=[]},polygonEnd:function(){u.point=h,u.lineStart=b,u.lineEnd=m,o=yi(o);var w=Pr(v,i);o.length?(f||(r.polygonStart(),f=!0),Si(o,Rr,w,n,r)):w&&(f||(r.polygonStart(),f=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),f&&(r.polygonEnd(),f=!1),o=v=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(w,E){e(w,E)&&r.point(w,E)}function d(w,E){a.point(w,E)}function b(){u.point=d,a.lineStart()}function m(){u.point=h,a.lineEnd()}function S(w,E){c.push([w,E]),l.point(w,E)}function y(){l.lineStart(),c=[]}function p(){S(c[0][0],c[0][1]),l.lineEnd();var w=l.clean(),E=s.result(),C,z=E.length,A,x,T;if(c.pop(),v.push(c),c=null,!!z){if(w&1){if(x=E[0],(A=x.length-1)>0){for(f||(r.polygonStart(),f=!0),r.lineStart(),C=0;C<A;++C)r.point((T=x[C])[0],T[1]);r.lineEnd()}return}z>1&&w&2&&E.push(E.pop().concat(E.shift())),o.push(E.filter(Ir))}}return u}}function Ir(e){return e.length>1}function Rr(e,t){return((e=e.x)[0]<0?e[1]-ft-O:ft-e[1])-((t=t.x)[0]<0?t[1]-ft-O:ft-t[1])}const Vn=Ei(function(){return!0},zr,Or,[-q,-ft]);function zr(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(a,s){var l=a>0?q:-q,f=U(a-t);U(f-q)<O?(e.point(t,n=(n+s)/2>0?ft:-ft),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(l,n),e.point(a,n),r=0):i!==l&&f>=q&&(U(t-i)<O&&(t-=i*O),U(a-l)<O&&(a-=l*O),n=Nr(t,n,a,s),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(l,n),r=0),e.point(t=a,n=s),i=l},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function Nr(e,t,n,i){var r,a,s=Z(e-n);return U(s)>O?Cr((Z(t)*(a=W(i))*Z(n)-Z(i)*(r=W(t))*Z(e))/(r*a*s)):(t+i)/2}function Or(e,t,n,i){var r;if(e==null)r=n*ft,i.point(-q,r),i.point(0,r),i.point(q,r),i.point(q,0),i.point(q,-r),i.point(0,-r),i.point(-q,-r),i.point(-q,0),i.point(-q,r);else if(U(e[0]-t[0])>O){var a=e[0]<t[0]?q:-q;r=n*a/2,i.point(-a,r),i.point(0,r),i.point(a,r)}else i.point(t[0],t[1])}function Fr(e){var t=W(e),n=2*st,i=t>0,r=U(t)>O;function a(o,c,u,h){Dr(h,e,n,u,o,c)}function s(o,c){return W(o)*W(c)>t}function l(o){var c,u,h,d,b;return{lineStart:function(){d=h=!1,b=1},point:function(m,S){var y=[m,S],p,w=s(m,S),E=i?w?0:v(m,S):w?v(m+(m<0?q:-q),S):0;if(!c&&(d=h=w)&&o.lineStart(),w!==h&&(p=f(c,y),(!p||ye(c,p)||ye(y,p))&&(y[2]=1)),w!==h)b=0,w?(o.lineStart(),p=f(y,c),o.point(p[0],p[1])):(p=f(c,y),o.point(p[0],p[1],2),o.lineEnd()),c=p;else if(r&&c&&i^w){var C;!(E&u)&&(C=f(y,c,!0))&&(b=0,i?(o.lineStart(),o.point(C[0][0],C[0][1]),o.point(C[1][0],C[1][1]),o.lineEnd()):(o.point(C[1][0],C[1][1]),o.lineEnd(),o.lineStart(),o.point(C[0][0],C[0][1],3)))}w&&(!c||!ye(c,y))&&o.point(y[0],y[1]),c=y,h=w,u=E},lineEnd:function(){h&&o.lineEnd(),c=null},clean:function(){return b|(d&&h)<<1}}}function f(o,c,u){var h=Ht(o),d=Ht(c),b=[1,0,0],m=xe(h,d),S=ve(m,m),y=m[0],p=S-y*y;if(!p)return!u&&o;var w=t*S/p,E=-t*y/p,C=xe(b,m),z=he(b,w),A=he(m,E);Fe(z,A);var x=C,T=ve(z,x),M=ve(x,x),N=T*T-M*(ve(z,z)-1);if(!(N<0)){var P=jt(N),L=he(x,(-T-P)/M);if(Fe(L,z),L=Ze(L),!u)return L;var _=o[0],j=c[0],X=o[1],H=c[1],K;j<_&&(K=_,_=j,j=K);var lt=j-_,pt=U(lt-q)<O,Y=pt||lt<O;if(!pt&&H<X&&(K=X,X=H,H=K),Y?pt?X+H>0^L[1]<(U(L[0]-_)<O?X:H):X<=L[1]&&L[1]<=H:lt>q^(_<=L[0]&&L[0]<=j)){var Q=he(x,(-T+P)/M);return Fe(Q,z),[L,Ze(Q)]}}}function v(o,c){var u=i?e:q-e,h=0;return o<-u?h|=1:o>u&&(h|=2),c<-u?h|=4:c>u&&(h|=8),h}return Ei(s,l,a,i?[0,-e]:[-q,e-q])}function Yr(e,t,n,i,r,a){var s=e[0],l=e[1],f=t[0],v=t[1],o=0,c=1,u=f-s,h=v-l,d;if(d=n-s,!(!u&&d>0)){if(d/=u,u<0){if(d<o)return;d<c&&(c=d)}else if(u>0){if(d>c)return;d>o&&(o=d)}if(d=r-s,!(!u&&d<0)){if(d/=u,u<0){if(d>c)return;d>o&&(o=d)}else if(u>0){if(d<o)return;d<c&&(c=d)}if(d=i-l,!(!h&&d>0)){if(d/=h,h<0){if(d<o)return;d<c&&(c=d)}else if(h>0){if(d>c)return;d>o&&(o=d)}if(d=a-l,!(!h&&d<0)){if(d/=h,h<0){if(d>c)return;d>o&&(o=d)}else if(h>0){if(d<o)return;d<c&&(c=d)}return o>0&&(e[0]=s+o*u,e[1]=l+o*h),c<1&&(t[0]=s+c*u,t[1]=l+c*h),!0}}}}}var Jt=1e9,ge=-Jt;function qr(e,t,n,i){function r(v,o){return e<=v&&v<=n&&t<=o&&o<=i}function a(v,o,c,u){var h=0,d=0;if(v==null||(h=s(v,c))!==(d=s(o,c))||f(v,o)<0^c>0)do u.point(h===0||h===3?e:n,h>1?i:t);while((h=(h+c+4)%4)!==d);else u.point(o[0],o[1])}function s(v,o){return U(v[0]-e)<O?o>0?0:3:U(v[0]-n)<O?o>0?2:1:U(v[1]-t)<O?o>0?1:0:o>0?3:2}function l(v,o){return f(v.x,o.x)}function f(v,o){var c=s(v,1),u=s(o,1);return c!==u?c-u:c===0?o[1]-v[1]:c===1?v[0]-o[0]:c===2?v[1]-o[1]:o[0]-v[0]}return function(v){var o=v,c=bi(),u,h,d,b,m,S,y,p,w,E,C,z={point:A,lineStart:N,lineEnd:P,polygonStart:T,polygonEnd:M};function A(_,j){r(_,j)&&o.point(_,j)}function x(){for(var _=0,j=0,X=h.length;j<X;++j)for(var H=h[j],K=1,lt=H.length,pt=H[0],Y,Q,tt=pt[0],Et=pt[1];K<lt;++K)Y=tt,Q=Et,pt=H[K],tt=pt[0],Et=pt[1],Q<=i?Et>i&&(tt-Y)*(i-Q)>(Et-Q)*(e-Y)&&++_:Et<=i&&(tt-Y)*(i-Q)<(Et-Q)*(e-Y)&&--_;return _}function T(){o=c,u=[],h=[],C=!0}function M(){var _=x(),j=C&&_,X=(u=yi(u)).length;(j||X)&&(v.polygonStart(),j&&(v.lineStart(),a(null,null,1,v),v.lineEnd()),X&&Si(u,l,_,a,v),v.polygonEnd()),o=v,u=h=d=null}function N(){z.point=L,h&&h.push(d=[]),E=!0,w=!1,y=p=NaN}function P(){u&&(L(b,m),S&&w&&c.rejoin(),u.push(c.result())),z.point=A,w&&o.lineEnd()}function L(_,j){var X=r(_,j);if(h&&d.push([_,j]),E)b=_,m=j,S=X,E=!1,X&&(o.lineStart(),o.point(_,j));else if(X&&w)o.point(_,j);else{var H=[y=Math.max(ge,Math.min(Jt,y)),p=Math.max(ge,Math.min(Jt,p))],K=[_=Math.max(ge,Math.min(Jt,_)),j=Math.max(ge,Math.min(Jt,j))];Yr(H,K,e,t,n,i)?(w||(o.lineStart(),o.point(H[0],H[1])),o.point(K[0],K[1]),X||o.lineEnd(),C=!1):X&&(o.lineStart(),o.point(_,j),C=!1)}y=_,p=j,w=X}return z}}function Xn(e,t,n){var i=Yt(e,t-O,n).concat(t);return function(r){return i.map(function(a){return[r,a]})}}function Hn(e,t,n){var i=Yt(e,t-O,n).concat(t);return function(r){return i.map(function(a){return[a,r]})}}function Br(){var e,t,n,i,r,a,s,l,f=10,v=f,o=90,c=360,u,h,d,b,m=2.5;function S(){return{type:"MultiLineString",coordinates:y()}}function y(){return Yt(de(i/o)*o,n,o).map(d).concat(Yt(de(l/c)*c,s,c).map(b)).concat(Yt(de(t/f)*f,e,f).filter(function(p){return U(p%o)>O}).map(u)).concat(Yt(de(a/v)*v,r,v).filter(function(p){return U(p%c)>O}).map(h))}return S.lines=function(){return y().map(function(p){return{type:"LineString",coordinates:p}})},S.outline=function(){return{type:"Polygon",coordinates:[d(i).concat(b(s).slice(1),d(n).reverse().slice(1),b(l).reverse().slice(1))]}},S.extent=function(p){return arguments.length?S.extentMajor(p).extentMinor(p):S.extentMinor()},S.extentMajor=function(p){return arguments.length?(i=+p[0][0],n=+p[1][0],l=+p[0][1],s=+p[1][1],i>n&&(p=i,i=n,n=p),l>s&&(p=l,l=s,s=p),S.precision(m)):[[i,l],[n,s]]},S.extentMinor=function(p){return arguments.length?(t=+p[0][0],e=+p[1][0],a=+p[0][1],r=+p[1][1],t>e&&(p=t,t=e,e=p),a>r&&(p=a,a=r,r=p),S.precision(m)):[[t,a],[e,r]]},S.step=function(p){return arguments.length?S.stepMajor(p).stepMinor(p):S.stepMinor()},S.stepMajor=function(p){return arguments.length?(o=+p[0],c=+p[1],S):[o,c]},S.stepMinor=function(p){return arguments.length?(f=+p[0],v=+p[1],S):[f,v]},S.precision=function(p){return arguments.length?(m=+p,u=Xn(a,r,90),h=Hn(t,e,m),d=Xn(l,s,90),b=Hn(i,n,m),S):m},S.extentMajor([[-180,-90+O],[180,90-O]]).extentMinor([[-180,-80-O],[180,80+O]])}const Ke=e=>e;var qe=new It,Qe=new It,xi,Mi,tn,en,$t={point:dt,lineStart:dt,lineEnd:dt,polygonStart:function(){$t.lineStart=Vr,$t.lineEnd=Hr},polygonEnd:function(){$t.lineStart=$t.lineEnd=$t.point=dt,qe.add(U(Qe)),Qe=new It},result:function(){var e=qe/2;return qe=new It,e}};function Vr(){$t.point=Xr}function Xr(e,t){$t.point=ki,xi=tn=e,Mi=en=t}function ki(e,t){Qe.add(en*e-tn*t),tn=e,en=t}function Hr(){ki(xi,Mi)}var Ut=1/0,Me=Ut,re=-Ut,ke=re,$e={point:Ur,lineStart:dt,lineEnd:dt,polygonStart:dt,polygonEnd:dt,result:function(){var e=[[Ut,Me],[re,ke]];return re=ke=-(Me=Ut=1/0),e}};function Ur(e,t){e<Ut&&(Ut=e),e>re&&(re=e),t<Me&&(Me=t),t>ke&&(ke=t)}var nn=0,rn=0,Kt=0,Te=0,Ce=0,qt=0,an=0,sn=0,Qt=0,$i,Ti,wt,yt,ut={point:zt,lineStart:Un,lineEnd:Zn,polygonStart:function(){ut.lineStart=Gr,ut.lineEnd=Jr},polygonEnd:function(){ut.point=zt,ut.lineStart=Un,ut.lineEnd=Zn},result:function(){var e=Qt?[an/Qt,sn/Qt]:qt?[Te/qt,Ce/qt]:Kt?[nn/Kt,rn/Kt]:[NaN,NaN];return nn=rn=Kt=Te=Ce=qt=an=sn=Qt=0,e}};function zt(e,t){nn+=e,rn+=t,++Kt}function Un(){ut.point=Zr}function Zr(e,t){ut.point=Wr,zt(wt=e,yt=t)}function Wr(e,t){var n=e-wt,i=t-yt,r=jt(n*n+i*i);Te+=r*(wt+e)/2,Ce+=r*(yt+t)/2,qt+=r,zt(wt=e,yt=t)}function Zn(){ut.point=zt}function Gr(){ut.point=Kr}function Jr(){Ci($i,Ti)}function Kr(e,t){ut.point=Ci,zt($i=wt=e,Ti=yt=t)}function Ci(e,t){var n=e-wt,i=t-yt,r=jt(n*n+i*i);Te+=r*(wt+e)/2,Ce+=r*(yt+t)/2,qt+=r,r=yt*e-wt*t,an+=r*(wt+e),sn+=r*(yt+t),Qt+=r*3,zt(wt=e,yt=t)}function Ai(e){this._context=e}Ai.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,vt);break}}},result:dt};var on=new It,Be,Li,ji,te,ee,ae={point:dt,lineStart:function(){ae.point=Qr},lineEnd:function(){Be&&Di(Li,ji),ae.point=dt},polygonStart:function(){Be=!0},polygonEnd:function(){Be=null},result:function(){var e=+on;return on=new It,e}};function Qr(e,t){ae.point=Di,Li=te=e,ji=ee=t}function Di(e,t){te-=e,ee-=t,on.add(jt(te*te+ee*ee)),te=e,ee=t}let Wn,Ae,Gn,Jn;class Kn{constructor(t){this._append=t==null?Pi:ta(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==Gn||this._append!==Ae){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,Gn=i,Ae=this._append,Jn=this._,this._=r}this._+=Jn;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Pi(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function ta(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return Pi;if(t!==Wn){const n=10**t;Wn=t,Ae=function(r){let a=1;this._+=r[0];for(const s=r.length;a<s;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}return Ae}function ea(e,t){let n=3,i=4.5,r,a;function s(l){return l&&(typeof i=="function"&&a.pointRadius(+i.apply(this,arguments)),Nt(l,r(a))),a.result()}return s.area=function(l){return Nt(l,r($t)),$t.result()},s.measure=function(l){return Nt(l,r(ae)),ae.result()},s.bounds=function(l){return Nt(l,r($e)),$e.result()},s.centroid=function(l){return Nt(l,r(ut)),ut.result()},s.projection=function(l){return arguments.length?(r=l==null?(e=null,Ke):(e=l).stream,s):e},s.context=function(l){return arguments.length?(a=l==null?(t=null,new Kn(n)):new Ai(t=l),typeof i!="function"&&a.pointRadius(i),s):t},s.pointRadius=function(l){return arguments.length?(i=typeof l=="function"?l:(a.pointRadius(+l),+l),s):i},s.digits=function(l){if(!arguments.length)return n;if(l==null)n=null;else{const f=Math.floor(l);if(!(f>=0))throw new RangeError(`invalid digits: ${l}`);n=f}return t===null&&(a=new Kn(n)),s},s.projection(e).digits(n).context(t)}function gn(e){return function(t){var n=new ln;for(var i in e)n[i]=e[i];return n.stream=t,n}}function ln(){}ln.prototype={constructor:ln,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function _n(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),Nt(n,e.stream($e)),t($e.result()),i!=null&&e.clipExtent(i),e}function Ii(e,t,n){return _n(e,function(i){var r=t[1][0]-t[0][0],a=t[1][1]-t[0][1],s=Math.min(r/(i[1][0]-i[0][0]),a/(i[1][1]-i[0][1])),l=+t[0][0]+(r-s*(i[1][0]+i[0][0]))/2,f=+t[0][1]+(a-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([l,f])},n)}function na(e,t,n){return Ii(e,[[0,0],t],n)}function ia(e,t,n){return _n(e,function(i){var r=+t,a=r/(i[1][0]-i[0][0]),s=(r-a*(i[1][0]+i[0][0]))/2,l=-a*i[0][1];e.scale(150*a).translate([s,l])},n)}function ra(e,t,n){return _n(e,function(i){var r=+t,a=r/(i[1][1]-i[0][1]),s=-a*i[0][0],l=(r-a*(i[1][1]+i[0][1]))/2;e.scale(150*a).translate([s,l])},n)}var Qn=16,aa=W(30*st);function ti(e,t){return+t?oa(e,t):sa(e)}function sa(e){return gn({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function oa(e,t){function n(i,r,a,s,l,f,v,o,c,u,h,d,b,m){var S=v-i,y=o-r,p=S*S+y*y;if(p>4*t&&b--){var w=s+u,E=l+h,C=f+d,z=jt(w*w+E*E+C*C),A=Rt(C/=z),x=U(U(C)-1)<O||U(a-c)<O?(a+c)/2:Xt(E,w),T=e(x,A),M=T[0],N=T[1],P=M-i,L=N-r,_=y*P-S*L;(_*_/p>t||U((S*P+y*L)/p-.5)>.3||s*u+l*h+f*d<aa)&&(n(i,r,a,s,l,f,M,N,x,w/=z,E/=z,C,b,m),m.point(M,N),n(M,N,x,w,E,C,v,o,c,u,h,d,b,m))}}return function(i){var r,a,s,l,f,v,o,c,u,h,d,b,m={point:S,lineStart:y,lineEnd:w,polygonStart:function(){i.polygonStart(),m.lineStart=E},polygonEnd:function(){i.polygonEnd(),m.lineStart=y}};function S(A,x){A=e(A,x),i.point(A[0],A[1])}function y(){c=NaN,m.point=p,i.lineStart()}function p(A,x){var T=Ht([A,x]),M=e(A,x);n(c,u,o,h,d,b,c=M[0],u=M[1],o=A,h=T[0],d=T[1],b=T[2],Qn,i),i.point(c,u)}function w(){m.point=S,i.lineEnd()}function E(){y(),m.point=C,m.lineEnd=z}function C(A,x){p(r=A,x),a=c,s=u,l=h,f=d,v=b,m.point=p}function z(){n(c,u,o,h,d,b,a,s,r,l,f,v,Qn,i),m.lineEnd=w,w()}return m}}var la=gn({point:function(e,t){this.stream.point(e*st,t*st)}});function ca(e){return gn({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function ua(e,t,n,i,r){function a(s,l){return s*=i,l*=r,[t+e*s,n-e*l]}return a.invert=function(s,l){return[(s-t)/e*i,(n-l)/e*r]},a}function ei(e,t,n,i,r,a){if(!a)return ua(e,t,n,i,r);var s=W(a),l=Z(a),f=s*e,v=l*e,o=s/e,c=l/e,u=(l*n-s*t)/e,h=(l*t+s*n)/e;function d(b,m){return b*=i,m*=r,[f*b-v*m+t,n-v*b-f*m]}return d.invert=function(b,m){return[i*(o*b-c*m+u),r*(h-c*b-o*m)]},d}function fa(e){return da(function(){return e})()}function da(e){var t,n=150,i=480,r=250,a=0,s=0,l=0,f=0,v=0,o,c=0,u=1,h=1,d=null,b=Vn,m=null,S,y,p,w=Ke,E=.5,C,z,A,x,T;function M(_){return A(_[0]*st,_[1]*st)}function N(_){return _=A.invert(_[0],_[1]),_&&[_[0]*Mt,_[1]*Mt]}M.stream=function(_){return x&&T===_?x:x=la(ca(o)(b(C(w(T=_)))))},M.preclip=function(_){return arguments.length?(b=_,d=void 0,L()):b},M.postclip=function(_){return arguments.length?(w=_,m=S=y=p=null,L()):w},M.clipAngle=function(_){return arguments.length?(b=+_?Fr(d=_*st):(d=null,Vn),L()):d*Mt},M.clipExtent=function(_){return arguments.length?(w=_==null?(m=S=y=p=null,Ke):qr(m=+_[0][0],S=+_[0][1],y=+_[1][0],p=+_[1][1]),L()):m==null?null:[[m,S],[y,p]]},M.scale=function(_){return arguments.length?(n=+_,P()):n},M.translate=function(_){return arguments.length?(i=+_[0],r=+_[1],P()):[i,r]},M.center=function(_){return arguments.length?(a=_[0]%360*st,s=_[1]%360*st,P()):[a*Mt,s*Mt]},M.rotate=function(_){return arguments.length?(l=_[0]%360*st,f=_[1]%360*st,v=_.length>2?_[2]%360*st:0,P()):[l*Mt,f*Mt,v*Mt]},M.angle=function(_){return arguments.length?(c=_%360*st,P()):c*Mt},M.reflectX=function(_){return arguments.length?(u=_?-1:1,P()):u<0},M.reflectY=function(_){return arguments.length?(h=_?-1:1,P()):h<0},M.precision=function(_){return arguments.length?(C=ti(z,E=_*_),L()):jt(E)},M.fitExtent=function(_,j){return Ii(M,_,j)},M.fitSize=function(_,j){return na(M,_,j)},M.fitWidth=function(_,j){return ia(M,_,j)},M.fitHeight=function(_,j){return ra(M,_,j)};function P(){var _=ei(n,0,0,u,h,c).apply(null,t(a,s)),j=ei(n,i-_[0],r-_[1],u,h,c);return o=jr(l,f,v),z=Ge(t,j),A=Ge(o,z),C=ti(z,E),L()}function L(){return x=T=null,M}return function(){return t=e.apply(this,arguments),M.invert=t.invert&&N,P()}}function va(e){return function(t,n){var i=jt(t*t+n*n),r=e(i),a=Z(r),s=W(r);return[Xt(t*a,i*s),Rt(i&&n*a/i)]}}function Ri(e,t){return[W(t)*Z(e),Z(t)]}Ri.invert=va(Rt);function ha(){return fa(Ri).scale(249.5).clipAngle(90+O)}var pa=oe('<path fill="none" class="graticule svelte-1yv80ee" stroke-width="0.3"></path>');function ni(e,t){nt(t,!0);let n=B(0),i=B(0);const r=le.subscribe(u=>{R(n,J(u.deg_x)),R(i,J(u.deg_y))});ht(()=>{r&&r()});const a=kt(t,"scale",3,2e3),s=kt(t,"steps",3,5),l=kt(t,"clipAngle",3,15),f=Br().stepMajor([45,45]).stepMinor([s(),s()]);let v=Lt(()=>ha().scale(a()).rotate([-g(n),-g(i)]).translate([1080/2,810/2]).clipAngle(l())),o=Lt(()=>ea().projection(g(v)));var c=pa();et(()=>V(c,"d",g(o)(f()))),I(e,c),it()}function cn(e){return typeof e=="string"?e.toLowerCase().trim().replaceAll("ä","ae").replaceAll("ö","oe").replaceAll("ü","ue").replaceAll("ß","ss").replace(/\W+/g,"_").replace(/^_|_$/g,""):null}const ii={fid:"",geo:{addr:"",lat:53.6,lon:9.9},base:[{id:"home",name:"Primary target",pos:{x:-23900,y:0,f:500}},{id:"polaris",name:"Polaris",pos:{x:0,y:11912,f:600}}]};function ga(e,t){const n={...ii.geo,addr:t},i=[];for(let r of ii.base)i.push({...r,pos:{...r.pos}});return{fid:e,geo:n,base:i}}function ri(e){return Math.PI*e/180}function un(e){return e*180/Math.PI}function _a(e){const t=gr(le).spr;let n=Math.round(t*e/360);return Math.abs(n)>t/2&&(n=n>0?n-t:n+t),n}function ai(e){const t=un(e);return _a(t)}var ma=(e,t)=>t("A",e),wa=(e,t)=>t("B",e),ya=F('<div id="camera-stream" class="svelte-zqlhxu"><button id="telescope-stream"><svg class="svg-img svelte-zqlhxu" preserveAspectRatio="xMidYMid slice"><foreignObject class="img-wrap svelte-zqlhxu" x="0" y="0"><img alt="Telescope" class="svg-img svelte-zqlhxu"></foreignObject><!></svg></button> <button id="viewfinder-stream"><svg class="svg-img svelte-zqlhxu" preserveAspectRatio="xMidYMid slice"><foreignObject class="img-wrap svelte-zqlhxu" x="0" y="0"><img alt="Viewfinder" class="svg-img svelte-zqlhxu"></foreignObject><g><circle r="0.0001" fill="none" stroke="none"></circle><rect class="crosshair svelte-zqlhxu"></rect><!></g></svg></button></div>');function ba(e,t){nt(t,!0);const n=St(),i=()=>ot(vr,"$locHost",n),r=()=>ot(we,"$swapPreview",n),a=()=>ot(be,"$displayCompass",n);let s=B(0),l=B(0);const f=1080,v=810;let o=B(void 0);const c=()=>{const Y=g(o).getBoundingClientRect();return{x:g(u)==="B"?Y.x:g(s)/2,y:g(u)==="B"?Y.y:g(l)/2}};let u=B(void 0);const h=we.subscribe(Y=>{R(u,J(Y))});let d=B(0),b=B(0);const m=le.subscribe(Y=>{R(d,J(Y.deg_x)),R(b,J(Y.deg_y))}),S=(Y,Q)=>{if(g(u)!==Y)we.update(tt=>Y);else{const tt=c(),Et=Math.max(g(s)/f,g(l)/v),Zt={x:Math.round((Q.clientX-tt.x)/Et),y:-1*Math.round((Q.clientY-tt.y)/Et)},Ni=g(u)==="B"?y.SphereScaleVF:y.SphereScaleTel,ue=ri(g(b)),Oi=ri(g(d)),Pe=Math.sqrt(Math.pow(Zt.x,2)+Math.pow(Zt.y,2)),Wt=Math.asin(Pe/Ni),Fi=Math.asin(Math.cos(Wt)*Math.sin(ue)+Zt.y*Math.sin(Wt)*Math.cos(ue)/Pe),Yi=Oi+Math.atan(Zt.x*Math.sin(Wt)/(Pe*Math.cos(Wt)*Math.cos(ue)-Zt.y*Math.sin(Wt)*Math.sin(ue)));rt(`/goto/${ai(Yi)}/${ai(Fi)}`,qi=>{console.log("GoTo cmd",qi)})}};let y=J({CrosshairSize:.4,CrosshairOffsetX:0,CrosshairOffsetY:0,SphereScaleVF:1500,SphereScaleTel:24e3}),p=ne.subscribe(Y=>{for(let Q of Y)y[Q.id]=Q.value}),w=B("starfield-zoom.jpg"),E=B("starfield.jpg"),C=Lt(()=>Math.ceil(un(Math.asin(f/y.SphereScaleVF)))),z=Lt(()=>Math.ceil(un(Math.asin(f/y.SphereScaleTel))));ce(()=>{R(w,`${i()}:7777/stream_a.mjpg`),R(E,`${i()}:7777/stream_b.mjpg`),rt("/config/sphere/settings",Y=>{console.log("MOUNT",Y),ne.update(Q=>Q.map(tt=>tt!=null&&tt.id&&Object.hasOwn(Y,tt.id)?{...tt,value:Y[tt.id]}:{...tt}))})}),ht(()=>{h&&h(),p&&p(),m&&m()});var A=ya(),x=$(A);x.__click=[ma,S];var T=$(x);V(T,"viewBox",`0 0 ${f} ${v}`);var M=$(T);V(M,"width",f),V(M,"height",v);var N=$(M);k(M);var P=D(M);G(P,a,Y=>{ni(Y,{get scale(){return y.SphereScaleTel},steps:"0.2",get clipAngle(){return g(z)},get width(){return g(s)},get height(){return g(l)}})}),k(T),k(x);var L=D(x,2);L.__click=[wa,S];var _=$(L);V(_,"viewBox",`0 0 ${f} ${v}`);var j=$(_);V(j,"width",f),V(j,"height",v);var X=$(j);k(j);var H=D(j),K=$(H);V(K,"cx",f/2),V(K,"cy",v/2),pr(K,Y=>R(o,Y),()=>g(o));var lt=D(K);V(lt,"x",f/2),V(lt,"y",v/2);var pt=D(lt);G(pt,a,Y=>{ni(Y,{get scale(){return y.SphereScaleVF},steps:"5",get clipAngle(){return g(C)},get width(){return g(s)},get height(){return g(l)}})}),k(H),k(_),k(L),k(A),et(()=>{bt(x,`stream-wrapper ${(r()==="A"?"large":"")??""} svelte-zqlhxu`),V(T,"width",g(s)),V(T,"height",g(l)),V(N,"src",g(w)),bt(L,`stream-wrapper ${(r()==="B"?"large":"")??""} svelte-zqlhxu`),V(_,"width",g(s)),V(_,"height",g(l)),V(X,"src",g(E)),V(H,"transform",`translate(${f/4*y.CrosshairOffsetX} ${v/4*y.CrosshairOffsetY})`),V(lt,"transform",`translate(${g(s)*y.CrosshairSize*-.5} ${g(l)*y.CrosshairSize*-.5})`),V(lt,"width",g(s)*y.CrosshairSize),V(lt,"height",g(l)*y.CrosshairSize)}),Pn(A,"clientWidth",Y=>R(s,Y)),Pn(A,"clientHeight",Y=>R(l,Y)),I(e,A),it()}at(["click"]);var Sa=F('<div class="layer svelte-qmdbdl"><!></div>'),Ea=F('<div class="visuals svelte-qmdbdl"><!> <!></div>');function xa(e){const t=St(),n=()=>ot(be,"$displayCompass",t);var i=Ea(),r=$(i);ba(r,{});var a=D(r,2);G(a,n,s=>{var l=Sa(),f=$(l);kr(f,{}),k(l),I(s,l)}),k(i),I(e,i)}class Ma{constructor(t,n){this.stick=t,this.stick&&(this.callback=n,this.dragStart=null,this.touchId=null,this.maxDistance=200,this.deadZone=8,this.active=!1,this.value={x:0,y:0},this.counter=0,this.prev={x:0,y:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",i=>{this._handleDown(i)}),this.stick.addEventListener("touchstart",i=>{this._handleDown(i)}),document.addEventListener("mousemove",i=>{this._handleMove(i)},{passive:!1}),document.addEventListener("touchmove",i=>{this._handleMove(i)},{passive:!1}),document.addEventListener("mouseup",i=>{this._handleUp(i)}),document.addEventListener("touchend",i=>{this._handleUp(i)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.clientX,y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;let n=null;if(t.changedTouches){for(let m=0;m<t.changedTouches.length;m++)this.touchId===t.changedTouches[m].identifier&&(n=m,t.clientX=t.changedTouches[m].clientX,t.clientY=t.changedTouches[m].clientY);if(n==null)return}const i=this.stick.getBoundingClientRect(),r=i?Math.round(16e3/i.width)/100:1,a=t.clientX-this.dragStart.x,s=t.clientY-this.dragStart.y,l=Math.atan2(s,a),f=Math.min(this.maxDistance,Math.hypot(a,s)*r),v=f*Math.cos(l),o=f*Math.sin(l);this.stick.style.transform=`translate(${v}px, ${o}px)`;const c=f<this.deadZone?0:this.maxDistance/(this.maxDistance-this.deadZone)*(f-this.deadZone),u=c*Math.cos(l),h=c*Math.sin(l),d=parseFloat((u/this.maxDistance).toFixed(4)),b=parseFloat((h/this.maxDistance).toFixed(4));this.value={x:d,y:b},this._loop()}_handleUp(t){this.active&&(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier||(this.stick.style.transition=".2s",this.stick.style.transform="translate3d(0px, 0px, 0px)",this.value={x:0,y:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5+this.value.x*511.5),n=Math.round(511.5+this.value.y*511.5);this.callback(`/joystick/${t}/${n}`)}_debounce(t){return(...n)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...n)},this.debounceTimeout)}}_update(){(this.value.x!==this.prev.x||this.value.y!==this.prev.y)&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}class ka{constructor(t,n){this.stick=t,this.stick&&(this.callback=n,this.dragStart=null,this.touchId=null,this.maxDistance=230,this.deadZone=8,this.active=!1,this.value={f:0},this.counter=0,this.prev={f:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",i=>{this._handleDown(i)}),this.stick.addEventListener("touchstart",i=>{this._handleDown(i)}),document.addEventListener("mousemove",i=>{this._handleMove(i)},{passive:!1}),document.addEventListener("touchmove",i=>{this._handleMove(i)},{passive:!1}),document.addEventListener("mouseup",i=>{this._handleUp(i)}),document.addEventListener("touchend",i=>{this._handleUp(i)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{y:t.changedTouches[0].clientY}:{y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;t.preventDefault();let n=null;if(t.changedTouches){for(let f=0;f<t.changedTouches.length;f++)this.touchId===t.changedTouches[f].identifier&&(n=f,t.clientY=t.changedTouches[f].clientY);if(n==null)return}const i=this.stick.getBoundingClientRect(),r=i?Math.round(1e4/i.width)/100:1,a=t.clientY-this.dragStart.y,s=a>=0?Math.min(this.maxDistance,a*r):Math.max(-this.maxDistance,a*r);this.stick.style.transform=`translateY(${s}px)`;const l=Math.abs(s)>this.deadZone?parseFloat((s/this.maxDistance).toFixed(4)):0;this.value={f:l},this._loop()}_handleUp(t){this.active&&(t.preventDefault(),!(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier)&&(this.stick.style.transition=".2s",this.stick.style.transform="translateY(0px)",this.value={f:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5-this.value.f*511.5);this.callback(`/focus/${t}`)}_debounce(t){return(...n)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...n)},this.debounceTimeout)}}_update(){this.value.f!==this.prev.f&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}var $a=oe('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-1jgdvgh"><defs><circle id="joys-def-cir2" r="80" cy="0"></circle><path id="joys-def-arrow" d="M0 -120 -40 -100 40 -100z"></path><rect id="joys-def-slide" width="100" height="100" transform="translate(335 -50)" rx="15" ry="15"></rect></defs><g id="joys" transform="translate(320 355)" class="svelte-1jgdvgh"><use id="joys-arrow-top" href="#joys-def-arrow" class="svelte-1jgdvgh"></use><use id="joys-arrow-right" href="#joys-def-arrow" transform="rotate(90)" class="svelte-1jgdvgh"></use><use id="joys-arrow-left" href="#joys-def-arrow" transform="rotate(-90)" class="svelte-1jgdvgh"></use><use id="joys-arrow-bottom" href="#joys-def-arrow" transform="rotate(180)" class="svelte-1jgdvgh"></use><use id="joys-stick" href="#joys-def-cir2" style="transform: translate(0px, 0px)" class="svelte-1jgdvgh"></use><use id="joys-arrow-top" href="#joys-def-arrow" transform="translate(385 30)" class="svelte-1jgdvgh"></use><use id="joys-arrow-top" href="#joys-def-arrow" transform="translate(385 -30) rotate(180)" class="svelte-1jgdvgh"></use><use id="joys-slide" href="#joys-def-slide" style="transform: translateY(0px)" class="svelte-1jgdvgh"></use><a href="#toggle" role="button" tabindex="0" aria-label="Change to adjustment tool"><g id="joys-swap" transform="translate(-250,250)" class="svelte-1jgdvgh"><circle class="element svelte-1jgdvgh" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M6.121 13c-.553 0-1 .448-1 1s.447 1 1 1h1.465l-3.293 3.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.414-3.414v1.707c0 .552.447 1 1 1s.879-.448.879-1v-5h-4.879zM7 11c.552 0 1-.448 1-1v-2h2c.553 0 1-.448 1-1s-.447-1-1-1h-3.999l-.001 4c0 .552.447 1 1 1zM17 13c-.553 0-1 .448-1 1v2h-2c-.553 0-1 .448-1 1s.447 1 1 1h4v-4c0-.552-.447-1-1-1zM18.293 4.293l-3.293 3.293v-1.586c0-.552-.447-1-1-1s-1 .448-1 1v5h5c.552 0 1-.448 1-1s-.447-1-1-1h-1.586l3.293-3.292c.391-.391.391-1.023 0-1.414s-1.023-.392-1.414-.001z" class="svelte-1jgdvgh"></path></g></g></a></g></svg>');function Ta(e,t){nt(t,!0);let n=null,i=null;ce(()=>{n=new Ma(document.getElementById("joys-stick"),l=>{rt(l,f=>{console.log("SVELTE Joystick",f)})}),i=new ka(document.getElementById("joys-slide"),l=>{rt(l,f=>{console.log("SVELTE Focus",f)})})}),ht(()=>{n&&n.hasOwnProperty("destroy")&&n.destroy(),i&&i.hasOwnProperty("destroy")&&i.destroy()});var r=$a(),a=D($(r)),s=D($(a),8);s.__click=function(...l){var f;(f=t.toggle)==null||f.apply(this,l)},k(a),k(r),I(e,r),it()}at(["click"]);class Ca{constructor(t,n){if(this.adjust=t,this.adjust){this.callback=n;const i=8e4/360;this.axisSteps={lg:Math.round(i),md:Math.round(i/10),sm:Math.round(i/100)},this.adjust.addEventListener("mouseup",r=>{this.sendCommand(r.target.dataset)})}}destroy(){this.adjust.removeEventListener("mouseup",t=>{this.sendCommand(t.target.dataset)})}sendCommand(t){let n=t==null?void 0:t.dir,i=t==null?void 0:t.len;n&&i&&typeof this.axisSteps[i]=="number"&&(i=this.axisSteps[i],["closer","further"].indexOf(n)>=0&&(i=n==="closer"?-i:i,n="focus"),this.callback(`/adjust/${n}/${i}`))}}var Aa=oe('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-cf79tv"><defs><path id="arr1" d="M0 -80 40 -60 40 0 0 -20 -40 0 -40 -60z"></path><path id="arr2" d="M95 95 70 95 70 165 165 165 165 70 95 70z"></path><path id="arr3" d="M165 165 130 165 130 245 245 245 245 130 165 130z"></path><circle id="cir1" r="40" cy="30"></circle><circle id="cir2" r="50" cy="120"></circle><circle id="cir3" r="60" cy="230"></circle><path id="cir3" d="M-85 125 A 108 108 0 1 0 85 125 A 54 54 0 0 1 -85 125z"></path></defs><g id="adjust" transform="translate(355 355)" class="svelte-cf79tv"><g transform="rotate(0)"><use href="#arr1" transform="translate(0 -50)" data-dir="up" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="up" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="up" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(90)"><use href="#arr1" transform="translate(0 -50)" data-dir="right" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="right" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="right" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(180)"><use href="#arr1" transform="translate(0 -50)" data-dir="down" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="down" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="down" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(270)"><use href="#arr1" transform="translate(0 -50)" data-dir="left" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="left" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="left" data-len="lg" class="svelte-cf79tv"></use></g><g transform="translate(360 0)"><use href="#arr1" transform="translate(0 -50)" data-dir="further" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="further" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="further" data-len="lg" class="svelte-cf79tv"></use></g><g transform="translate(360 0) rotate(180)"><use href="#arr1" transform="translate(0 -50)" data-dir="closer" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="closer" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="closer" data-len="lg" class="svelte-cf79tv"></use></g><a href="#toggle" role="button" tabindex="0" aria-label="Change to Joystick"><g id="joys-swap" transform="translate(-285,250)" class="svelte-cf79tv"><circle class="element svelte-cf79tv" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M17.707 8.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l1.293 1.293h-4.586v-4.586l1.293 1.293c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-3.707-3.707-3.707 3.707c-.391.391-.391 1.023 0 1.414s1.023.391 1.414 0l1.293-1.293v4.586h-4.586l1.293-1.293c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-3.707 3.707 3.707 3.707c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-1.293-1.293h4.586v4.586l-1.293-1.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l3.707 3.707 3.707-3.707c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-1.293 1.293v-4.586h4.586l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707z" class="svelte-cf79tv"></path></g></g></a></g></svg>');function La(e,t){nt(t,!0);let n=null;ce(()=>{n=new Ca(document.getElementById("adjust"),s=>{rt(s,l=>{console.log("SVELTE Adjust",l)})})}),ht(()=>{n&&n.hasOwnProperty("destroy")&&n.destroy()});var i=Aa(),r=D($(i)),a=D($(r),6);a.__click=function(...s){var l;(l=t.toggle)==null||l.apply(this,s)},k(r),k(i),I(e,i),it()}at(["click"]);var ja=F('<div class="joystick-wrapper svelte-gruxg2"><!></div>');function Da(e){let t=B("mov");const n=a=>{a.preventDefault(),R(t,J(g(t)==="mov"?"adj":"mov"))};var i=ja(),r=$(i);G(r,()=>g(t)==="mov",a=>{Ta(a,{toggle:n})},a=>{La(a,{toggle:n})}),k(i),I(e,i)}var Pa=(e,t)=>{R(t,!1)},Ia=F('<header><input type="text" id="address" placeholder="Address"></header> <div class="flexbox"><input type="text" id="latitude" placeholder="Latitude"> <input type="text" id="longitude" placeholder="Longitude"></div> <button class="button button-small">Save location</button> <button class="button">Cancel</button>',1),Ra=(e,t)=>{R(t,!0)},za=F('<header> <button class="edit-button icon-edit" aria-label="Edit"></button></header>'),Na=F("<div> </div>"),Oa=F("<!> <!>",1),Fa=(e,t,n)=>t(e,`/navi/position/${g(n).id}`),Ya=(e,t,n)=>t(g(n).id),qa=F('<button class="delete-button icon-delete" aria-label="Delete" title="Delete"></button>'),Ba=F("<li><button> </button> <!></li>"),Va=F('<div class="nav-add"><label for="new-name">Save/update current position as ...</label> <input type="text" id="new-name" class="input" placeholder="Enter position name"> <div class="margin-bottom"><sub> </sub></div> <button class="button button-small">Save target</button></div>'),Xa=F('<div class="nav-selector"><button class="button button-small">Change location</button></div>'),Ha=F('<div class="content-card"><div class="nav-curr-pos"><!></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function Ua(e,t){nt(t,!0);const n=St(),i=()=>ot(mt,"$positions",n),r=()=>ot(le,"$arduinoSettings",n);let a=B(!1),s=B(""),l=Lt(()=>cn(g(s))),f=B(""),v=B(""),o=B(""),c=B(J([]));const u=mt.subscribe(x=>{x!=null&&x.fid&&(R(f,J(x.geo.addr)),R(v,J(x.geo.lat)),R(o,J(x.geo.lon)),R(c,J([...x.base])))});ht(()=>{u&&u()});const h=()=>{const x={...i()};De(`/navi/position/update/${x.fid}`,x,T=>{console.log("SVELTE saved",T)})},d=()=>{const x={addr:g(f),lat:parseFloat(g(v)),lon:parseFloat(g(o))};mt.update(T=>({...T,geo:x})),h(),R(a,!1)},b=()=>{const x=cn(g(s));if(x){let T=!1;const M=(({x:P,y:L,f:_})=>({x:P,y:L,f:_}))(r());let N=g(c).map(P=>P.id!==x?P:(T=!0,{...P,pos:M}));T||N.push({id:x,name:g(s),pos:M}),mt.update(P=>({...P,base:N})),h(),R(s,"")}R(a,!1)},m=x=>x==="home"?"icon-home":x==="polaris"?"icon-star":"icon-target",S=x=>{if(confirm(`Do you really want to delete position: "${x}"`)){const T=[...i().base].filter(M=>M.id!==x);mt.update(M=>({...M,base:T})),h(),R(a,!1)}},y=(x,T)=>{x.preventDefault(),rt(T,M=>{console.log("SVELTE position",M)})};var p=Ha(),w=$(p),E=$(w);G(E,()=>g(a),x=>{var T=Ia(),M=gt(T),N=$(M);Ot(N),k(M);var P=D(M,2),L=$(P);Ot(L);var _=D(L,2);Ot(_),k(P);var j=D(P,2);j.__click=d;var X=D(j,2);X.__click=[Pa,a],Ft(N,()=>g(f),H=>R(f,H)),Ft(L,()=>g(v),H=>R(v,H)),Ft(_,()=>g(o),H=>R(o,H)),I(x,T)},x=>{var T=Oa(),M=gt(T);G(M,()=>g(f),P=>{var L=za(),_=$(L),j=D(_);j.__click=[Ra,a],k(L),et(()=>_t(_,`${g(f)??""} `)),I(P,L)});var N=D(M,2);G(N,()=>g(v)&&g(o),P=>{var L=Na(),_=$(L);k(L),et(()=>_t(_,`${g(v)??""}°, ${g(o)??""}°`)),I(P,L)}),I(x,T)}),k(w);var C=D(w,2),z=$(C);Pt(z,21,()=>g(c),Vt,(x,T)=>{var M=Ba(),N=$(M);const P=Lt(()=>`nav-button ${m(g(T).id)??""}`);N.__click=[Fa,y,T];var L=$(N,!0);k(N);var _=D(N,2);G(_,()=>g(a)&&g(T).id!=="home"&&g(T).id!=="polaris",j=>{var X=qa();X.__click=[Ya,S,T],I(j,X)}),k(M),et(()=>{bt(N,g(P)),_t(L,g(T).name)}),I(x,M)}),k(z),k(C);var A=D(C,2);G(A,()=>g(a),x=>{var T=Va(),M=D($(T),2);Ot(M);var N=D(M,2),P=$(N),L=$(P);k(P),k(N);var _=D(N,2);_.__click=b,k(T),et(()=>{_t(L,`ID: ${g(l)??""}`),_.disabled=g(l).length<3}),Ft(M,()=>g(s),j=>R(s,j)),I(x,T)},x=>{var T=Xa(),M=$(T);M.__click=function(...N){var P;(P=t.toggleAdmin)==null||P.apply(this,N)},k(T),I(x,T)}),k(p),I(e,p),it()}at(["click"]);const Za=(e,t)=>{R(t,!g(t))};var Wa=(e,t,n)=>t(g(n).fid),Ga=(e,t,n)=>t(g(n).fid),Ja=F('<button class="delete-button icon-delete" aria-label="Delete"></button>'),Ka=F('<li><button class="nav-button icon-location"> </button> <!></li>'),Qa=(e,t)=>t(),ts=F('<div class="nav-add"><input type="text" id="new-location" class="input" placeholder="Enter new location name"> <button class="button">+&nbsp;Add</button></div> <div> </div>',1),es=F('<div class="nav-selector"><button class="button button-small">&laquo;&nbsp;Back</button></div>'),ns=F('<div class="content-card"><header>Locations <button aria-label="Edit"></button></header> <div class="nav-curr-pos"><div><p>The location is the place where your telescope is placed.</p></div></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function is(e,t){nt(t,!0);const n=St(),i=()=>ot(fe,"$locations",n);let r=B("");const a=mt.subscribe(y=>{R(r,J(y.fid))});ht(()=>{a&&a()});let s=B(!1),l=B(""),f=Lt(()=>cn(g(l)));const v=y=>{y!==g(r)&&rt(`/navi/location/${y}`,p=>{(p==null?void 0:p.fid)===y&&(mt.update(w=>({...p})),console.log("Loaded location"))})},o=()=>{if(g(f).length>=3){const y=ga(g(f),g(l));De(`/navi/position/update/${g(f)}`,y,p=>{mt.update(w=>y),fe.update(w=>[...w,{fid:g(f),addr:g(l)}]),R(l,""),console.log("Added new location",p)})}else console.error("ID is too short. At least 3 char are required.")},c=y=>{confirm(`Do you really want to delete location: "${y}"`)?rt(`/navi/location/delete/${y}`,p=>{p.response===200&&(fe.update(w=>w.filter(E=>E.fid!==y)),alert(`Location "${y}" deleted`))}):alert(`Deletion of "${y}" canceled.`)};ce(()=>{i().length===0&&rt("/navi/location-list",y=>{fe.update(p=>[...y]),console.log("Loaded location list")})});var u=ns(),h=$(u),d=D($(h));d.__click=[Za,s],k(h);var b=D(h,4),m=$(b);Pt(m,5,i,Vt,(y,p)=>{var w=Ka(),E=$(w);E.__click=[Wa,v,p];var C=$(E,!0);k(E);var z=D(E,2);G(z,()=>g(s)&&g(p).fid!==g(r)&&g(p).fid!=="index",A=>{var x=Ja();x.__click=[Ga,c,p],I(A,x)}),k(w),et(()=>{bt(w,g(p).fid===g(r)?"active":""),_t(C,g(p).addr)}),I(y,w)}),k(m),k(b);var S=D(b,2);G(S,()=>g(s),y=>{var p=ts(),w=gt(p),E=$(w);Ot(E);var C=D(E,2);C.__click=[Qa,o],k(w);var z=D(w,2),A=$(z,!0);k(z),et(()=>_t(A,g(f))),Ft(E,()=>g(l),x=>R(l,x)),I(y,p)},y=>{var p=es(),w=$(p);w.__click=function(...E){var C;(C=t.toggleAdmin)==null||C.apply(this,E)},k(p),I(y,p)}),k(u),et(()=>bt(d,`edit-button icon-edit${(g(s)?" active":"")??""}`)),I(e,u),it()}at(["click"]);function rs(e,t){nt(t,!0);const n=St(),i=()=>ot(mt,"$positions",n);let r=B(!1);const a=()=>{R(r,!g(r))};ce(()=>{var f;(f=i())!=null&&f.fid||rt("/navi/location/index",v=>{(v==null?void 0:v.fid)==="index"&&mt.update(o=>({...v}))})});var s=Tt(),l=gt(s);G(l,()=>g(r),f=>{is(f,{toggleAdmin:a})},f=>{Ua(f,{toggleAdmin:a})}),I(e,s),it()}var as=(e,t,n,i)=>{t()(n.id,i())},ss=(e,t,n,i)=>{t()(n.id,i())},os=F('<div class="slider-wrapper svelte-1qw7onx"><label class="svelte-1qw7onx"> </label> <input type="range" class="svelte-1qw7onx"></div>');function zi(e,t){nt(t,!0);let n=kt(t,"oninput",3,()=>{}),i=kt(t,"onchange",3,()=>{}),r=kt(t,"value",7,0),a=kt(t,"minValue",3,0),s=kt(t,"maxValue",3,10),l=kt(t,"steps",3,1);var f=os(),v=$(f),o=$(v,!0);k(v);var c=D(v,2);Ot(c),c.__change=[as,i,t,r],c.__input=[ss,n,t,r],k(f),et(()=>{V(v,"for","slider_slide_"+t.id),_t(o,t.name),V(c,"id","slider_slide_"+t.id),V(c,"min",a()),V(c,"max",s()),V(c,"step",l())}),Ft(c,r),I(e,f),it()}at(["change","input"]);var ls=F('<div class="camera-options svelte-1x08sfe"><!> <div class="actions-wrapper svelte-1x08sfe"><button class="svelte-1x08sfe">Reset defaults</button></div></div>');function cs(e,t){nt(t,!1);const n=St(),i=()=>ot(Ne,"$camControls",n),r=(o,c)=>{Ne.update(u=>u.map(h=>h.id===o?{...h,value:c}:{...h})),rt(`/cam/ctrl/${o}/${c}`,u=>{console.log("SVELTE CamCtrl",u)})},a=()=>{Ne.update(c=>c.map(u=>({...u,value:u.defaultValue})));const o={};for(let c of i())c!=null&&c.id&&(o[c.id]=c.defaultValue);De("/cam/controls",o,c=>{console.log("SVELTE Cam Controls",c)})};hi();var s=ls(),l=$(s);Pt(l,3,i,o=>o.name,(o,c,u)=>{zi(o,vi(()=>g(c),{get index(){return g(u)},onchange:r}))});var f=D(l,2),v=$(f);v.__click=a,k(f),k(s),I(e,s),it()}at(["click"]);const us=()=>{Se.update(e=>!e)};var fs=oe('<polygon points="-15,-15 -15,15 15,15 15,-15" stroke-width="5" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),ds=oe('<polygon points="-7.5,-22.5 -7.5,22.5 20,0" stroke-width="10" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),vs=F('<div id="video-recording" class="svelte-1h8ia9r"><button aria-label="Record video" class="svelte-1h8ia9r"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" preserveAspectRatio="xMinYMin slice" class="svelte-1h8ia9r"><g transform="translate(42,42)"><circle r="38" stroke-width="5" class="svelte-1h8ia9r"></circle><!></g></svg></button></div>');function hs(e,t){nt(t,!0);let n=B(!1);const i=Se.subscribe(v=>{if(g(n)!==v){R(n,J(v));const o=g(n)?"start":"stop";rt(`/cam/video-rec/vid/${o}`,c=>{console.log("Video recording",c)})}});ht(()=>{i&&i()});var r=vs(),a=$(r);a.__click=[us];var s=$(a),l=$(s),f=D($(l));G(f,()=>g(n),v=>{var o=fs();I(v,o)},v=>{var o=ds();I(v,o)}),k(l),k(s),k(a),k(r),I(e,r),it()}at(["click"]);var ps=F('<h3 class="message svelte-2mgxfn"><!></h3>'),gs=F('<div class="sphere-config svelte-2mgxfn"><!> <!> <div class="actions-wrapper svelte-2mgxfn"><a href="/system" class="button"><span class="icon-settings"></span>System</a> <button class="button">Save settings</button></div></div>');function _s(e,t){nt(t,!0);const n=St(),i=()=>ot(ne,"$sphereControls",n);let r=B(void 0),a=B(J([]));const s=ne.subscribe(d=>{R(a,J(d.map(b=>({...b}))))}),l=(d,b)=>{console.log(),ne.update(m=>m.map(S=>S.id===d?{...S,value:b}:{...S}))},f=()=>{const d={};for(let b of i())d[b.id]=b.value;De("/config/sphere/settings",d,b=>{R(r,J((b==null?void 0:b.response)===200?'<span style="color:#090">Successfully saved settings.</span>':'<span style="color:#B00">Failed to save settings.</span>')),setTimeout(()=>{R(r,null)},5e3)})};ht(()=>{s&&s()});var v=gs(),o=$(v);G(o,()=>g(r),d=>{var b=ps(),m=$(b);yr(m,()=>g(r)),k(b),I(d,b)});var c=D(o,2);Pt(c,17,()=>g(a),Vt,(d,b,m)=>{zi(d,vi(()=>g(b),{index:m,oninput:l}))});var u=D(c,2),h=D($(u),2);h.__click=f,k(u),k(v),I(e,v),it()}at(["click"]);const ms=(e,t)=>{const n=t()==="B"?"cam_b":"cam_a";rt(`/cam/capture-img/image/${n}`,i=>{console.log("Capture image",i)})},ws=(e,t,n,i)=>{const r=t()==="B"?"cam_b":"cam_a";rt(`/cam/snail-shot/${g(n)}/${g(i)}/${r}`,a=>{console.log("Snails",a,r)})};var ys=(e,t)=>console.log("X:",g(t)),bs=F("<option></option>"),Ss=(e,t)=>console.log("Y:",g(t)),Es=F("<option></option>"),xs=F('<div id="image-capture" class="svelte-2mcnnf"><button aria-label="Capture image" class="svelte-2mcnnf"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-2mcnnf"><g transform="translate(42,42)"><circle r="28" fill="#C00" stroke="#C00"></circle><circle r="38" class="capture-button svelte-2mcnnf"></circle></g></svg></button> <button aria-label="Snail shot" class="svelte-2mcnnf"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-2mcnnf"><g transform="translate(42,42)"><polyline points="0,0 20,0 20,15 -20,15 -20,-15 40,-15 40,30 -20,30 -12,28 -12,32 -20,30" class="svelte-2mcnnf"></polyline></g></svg></button> <div class="dimensions svelte-2mcnnf"><label class="svelte-2mcnnf"><span class="svelte-2mcnnf">hor</span><select class="svelte-2mcnnf"></select></label> <label class="svelte-2mcnnf"><span class="svelte-2mcnnf">ver</span><select class="svelte-2mcnnf"></select></label></div></div>');function Ms(e,t){nt(t,!0);const n=St(),i=()=>ot(we,"$swapPreview",n);let r=B(3),a=B(3);var s=xs(),l=$(s);l.__click=[ms,i];var f=D(l,2);f.__click=[ws,i,r,a];var v=D(f,2),o=$(v),c=D($(o));c.__change=[ys,r],Pt(c,20,()=>Array.from({length:7}),Vt,(d,b,m)=>{var S=bs();S.value=(S.__value=m+3)==null?"":m+3,S.textContent=m+3,I(d,S)}),k(c),k(o);var u=D(o,2),h=D($(u));h.__change=[Ss,a],Pt(h,20,()=>Array.from({length:7}),Vt,(d,b,m)=>{var S=Es();S.value=(S.__value=m+3)==null?"":m+3,S.textContent=m+3,I(d,S)}),k(h),k(u),k(v),k(s),Dn(c,()=>g(r),d=>R(r,d)),Dn(h,()=>g(a),d=>R(a,d)),I(e,s),it()}at(["click","change"]);var ks=F('<div class="controls svelte-bwwnlr"><div class="tools svelte-bwwnlr"><!></div></div>');function $s(e){const t=St(),n=()=>ot(Xe,"$toolTab",t);var i=Tt(),r=gt(i);G(r,n,a=>{var s=ks(),l=$(s),f=$(l);G(f,()=>n()==="target",v=>{Da(v)},v=>{var o=Tt(),c=gt(o);G(c,()=>n()==="sphere",u=>{_s(u,{})},u=>{var h=Tt(),d=gt(h);G(d,()=>n()==="location",b=>{rs(b,{})},b=>{var m=Tt(),S=gt(m);G(S,()=>n()==="adjust",y=>{cs(y,{})},y=>{var p=Tt(),w=gt(p);G(w,()=>n()==="video",E=>{hs(E,{})},E=>{var C=Tt(),z=gt(C);G(z,()=>n()==="picture",A=>{Ms(A,{})},null,!0),I(E,C)},!0),I(y,p)},!0),I(b,m)},!0),I(u,h)},!0),I(v,o)}),k(l),k(s),I(a,s)}),I(e,i)}var Ts=F('<li><button><span class="svelte-dso250"> </span></button></li>'),Cs=F('<div id="options-menu" class="svelte-dso250"><ul class="svelte-dso250"></ul></div>');function As(e,t){nt(t,!0);let n=B("");const i=Xe.subscribe(o=>{R(n,J(o))});let r=B(!1);const a=be.subscribe(o=>{R(r,J(o))}),s=o=>{Xe.update(c=>c===o?"":o)};ht(()=>{i&&i(),a&&a()});const l=[{id:"sphere",name:"Sphere",icon:"icon-settings",callback:()=>{s("sphere")},enabled:()=>g(n)==="sphere"},{id:"compass",name:"Compass",icon:"icon-compass",callback:()=>{be.update(o=>!o)},enabled:()=>g(r)},{id:"location",name:"Location",icon:"icon-location",callback:()=>{s("location")},enabled:()=>g(n)==="location"},{id:"target",name:"Target",icon:"icon-target",callback:()=>{s("target")},enabled:()=>g(n)==="target"},{id:"adjust",name:"Contrast",icon:"icon-adjust",callback:()=>{s("adjust")},enabled:()=>g(n)==="adjust"},{id:"video",name:"Video",icon:"icon-video",callback:()=>{s("video")},enabled:()=>g(n)==="video"},{id:"picture",name:"Picture",icon:"icon-image",callback:()=>{s("picture")},enabled:()=>g(n)==="picture"}];var f=Cs(),v=$(f);Pt(v,21,()=>l,Vt,(o,c)=>{var u=Ts();const h=Lt(()=>`${(g(c).enabled()?"active":"")??""} svelte-dso250`);var d=$(u);d.__click=function(...S){var y;(y=g(c).callback)==null||y.apply(this,S)};var b=$(d),m=$(b,!0);k(b),k(d),k(u),et(()=>{bt(u,g(h)),bt(d,`${g(c).icon??""} svelte-dso250`),_t(m,g(c).name)}),I(o,u)}),k(v),k(f),I(e,f),it()}at(["click"]);var Ls=F('<div><button class="task--button video-recorder svelte-1btt76e" aria-label="Stop video recording"><span class="icon-stop"></span> <span class="time"> </span></button></div>');function js(e,t){nt(t,!0);const n={elapsedTime:0};let i=B("00:00:00");function r(c,u,h){const d=[c,u,h].map(b=>b<10?`0${b}`:b);R(i,J(d.join(":")))}function a(){n.startTime=Date.now(),n.intervalId=setInterval(()=>{const c=Date.now()-n.startTime+n.elapsedTime,u=parseInt(c/1e3%60,10),h=parseInt(c/(1e3*60)%60,10),d=parseInt(c/(1e3*60*60)%24,10);r(d,h,u)},1e3)}function s(){n.intervalId&&(clearInterval(n.intervalId),Se.update(()=>!1),R(i,"00:00:00"))}let l=B(!1);const f=Se.subscribe(c=>{c!==g(l)&&(c?a():s(),R(l,J(c)))});ht(()=>{f&&f()});var v=Tt(),o=gt(v);G(o,()=>g(l),c=>{var u=Ls(),h=$(u);h.__click=s;var d=D($(h),2),b=$(d,!0);k(d),k(h),k(u),et(()=>_t(b,g(i))),I(c,u)}),I(e,v),it()}at(["click"]);const Ds=(e,t)=>{document.fullscreenElement?(document.exitFullscreen(),R(t,!1)):(document.documentElement.requestFullscreen(),R(t,!0))};var Ps=F('<button class="task--button" aria-label="Switch fullscreen mode"><span></span></button>');function Is(e){let t=B(!1);var n=Ps();n.__click=[Ds,t];var i=$(n);k(n),et(()=>bt(i,g(t)?"icon-viewport":"icon-fullscreen")),I(e,n)}at(["click"]);const Rs=()=>{pn.update(e=>!e)};var zs=F('<button class="task--button daylight-button svelte-192ooay" aria-label="Switch daylight mode"><span></span></button>');function Ns(e,t){nt(t,!0);let n=B(!1),i=pn.subscribe(s=>{R(n,J(s))});ht(()=>{i&&i()});var r=zs();r.__click=[Rs];var a=$(r);k(r),et(()=>bt(a,g(n)?"icon-dark":"icon-light")),I(e,r),it()}at(["click"]);var Os=F('<div class="tasks svelte-1laysiz"><!> <!> <!></div>');function Fs(e){var t=Os(),n=$(t);js(n,{});var i=D(n,2);Is(i);var r=D(i,2);Ns(r,{}),k(t),I(e,t)}var Ys=F("<div><!> <!> <!> <!></div>");function Js(e){const t=St(),n=()=>ot(pn,"$daylight",t);var i=Ys(),r=$(i);Fs(r);var a=D(r,2);xa(a);var s=D(a,2);$s(s);var l=D(s,2);As(l,{}),k(i),et(()=>bt(i,`${"container"+(n()?" daylight":"")} svelte-183uj8y`)),I(e,i)}export{Js as component};
