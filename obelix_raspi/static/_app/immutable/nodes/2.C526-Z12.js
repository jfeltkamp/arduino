import{b as Ze,e as ii,a as D,t as Y,n as Qt,c as Tt}from "../chunks/disclose-version.CVdQhuh4.js";import{A as ri,F as ke,U as Ge,C as ai,G as Je,ae as si,at as oi,as as li,T as ci,a9 as ui,D as di,aC as fi,r as vi,e as Tn,H as nt,b as z,M as $,O as P,N as E,K as at,J as it,aD as We,a as v,aB as V,i as Et,I as ht}from "../chunks/runtime.CdqqS4Bm.js";import{a as te,b as ce,c as Gt,o as et,e as hi,f as de,s as $t,p as pt,g as we,h as ie,i as Se,v as jn,t as Te,T as pi,d as gi}from "../chunks/Tasks.DpKWIL6o.js";import{a as _t,d as vt,s as yt,b as st}from "../chunks/store.D6nl9me4.js";import{b as mi,a as wt,p as W,o as ee,i as J}from "../chunks/index-client.DBmkXexQ.js";import{a as _i,s as B,b as Ke,r as At,e as jt,i as qt}from "../chunks/size.BnFFJ2ou.js";import{i as Cn}from "../chunks/lifecycle.Tf9ZFBZr.js";import{b as yi}from "../chunks/this.DSTkaCEA.js";import{p as Mt,s as Ln}from "../chunks/props.DaeUU8jY.js";import{g as wi,a as bi}from "../chunks/entry.ChLqfm6M.js";function Si(e, t, i, n, r){var a=e,s="",l;ri(()=>{if(s===(s=t()??"")){ke&&Ge();return}l!==void 0&&(di(l),l=void 0),s!==""&&(l=ai(()=>{if(ke){Je.data;for(var u=Ge(),f=u; u!==null&&(u.nodeType!==8||u.data!=="");)f=u,u=si(u);if(u===null)throw oi(),li;Ze(Je,f),a=ci(u);return}var o=s+"",c=ii(o);Ze(ui(c),c.lastChild),a.before(c)}))})}function Pn(e, t, i, n=i){e.addEventListener(t,i);const r=e.__on_r;r?e.__on_r=()=>{r(),n()}:e.__on_r=n,_i()}function Dt(e, t, i=t){var n=fi();Pn(e,"input",()=>{var r=Qe(e)?tn(e.value):e.value;i(r),n&&r!==(r=t())&&(e.value=r??"")}),vi(()=>{var r=t();if(ke&&e.defaultValue!==e.value){i(e.value);return}Qe(e)&&r===tn(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function Qe(e){var t=e.type;return t==="number"||t==="range"}function tn(e){return e===""?null:+e}function Rn(e, t, i){if(e.multiple)return xi(e,t);for(var n of e.options){var r=Jt(n);if(mi(r,t)){n.selected=!0;return}}(!i||t!==void 0)&&(e.selectedIndex=-1)}function Mi(e, t){Tn(()=>{var i=new MutationObserver(()=>{var n=e.__value;Rn(e,n)});return i.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{i.disconnect()}})}function en(e, t, i=t){var n=!0;Pn(e,"change",()=>{var r;if(e.multiple)r=[].map.call(e.querySelectorAll(":checked"),Jt);else{var a=e.querySelector(":checked");r=a&&Jt(a)}i(r)}),Tn(()=>{var r=t();if(Rn(e,r,n),n&&r===void 0){var a=e.querySelector(":checked");a!==null&&(r=Jt(a),i(r))}e.__value=r,n=!1}),Mi(e)}function xi(e, t){for(var i of e.options)i.selected=~t.indexOf(Jt(i))}function Jt(e){return"__value"in e?e.__value:e.value}var Ei=Y('<div id="horizon-wrapper" class="svelte-14er9jv"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 220" width="220" height="220" class="svelte-14er9jv"><defs><path id="altitude" d="M32 0 108 0" stroke-width="2" stroke-linecap="round"></path><path id="altitudeText" d="M40 -4 108 -4" stroke="#000" stroke-linecap="round"></path></defs><g id="compass" transform="translate(110 110)"><circle r="32" class="compass svelte-14er9jv" stroke-width="2"></circle><circle r="30" class="compass--scale svelte-14er9jv" stroke-dasharray="2 21.5619449019" stroke-dashoffset="1" stroke-width="6"></circle><g><polygon class="compass--needle svelte-14er9jv" points="-10,10 0,-30 0,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" fill="#000"></polygon><polygon class="compass--needle svelte-14er9jv" points="10,10 0,-30 0,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" fill="#FFF"></polygon></g><g><use class="compass--alt svelte-14er9jv" href="#altitude"></use><text class="compass--text svelte-14er9jv" font-size="20"><textPath href="#altitudeText"> </textPath></text></g><text class="compass--text svelte-14er9jv" font-size="20" text-anchor="middle" y="50"> </text></g></svg></div>');function $i(e, t){nt(t,!1);let i=We(),n=We();const r=te.subscribe(y=>{z(i,y.deg_x),z(n,y.deg_y)});wt(()=>{r&&r()}),Cn();var a=Ei(),s=$(a),l=P($(s)),u=P($(l),2),f=P(u),o=P($(f)),c=$(o),d=$(c);E(c),E(o),E(f);var p=P(f),h=$(p);E(p),E(l),E(s),E(a),at(()=>{B(u,"transform",`rotate(${v(i)??""})`),B(f,"transform",`rotate(${-v(n)})`),_t(d,`${v(n)??""}°`),_t(h,`${v(i)??""}°`)}),D(e,a),it()}class Ct{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const i=this._partials;let n=0;for(let r=0; r<this._n&&r<32; r++){const a=i[r],s=t+a,l=Math.abs(t)<Math.abs(a)?t-(s-a):a-(s-t);l&&(i[n++]=l),t=s}return i[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let i=this._n,n,r,a,s=0;if(i>0){for(s=t[--i]; i>0&&(n=s,r=t[--i],s=n+r,a=r-(s-n),!a););i>0&&(a<0&&t[i-1]<0||a>0&&t[i-1]>0)&&(r=a*2,n=s+r,r==n-s&&(s=n))}return s}}function*ki(e){for(const t of e)yield*t}function An(e){return Array.from(ki(e))}function zt(e, t, i){e=+e,t=+t,i=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+i;for(var n=-1,r=Math.max(0,Math.ceil((t-e)/i))|0,a=new Array(r); ++n<r;)a[n]=e+n*i;return a}var N=1e-6,Ti=1e-12,F=Math.PI,ct=F/2,nn=F/4,dt=F*2,St=180/F,rt=F/180,U=Math.abs,ji=Math.atan,Nt=Math.atan2,G=Math.cos,re=Math.ceil,Z=Math.sin,Ci=Math.sign||function(e){return e>0?1:e<0?-1:0},kt=Math.sqrt;function Li(e){return e>1?0:e<-1?F:Math.acos(e)}function Lt(e){return e>1?ct:e<-1?-ct:Math.asin(e)}function ut(){}function fe(e, t){e&&an.hasOwnProperty(e.type)&&an[e.type](e,t)}var rn={Feature:function(e, t){fe(e.geometry,t)},FeatureCollection:function(e, t){for(var i=e.features,n=-1,r=i.length; ++n<r;)fe(i[n].geometry,t)}},an={Sphere:function(e, t){t.sphere()},Point:function(e, t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e, t){for(var i=e.coordinates,n=-1,r=i.length; ++n<r;)e=i[n],t.point(e[0],e[1],e[2])},LineString:function(e, t){je(e.coordinates,t,0)},MultiLineString:function(e, t){for(var i=e.coordinates,n=-1,r=i.length; ++n<r;)je(i[n],t,0)},Polygon:function(e, t){sn(e.coordinates,t)},MultiPolygon:function(e, t){for(var i=e.coordinates,n=-1,r=i.length; ++n<r;)sn(i[n],t)},GeometryCollection:function(e, t){for(var i=e.geometries,n=-1,r=i.length; ++n<r;)fe(i[n],t)}};function je(e, t, i){var n=-1,r=e.length-i,a;for(t.lineStart(); ++n<r;)a=e[n],t.point(a[0],a[1],a[2]);t.lineEnd()}function sn(e, t){var i=-1,n=e.length;for(t.polygonStart(); ++i<n;)je(e[i],t,1);t.polygonEnd()}function Rt(e, t){e&&rn.hasOwnProperty(e.type)?rn[e.type](e,t):fe(e,t)}function Ce(e){return[Nt(e[1],e[0]),Lt(e[2])]}function Ot(e){var t=e[0],i=e[1],n=G(i);return[n*G(t),n*Z(t),Z(i)]}function ae(e, t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ve(e, t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Me(e, t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function se(e, t){return[e[0]*t,e[1]*t,e[2]*t]}function Le(e){var t=kt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Pe(e, t){function i(n, r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(i.invert=function(n, r){return n=t.invert(n,r),n&&e.invert(n[0],n[1])}),i}function Re(e, t){return U(e)>F&&(e-=Math.round(e/dt)*dt),[e,t]}Re.invert=Re;function Pi(e, t, i){return(e%=dt)?t||i?Pe(ln(e),cn(t,i)):ln(e):t||i?cn(t,i):Re}function on(e){return function(t, i){return t+=e,U(t)>F&&(t-=Math.round(t/dt)*dt),[t,i]}}function ln(e){var t=on(e);return t.invert=on(-e),t}function cn(e, t){var i=G(e),n=Z(e),r=G(t),a=Z(t);function s(l, u){var f=G(u),o=G(l)*f,c=Z(l)*f,d=Z(u),p=d*i+o*n;return[Nt(c*r-p*a,o*i-d*n),Lt(p*r+c*a)]}return s.invert=function(l, u){var f=G(u),o=G(l)*f,c=Z(l)*f,d=Z(u),p=d*r-c*a;return[Nt(c*r+d*a,o*i+p*n),Lt(p*i-o*n)]},s}function Ri(e, t, i, n, r, a){if(i){var s=G(t),l=Z(t),u=n*i;r==null?(r=t+n*dt,a=t-u/2):(r=un(s,r),a=un(s,a),(n>0?r<a:r>a)&&(r+=n*dt));for(var f,o=r; n>0?o>a:o<a; o-=u)f=Ce([s,-l*G(o),-l*Z(o)]),e.point(f[0],f[1])}}function un(e, t){t=Ot(t),t[0]-=e,Le(t);var i=Li(-t[1]);return((-t[2]<0?-i:i)+dt-N)%dt}function Dn(){var e=[],t;return{point:function(i, n, r){t.push([i,n,r])},lineStart:function(){e.push(t=[])},lineEnd:ut,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function ue(e, t){return U(e[0]-t[0])<N&&U(e[1]-t[1])<N}function oe(e, t, i, n){this.x=e,this.z=t,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function zn(e, t, i, n, r){var a=[],s=[],l,u;if(e.forEach(function(h){if(!((y=h.length-1)<=0)){var y,w=h[0],b=h[y],_;if(ue(w,b)){if(!w[2]&&!b[2]){for(r.lineStart(),l=0; l<y; ++l)r.point((w=h[l])[0],w[1]);r.lineEnd();return}b[0]+=2*N}a.push(_=new oe(w,h,null,!0)),s.push(_.o=new oe(w,null,_,!1)),a.push(_=new oe(b,h,null,!1)),s.push(_.o=new oe(b,null,_,!0))}}),!!a.length){for(s.sort(t),dn(a),dn(s),l=0,u=s.length; l<u; ++l)s[l].e=i=!i;for(var f=a[0],o,c;;){for(var d=f,p=!0; d.v;)if((d=d.n)===f)return;o=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(l=0,u=o.length; l<u; ++l)r.point((c=o[l])[0],c[1]);else n(d.x,d.n.x,1,r);d=d.n}else{if(p)for(o=d.p.z,l=o.length-1; l>=0; --l)r.point((c=o[l])[0],c[1]);else n(d.x,d.p.x,-1,r);d=d.p}d=d.o,o=d.z,p=!p}while(!d.v);r.lineEnd()}}}function dn(e){if(t=e.length){for(var t,i=0,n=e[0],r; ++i<t;)n.n=r=e[i],r.p=n,n=r;n.n=r=e[0],r.p=n}}function xe(e){return U(e[0])<=F?e[0]:Ci(e[0])*((U(e[0])+F)%dt-F)}function Ai(e, t){var i=xe(t),n=t[1],r=Z(n),a=[Z(i),-G(i),0],s=0,l=0,u=new Ct;r===1?n=ct+N:r===-1&&(n=-ct-N);for(var f=0,o=e.length; f<o; ++f)if(d=(c=e[f]).length)for(var c,d,p=c[d-1],h=xe(p),y=p[1]/2+nn,w=Z(y),b=G(y),_=0; _<d; ++_,h=S,w=j,b=I,p=g){var g=c[_],S=xe(g),T=g[1]/2+nn,j=Z(T),I=G(T),A=S-h,M=A>=0?1:-1,k=M*A,x=k>F,q=w*j;if(u.add(Nt(q*M*Z(k),b*I+q*G(k))),s+=x?A+M*dt:A,x^h>=i^S>=i){var R=ve(Ot(p),Ot(g));Le(R);var C=ve(a,R);Le(C);var m=(x^A>=0?-1:1)*Lt(C[2]);(n>m||n===m&&(R[0]||R[1]))&&(l+=x^A>=0?1:-1)}}return(s<-N||s<N&&u<-Ti)^l&1}function In(e, t, i, n){return function(r){var a=t(r),s=Dn(),l=t(s),u=!1,f,o,c,d={point:p,lineStart:y,lineEnd:w,polygonStart:function(){d.point=b,d.lineStart=_,d.lineEnd=g,o=[],f=[]},polygonEnd:function(){d.point=p,d.lineStart=y,d.lineEnd=w,o=An(o);var S=Ai(f,n);o.length?(u||(r.polygonStart(),u=!0),zn(o,zi,S,i,r)):S&&(u||(r.polygonStart(),u=!0),r.lineStart(),i(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),o=f=null},sphere:function(){r.polygonStart(),r.lineStart(),i(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(S, T){e(S,T)&&r.point(S,T)}function h(S, T){a.point(S,T)}function y(){d.point=h,a.lineStart()}function w(){d.point=p,a.lineEnd()}function b(S, T){c.push([S,T]),l.point(S,T)}function _(){l.lineStart(),c=[]}function g(){b(c[0][0],c[0][1]),l.lineEnd();var S=l.clean(),T=s.result(),j,I=T.length,A,M,k;if(c.pop(),f.push(c),c=null,!!I){if(S&1){if(M=T[0],(A=M.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),j=0; j<A; ++j)r.point((k=M[j])[0],k[1]);r.lineEnd()}return}I>1&&S&2&&T.push(T.pop().concat(T.shift())),o.push(T.filter(Di))}}return d}}function Di(e){return e.length>1}function zi(e, t){return((e=e.x)[0]<0?e[1]-ct-N:ct-e[1])-((t=t.x)[0]<0?t[1]-ct-N:ct-t[1])}const fn=In(function(){return!0},Ii,Ni,[-F,-ct]);function Ii(e){var t=NaN,i=NaN,n=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(a, s){var l=a>0?F:-F,u=U(a-t);U(u-F)<N?(e.point(t,i=(i+s)/2>0?ct:-ct),e.point(n,i),e.lineEnd(),e.lineStart(),e.point(l,i),e.point(a,i),r=0):n!==l&&u>=F&&(U(t-n)<N&&(t-=n*N),U(a-l)<N&&(a-=l*N),i=qi(t,i,a,s),e.point(n,i),e.lineEnd(),e.lineStart(),e.point(l,i),r=0),e.point(t=a,i=s),n=l},lineEnd:function(){e.lineEnd(),t=i=NaN},clean:function(){return 2-r}}}function qi(e, t, i, n){var r,a,s=Z(e-i);return U(s)>N?ji((Z(t)*(a=G(n))*Z(i)-Z(n)*(r=G(t))*Z(e))/(r*a*s)):(t+n)/2}function Ni(e, t, i, n){var r;if(e==null)r=i*ct,n.point(-F,r),n.point(0,r),n.point(F,r),n.point(F,0),n.point(F,-r),n.point(0,-r),n.point(-F,-r),n.point(-F,0),n.point(-F,r);else if(U(e[0]-t[0])>N){var a=e[0]<t[0]?F:-F;r=i*a/2,n.point(-a,r),n.point(0,r),n.point(a,r)}else n.point(t[0],t[1])}function Oi(e){var t=G(e),i=2*rt,n=t>0,r=U(t)>N;function a(o, c, d, p){Ri(p,e,i,d,o,c)}function s(o, c){return G(o)*G(c)>t}function l(o){var c,d,p,h,y;return{lineStart:function(){h=p=!1,y=1},point:function(w, b){var _=[w,b],g,S=s(w,b),T=n?S?0:f(w,b):S?f(w+(w<0?F:-F),b):0;if(!c&&(h=p=S)&&o.lineStart(),S!==p&&(g=u(c,_),(!g||ue(c,g)||ue(_,g))&&(_[2]=1)),S!==p)y=0,S?(o.lineStart(),g=u(_,c),o.point(g[0],g[1])):(g=u(c,_),o.point(g[0],g[1],2),o.lineEnd()),c=g;else if(r&&c&&n^S){var j;!(T&d)&&(j=u(_,c,!0))&&(y=0,n?(o.lineStart(),o.point(j[0][0],j[0][1]),o.point(j[1][0],j[1][1]),o.lineEnd()):(o.point(j[1][0],j[1][1]),o.lineEnd(),o.lineStart(),o.point(j[0][0],j[0][1],3)))}S&&(!c||!ue(c,_))&&o.point(_[0],_[1]),c=_,p=S,d=T},lineEnd:function(){p&&o.lineEnd(),c=null},clean:function(){return y|(h&&p)<<1}}}function u(o, c, d){var p=Ot(o),h=Ot(c),y=[1,0,0],w=ve(p,h),b=ae(w,w),_=w[0],g=b-_*_;if(!g)return!d&&o;var S=t*b/g,T=-t*_/g,j=ve(y,w),I=se(y,S),A=se(w,T);Me(I,A);var M=j,k=ae(I,M),x=ae(M,M),q=k*k-x*(ae(I,I)-1);if(!(q<0)){var R=kt(q),C=se(M,(-k-R)/x);if(Me(C,I),C=Ce(C),!d)return C;var m=o[0],L=c[0],X=o[1],H=c[1],K;L<m&&(K=m,m=L,L=K);var ot=L-m,ft=U(ot-F)<N,O=ft||ot<N;if(!ft&&H<X&&(K=X,X=H,H=K),O?ft?X+H>0^C[1]<(U(C[0]-m)<N?X:H):X<=C[1]&&C[1]<=H:ot>F^(m<=C[0]&&C[0]<=L)){var Q=se(M,(-k+R)/x);return Me(Q,I),[C,Ce(Q)]}}}function f(o, c){var d=n?e:F-e,p=0;return o<-d?p|=1:o>d&&(p|=2),c<-d?p|=4:c>d&&(p|=8),p}return In(s,l,a,n?[0,-e]:[-F,e-F])}function Fi(e, t, i, n, r, a){var s=e[0],l=e[1],u=t[0],f=t[1],o=0,c=1,d=u-s,p=f-l,h;if(h=i-s,!(!d&&h>0)){if(h/=d,d<0){if(h<o)return;h<c&&(c=h)}else if(d>0){if(h>c)return;h>o&&(o=h)}if(h=r-s,!(!d&&h<0)){if(h/=d,d<0){if(h>c)return;h>o&&(o=h)}else if(d>0){if(h<o)return;h<c&&(c=h)}if(h=n-l,!(!p&&h>0)){if(h/=p,p<0){if(h<o)return;h<c&&(c=h)}else if(p>0){if(h>c)return;h>o&&(o=h)}if(h=a-l,!(!p&&h<0)){if(h/=p,p<0){if(h>c)return;h>o&&(o=h)}else if(p>0){if(h<o)return;h<c&&(c=h)}return o>0&&(e[0]=s+o*d,e[1]=l+o*p),c<1&&(t[0]=s+c*d,t[1]=l+c*p),!0}}}}}var Vt=1e9,le=-Vt;function Yi(e, t, i, n){function r(f, o){return e<=f&&f<=i&&t<=o&&o<=n}function a(f, o, c, d){var p=0,h=0;if(f==null||(p=s(f,c))!==(h=s(o,c))||u(f,o)<0^c>0)do d.point(p===0||p===3?e:i,p>1?n:t);while((p=(p+c+4)%4)!==h);else d.point(o[0],o[1])}function s(f, o){return U(f[0]-e)<N?o>0?0:3:U(f[0]-i)<N?o>0?2:1:U(f[1]-t)<N?o>0?1:0:o>0?3:2}function l(f, o){return u(f.x,o.x)}function u(f, o){var c=s(f,1),d=s(o,1);return c!==d?c-d:c===0?o[1]-f[1]:c===1?f[0]-o[0]:c===2?f[1]-o[1]:o[0]-f[0]}return function(f){var o=f,c=Dn(),d,p,h,y,w,b,_,g,S,T,j,I={point:A,lineStart:q,lineEnd:R,polygonStart:k,polygonEnd:x};function A(m, L){r(m,L)&&o.point(m,L)}function M(){for(var m=0,L=0,X=p.length; L<X; ++L)for(var H=p[L],K=1,ot=H.length,ft=H[0],O,Q,tt=ft[0],bt=ft[1]; K<ot; ++K)O=tt,Q=bt,ft=H[K],tt=ft[0],bt=ft[1],Q<=n?bt>n&&(tt-O)*(n-Q)>(bt-Q)*(e-O)&&++m:bt<=n&&(tt-O)*(n-Q)<(bt-Q)*(e-O)&&--m;return m}function k(){o=c,d=[],p=[],j=!0}function x(){var m=M(),L=j&&m,X=(d=An(d)).length;(L||X)&&(f.polygonStart(),L&&(f.lineStart(),a(null,null,1,f),f.lineEnd()),X&&zn(d,l,m,a,f),f.polygonEnd()),o=f,d=p=h=null}function q(){I.point=C,p&&p.push(h=[]),T=!0,S=!1,_=g=NaN}function R(){d&&(C(y,w),b&&S&&c.rejoin(),d.push(c.result())),I.point=A,S&&o.lineEnd()}function C(m, L){var X=r(m,L);if(p&&h.push([m,L]),T)y=m,w=L,b=X,T=!1,X&&(o.lineStart(),o.point(m,L));else if(X&&S)o.point(m,L);else{var H=[_=Math.max(le,Math.min(Vt,_)),g=Math.max(le,Math.min(Vt,g))],K=[m=Math.max(le,Math.min(Vt,m)),L=Math.max(le,Math.min(Vt,L))];Fi(H,K,e,t,i,n)?(S||(o.lineStart(),o.point(H[0],H[1])),o.point(K[0],K[1]),X||o.lineEnd(),j=!1):X&&(o.lineStart(),o.point(m,L),j=!1)}_=m,g=L,S=X}return I}}function vn(e, t, i){var n=zt(e,t-N,i).concat(t);return function(r){return n.map(function(a){return[r,a]})}}function hn(e, t, i){var n=zt(e,t-N,i).concat(t);return function(r){return n.map(function(a){return[a,r]})}}function Bi(){var e,t,i,n,r,a,s,l,u=10,f=u,o=90,c=360,d,p,h,y,w=2.5;function b(){return{type:"MultiLineString",coordinates:_()}}function _(){return zt(re(n/o)*o,i,o).map(h).concat(zt(re(l/c)*c,s,c).map(y)).concat(zt(re(t/u)*u,e,u).filter(function(g){return U(g%o)>N}).map(d)).concat(zt(re(a/f)*f,r,f).filter(function(g){return U(g%c)>N}).map(p))}return b.lines=function(){return _().map(function(g){return{type:"LineString",coordinates:g}})},b.outline=function(){return{type:"Polygon",coordinates:[h(n).concat(y(s).slice(1),h(i).reverse().slice(1),y(l).reverse().slice(1))]}},b.extent=function(g){return arguments.length?b.extentMajor(g).extentMinor(g):b.extentMinor()},b.extentMajor=function(g){return arguments.length?(n=+g[0][0],i=+g[1][0],l=+g[0][1],s=+g[1][1],n>i&&(g=n,n=i,i=g),l>s&&(g=l,l=s,s=g),b.precision(w)):[[n,l],[i,s]]},b.extentMinor=function(g){return arguments.length?(t=+g[0][0],e=+g[1][0],a=+g[0][1],r=+g[1][1],t>e&&(g=t,t=e,e=g),a>r&&(g=a,a=r,r=g),b.precision(w)):[[t,a],[e,r]]},b.step=function(g){return arguments.length?b.stepMajor(g).stepMinor(g):b.stepMinor()},b.stepMajor=function(g){return arguments.length?(o=+g[0],c=+g[1],b):[o,c]},b.stepMinor=function(g){return arguments.length?(u=+g[0],f=+g[1],b):[u,f]},b.precision=function(g){return arguments.length?(w=+g,d=vn(a,r,90),p=hn(t,e,w),h=vn(l,s,90),y=hn(n,i,w),b):w},b.extentMajor([[-180,-90+N],[180,90-N]]).extentMinor([[-180,-80-N],[180,80+N]])}const Ae= e=>e;var Ee=new Ct,De=new Ct,qn,Nn,ze,Ie,xt={point:ut,lineStart:ut,lineEnd:ut,polygonStart:function(){xt.lineStart=Vi,xt.lineEnd=Ui},polygonEnd:function(){xt.lineStart=xt.lineEnd=xt.point=ut,Ee.add(U(De)),De=new Ct},result:function(){var e=Ee/2;return Ee=new Ct,e}};function Vi(){xt.point=Xi}function Xi(e, t){xt.point=On,qn=ze=e,Nn=Ie=t}function On(e, t){De.add(Ie*e-ze*t),ze=e,Ie=t}function Ui(){On(qn,Nn)}var Ft=1/0,he=Ft,Wt=-Ft,pe=Wt,ge={point:Hi,lineStart:ut,lineEnd:ut,polygonStart:ut,polygonEnd:ut,result:function(){var e=[[Ft,he],[Wt,pe]];return Wt=pe=-(he=Ft=1/0),e}};function Hi(e, t){e<Ft&&(Ft=e),e>Wt&&(Wt=e),t<he&&(he=t),t>pe&&(pe=t)}var qe=0,Ne=0,Xt=0,me=0,_e=0,It=0,Oe=0,Fe=0,Ut=0,Fn,Yn,gt,mt,lt={point:Pt,lineStart:pn,lineEnd:gn,polygonStart:function(){lt.lineStart=Ji,lt.lineEnd=Wi},polygonEnd:function(){lt.point=Pt,lt.lineStart=pn,lt.lineEnd=gn},result:function(){var e=Ut?[Oe/Ut,Fe/Ut]:It?[me/It,_e/It]:Xt?[qe/Xt,Ne/Xt]:[NaN,NaN];return qe=Ne=Xt=me=_e=It=Oe=Fe=Ut=0,e}};function Pt(e, t){qe+=e,Ne+=t,++Xt}function pn(){lt.point=Zi}function Zi(e, t){lt.point=Gi,Pt(gt=e,mt=t)}function Gi(e, t){var i=e-gt,n=t-mt,r=kt(i*i+n*n);me+=r*(gt+e)/2,_e+=r*(mt+t)/2,It+=r,Pt(gt=e,mt=t)}function gn(){lt.point=Pt}function Ji(){lt.point=Ki}function Wi(){Bn(Fn,Yn)}function Ki(e, t){lt.point=Bn,Pt(Fn=gt=e,Yn=mt=t)}function Bn(e, t){var i=e-gt,n=t-mt,r=kt(i*i+n*n);me+=r*(gt+e)/2,_e+=r*(mt+t)/2,It+=r,r=mt*e-gt*t,Oe+=r*(gt+e),Fe+=r*(mt+t),Ut+=r*3,Pt(gt=e,mt=t)}function Vn(e){this._context=e}Vn.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e, t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,dt);break}}},result:ut};var Ye=new Ct,$e,Xn,Un,Ht,Zt,Kt={point:ut,lineStart:function(){Kt.point=Qi},lineEnd:function(){$e&&Hn(Xn,Un),Kt.point=ut},polygonStart:function(){$e=!0},polygonEnd:function(){$e=null},result:function(){var e=+Ye;return Ye=new Ct,e}};function Qi(e, t){Kt.point=Hn,Xn=Ht=e,Un=Zt=t}function Hn(e, t){Ht-=e,Zt-=t,Ye.add(kt(Ht*Ht+Zt*Zt)),Ht=e,Zt=t}let mn,ye,_n,yn;class wn{constructor(t){this._append=t==null?Zn:tr(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t, i){switch(this._point){case 0:{this._append`M${t},${i}`,this._point=1;break}case 1:{this._append`L${t},${i}`;break}default:{if(this._append`M${t},${i}`,this._radius!==_n||this._append!==ye){const n=this._radius,r=this._;this._="",this._append`m0,${n}a${n},${n} 0 1,1 0,${-2*n}a${n},${n} 0 1,1 0,${2*n}z`,_n=n,ye=this._append,yn=this._,this._=r}this._+=yn;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Zn(e){let t=1;this._+=e[0];for(const i=e.length; t<i; ++t)this._+=arguments[t]+e[t]}function tr(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return Zn;if(t!==mn){const i=10**t;mn=t,ye=function(r){let a=1;this._+=r[0];for(const s=r.length; a<s; ++a)this._+=Math.round(arguments[a]*i)/i+r[a]}}return ye}function er(e, t){let i=3,n=4.5,r,a;function s(l){return l&&(typeof n=="function"&&a.pointRadius(+n.apply(this,arguments)),Rt(l,r(a))),a.result()}return s.area=function(l){return Rt(l,r(xt)),xt.result()},s.measure=function(l){return Rt(l,r(Kt)),Kt.result()},s.bounds=function(l){return Rt(l,r(ge)),ge.result()},s.centroid=function(l){return Rt(l,r(lt)),lt.result()},s.projection=function(l){return arguments.length?(r=l==null?(e=null,Ae):(e=l).stream,s):e},s.context=function(l){return arguments.length?(a=l==null?(t=null,new wn(i)):new Vn(t=l),typeof n!="function"&&a.pointRadius(n),s):t},s.pointRadius=function(l){return arguments.length?(n=typeof l=="function"?l:(a.pointRadius(+l),+l),s):n},s.digits=function(l){if(!arguments.length)return i;if(l==null)i=null;else{const u=Math.floor(l);if(!(u>=0))throw new RangeError(`invalid digits: ${l}`);i=u}return t===null&&(a=new wn(i)),s},s.projection(e).digits(i).context(t)}function Ue(e){return function(t){var i=new Be;for(var n in e)i[n]=e[n];return i.stream=t,i}}function Be(){}Be.prototype={constructor:Be,point:function(e, t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function He(e, t, i){var n=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),n!=null&&e.clipExtent(null),Rt(i,e.stream(ge)),t(ge.result()),n!=null&&e.clipExtent(n),e}function Gn(e, t, i){return He(e,function(n){var r=t[1][0]-t[0][0],a=t[1][1]-t[0][1],s=Math.min(r/(n[1][0]-n[0][0]),a/(n[1][1]-n[0][1])),l=+t[0][0]+(r-s*(n[1][0]+n[0][0]))/2,u=+t[0][1]+(a-s*(n[1][1]+n[0][1]))/2;e.scale(150*s).translate([l,u])},i)}function nr(e, t, i){return Gn(e,[[0,0],t],i)}function ir(e, t, i){return He(e,function(n){var r=+t,a=r/(n[1][0]-n[0][0]),s=(r-a*(n[1][0]+n[0][0]))/2,l=-a*n[0][1];e.scale(150*a).translate([s,l])},i)}function rr(e, t, i){return He(e,function(n){var r=+t,a=r/(n[1][1]-n[0][1]),s=-a*n[0][0],l=(r-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([s,l])},i)}var bn=16,ar=G(30*rt);function Sn(e, t){return+t?or(e,t):sr(e)}function sr(e){return Ue({point:function(t, i){t=e(t,i),this.stream.point(t[0],t[1])}})}function or(e, t){function i(n, r, a, s, l, u, f, o, c, d, p, h, y, w){var b=f-n,_=o-r,g=b*b+_*_;if(g>4*t&&y--){var S=s+d,T=l+p,j=u+h,I=kt(S*S+T*T+j*j),A=Lt(j/=I),M=U(U(j)-1)<N||U(a-c)<N?(a+c)/2:Nt(T,S),k=e(M,A),x=k[0],q=k[1],R=x-n,C=q-r,m=_*R-b*C;(m*m/g>t||U((b*R+_*C)/g-.5)>.3||s*d+l*p+u*h<ar)&&(i(n,r,a,s,l,u,x,q,M,S/=I,T/=I,j,y,w),w.point(x,q),i(x,q,M,S,T,j,f,o,c,d,p,h,y,w))}}return function(n){var r,a,s,l,u,f,o,c,d,p,h,y,w={point:b,lineStart:_,lineEnd:S,polygonStart:function(){n.polygonStart(),w.lineStart=T},polygonEnd:function(){n.polygonEnd(),w.lineStart=_}};function b(A, M){A=e(A,M),n.point(A[0],A[1])}function _(){c=NaN,w.point=g,n.lineStart()}function g(A, M){var k=Ot([A,M]),x=e(A,M);i(c,d,o,p,h,y,c=x[0],d=x[1],o=A,p=k[0],h=k[1],y=k[2],bn,n),n.point(c,d)}function S(){w.point=b,n.lineEnd()}function T(){_(),w.point=j,w.lineEnd=I}function j(A, M){g(r=A,M),a=c,s=d,l=p,u=h,f=y,w.point=g}function I(){i(c,d,o,p,h,y,a,s,r,l,u,f,bn,n),w.lineEnd=S,S()}return w}}var lr=Ue({point:function(e, t){this.stream.point(e*rt,t*rt)}});function cr(e){return Ue({point:function(t, i){var n=e(t,i);return this.stream.point(n[0],n[1])}})}function ur(e, t, i, n, r){function a(s, l){return s*=n,l*=r,[t+e*s,i-e*l]}return a.invert=function(s, l){return[(s-t)/e*n,(i-l)/e*r]},a}function Mn(e, t, i, n, r, a){if(!a)return ur(e,t,i,n,r);var s=G(a),l=Z(a),u=s*e,f=l*e,o=s/e,c=l/e,d=(l*i-s*t)/e,p=(l*t+s*i)/e;function h(y, w){return y*=n,w*=r,[u*y-f*w+t,i-f*y-u*w]}return h.invert=function(y, w){return[n*(o*y-c*w+d),r*(p-c*y-o*w)]},h}function dr(e){return fr(function(){return e})()}function fr(e){var t,i=150,n=480,r=250,a=0,s=0,l=0,u=0,f=0,o,c=0,d=1,p=1,h=null,y=fn,w=null,b,_,g,S=Ae,T=.5,j,I,A,M,k;function x(m){return A(m[0]*rt,m[1]*rt)}function q(m){return m=A.invert(m[0],m[1]),m&&[m[0]*St,m[1]*St]}x.stream=function(m){return M&&k===m?M:M=lr(cr(o)(y(j(S(k=m)))))},x.preclip=function(m){return arguments.length?(y=m,h=void 0,C()):y},x.postclip=function(m){return arguments.length?(S=m,w=b=_=g=null,C()):S},x.clipAngle=function(m){return arguments.length?(y=+m?Oi(h=m*rt):(h=null,fn),C()):h*St},x.clipExtent=function(m){return arguments.length?(S=m==null?(w=b=_=g=null,Ae):Yi(w=+m[0][0],b=+m[0][1],_=+m[1][0],g=+m[1][1]),C()):w==null?null:[[w,b],[_,g]]},x.scale=function(m){return arguments.length?(i=+m,R()):i},x.translate=function(m){return arguments.length?(n=+m[0],r=+m[1],R()):[n,r]},x.center=function(m){return arguments.length?(a=m[0]%360*rt,s=m[1]%360*rt,R()):[a*St,s*St]},x.rotate=function(m){return arguments.length?(l=m[0]%360*rt,u=m[1]%360*rt,f=m.length>2?m[2]%360*rt:0,R()):[l*St,u*St,f*St]},x.angle=function(m){return arguments.length?(c=m%360*rt,R()):c*St},x.reflectX=function(m){return arguments.length?(d=m?-1:1,R()):d<0},x.reflectY=function(m){return arguments.length?(p=m?-1:1,R()):p<0},x.precision=function(m){return arguments.length?(j=Sn(I,T=m*m),C()):kt(T)},x.fitExtent=function(m, L){return Gn(x,m,L)},x.fitSize=function(m, L){return nr(x,m,L)},x.fitWidth=function(m, L){return ir(x,m,L)},x.fitHeight=function(m, L){return rr(x,m,L)};function R(){var m=Mn(i,0,0,d,p,c).apply(null,t(a,s)),L=Mn(i,n-m[0],r-m[1],d,p,c);return o=Pi(l,u,f),I=Pe(t,L),A=Pe(o,I),j=Sn(I,T),C()}function C(){return M=k=null,x}return function(){return t=e.apply(this,arguments),x.invert=t.invert&&q,R()}}function vr(e){return function(t, i){var n=kt(t*t+i*i),r=e(n),a=Z(r),s=G(r);return[Nt(t*a,n*s),Lt(n&&i*a/n)]}}function Jn(e, t){return[G(t)*Z(e),Z(t)]}Jn.invert=vr(Lt);function hr(){return dr(Jn).scale(249.5).clipAngle(90+N)}var pr=Qt('<path fill="none" class="graticule svelte-1yv80ee" stroke-width="0.3"></path>');function xn(e, t){nt(t,!0);let i=V(0),n=V(0);const r=te.subscribe(d=>{z(i,W(d.deg_x)),z(n,W(d.deg_y))});wt(()=>{r&&r()});const a=Mt(t,"scale",3,2e3),s=Mt(t,"steps",3,5),l=Mt(t,"clipAngle",3,15),u=Bi().stepMajor([45,45]).stepMinor([s(),s()]);let f=Et(()=>hr().scale(a()).rotate([-v(i),-v(n)]).translate([1080/2,810/2]).clipAngle(l())),o=Et(()=>er().projection(v(f)));var c=pr();at(()=>B(c,"d",v(o)(u()))),D(e,c),it()}function Ve(e){return typeof e=="string"?e.toLowerCase().trim().replaceAll("ä","ae").replaceAll("ö","oe").replaceAll("ü","ue").replaceAll("ß","ss").replace(/\W+/g,"_").replace(/^_|_$/g,""):null}const En={fid:"",geo:{addr:"",lat:53.6,lon:9.9},base:[{id:"home",name:"Primary target",pos:{x:-23900,y:0,f:500}},{id:"polaris",name:"Polaris",pos:{x:0,y:11912,f:600}}]};function gr(e, t){const i={...En.geo,addr:t},n=[];for(let r of En.base)n.push({...r,pos:{...r.pos}});return{fid:e,geo:i,base:n}}function $n(e){return Math.PI*e/180}function Xe(e){return e*180/Math.PI}function mr(e){const t=wi(te).spr;let i=Math.round(t*e/360);return Math.abs(i)>t/2&&(i=i>0?i-t:i+t),i}function kn(e){const t=Xe(e);return mr(t)}var _r=(e, t)=>t("A",e),yr=(e, t)=>t("B",e),wr=Y('<div id="camera-stream" class="svelte-zqlhxu"><button id="telescope-stream"><svg class="svg-img svelte-zqlhxu" preserveAspectRatio="xMidYMid slice"><foreignObject class="img-wrap svelte-zqlhxu" x="0" y="0"><img alt="Telescope" class="svg-img svelte-zqlhxu"></foreignObject><!></svg></button> <button id="viewfinder-stream"><svg class="svg-img svelte-zqlhxu" preserveAspectRatio="xMidYMid slice"><foreignObject class="img-wrap svelte-zqlhxu" x="0" y="0"><img alt="Viewfinder" class="svg-img svelte-zqlhxu"></foreignObject><g><circle r="0.0001" fill="none" stroke="none"></circle><rect class="crosshair svelte-zqlhxu"></rect><!></g></svg></button></div>');function br(e, t){nt(t,!0);const i=yt(),n=()=>st(hi,"$locHost",i),r=()=>st(ce,"$swapPreview",i),a=()=>st(de,"$displayCompass",i);let s=V(0),l=V(0);const u=1080,f=810;let o=V(void 0);const c=()=>{const O=v(o).getBoundingClientRect();return{x:v(d)==="B"?O.x:v(s)/2,y:v(d)==="B"?O.y:v(l)/2}};let d=V(void 0);const p=ce.subscribe(O=>{z(d,W(O))});let h=V(0),y=V(0);const w=te.subscribe(O=>{z(h,W(O.deg_x)),z(y,W(O.deg_y))}),b=(O, Q)=>{if(v(d)!==O)ce.update(tt=>O);else{const tt=c(),bt=Math.max(v(s)/u,v(l)/f),Yt={x:Math.round((Q.clientX-tt.x)/bt),y:-1*Math.round((Q.clientY-tt.y)/bt)},Kn=v(d)==="B"?_.SphereScaleVF:_.SphereScaleTel,ne=$n(v(y)),Qn=$n(v(h)),be=Math.sqrt(Math.pow(Yt.x,2)+Math.pow(Yt.y,2)),Bt=Math.asin(be/Kn),ti=Math.asin(Math.cos(Bt)*Math.sin(ne)+Yt.y*Math.sin(Bt)*Math.cos(ne)/be),ei=Qn+Math.atan(Yt.x*Math.sin(Bt)/(be*Math.cos(Bt)*Math.cos(ne)-Yt.y*Math.sin(Bt)*Math.sin(ne)));et(`/goto/${kn(ei)}/${kn(ti)}`, ni=>{console.log("GoTo cmd",ni)})}};let _=W({CrosshairSize:.4,CrosshairOffsetX:0,CrosshairOffsetY:0,SphereScaleVF:1500,SphereScaleTel:24e3}),g=Gt.subscribe(O=>{for(let Q of O)_[Q.id]=Q.value}),S=V("starfield-zoom.jpg"),T=V("starfield.jpg"),j=Et(()=>Math.ceil(Xe(Math.asin(u/_.SphereScaleVF)))),I=Et(()=>Math.ceil(Xe(Math.asin(u/_.SphereScaleTel))));ee(()=>{z(S,`${n()}:7777/stream_a.mjpg`),z(T,`${n()}:7777/stream_b.mjpg`),et("/config/sphere/settings", O=>{console.log("MOUNT",O),Gt.update(Q=>Q.map(tt=>tt!=null&&tt.id&&Object.hasOwn(O,tt.id)?{...tt,value:O[tt.id]}:{...tt}))})}),wt(()=>{p&&p(),g&&g(),w&&w()});var A=wr(),M=$(A);M.__click=[_r,b];var k=$(M);B(k,"viewBox",`0 0 ${u} ${f}`);var x=$(k);B(x,"width",u),B(x,"height",f);var q=$(x);E(x);var R=P(x);J(R,a, O=>{xn(O,{get scale(){return _.SphereScaleTel},steps:"0.2",get clipAngle(){return v(I)},get width(){return v(s)},get height(){return v(l)}})}),E(k),E(M);var C=P(M,2);C.__click=[yr,b];var m=$(C);B(m,"viewBox",`0 0 ${u} ${f}`);var L=$(m);B(L,"width",u),B(L,"height",f);var X=$(L);E(L);var H=P(L),K=$(H);B(K,"cx",u/2),B(K,"cy",f/2),yi(K, O=>z(o,O),()=>v(o));var ot=P(K);B(ot,"x",u/2),B(ot,"y",f/2);var ft=P(ot);J(ft,a, O=>{xn(O,{get scale(){return _.SphereScaleVF},steps:"5",get clipAngle(){return v(j)},get width(){return v(s)},get height(){return v(l)}})}),E(H),E(m),E(C),E(A),at(()=>{$t(M,`stream-wrapper ${(r()==="A"?"large":"")??""} svelte-zqlhxu`),B(k,"width",v(s)),B(k,"height",v(l)),B(q,"src",v(S)),$t(C,`stream-wrapper ${(r()==="B"?"large":"")??""} svelte-zqlhxu`),B(m,"width",v(s)),B(m,"height",v(l)),B(X,"src",v(T)),B(H,"transform",`translate(${u/4*_.CrosshairOffsetX} ${f/4*_.CrosshairOffsetY})`),B(ot,"transform",`translate(${v(s)*_.CrosshairSize*-.5} ${v(l)*_.CrosshairSize*-.5})`),B(ot,"width",v(s)*_.CrosshairSize),B(ot,"height",v(l)*_.CrosshairSize)}),Ke(A,"clientWidth", O=>z(s,O)),Ke(A,"clientHeight", O=>z(l,O)),D(e,A),it()}vt(["click"]);var Sr=Y('<div class="layer svelte-qmdbdl"><!></div>'),Mr=Y('<div class="visuals svelte-qmdbdl"><!> <!></div>');function xr(e){const t=yt(),i=()=>st(de,"$displayCompass",t);var n=Mr(),r=$(n);br(r,{});var a=P(r,2);J(a,i, s=>{var l=Sr(),u=$(l);$i(u,{}),E(l),D(s,l)}),E(n),D(e,n)}class Er{constructor(t, i){this.stick=t,this.stick&&(this.callback=i,this.dragStart=null,this.touchId=null,this.maxDistance=200,this.deadZone=8,this.active=!1,this.value={x:0,y:0},this.counter=0,this.prev={x:0,y:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown", n=>{this._handleDown(n)}),this.stick.addEventListener("touchstart", n=>{this._handleDown(n)}),document.addEventListener("mousemove", n=>{this._handleMove(n)},{passive:!1}),document.addEventListener("touchmove", n=>{this._handleMove(n)},{passive:!1}),document.addEventListener("mouseup", n=>{this._handleUp(n)}),document.addEventListener("touchend", n=>{this._handleUp(n)}))}destroy(){this.stick.removeEventListener("mousedown", t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart", t=>{this._handleDown(t)}),document.removeEventListener("mousemove", t=>{this._handleMove(t)}),document.removeEventListener("touchmove", t=>{this._handleMove(t)}),document.removeEventListener("mouseup", t=>{this._handleUp(t)}),document.removeEventListener("touchend", t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.clientX,y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;let i=null;if(t.changedTouches){for(let w=0; w<t.changedTouches.length; w++)this.touchId===t.changedTouches[w].identifier&&(i=w,t.clientX=t.changedTouches[w].clientX,t.clientY=t.changedTouches[w].clientY);if(i==null)return}const n=this.stick.getBoundingClientRect(),r=n?Math.round(16e3/n.width)/100:1,a=t.clientX-this.dragStart.x,s=t.clientY-this.dragStart.y,l=Math.atan2(s,a),u=Math.min(this.maxDistance,Math.hypot(a,s)*r),f=u*Math.cos(l),o=u*Math.sin(l);this.stick.style.transform=`translate(${f}px, ${o}px)`;const c=u<this.deadZone?0:this.maxDistance/(this.maxDistance-this.deadZone)*(u-this.deadZone),d=c*Math.cos(l),p=c*Math.sin(l),h=parseFloat((d/this.maxDistance).toFixed(4)),y=parseFloat((p/this.maxDistance).toFixed(4));this.value={x:h,y},this._loop()}_handleUp(t){this.active&&(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier||(this.stick.style.transition=".2s",this.stick.style.transform="translate3d(0px, 0px, 0px)",this.value={x:0,y:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5+this.value.x*511.5),i=Math.round(511.5+this.value.y*511.5);this.callback(`/joystick/${t}/${i}`)}_debounce(t){return(...i)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...i)},this.debounceTimeout)}}_update(){(this.value.x!==this.prev.x||this.value.y!==this.prev.y)&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}class $r{constructor(t, i){this.stick=t,this.stick&&(this.callback=i,this.dragStart=null,this.touchId=null,this.maxDistance=230,this.deadZone=8,this.active=!1,this.value={f:0},this.counter=0,this.prev={f:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown", n=>{this._handleDown(n)}),this.stick.addEventListener("touchstart", n=>{this._handleDown(n)}),document.addEventListener("mousemove", n=>{this._handleMove(n)},{passive:!1}),document.addEventListener("touchmove", n=>{this._handleMove(n)},{passive:!1}),document.addEventListener("mouseup", n=>{this._handleUp(n)}),document.addEventListener("touchend", n=>{this._handleUp(n)}))}destroy(){this.stick.removeEventListener("mousedown", t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart", t=>{this._handleDown(t)}),document.removeEventListener("mousemove", t=>{this._handleMove(t)}),document.removeEventListener("touchmove", t=>{this._handleMove(t)}),document.removeEventListener("mouseup", t=>{this._handleUp(t)}),document.removeEventListener("touchend", t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{y:t.changedTouches[0].clientY}:{y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;t.preventDefault();let i=null;if(t.changedTouches){for(let u=0; u<t.changedTouches.length; u++)this.touchId===t.changedTouches[u].identifier&&(i=u,t.clientY=t.changedTouches[u].clientY);if(i==null)return}const n=this.stick.getBoundingClientRect(),r=n?Math.round(1e4/n.width)/100:1,a=t.clientY-this.dragStart.y,s=a>=0?Math.min(this.maxDistance,a*r):Math.max(-this.maxDistance,a*r);this.stick.style.transform=`translateY(${s}px)`;const l=Math.abs(s)>this.deadZone?parseFloat((s/this.maxDistance).toFixed(4)):0;this.value={f:l},this._loop()}_handleUp(t){this.active&&(t.preventDefault(),!(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier)&&(this.stick.style.transition=".2s",this.stick.style.transform="translateY(0px)",this.value={f:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5-this.value.f*511.5);this.callback(`/focus/${t}`)}_debounce(t){return(...i)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...i)},this.debounceTimeout)}}_update(){this.value.f!==this.prev.f&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}var kr=Qt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-1jgdvgh"><defs><circle id="joys-def-cir2" r="80" cy="0"></circle><path id="joys-def-arrow" d="M0 -120 -40 -100 40 -100z"></path><rect id="joys-def-slide" width="100" height="100" transform="translate(335 -50)" rx="15" ry="15"></rect></defs><g id="joys" transform="translate(320 355)" class="svelte-1jgdvgh"><use id="joys-arrow-top" href="#joys-def-arrow" class="svelte-1jgdvgh"></use><use id="joys-arrow-right" href="#joys-def-arrow" transform="rotate(90)" class="svelte-1jgdvgh"></use><use id="joys-arrow-left" href="#joys-def-arrow" transform="rotate(-90)" class="svelte-1jgdvgh"></use><use id="joys-arrow-bottom" href="#joys-def-arrow" transform="rotate(180)" class="svelte-1jgdvgh"></use><use id="joys-stick" href="#joys-def-cir2" style="transform: translate(0px, 0px)" class="svelte-1jgdvgh"></use><use id="joys-arrow-top" href="#joys-def-arrow" transform="translate(385 30)" class="svelte-1jgdvgh"></use><use id="joys-arrow-top" href="#joys-def-arrow" transform="translate(385 -30) rotate(180)" class="svelte-1jgdvgh"></use><use id="joys-slide" href="#joys-def-slide" style="transform: translateY(0px)" class="svelte-1jgdvgh"></use><a href="#toggle" role="button" tabindex="0" aria-label="Change to adjustment tool"><g id="joys-swap" transform="translate(-250,250)" class="svelte-1jgdvgh"><circle class="element svelte-1jgdvgh" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M6.121 13c-.553 0-1 .448-1 1s.447 1 1 1h1.465l-3.293 3.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.414-3.414v1.707c0 .552.447 1 1 1s.879-.448.879-1v-5h-4.879zM7 11c.552 0 1-.448 1-1v-2h2c.553 0 1-.448 1-1s-.447-1-1-1h-3.999l-.001 4c0 .552.447 1 1 1zM17 13c-.553 0-1 .448-1 1v2h-2c-.553 0-1 .448-1 1s.447 1 1 1h4v-4c0-.552-.447-1-1-1zM18.293 4.293l-3.293 3.293v-1.586c0-.552-.447-1-1-1s-1 .448-1 1v5h5c.552 0 1-.448 1-1s-.447-1-1-1h-1.586l3.293-3.292c.391-.391.391-1.023 0-1.414s-1.023-.392-1.414-.001z" class="svelte-1jgdvgh"></path></g></g></a></g></svg>');function Tr(e, t){nt(t,!0);let i=null,n=null;ee(()=>{i=new Er(document.getElementById("joys-stick"), l=>{et(l, u=>{console.log("SVELTE Joystick",u)})}),n=new $r(document.getElementById("joys-slide"), l=>{et(l, u=>{console.log("SVELTE Focus",u)})})}),wt(()=>{i&&i.hasOwnProperty("destroy")&&i.destroy(),n&&n.hasOwnProperty("destroy")&&n.destroy()});var r=kr(),a=P($(r)),s=P($(a),8);s.__click=function(...l){var u;(u=t.toggle)==null||u.apply(this,l)},E(a),E(r),D(e,r),it()}vt(["click"]);class jr{constructor(t, i){if(this.adjust=t,this.adjust){this.callback=i;const n=8e4/360;this.axisSteps={lg:Math.round(n),md:Math.round(n/10),sm:Math.round(n/100)},this.adjust.addEventListener("mouseup", r=>{this.sendCommand(r.target.dataset)})}}destroy(){this.adjust.removeEventListener("mouseup", t=>{this.sendCommand(t.target.dataset)})}sendCommand(t){let i=t==null?void 0:t.dir,n=t==null?void 0:t.len;i&&n&&typeof this.axisSteps[n]=="number"&&(n=this.axisSteps[n],["closer","further"].indexOf(i)>=0&&(n=i==="closer"?-n:n,i="focus"),this.callback(`/adjust/${i}/${n}`))}}var Cr=Qt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-cf79tv"><defs><path id="arr1" d="M0 -80 40 -60 40 0 0 -20 -40 0 -40 -60z"></path><path id="arr2" d="M95 95 70 95 70 165 165 165 165 70 95 70z"></path><path id="arr3" d="M165 165 130 165 130 245 245 245 245 130 165 130z"></path><circle id="cir1" r="40" cy="30"></circle><circle id="cir2" r="50" cy="120"></circle><circle id="cir3" r="60" cy="230"></circle><path id="cir3" d="M-85 125 A 108 108 0 1 0 85 125 A 54 54 0 0 1 -85 125z"></path></defs><g id="adjust" transform="translate(355 355)" class="svelte-cf79tv"><g transform="rotate(0)"><use href="#arr1" transform="translate(0 -50)" data-dir="up" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="up" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="up" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(90)"><use href="#arr1" transform="translate(0 -50)" data-dir="right" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="right" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="right" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(180)"><use href="#arr1" transform="translate(0 -50)" data-dir="down" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="down" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="down" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(270)"><use href="#arr1" transform="translate(0 -50)" data-dir="left" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="left" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="left" data-len="lg" class="svelte-cf79tv"></use></g><g transform="translate(360 0)"><use href="#arr1" transform="translate(0 -50)" data-dir="further" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="further" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="further" data-len="lg" class="svelte-cf79tv"></use></g><g transform="translate(360 0) rotate(180)"><use href="#arr1" transform="translate(0 -50)" data-dir="closer" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="closer" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="closer" data-len="lg" class="svelte-cf79tv"></use></g><a href="#toggle" role="button" tabindex="0" aria-label="Change to Joystick"><g id="joys-swap" transform="translate(-285,250)" class="svelte-cf79tv"><circle class="element svelte-cf79tv" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M17.707 8.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l1.293 1.293h-4.586v-4.586l1.293 1.293c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-3.707-3.707-3.707 3.707c-.391.391-.391 1.023 0 1.414s1.023.391 1.414 0l1.293-1.293v4.586h-4.586l1.293-1.293c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-3.707 3.707 3.707 3.707c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-1.293-1.293h4.586v4.586l-1.293-1.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l3.707 3.707 3.707-3.707c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-1.293 1.293v-4.586h4.586l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707z" class="svelte-cf79tv"></path></g></g></a></g></svg>');function Lr(e, t){nt(t,!0);let i=null;ee(()=>{i=new jr(document.getElementById("adjust"), s=>{et(s, l=>{console.log("SVELTE Adjust",l)})})}),wt(()=>{i&&i.hasOwnProperty("destroy")&&i.destroy()});var n=Cr(),r=P($(n)),a=P($(r),6);a.__click=function(...s){var l;(l=t.toggle)==null||l.apply(this,s)},E(r),E(n),D(e,n),it()}vt(["click"]);var Pr=Y('<div class="joystick-wrapper svelte-gruxg2"><!></div>');function Rr(e){let t=V("mov");const i= a=>{a.preventDefault(),z(t,W(v(t)==="mov"?"adj":"mov"))};var n=Pr(),r=$(n);J(r,()=>v(t)==="mov", a=>{Tr(a,{toggle:i})}, a=>{Lr(a,{toggle:i})}),E(n),D(e,n)}var Ar=(e, t)=>{z(t,!1)},Dr=Y('<header><input type="text" id="address" placeholder="Address"></header> <div class="flexbox"><input type="text" id="latitude" placeholder="Latitude"> <input type="text" id="longitude" placeholder="Longitude"></div> <button class="button button-small">Save location</button> <button class="button">Cancel</button>',1),zr=(e, t)=>{z(t,!0)},Ir=Y('<header> <button class="edit-button icon-edit" aria-label="Edit"></button></header>'),qr=Y("<div> </div>"),Nr=Y("<!> <!>",1),Or=(e, t, i)=>t(e,`/navi/position/${v(i).id}`),Fr=(e, t, i)=>t(v(i).id),Yr=Y('<button class="delete-button icon-delete" aria-label="Delete" title="Delete"></button>'),Br=Y("<li><button> </button> <!></li>"),Vr=Y('<div class="nav-add"><label for="new-name">Save/update current position as ...</label> <input type="text" id="new-name" class="input" placeholder="Enter position name"> <div class="margin-bottom"><sub> </sub></div> <button class="button button-small">Save target</button></div>'),Xr=Y('<div class="nav-selector"><button class="button button-small">Change location</button></div>'),Ur=Y('<div class="content-card"><div class="nav-curr-pos"><!></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function Hr(e, t){nt(t,!0);const i=yt(),n=()=>st(pt,"$positions",i),r=()=>st(te,"$arduinoSettings",i);let a=V(!1),s=V(""),l=Et(()=>Ve(v(s))),u=V(""),f=V(""),o=V(""),c=V(W([]));const d=pt.subscribe(M=>{M!=null&&M.fid&&(z(u,W(M.geo.addr)),z(f,W(M.geo.lat)),z(o,W(M.geo.lon)),z(c,W([...M.base])))});wt(()=>{d&&d()});const p=()=>{const M={...n()};we(`/navi/position/update/${M.fid}`,M, k=>{console.log("SVELTE saved",k)})},h=()=>{const M={addr:v(u),lat:parseFloat(v(f)),lon:parseFloat(v(o))};pt.update(k=>({...k,geo:M})),p(),z(a,!1)},y=()=>{const M=Ve(v(s));if(M){let k=!1;const x=(({x:R,y:C,f:m})=>({x:R,y:C,f:m}))(r());let q=v(c).map(R=>R.id!==M?R:(k=!0,{...R,pos:x}));k||q.push({id:M,name:v(s),pos:x}),pt.update(R=>({...R,base:q})),p(),z(s,"")}z(a,!1)},w= M=>M==="home"?"icon-home":M==="polaris"?"icon-star":"icon-target",b= M=>{if(confirm(`Do you really want to delete position: "${M}"`)){const k=[...n().base].filter(x=>x.id!==M);pt.update(x=>({...x,base:k})),p(),z(a,!1)}},_=(M, k)=>{M.preventDefault(),et(k, x=>{console.log("SVELTE position",x)})};var g=Ur(),S=$(g),T=$(S);J(T,()=>v(a), M=>{var k=Dr(),x=ht(k),q=$(x);At(q),E(x);var R=P(x,2),C=$(R);At(C);var m=P(C,2);At(m),E(R);var L=P(R,2);L.__click=h;var X=P(L,2);X.__click=[Ar,a],Dt(q,()=>v(u), H=>z(u,H)),Dt(C,()=>v(f), H=>z(f,H)),Dt(m,()=>v(o), H=>z(o,H)),D(M,k)}, M=>{var k=Nr(),x=ht(k);J(x,()=>v(u), R=>{var C=Ir(),m=$(C),L=P(m);L.__click=[zr,a],E(C),at(()=>_t(m,`${v(u)??""} `)),D(R,C)});var q=P(x,2);J(q,()=>v(f)&&v(o), R=>{var C=qr(),m=$(C);E(C),at(()=>_t(m,`${v(f)??""}°, ${v(o)??""}°`)),D(R,C)}),D(M,k)}),E(S);var j=P(S,2),I=$(j);jt(I,21,()=>v(c),qt,(M, k)=>{var x=Br(),q=$(x);const R=Et(()=>`nav-button ${w(v(k).id)??""}`);q.__click=[Or,_,k];var C=$(q,!0);E(q);var m=P(q,2);J(m,()=>v(a)&&v(k).id!=="home"&&v(k).id!=="polaris", L=>{var X=Yr();X.__click=[Fr,b,k],D(L,X)}),E(x),at(()=>{$t(q,v(R)),_t(C,v(k).name)}),D(M,x)}),E(I),E(j);var A=P(j,2);J(A,()=>v(a), M=>{var k=Vr(),x=P($(k),2);At(x);var q=P(x,2),R=$(q),C=$(R);E(R),E(q);var m=P(q,2);m.__click=y,E(k),at(()=>{_t(C,`ID: ${v(l)??""}`),m.disabled=v(l).length<3}),Dt(x,()=>v(s), L=>z(s,L)),D(M,k)}, M=>{var k=Xr(),x=$(k);x.__click=function(...q){var R;(R=t.toggleAdmin)==null||R.apply(this,q)},E(k),D(M,k)}),E(g),D(e,g),it()}vt(["click"]);const Zr=(e, t)=>{z(t,!v(t))};var Gr=(e, t, i)=>t(v(i).fid),Jr=(e, t, i)=>t(v(i).fid),Wr=Y('<button class="delete-button icon-delete" aria-label="Delete"></button>'),Kr=Y('<li><button class="nav-button icon-location"> </button> <!></li>'),Qr=(e, t)=>t(),ta=Y('<div class="nav-add"><input type="text" id="new-location" class="input" placeholder="Enter new location name"> <button class="button">+&nbsp;Add</button></div> <div> </div>',1),ea=Y('<div class="nav-selector"><button class="button button-small">&laquo;&nbsp;Back</button></div>'),na=Y('<div class="content-card"><header>Locations <button aria-label="Edit"></button></header> <div class="nav-curr-pos"><div><p>The location is the place where your telescope is placed.</p></div></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function ia(e, t){nt(t,!0);const i=yt(),n=()=>st(ie,"$locations",i);let r=V("");const a=pt.subscribe(_=>{z(r,W(_.fid))});wt(()=>{a&&a()});let s=V(!1),l=V(""),u=Et(()=>Ve(v(l)));const f= _=>{_!==v(r)&&et(`/navi/location/${_}`, g=>{(g==null?void 0:g.fid)===_&&(pt.update(S=>({...g})),console.log("Loaded location"))})},o=()=>{if(v(u).length>=3){const _=gr(v(u),v(l));we(`/navi/position/update/${v(u)}`,_, g=>{pt.update(S=>_),ie.update(S=>[...S,{fid:v(u),addr:v(l)}]),z(l,""),console.log("Added new location",g)})}else console.error("ID is too short. At least 3 char are required.")},c= _=>{confirm(`Do you really want to delete location: "${_}"`)?et(`/navi/location/delete/${_}`, g=>{g.response===200&&(ie.update(S=>S.filter(T=>T.fid!==_)),alert(`Location "${_}" deleted`))}):alert(`Deletion of "${_}" canceled.`)};ee(()=>{n().length===0&&et("/navi/location-list", _=>{ie.update(g=>[..._]),console.log("Loaded location list")})});var d=na(),p=$(d),h=P($(p));h.__click=[Zr,s],E(p);var y=P(p,4),w=$(y);jt(w,5,n,qt,(_, g)=>{var S=Kr(),T=$(S);T.__click=[Gr,f,g];var j=$(T,!0);E(T);var I=P(T,2);J(I,()=>v(s)&&v(g).fid!==v(r)&&v(g).fid!=="index", A=>{var M=Wr();M.__click=[Jr,c,g],D(A,M)}),E(S),at(()=>{$t(S,v(g).fid===v(r)?"active":""),_t(j,v(g).addr)}),D(_,S)}),E(w),E(y);var b=P(y,2);J(b,()=>v(s), _=>{var g=ta(),S=ht(g),T=$(S);At(T);var j=P(T,2);j.__click=[Qr,o],E(S);var I=P(S,2),A=$(I,!0);E(I),at(()=>_t(A,v(u))),Dt(T,()=>v(l), M=>z(l,M)),D(_,g)}, _=>{var g=ea(),S=$(g);S.__click=function(...T){var j;(j=t.toggleAdmin)==null||j.apply(this,T)},E(g),D(_,g)}),E(d),at(()=>$t(h,`edit-button icon-edit${(v(s)?" active":"")??""}`)),D(e,d),it()}vt(["click"]);function ra(e, t){nt(t,!0);const i=yt(),n=()=>st(pt,"$positions",i);let r=V(!1);const a=()=>{z(r,!v(r))};ee(()=>{var u;(u=n())!=null&&u.fid||et("/navi/location/index", f=>{(f==null?void 0:f.fid)==="index"&&pt.update(o=>({...f}))})});var s=Tt(),l=ht(s);J(l,()=>v(r), u=>{ia(u,{toggleAdmin:a})}, u=>{Hr(u,{toggleAdmin:a})}),D(e,s),it()}var aa=(e, t, i, n)=>{t()(i.id,n())},sa=(e, t, i, n)=>{t()(i.id,n())},oa=Y('<div class="slider-wrapper svelte-1qw7onx"><label class="svelte-1qw7onx"> </label> <input type="range" class="svelte-1qw7onx"></div>');function Wn(e, t){nt(t,!0);let i=Mt(t,"oninput",3,()=>{}),n=Mt(t,"onchange",3,()=>{}),r=Mt(t,"value",7,0),a=Mt(t,"minValue",3,0),s=Mt(t,"maxValue",3,10),l=Mt(t,"steps",3,1);var u=oa(),f=$(u),o=$(f,!0);E(f);var c=P(f,2);At(c),c.__change=[aa,n,t,r],c.__input=[sa,i,t,r],E(u),at(()=>{B(f,"for","slider_slide_"+t.id),_t(o,t.name),B(c,"id","slider_slide_"+t.id),B(c,"min",a()),B(c,"max",s()),B(c,"step",l())}),Dt(c,r),D(e,u),it()}vt(["change","input"]);var la=Y('<div class="camera-options svelte-1x08sfe"><!> <div class="actions-wrapper svelte-1x08sfe"><button class="svelte-1x08sfe">Reset defaults</button></div></div>');function ca(e, t){nt(t,!1);const i=yt(),n=()=>st(Se,"$camControls",i),r=(o, c)=>{Se.update(d=>d.map(p=>p.id===o?{...p,value:c}:{...p})),et(`/cam/ctrl/${o}/${c}`, d=>{console.log("SVELTE CamCtrl",d)})},a=()=>{Se.update(c=>c.map(d=>({...d,value:d.defaultValue})));const o={};for(let c of n())c!=null&&c.id&&(o[c.id]=c.defaultValue);we("/cam/controls",o, c=>{console.log("SVELTE Cam Controls",c)})};Cn();var s=la(),l=$(s);jt(l,3,n, o=>o.name,(o, c, d)=>{Wn(o,Ln(()=>v(c),{get index(){return v(d)},onchange:r}))});var u=P(l,2),f=$(u);f.__click=a,E(u),E(s),D(e,s),it()}vt(["click"]);const ua=()=>{jn.update(e=>!e)};var da=Qt('<polygon points="-15,-15 -15,15 15,15 15,-15" stroke-width="5" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),fa=Qt('<polygon points="-7.5,-22.5 -7.5,22.5 20,0" stroke-width="10" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),va=Y('<div id="video-recording" class="svelte-1h8ia9r"><button aria-label="Record video" class="svelte-1h8ia9r"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" preserveAspectRatio="xMinYMin slice" class="svelte-1h8ia9r"><g transform="translate(42,42)"><circle r="38" stroke-width="5" class="svelte-1h8ia9r"></circle><!></g></svg></button></div>');function ha(e, t){nt(t,!0);let i=V(!1);const n=jn.subscribe(f=>{if(v(i)!==f){z(i,W(f));const o=v(i)?"start":"stop";et(`/cam/video-rec/vid/${o}`, c=>{console.log("Video recording",c)})}});wt(()=>{n&&n()});var r=va(),a=$(r);a.__click=[ua];var s=$(a),l=$(s),u=P($(l));J(u,()=>v(i), f=>{var o=da();D(f,o)}, f=>{var o=fa();D(f,o)}),E(l),E(s),E(a),E(r),D(e,r),it()}vt(["click"]);var pa=Y('<h3 class="message svelte-2mgxfn"><!></h3>'),ga=Y('<div class="sphere-config svelte-2mgxfn"><!> <!> <div class="actions-wrapper svelte-2mgxfn"><a href="/system" class="button"><span class="icon-settings"></span>System</a> <button class="button">Save settings</button></div></div>');function ma(e, t){nt(t,!0);const i=yt(),n=()=>st(Gt,"$sphereControls",i);let r=V(void 0),a=V(W([]));const s=Gt.subscribe(h=>{z(a,W(h.map(y=>({...y}))))}),l=(h, y)=>{console.log(),Gt.update(w=>w.map(b=>b.id===h?{...b,value:y}:{...b}))},u=()=>{const h={};for(let y of n())h[y.id]=y.value;we("/config/sphere/settings",h, y=>{z(r,W((y==null?void 0:y.response)===200?'<span style="color:#090">Successfully saved settings.</span>':'<span style="color:#B00">Failed to save settings.</span>')),setTimeout(()=>{z(r,null)},5e3)})};wt(()=>{s&&s()});var f=ga(),o=$(f);J(o,()=>v(r), h=>{var y=pa(),w=$(y);Si(w,()=>v(r)),E(y),D(h,y)});var c=P(o,2);jt(c,17,()=>v(a),qt,(h, y, w)=>{Wn(h,Ln(()=>v(y),{index:w,oninput:l}))});var d=P(c,2),p=P($(d),2);p.__click=u,E(d),E(f),D(e,f),it()}vt(["click"]);const _a=(e, t)=>{const i=t()==="B"?"cam_b":"cam_a";et(`/cam/capture-img/image/${i}`, n=>{console.log("Capture image",n)})},ya=(e, t, i, n)=>{const r=t()==="B"?"cam_b":"cam_a";et(`/cam/snail-shot/${v(i)}/${v(n)}/${r}`, a=>{console.log("Snails",a,r)})};var wa=(e, t)=>console.log("X:",v(t)),ba=Y("<option></option>"),Sa=(e, t)=>console.log("Y:",v(t)),Ma=Y("<option></option>"),xa=()=>bi("/images"),Ea=Y('<div id="image-capture" class="svelte-nnuquw"><button class="svg-btn svelte-nnuquw" aria-label="Capture image"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-nnuquw"><g transform="translate(42,42)"><circle r="28" fill="#C00" stroke="#C00"></circle><circle r="38" class="capture-button svelte-nnuquw"></circle></g></svg></button> <button class="svg-btn svelte-nnuquw" aria-label="Snail shot"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-nnuquw"><g transform="translate(42,42)"><polyline points="0,0 20,0 20,15 -20,15 -20,-15 40,-15 40,30 -20,30 -12,28 -12,32 -20,30" class="svelte-nnuquw"></polyline></g></svg></button> <div class="dimensions svelte-nnuquw"><label class="svelte-nnuquw"><span class="svelte-nnuquw">hor</span><select class="svelte-nnuquw"></select></label> <label class="svelte-nnuquw"><span class="svelte-nnuquw">ver</span><select class="svelte-nnuquw"></select></label></div> <button class="ico-btn icon-gallery" aria-label="Image gallery"></button></div>');function $a(e, t){nt(t,!0);const i=yt(),n=()=>st(ce,"$swapPreview",i);let r=V(3),a=V(3);var s=Ea(),l=$(s);l.__click=[_a,n];var u=P(l,2);u.__click=[ya,n,r,a];var f=P(u,2),o=$(f),c=P($(o));c.__change=[wa,r],jt(c,20,()=>Array.from({length:7}),qt,(y, w, b)=>{var _=ba();_.value=(_.__value=b+3)==null?"":b+3,_.textContent=b+3,D(y,_)}),E(c),E(o);var d=P(o,2),p=P($(d));p.__change=[Sa,a],jt(p,20,()=>Array.from({length:7}),qt,(y, w, b)=>{var _=Ma();_.value=(_.__value=b+3)==null?"":b+3,_.textContent=b+3,D(y,_)}),E(p),E(d),E(f);var h=P(f,2);h.__click=[xa],E(s),en(c,()=>v(r), y=>z(r,y)),en(p,()=>v(a), y=>z(a,y)),D(e,s),it()}vt(["click","change"]);var ka=Y('<div class="controls svelte-bwwnlr"><div class="tools svelte-bwwnlr"><!></div></div>');function Ta(e){const t=yt(),i=()=>st(Te,"$toolTab",t);var n=Tt(),r=ht(n);J(r,i, a=>{var s=ka(),l=$(s),u=$(l);J(u,()=>i()==="target", f=>{Rr(f)}, f=>{var o=Tt(),c=ht(o);J(c,()=>i()==="sphere", d=>{ma(d,{})}, d=>{var p=Tt(),h=ht(p);J(h,()=>i()==="location", y=>{ra(y,{})}, y=>{var w=Tt(),b=ht(w);J(b,()=>i()==="adjust", _=>{ca(_,{})}, _=>{var g=Tt(),S=ht(g);J(S,()=>i()==="video", T=>{ha(T,{})}, T=>{var j=Tt(),I=ht(j);J(I,()=>i()==="picture", A=>{$a(A,{})},null,!0),D(T,j)},!0),D(_,g)},!0),D(y,w)},!0),D(d,p)},!0),D(f,o)}),E(l),E(s),D(a,s)}),D(e,n)}var ja=Y('<li><button><span class="svelte-dso250"> </span></button></li>'),Ca=Y('<div id="options-menu" class="svelte-dso250"><ul class="svelte-dso250"></ul></div>');function La(e, t){nt(t,!0);let i=V("");const n=Te.subscribe(o=>{z(i,W(o))});let r=V(!1);const a=de.subscribe(o=>{z(r,W(o))}),s= o=>{Te.update(c=>c===o?"":o)};wt(()=>{n&&n(),a&&a()});const l=[{id:"sphere",name:"Sphere",icon:"icon-settings",callback:()=>{s("sphere")},enabled:()=>v(i)==="sphere"},{id:"compass",name:"Compass",icon:"icon-compass",callback:()=>{de.update(o=>!o)},enabled:()=>v(r)},{id:"location",name:"Location",icon:"icon-location",callback:()=>{s("location")},enabled:()=>v(i)==="location"},{id:"target",name:"Target",icon:"icon-target",callback:()=>{s("target")},enabled:()=>v(i)==="target"},{id:"adjust",name:"Contrast",icon:"icon-adjust",callback:()=>{s("adjust")},enabled:()=>v(i)==="adjust"},{id:"video",name:"Video",icon:"icon-video",callback:()=>{s("video")},enabled:()=>v(i)==="video"},{id:"picture",name:"Picture",icon:"icon-image",callback:()=>{s("picture")},enabled:()=>v(i)==="picture"}];var u=Ca(),f=$(u);jt(f,21,()=>l,qt,(o, c)=>{var d=ja();const p=Et(()=>`${(v(c).enabled()?"active":"")??""} svelte-dso250`);var h=$(d);h.__click=function(...b){var _;(_=v(c).callback)==null||_.apply(this,b)};var y=$(h),w=$(y,!0);E(y),E(h),E(d),at(()=>{$t(d,v(p)),$t(h,`${v(c).icon??""} svelte-dso250`),_t(w,v(c).name)}),D(o,d)}),E(f),E(u),D(e,u),it()}vt(["click"]);var Pa=Y("<div><!> <!> <!> <!></div>");function Ba(e){const t=yt(),i=()=>st(gi,"$daylight",t);var n=Pa(),r=$(n);pi(r);var a=P(r,2);xr(a);var s=P(a,2);Ta(s);var l=P(s,2);La(l,{}),E(n),at(()=>$t(n,`${"container"+(i()?" daylight":"")} svelte-183uj8y`)),D(e,n)}export{Ba as component};
