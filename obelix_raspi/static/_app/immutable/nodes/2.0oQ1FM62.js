var zs=Object.defineProperty;var Gn=n=>{throw TypeError(n)};var Us=(n,t,e)=>t in n?zs(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var ti=(n,t,e)=>Us(n,typeof t!="symbol"?t+"":t,e),en=(n,t,e)=>t.has(n)||Gn("Cannot "+e);var Mt=(n,t,e)=>(en(n,t,"read from private field"),e?e.call(n):t.get(n)),oe=(n,t,e)=>t.has(n)?Gn("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),nn=(n,t,e,i)=>(en(n,t,"write to private field"),i?i.call(n,e):t.set(n,e),e),ei=(n,t,e)=>(en(n,t,"access private method"),e);import{b as ni,e as Ys,a as B,t as j,n as we,c as Bt}from"../chunks/disclose-version.CNLHaAqQ.js";import{S as Hs,h as Hi,k as ot,K as Me,L as pn,A as Xs,Q as Xi,a7 as Ws,a8 as ii,J as sn,l as jt,ar as Le,a5 as Wi,i as qn,a6 as Ks,C as si,as as ri,at as jn,au as Js,U as Zs,$ as oi,av as Fn,aw as Qs,P as Gs,ax as tr,j as Ki,F as Ji,M as er,B as nr,ab as ir,ay as Zi,az as sr,G as Qi,N as rr,I as or,aA as ar,a4 as ai,aB as cr,aC as lr,aD as ur,aa as hr,a9 as zn,b as fr,p as st,V as P,q as A,w as $,v as T,t as it,o as rt,aE as ci,g,aq as U,f as Vt,m as bt}from"../chunks/runtime.CedCiwwz.js";import{a as Et,d as ct,s as Rt,b as ut}from"../chunks/store.BJdxs5V9.js";import{c as dr,d as mt,a as Q,p as Nt,o as be,i as Z,b as pr,s as Gi}from"../chunks/index-client.B4OvqJGf.js";import{i as ts}from"../chunks/lifecycle.B-JXNPr4.js";import{w as _t,g as Je}from"../chunks/index.CtQPgalP.js";let rn=null;function Qt(n,t){return t}function vr(n,t,e,i){for(var s=[],r=t.length,o=0;o<r;o++)Qs(t[o].e,s,!0);var a=r>0&&s.length===0&&e!==null;if(a){var l=e.parentNode;Gs(l),l.append(e),i.clear(),Pt(n,t[0].prev,t[r-1].next)}tr(s,()=>{for(var d=0;d<r;d++){var c=t[d];a||(i.delete(c.k),Pt(n,c.prev,c.next)),Ki(c.e,!a)}})}function Ft(n,t,e,i,s,r=null){var o=n,a={flags:t,items:new Map,first:null},l=(t&Zi)!==0;if(l){var d=n;o=ot?Me(Ji(d)):d.appendChild(Hs())}ot&&pn();var c=null,u=!1;Hi(()=>{var h=e(),p=Xs(h)?h:h==null?[]:Xi(h),f=p.length;if(u&&f===0)return;u=f===0;let b=!1;if(ot){var _=o.data===Ws;_!==(f===0)&&(o=ii(),Me(o),sn(!1),b=!0)}if(ot){for(var E=null,w,v=0;v<f;v++){if(jt.nodeType===8&&jt.data===er){o=jt,b=!0,sn(!1);break}var y=p[v],k=i(y,v);w=es(jt,a,E,null,y,k,v,s,t),a.items.set(k,w),E=w}f>0&&Me(ii())}if(!ot){var R=nr;gr(p,a,o,s,t,(R.f&Le)!==0,i)}r!==null&&(f===0?c?Wi(c):c=qn(()=>r(o)):c!==null&&Ks(c,()=>{c=null})),b&&sn(!0),e()}),ot&&(o=jt)}function gr(n,t,e,i,s,r,o){var M,m,L,H;var a=(s&sr)!==0,l=(s&(jn|Fn))!==0,d=n.length,c=t.items,u=t.first,h=u,p,f=null,b,_=[],E=[],w,v,y,k;if(a)for(k=0;k<d;k+=1)w=n[k],v=o(w,k),y=c.get(v),y!==void 0&&((M=y.a)==null||M.measure(),(b??(b=new Set)).add(y));for(k=0;k<d;k+=1){if(w=n[k],v=o(w,k),y=c.get(v),y===void 0){var R=h?h.e.nodes_start:e;f=es(R,t,f,f===null?t.first:f.next,w,v,k,i,s),c.set(v,f),_=[],E=[],h=f.next;continue}if(l&&mr(y,w,k,s),y.e.f&Le&&(Wi(y.e),a&&((m=y.a)==null||m.unfix(),(b??(b=new Set)).delete(y))),y!==h){if(p!==void 0&&p.has(y)){if(_.length<E.length){var D=E[0],O;f=D.prev;var S=_[0],C=_[_.length-1];for(O=0;O<_.length;O+=1)li(_[O],D,e);for(O=0;O<E.length;O+=1)p.delete(E[O]);Pt(t,S.prev,C.next),Pt(t,f,S),Pt(t,C,D),h=D,f=C,k-=1,_=[],E=[]}else p.delete(y),li(y,h,e),Pt(t,y.prev,y.next),Pt(t,y,f===null?t.first:f.next),Pt(t,f,y),f=y;continue}for(_=[],E=[];h!==null&&h.k!==v;)(r||!(h.e.f&Le))&&(p??(p=new Set)).add(h),E.push(h),h=h.next;if(h===null)continue;y=h}_.push(y),f=y,h=y.next}if(h!==null||p!==void 0){for(var x=p===void 0?[]:Xi(p);h!==null;)(r||!(h.e.f&Le))&&x.push(h),h=h.next;var I=x.length;if(I>0){var N=s&Zi&&d===0?e:null;if(a){for(k=0;k<I;k+=1)(L=x[k].a)==null||L.measure();for(k=0;k<I;k+=1)(H=x[k].a)==null||H.fix()}vr(t,x,N,c)}}a&&ir(()=>{var X;if(b!==void 0)for(y of b)(X=y.a)==null||X.apply()}),si.first=t.first&&t.first.e,si.last=f&&f.e}function mr(n,t,e,i){i&jn&&ri(n.v,t),i&Fn?ri(n.i,e):n.i=e}function es(n,t,e,i,s,r,o,a,l){var d=rn;try{var c=(l&jn)!==0,u=(l&Js)===0,h=c?u?Zs(s):oi(s):s,p=l&Fn?oi(o):o,f={i:p,v:h,k:r,a:null,e:null,prev:e,next:i};return rn=f,f.e=qn(()=>a(n,h,p),ot),f.e.prev=e&&e.e,f.e.next=i&&i.e,e===null?t.first=f:(e.next=f,e.e.next=f.e),i!==null&&(i.prev=f,i.e.prev=f.e),f}finally{rn=d}}function li(n,t,e){for(var i=n.next?n.next.e.nodes_start:e,s=t?t.e.nodes_start:e,r=n.e.nodes_start;r!==i;){var o=Qi(r);s.before(r),r=o}}function Pt(n,t,e){t===null?n.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function _r(n,t,e,i,s){var r=n,o="",a;Hi(()=>{if(o===(o=t()??"")){ot&&pn();return}a!==void 0&&(Ki(a),a=void 0),o!==""&&(a=qn(()=>{if(ot){jt.data;for(var l=pn(),d=l;l!==null&&(l.nodeType!==8||l.data!=="");)d=l,l=Qi(l);if(l===null)throw rr(),or;ni(jt,d),r=Me(l);return}var c=o+"",u=Ys(c);ni(Ji(u),u.lastChild),r.before(u)}))})}let ui=!1;function ns(){ui||(ui=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{var t;if(!n.defaultPrevented)for(const e of n.target.elements)(t=e.__on_r)==null||t.call(e)})},{capture:!0}))}function Xt(n){if(ot){var t=!1,e=()=>{if(!t){if(t=!0,n.hasAttribute("value")){var i=n.value;Y(n,"value",null),n.value=i}if(n.hasAttribute("checked")){var s=n.checked;Y(n,"checked",null),n.checked=s}}};n.__on_r=e,lr(e),ns()}}function Y(n,t,e,i){var s=n.__attributes??(n.__attributes={});ot&&(s[t]=n.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&n.nodeName==="LINK")||s[t]!==(s[t]=e)&&(t==="style"&&"__styles"in n&&(n.__styles={}),t==="loading"&&(n[ar]=e),e==null?n.removeAttribute(t):typeof e!="string"&&yr(n).includes(t)?n[t]=e:n.setAttribute(t,e))}var hi=new Map;function yr(n){var t=hi.get(n.nodeName);if(t)return t;hi.set(n.nodeName,t=[]);for(var e,i=ai(n),s=Element.prototype;s!==i;){e=cr(i);for(var r in e)e[r].set&&t.push(r);i=ai(i)}return t}function At(n,t){var e=n.__className,i=wr(t);ot&&n.className===i?n.__className=i:(e!==i||ot&&n.className!==i)&&(t==null?n.removeAttribute("class"):n.className=i,n.__className=i)}function wr(n){return n??""}function is(n,t,e,i=e){n.addEventListener(t,e);const s=n.__on_r;s?n.__on_r=()=>{s(),i()}:n.__on_r=i,ns()}function Wt(n,t,e=t){var i=ur();is(n,"input",()=>{var s=fi(n)?di(n.value):n.value;e(s),i&&s!==(s=t())&&(n.value=s??"")}),hr(()=>{var s=t();if(ot&&n.defaultValue!==n.value){e(n.value);return}fi(n)&&s===di(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function fi(n){var t=n.type;return t==="number"||t==="range"}function di(n){return n===""?null:+n}function ss(n,t,e){if(n.multiple)return Er(n,t);for(var i of n.options){var s=pe(i);if(dr(s,t)){i.selected=!0;return}}(!e||t!==void 0)&&(n.selectedIndex=-1)}function br(n,t){zn(()=>{var e=new MutationObserver(()=>{var i=n.__value;ss(n,i)});return e.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{e.disconnect()}})}function pi(n,t,e=t){var i=!0;is(n,"change",()=>{var s;if(n.multiple)s=[].map.call(n.querySelectorAll(":checked"),pe);else{var r=n.querySelector(":checked");s=r&&pe(r)}e(s)}),zn(()=>{var s=t();if(ss(n,s,i),i&&s===void 0){var r=n.querySelector(":checked");r!==null&&(s=pe(r),e(s))}n.__value=s,i=!1}),br(n)}function Er(n,t){for(var e of n.options)e.selected=~t.indexOf(pe(e))}function pe(n){return"__value"in n?n.__value:n.value}var Dt,Zt,ye,We,rs;const Ke=class Ke{constructor(t){oe(this,We);oe(this,Dt,new WeakMap);oe(this,Zt);oe(this,ye);nn(this,ye,t)}observe(t,e){var i=Mt(this,Dt).get(t)||new Set;return i.add(e),Mt(this,Dt).set(t,i),ei(this,We,rs).call(this).observe(t,Mt(this,ye)),()=>{var s=Mt(this,Dt).get(t);s.delete(e),s.size===0&&(Mt(this,Dt).delete(t),Mt(this,Zt).unobserve(t))}}};Dt=new WeakMap,Zt=new WeakMap,ye=new WeakMap,We=new WeakSet,rs=function(){return Mt(this,Zt)??nn(this,Zt,new ResizeObserver(t=>{for(var e of t){Ke.entries.set(e.target,e);for(var i of Mt(this,Dt).get(e.target)||[])i(e)}}))},ti(Ke,"entries",new WeakMap);let vn=Ke;var kr=new vn({box:"border-box"});function vi(n,t,e){var i=kr.observe(n,()=>e(n[t]));zn(()=>(fr(()=>e(n[t])),i))}const Sr=_t(`${location.protocol}//${location.hostname}`),Un=_t(location.origin),ne=_t({x:0,y:0,f:0,deg_x:0,deg_y:0,dx:1,dy:-1,df:1,acc:1e3,spr:8e4,mpa:2e4,minpx:-2e4,maxpx:2e4,mpf:5e3,vx:0,vy:0,va1:100,va2:1500,vf:0,vf1:100,vf2:1500}),on=_t([{id:"Brightness",name:"Brightness",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.01},{id:"Contrast",name:"Contrast",defaultValue:1,value:1,minValue:0,maxValue:6,steps:.1},{id:"Saturation",name:"Saturation",defaultValue:1,value:1,minValue:0,maxValue:32,steps:.1},{id:"Sharpness",name:"Sharpness",defaultValue:1,value:1,minValue:0,maxValue:16,steps:.1},{id:"ExposureTime",name:"Exposure time",description:"Value > 0 will reduce video framerate.",defaultValue:0,value:0,minValue:-10,maxValue:10,steps:.1},{id:"AnalogueGain",name:"Analogue gain",defaultValue:1,value:1,minValue:1,maxValue:8,steps:.1}]),ke=_t([]),kt=_t({}),gn=_t(""),Ie=_t(!0),Ne=_t("B"),Yn=_t(!1),Ve=_t(!1),ve=_t([{id:"CrosshairSize",name:"Crosshair Size",defaultValue:.04,value:.04,minValue:.005,maxValue:.25,steps:.005},{id:"CrosshairOffsetX",name:"Crosshair Offset X",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.005},{id:"CrosshairOffsetY",name:"Crosshair Offset Y",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.005},{id:"SphereScaleVF",name:"Sphere Scale Viewfinder",defaultValue:2740,value:2740,minValue:2e3,maxValue:5e3,steps:5},{id:"SphereScaleTel",name:"Sphere Scale Telescope",defaultValue:195280,value:195280,minValue:18e4,maxValue:22e4,steps:5}]);var xr=j('<div id="horizon-wrapper" class="svelte-14er9jv"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 220" width="220" height="220" class="svelte-14er9jv"><defs><path id="altitude" d="M32 0 108 0" stroke-width="2" stroke-linecap="round"></path><path id="altitudeText" d="M40 -4 108 -4" stroke="#000" stroke-linecap="round"></path></defs><g id="compass" transform="translate(110 110)"><circle r="32" class="compass svelte-14er9jv" stroke-width="2"></circle><circle r="30" class="compass--scale svelte-14er9jv" stroke-dasharray="2 21.5619449019" stroke-dashoffset="1" stroke-width="6"></circle><g><polygon class="compass--needle svelte-14er9jv" points="-10,10 0,-30 0,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" fill="#000"></polygon><polygon class="compass--needle svelte-14er9jv" points="10,10 0,-30 0,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" fill="#FFF"></polygon></g><g><use class="compass--alt svelte-14er9jv" href="#altitude"></use><text class="compass--text svelte-14er9jv" font-size="20"><textPath href="#altitudeText"> </textPath></text></g><text class="compass--text svelte-14er9jv" font-size="20" text-anchor="middle" y="50"> </text></g></svg></div>');function Tr(n,t){st(t,!1);let e=ci(),i=ci();const s=ne.subscribe(b=>{P(e,b.deg_x),P(i,b.deg_y)});mt(()=>{s&&s()}),ts();var r=xr(),o=A(r),a=$(A(o)),l=$(A(a),2),d=$(l),c=$(A(d)),u=A(c),h=A(u);T(u),T(c),T(d);var p=$(d),f=A(p);T(p),T(a),T(o),T(r),it(()=>{Y(l,"transform",`rotate(${g(e)??""})`),Y(d,"transform",`rotate(${-g(i)})`),Et(h,`${g(i)??""}°`),Et(f,`${g(e)??""}°`)}),B(n,r),rt()}const Ct=Object.create(null);Ct.open="0";Ct.close="1";Ct.ping="2";Ct.pong="3";Ct.message="4";Ct.upgrade="5";Ct.noop="6";const $e=Object.create(null);Object.keys(Ct).forEach(n=>{$e[Ct[n]]=n});const mn={type:"error",data:"parser error"},os=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",as=typeof ArrayBuffer=="function",cs=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,Hn=({type:n,data:t},e,i)=>os&&t instanceof Blob?e?i(t):gi(t,i):as&&(t instanceof ArrayBuffer||cs(t))?e?i(t):gi(new Blob([t]),i):i(Ct[n]+(t||"")),gi=(n,t)=>{const e=new FileReader;return e.onload=function(){const i=e.result.split(",")[1];t("b"+(i||""))},e.readAsDataURL(n)};function mi(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let an;function Ar(n,t){if(os&&n.data instanceof Blob)return n.data.arrayBuffer().then(mi).then(t);if(as&&(n.data instanceof ArrayBuffer||cs(n.data)))return t(mi(n.data));Hn(n,!1,e=>{an||(an=new TextEncoder),t(an.encode(e))})}const _i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ce=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<_i.length;n++)ce[_i.charCodeAt(n)]=n;const Cr=n=>{let t=n.length*.75,e=n.length,i,s=0,r,o,a,l;n[n.length-1]==="="&&(t--,n[n.length-2]==="="&&t--);const d=new ArrayBuffer(t),c=new Uint8Array(d);for(i=0;i<e;i+=4)r=ce[n.charCodeAt(i)],o=ce[n.charCodeAt(i+1)],a=ce[n.charCodeAt(i+2)],l=ce[n.charCodeAt(i+3)],c[s++]=r<<2|o>>4,c[s++]=(o&15)<<4|a>>2,c[s++]=(a&3)<<6|l&63;return d},Rr=typeof ArrayBuffer=="function",Xn=(n,t)=>{if(typeof n!="string")return{type:"message",data:ls(n,t)};const e=n.charAt(0);return e==="b"?{type:"message",data:Or(n.substring(1),t)}:$e[e]?n.length>1?{type:$e[e],data:n.substring(1)}:{type:$e[e]}:mn},Or=(n,t)=>{if(Rr){const e=Cr(n);return ls(e,t)}else return{base64:!0,data:n}},ls=(n,t)=>{switch(t){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},us="",Mr=(n,t)=>{const e=n.length,i=new Array(e);let s=0;n.forEach((r,o)=>{Hn(r,!1,a=>{i[o]=a,++s===e&&t(i.join(us))})})},Lr=(n,t)=>{const e=n.split(us),i=[];for(let s=0;s<e.length;s++){const r=Xn(e[s],t);if(i.push(r),r.type==="error")break}return i};function Nr(){return new TransformStream({transform(n,t){Ar(n,e=>{const i=e.length;let s;if(i<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,i);else if(i<65536){s=new Uint8Array(3);const r=new DataView(s.buffer);r.setUint8(0,126),r.setUint16(1,i)}else{s=new Uint8Array(9);const r=new DataView(s.buffer);r.setUint8(0,127),r.setBigUint64(1,BigInt(i))}n.data&&typeof n.data!="string"&&(s[0]|=128),t.enqueue(s),t.enqueue(e)})}})}let cn;function Se(n){return n.reduce((t,e)=>t+e.length,0)}function xe(n,t){if(n[0].length===t)return n.shift();const e=new Uint8Array(t);let i=0;for(let s=0;s<t;s++)e[s]=n[0][i++],i===n[0].length&&(n.shift(),i=0);return n.length&&i<n[0].length&&(n[0]=n[0].slice(i)),e}function $r(n,t){cn||(cn=new TextDecoder);const e=[];let i=0,s=-1,r=!1;return new TransformStream({transform(o,a){for(e.push(o);;){if(i===0){if(Se(e)<1)break;const l=xe(e,1);r=(l[0]&128)===128,s=l[0]&127,s<126?i=3:s===126?i=1:i=2}else if(i===1){if(Se(e)<2)break;const l=xe(e,2);s=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),i=3}else if(i===2){if(Se(e)<8)break;const l=xe(e,8),d=new DataView(l.buffer,l.byteOffset,l.length),c=d.getUint32(0);if(c>Math.pow(2,21)-1){a.enqueue(mn);break}s=c*Math.pow(2,32)+d.getUint32(4),i=3}else{if(Se(e)<s)break;const l=xe(e,s);a.enqueue(Xn(r?l:cn.decode(l),t)),i=0}if(s===0||s>n){a.enqueue(mn);break}}}})}const hs=4;function G(n){if(n)return Br(n)}function Br(n){for(var t in G.prototype)n[t]=G.prototype[t];return n}G.prototype.on=G.prototype.addEventListener=function(n,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(t),this};G.prototype.once=function(n,t){function e(){this.off(n,e),t.apply(this,arguments)}return e.fn=t,this.on(n,e),this};G.prototype.off=G.prototype.removeListener=G.prototype.removeAllListeners=G.prototype.removeEventListener=function(n,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+n];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var i,s=0;s<e.length;s++)if(i=e[s],i===t||i.fn===t){e.splice(s,1);break}return e.length===0&&delete this._callbacks["$"+n],this};G.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+n],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(e){e=e.slice(0);for(var i=0,s=e.length;i<s;++i)e[i].apply(this,t)}return this};G.prototype.emitReserved=G.prototype.emit;G.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};G.prototype.hasListeners=function(n){return!!this.listeners(n).length};const Ze=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0),ft=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Pr="arraybuffer";function fs(n,...t){return t.reduce((e,i)=>(n.hasOwnProperty(i)&&(e[i]=n[i]),e),{})}const Dr=ft.setTimeout,Ir=ft.clearTimeout;function Qe(n,t){t.useNativeTimers?(n.setTimeoutFn=Dr.bind(ft),n.clearTimeoutFn=Ir.bind(ft)):(n.setTimeoutFn=ft.setTimeout.bind(ft),n.clearTimeoutFn=ft.clearTimeout.bind(ft))}const Vr=1.33;function qr(n){return typeof n=="string"?jr(n):Math.ceil((n.byteLength||n.size)*Vr)}function jr(n){let t=0,e=0;for(let i=0,s=n.length;i<s;i++)t=n.charCodeAt(i),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(i++,e+=4);return e}function ds(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Fr(n){let t="";for(let e in n)n.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(n[e]));return t}function zr(n){let t={},e=n.split("&");for(let i=0,s=e.length;i<s;i++){let r=e[i].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}class Ur extends Error{constructor(t,e,i){super(t),this.description=e,this.context=i,this.type="TransportError"}}class Wn extends G{constructor(t){super(),this.writable=!1,Qe(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,i){return super.emitReserved("error",new Ur(t,e,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=Xn(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const e=Fr(t);return e.length?"?"+e:""}}class Yr extends Wn{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||e()})),this.writable||(i++,this.once("drain",function(){--i||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const e=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};Lr(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Mr(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=ds()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(t,e)}}let ps=!1;try{ps=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Hr=ps;function Xr(){}class Wr extends Yr{constructor(t){if(super(t),typeof location<"u"){const e=location.protocol==="https:";let i=location.port;i||(i=e?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||i!==t.port}}doWrite(t,e){const i=this.request({method:"POST",data:t});i.on("success",e),i.on("error",(s,r)=>{this.onError("xhr post error",s,r)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,i)=>{this.onError("xhr poll error",e,i)}),this.pollXhr=t}}class Tt extends G{constructor(t,e,i){super(),this.createRequest=t,Qe(this,i),this._opts=i,this._method=i.method||"GET",this._uri=e,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var t;const e=fs(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(e);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&i.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var s;i.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=Tt.requestsCount++,Tt.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Xr,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Tt.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Tt.requestsCount=0;Tt.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",yi);else if(typeof addEventListener=="function"){const n="onpagehide"in ft?"pagehide":"unload";addEventListener(n,yi,!1)}}function yi(){for(let n in Tt.requests)Tt.requests.hasOwnProperty(n)&&Tt.requests[n].abort()}const Kr=function(){const n=vs({xdomain:!1});return n&&n.responseType!==null}();class Jr extends Wr{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=Kr&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Tt(vs,this.uri(),t)}}function vs(n){const t=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Hr))return new XMLHttpRequest}catch{}if(!t)try{return new ft[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const gs=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Zr extends Wn{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,i=gs?{}:fs(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,i)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const i=t[e],s=e===t.length-1;Hn(i,this.supportsBinary,r=>{try{this.doWrite(i,r)}catch{}s&&Ze(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=ds()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const ln=ft.WebSocket||ft.MozWebSocket;class Qr extends Zr{createSocket(t,e,i){return gs?new ln(t,e,i):e?new ln(t,e):new ln(t)}doWrite(t,e){this.ws.send(e)}}class Gr extends Wn{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const e=$r(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=t.readable.pipeThrough(e).getReader(),s=Nr();s.readable.pipeTo(t.writable),this._writer=s.writable.getWriter();const r=()=>{i.read().then(({done:a,value:l})=>{a||(this.onPacket(l),r())}).catch(a=>{})};r();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const i=t[e],s=e===t.length-1;this._writer.write(i).then(()=>{s&&Ze(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const to={websocket:Qr,webtransport:Gr,polling:Jr},eo=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,no=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function _n(n){if(n.length>8e3)throw"URI too long";const t=n,e=n.indexOf("["),i=n.indexOf("]");e!=-1&&i!=-1&&(n=n.substring(0,e)+n.substring(e,i).replace(/:/g,";")+n.substring(i,n.length));let s=eo.exec(n||""),r={},o=14;for(;o--;)r[no[o]]=s[o]||"";return e!=-1&&i!=-1&&(r.source=t,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=io(r,r.path),r.queryKey=so(r,r.query),r}function io(n,t){const e=/\/{2,9}/g,i=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&i.splice(0,1),t.slice(-1)=="/"&&i.splice(i.length-1,1),i}function so(n,t){const e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,s,r){s&&(e[s]=r)}),e}const yn=typeof addEventListener=="function"&&typeof removeEventListener=="function",Be=[];yn&&addEventListener("offline",()=>{Be.forEach(n=>n())},!1);class It extends G{constructor(t,e){if(super(),this.binaryType=Pr,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(e=t,t=null),t){const i=_n(t);e.hostname=i.host,e.secure=i.protocol==="https"||i.protocol==="wss",e.port=i.port,i.query&&(e.query=i.query)}else e.host&&(e.hostname=_n(e.host).host);Qe(this,e),this.secure=e.secure!=null?e.secure:typeof location<"u"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach(i=>{const s=i.prototype.name;this.transports.push(s),this._transportsByName[s]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=zr(this.opts.query)),yn&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Be.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=hs,e.transport=t,this.id&&(e.sid=this.id);const i=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&It.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",It.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let i=0;i<this.writeBuffer.length;i++){const s=this.writeBuffer[i].data;if(s&&(e+=qr(s)),i>0&&e>this._maxPayload)return this.writeBuffer.slice(0,i);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Ze(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,e,i){return this._sendPacket("message",t,e,i),this}send(t,e,i){return this._sendPacket("message",t,e,i),this}_sendPacket(t,e,i,s){if(typeof e=="function"&&(s=e,e=void 0),typeof i=="function"&&(s=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const r={type:t,data:e,options:i};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),s&&this.once("flush",s),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},i=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}_onError(t){if(It.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),yn&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=Be.indexOf(this._offlineEventListener);i!==-1&&Be.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}It.protocol=hs;class ro extends It{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),i=!1;It.priorWebsocketSuccess=!1;const s=()=>{i||(e.send([{type:"ping",data:"probe"}]),e.once("packet",u=>{if(!i)if(u.type==="pong"&&u.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;It.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(c(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=e.name,this.emitReserved("upgradeError",h)}}))};function r(){i||(i=!0,c(),e.close(),e=null)}const o=u=>{const h=new Error("probe error: "+u);h.transport=e.name,r(),this.emitReserved("upgradeError",h)};function a(){o("transport closed")}function l(){o("socket closed")}function d(u){e&&u.name!==e.name&&r()}const c=()=>{e.removeListener("open",s),e.removeListener("error",o),e.removeListener("close",a),this.off("close",l),this.off("upgrading",d)};e.once("open",s),e.once("error",o),e.once("close",a),this.once("close",l),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{i||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let i=0;i<t.length;i++)~this.transports.indexOf(t[i])&&e.push(t[i]);return e}}let oo=class extends ro{constructor(t,e={}){const i=typeof t=="object"?t:e;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(s=>to[s]).filter(s=>!!s)),super(t,i)}};function ao(n,t="",e){let i=n;e=e||typeof location<"u"&&location,n==null&&(n=e.protocol+"//"+e.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=e.protocol+n:n=e.host+n),/^(https?|wss?):\/\//.test(n)||(typeof e<"u"?n=e.protocol+"//"+n:n="https://"+n),i=_n(n)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const r=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+r+":"+i.port+t,i.href=i.protocol+"://"+r+(e&&e.port===i.port?"":":"+i.port),i}const co=typeof ArrayBuffer=="function",lo=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,ms=Object.prototype.toString,uo=typeof Blob=="function"||typeof Blob<"u"&&ms.call(Blob)==="[object BlobConstructor]",ho=typeof File=="function"||typeof File<"u"&&ms.call(File)==="[object FileConstructor]";function Kn(n){return co&&(n instanceof ArrayBuffer||lo(n))||uo&&n instanceof Blob||ho&&n instanceof File}function Pe(n,t){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let e=0,i=n.length;e<i;e++)if(Pe(n[e]))return!0;return!1}if(Kn(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return Pe(n.toJSON(),!0);for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)&&Pe(n[e]))return!0;return!1}function fo(n){const t=[],e=n.data,i=n;return i.data=wn(e,t),i.attachments=t.length,{packet:i,buffers:t}}function wn(n,t){if(!n)return n;if(Kn(n)){const e={_placeholder:!0,num:t.length};return t.push(n),e}else if(Array.isArray(n)){const e=new Array(n.length);for(let i=0;i<n.length;i++)e[i]=wn(n[i],t);return e}else if(typeof n=="object"&&!(n instanceof Date)){const e={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=wn(n[i],t));return e}return n}function po(n,t){return n.data=bn(n.data,t),delete n.attachments,n}function bn(n,t){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<t.length)return t[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let e=0;e<n.length;e++)n[e]=bn(n[e],t);else if(typeof n=="object")for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(n[e]=bn(n[e],t));return n}const vo=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],go=5;var V;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(V||(V={}));class mo{constructor(t){this.replacer=t}encode(t){return(t.type===V.EVENT||t.type===V.ACK)&&Pe(t)?this.encodeAsBinary({type:t.type===V.EVENT?V.BINARY_EVENT:V.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===V.BINARY_EVENT||t.type===V.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=fo(t),i=this.encodeAsString(e.packet),s=e.buffers;return s.unshift(i),s}}function wi(n){return Object.prototype.toString.call(n)==="[object Object]"}class Jn extends G{constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const i=e.type===V.BINARY_EVENT;i||e.type===V.BINARY_ACK?(e.type=i?V.EVENT:V.ACK,this.reconstructor=new _o(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(Kn(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0;const i={type:Number(t.charAt(0))};if(V[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===V.BINARY_EVENT||i.type===V.BINARY_ACK){const r=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);const o=t.substring(r,e);if(o!=Number(o)||t.charAt(e)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(t.charAt(e+1)==="/"){const r=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););i.nsp=t.substring(r,e)}else i.nsp="/";const s=t.charAt(e+1);if(s!==""&&Number(s)==s){const r=e+1;for(;++e;){const o=t.charAt(e);if(o==null||Number(o)!=o){--e;break}if(e===t.length)break}i.id=Number(t.substring(r,e+1))}if(t.charAt(++e)){const r=this.tryParse(t.substr(e));if(Jn.isPayloadValid(i.type,r))i.data=r;else throw new Error("invalid payload")}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case V.CONNECT:return wi(e);case V.DISCONNECT:return e===void 0;case V.CONNECT_ERROR:return typeof e=="string"||wi(e);case V.EVENT:case V.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&vo.indexOf(e[0])===-1);case V.ACK:case V.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class _o{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const e=po(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const yo=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Jn,Encoder:mo,get PacketType(){return V},protocol:go},Symbol.toStringTag,{value:"Module"}));function wt(n,t,e){return n.on(t,e),function(){n.off(t,e)}}const wo=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});let _s=class extends G{constructor(t,e,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[wt(t,"open",this.onopen.bind(this)),wt(t,"packet",this.onpacket.bind(this)),wt(t,"error",this.onerror.bind(this)),wt(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var i,s,r;if(wo.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const o={type:V.EVENT,data:e};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const c=this.ids++,u=e.pop();this._registerAckCallback(c,u),o.id=c}const a=(s=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||s===void 0?void 0:s.writable,l=this.connected&&!(!((r=this.io.engine)===null||r===void 0)&&r._hasPingExpired());return this.flags.volatile&&!a||(l?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,e){var i;const s=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(s===void 0){this.acks[t]=e;return}const r=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===t&&this.sendBuffer.splice(a,1);e.call(this,new Error("operation has timed out"))},s),o=(...a)=>{this.io.clearTimeoutFn(r),e.apply(this,a)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...e){return new Promise((i,s)=>{const r=(o,a)=>o?s(o):i(a);r.withError=!0,e.push(r),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((s,...r)=>i!==this._queue[0]?void 0:(s!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(s)):(this._queue.shift(),e&&e(null,...r)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:V.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(i=>String(i.id)===t)){const i=this.acks[t];delete this.acks[t],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case V.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case V.EVENT:case V.BINARY_EVENT:this.onevent(t);break;case V.ACK:case V.BINARY_ACK:this.onack(t);break;case V.DISCONNECT:this.ondisconnect();break;case V.CONNECT_ERROR:this.destroy();const i=new Error(t.data.message);i.data=t.data.data,this.emitReserved("connect_error",i);break}}onevent(t){const e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const i of e)i.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let i=!1;return function(...s){i||(i=!0,e.packet({type:V.ACK,id:t,data:s}))}}onack(t){const e=this.acks[t.id];typeof e=="function"&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:V.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const i of e)i.apply(this,t.data)}}};function ie(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}ie.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*n);n=Math.floor(t*10)&1?n+e:n-e}return Math.min(n,this.max)|0};ie.prototype.reset=function(){this.attempts=0};ie.prototype.setMin=function(n){this.ms=n};ie.prototype.setMax=function(n){this.max=n};ie.prototype.setJitter=function(n){this.jitter=n};class En extends G{constructor(t,e){var i;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,Qe(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((i=e.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new ie({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;const s=e.parser||yo;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new oo(this.uri,this.opts);const e=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const s=wt(e,"open",function(){i.onopen(),t&&t()}),r=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),t?t(a):this.maybeReconnectOnOpen()},o=wt(e,"error",r);if(this._timeout!==!1){const a=this._timeout,l=this.setTimeoutFn(()=>{s(),r(new Error("timeout")),e.close()},a);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(s),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(wt(t,"ping",this.onping.bind(this)),wt(t,"data",this.ondata.bind(this)),wt(t,"error",this.onerror.bind(this)),wt(t,"close",this.onclose.bind(this)),wt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){Ze(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let i=this.nsps[t];return i?this._autoConnect&&!i.active&&i.connect():(i=new _s(this,t,e),this.nsps[t]=i),i}_destroy(t){const e=Object.keys(this.nsps);for(const i of e)if(this.nsps[i].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let i=0;i<e.length;i++)this.engine.write(e[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(s=>{s?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",s)):t.onreconnect()}))},e);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const ae={};function ge(n,t){typeof n=="object"&&(t=n,n=void 0),t=t||{};const e=ao(n,t.path||"/socket.io"),i=e.source,s=e.id,r=e.path,o=ae[s]&&r in ae[s].nsps,a=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let l;return a?l=new En(i,t):(ae[s]||(ae[s]=new En(i,t)),l=ae[s]),e.query&&!t.query&&(t.query=e.queryKey),l.socket(e.path,t)}Object.assign(ge,{Manager:En,Socket:_s,io:ge,connect:ge});class bo{constructor(){if(this.enabled=!1,typeof ge=="function"){const t=Je(Un);this.socket=ge(t),this.socket&&(this.socket.on("connect",()=>{this.enabled=!0,console.log("Connected to websocket Obelix 1.0")}),this.socket.on("update_settings",e=>{console.log("SOCKETio",e),typeof e=="object"&&!Array.isArray(e)&&e!==null&&ne.update(i=>({...i,...e}))}))}}destroy(){this.socket.offAny(),this.socket.disconnect()}emit(t){this.enabled&&this.socket.emit("message",t)}emitReply(t,e){this.enabled&&(console.log("emitReply"),this.socket.emit("message_reply",t,(i,s)=>{console.log("emitReply response",i,s),typeof e=="function"&&e(s)}))}}const ys=new bo;function at(n,t){ys.emit({get:"foo"}),fetch(Je(Un)+n).then(e=>e.json()).then(e=>{typeof t=="function"&&t(e)})}function Ge(n,t,e){ys.emitReply({post:"foo"},e),fetch(Je(Un)+n,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(i=>i.json()).then(i=>{e&&e(i)})}class zt{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let i=0;for(let s=0;s<this._n&&s<32;s++){const r=e[s],o=t+r,a=Math.abs(t)<Math.abs(r)?t-(o-r):r-(o-t);a&&(e[i++]=a),t=o}return e[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let e=this._n,i,s,r,o=0;if(e>0){for(o=t[--e];e>0&&(i=o,s=t[--e],o=i+s,r=s-(o-i),!r););e>0&&(r<0&&t[e-1]<0||r>0&&t[e-1]>0)&&(s=r*2,i=o+s,s==i-o&&(o=i))}return o}}function*Eo(n){for(const t of n)yield*t}function ws(n){return Array.from(Eo(n))}function Kt(n,t,e){n=+n,t=+t,e=(s=arguments.length)<2?(t=n,n=0,1):s<3?1:+e;for(var i=-1,s=Math.max(0,Math.ceil((t-n)/e))|0,r=new Array(s);++i<s;)r[i]=n+i*e;return r}var q=1e-6,ko=1e-12,z=Math.PI,pt=z/2,bi=z/4,gt=z*2,Lt=180/z,lt=z/180,W=Math.abs,So=Math.atan,Gt=Math.atan2,J=Math.cos,Te=Math.ceil,K=Math.sin,xo=Math.sign||function(n){return n>0?1:n<0?-1:0},qt=Math.sqrt;function To(n){return n>1?0:n<-1?z:Math.acos(n)}function Ut(n){return n>1?pt:n<-1?-pt:Math.asin(n)}function vt(){}function qe(n,t){n&&ki.hasOwnProperty(n.type)&&ki[n.type](n,t)}var Ei={Feature:function(n,t){qe(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,i=-1,s=e.length;++i<s;)qe(e[i].geometry,t)}},ki={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,i=-1,s=e.length;++i<s;)n=e[i],t.point(n[0],n[1],n[2])},LineString:function(n,t){kn(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,i=-1,s=e.length;++i<s;)kn(e[i],t,0)},Polygon:function(n,t){Si(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,i=-1,s=e.length;++i<s;)Si(e[i],t)},GeometryCollection:function(n,t){for(var e=n.geometries,i=-1,s=e.length;++i<s;)qe(e[i],t)}};function kn(n,t,e){var i=-1,s=n.length-e,r;for(t.lineStart();++i<s;)r=n[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function Si(n,t){var e=-1,i=n.length;for(t.polygonStart();++e<i;)kn(n[e],t,1);t.polygonEnd()}function Ht(n,t){n&&Ei.hasOwnProperty(n.type)?Ei[n.type](n,t):qe(n,t)}function Sn(n){return[Gt(n[1],n[0]),Ut(n[2])]}function te(n){var t=n[0],e=n[1],i=J(e);return[i*J(t),i*K(t),K(e)]}function Ae(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function je(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function un(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function Ce(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function xn(n){var t=qt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function Tn(n,t){function e(i,s){return i=n(i,s),t(i[0],i[1])}return n.invert&&t.invert&&(e.invert=function(i,s){return i=t.invert(i,s),i&&n.invert(i[0],i[1])}),e}function An(n,t){return W(n)>z&&(n-=Math.round(n/gt)*gt),[n,t]}An.invert=An;function Ao(n,t,e){return(n%=gt)?t||e?Tn(Ti(n),Ai(t,e)):Ti(n):t||e?Ai(t,e):An}function xi(n){return function(t,e){return t+=n,W(t)>z&&(t-=Math.round(t/gt)*gt),[t,e]}}function Ti(n){var t=xi(n);return t.invert=xi(-n),t}function Ai(n,t){var e=J(n),i=K(n),s=J(t),r=K(t);function o(a,l){var d=J(l),c=J(a)*d,u=K(a)*d,h=K(l),p=h*e+c*i;return[Gt(u*s-p*r,c*e-h*i),Ut(p*s+u*r)]}return o.invert=function(a,l){var d=J(l),c=J(a)*d,u=K(a)*d,h=K(l),p=h*s-u*r;return[Gt(u*s+h*r,c*e+p*i),Ut(p*e-c*i)]},o}function Co(n,t,e,i,s,r){if(e){var o=J(t),a=K(t),l=i*e;s==null?(s=t+i*gt,r=t-l/2):(s=Ci(o,s),r=Ci(o,r),(i>0?s<r:s>r)&&(s+=i*gt));for(var d,c=s;i>0?c>r:c<r;c-=l)d=Sn([o,-a*J(c),-a*K(c)]),n.point(d[0],d[1])}}function Ci(n,t){t=te(t),t[0]-=n,xn(t);var e=To(-t[1]);return((-t[2]<0?-e:e)+gt-q)%gt}function bs(){var n=[],t;return{point:function(e,i,s){t.push([e,i,s])},lineStart:function(){n.push(t=[])},lineEnd:vt,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}}function De(n,t){return W(n[0]-t[0])<q&&W(n[1]-t[1])<q}function Re(n,t,e,i){this.x=n,this.z=t,this.o=e,this.e=i,this.v=!1,this.n=this.p=null}function Es(n,t,e,i,s){var r=[],o=[],a,l;if(n.forEach(function(f){if(!((b=f.length-1)<=0)){var b,_=f[0],E=f[b],w;if(De(_,E)){if(!_[2]&&!E[2]){for(s.lineStart(),a=0;a<b;++a)s.point((_=f[a])[0],_[1]);s.lineEnd();return}E[0]+=2*q}r.push(w=new Re(_,f,null,!0)),o.push(w.o=new Re(_,null,w,!1)),r.push(w=new Re(E,f,null,!1)),o.push(w.o=new Re(E,null,w,!0))}}),!!r.length){for(o.sort(t),Ri(r),Ri(o),a=0,l=o.length;a<l;++a)o[a].e=e=!e;for(var d=r[0],c,u;;){for(var h=d,p=!0;h.v;)if((h=h.n)===d)return;c=h.z,s.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(a=0,l=c.length;a<l;++a)s.point((u=c[a])[0],u[1]);else i(h.x,h.n.x,1,s);h=h.n}else{if(p)for(c=h.p.z,a=c.length-1;a>=0;--a)s.point((u=c[a])[0],u[1]);else i(h.x,h.p.x,-1,s);h=h.p}h=h.o,c=h.z,p=!p}while(!h.v);s.lineEnd()}}}function Ri(n){if(t=n.length){for(var t,e=0,i=n[0],s;++e<t;)i.n=s=n[e],s.p=i,i=s;i.n=s=n[0],s.p=i}}function hn(n){return W(n[0])<=z?n[0]:xo(n[0])*((W(n[0])+z)%gt-z)}function Ro(n,t){var e=hn(t),i=t[1],s=K(i),r=[K(e),-J(e),0],o=0,a=0,l=new zt;s===1?i=pt+q:s===-1&&(i=-pt-q);for(var d=0,c=n.length;d<c;++d)if(h=(u=n[d]).length)for(var u,h,p=u[h-1],f=hn(p),b=p[1]/2+bi,_=K(b),E=J(b),w=0;w<h;++w,f=y,_=R,E=D,p=v){var v=u[w],y=hn(v),k=v[1]/2+bi,R=K(k),D=J(k),O=y-f,S=O>=0?1:-1,C=S*O,x=C>z,I=_*R;if(l.add(Gt(I*S*K(C),E*D+I*J(C))),o+=x?O+S*gt:O,x^f>=e^y>=e){var N=je(te(p),te(v));xn(N);var M=je(r,N);xn(M);var m=(x^O>=0?-1:1)*Ut(M[2]);(i>m||i===m&&(N[0]||N[1]))&&(a+=x^O>=0?1:-1)}}return(o<-q||o<q&&l<-ko)^a&1}function ks(n,t,e,i){return function(s){var r=t(s),o=bs(),a=t(o),l=!1,d,c,u,h={point:p,lineStart:b,lineEnd:_,polygonStart:function(){h.point=E,h.lineStart=w,h.lineEnd=v,c=[],d=[]},polygonEnd:function(){h.point=p,h.lineStart=b,h.lineEnd=_,c=ws(c);var y=Ro(d,i);c.length?(l||(s.polygonStart(),l=!0),Es(c,Mo,y,e,s)):y&&(l||(s.polygonStart(),l=!0),s.lineStart(),e(null,null,1,s),s.lineEnd()),l&&(s.polygonEnd(),l=!1),c=d=null},sphere:function(){s.polygonStart(),s.lineStart(),e(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function p(y,k){n(y,k)&&s.point(y,k)}function f(y,k){r.point(y,k)}function b(){h.point=f,r.lineStart()}function _(){h.point=p,r.lineEnd()}function E(y,k){u.push([y,k]),a.point(y,k)}function w(){a.lineStart(),u=[]}function v(){E(u[0][0],u[0][1]),a.lineEnd();var y=a.clean(),k=o.result(),R,D=k.length,O,S,C;if(u.pop(),d.push(u),u=null,!!D){if(y&1){if(S=k[0],(O=S.length-1)>0){for(l||(s.polygonStart(),l=!0),s.lineStart(),R=0;R<O;++R)s.point((C=S[R])[0],C[1]);s.lineEnd()}return}D>1&&y&2&&k.push(k.pop().concat(k.shift())),c.push(k.filter(Oo))}}return h}}function Oo(n){return n.length>1}function Mo(n,t){return((n=n.x)[0]<0?n[1]-pt-q:pt-n[1])-((t=t.x)[0]<0?t[1]-pt-q:pt-t[1])}const Oi=ks(function(){return!0},Lo,$o,[-z,-pt]);function Lo(n){var t=NaN,e=NaN,i=NaN,s;return{lineStart:function(){n.lineStart(),s=1},point:function(r,o){var a=r>0?z:-z,l=W(r-t);W(l-z)<q?(n.point(t,e=(e+o)/2>0?pt:-pt),n.point(i,e),n.lineEnd(),n.lineStart(),n.point(a,e),n.point(r,e),s=0):i!==a&&l>=z&&(W(t-i)<q&&(t-=i*q),W(r-a)<q&&(r-=a*q),e=No(t,e,r,o),n.point(i,e),n.lineEnd(),n.lineStart(),n.point(a,e),s=0),n.point(t=r,e=o),i=a},lineEnd:function(){n.lineEnd(),t=e=NaN},clean:function(){return 2-s}}}function No(n,t,e,i){var s,r,o=K(n-e);return W(o)>q?So((K(t)*(r=J(i))*K(e)-K(i)*(s=J(t))*K(n))/(s*r*o)):(t+i)/2}function $o(n,t,e,i){var s;if(n==null)s=e*pt,i.point(-z,s),i.point(0,s),i.point(z,s),i.point(z,0),i.point(z,-s),i.point(0,-s),i.point(-z,-s),i.point(-z,0),i.point(-z,s);else if(W(n[0]-t[0])>q){var r=n[0]<t[0]?z:-z;s=e*r/2,i.point(-r,s),i.point(0,s),i.point(r,s)}else i.point(t[0],t[1])}function Bo(n){var t=J(n),e=2*lt,i=t>0,s=W(t)>q;function r(c,u,h,p){Co(p,n,e,h,c,u)}function o(c,u){return J(c)*J(u)>t}function a(c){var u,h,p,f,b;return{lineStart:function(){f=p=!1,b=1},point:function(_,E){var w=[_,E],v,y=o(_,E),k=i?y?0:d(_,E):y?d(_+(_<0?z:-z),E):0;if(!u&&(f=p=y)&&c.lineStart(),y!==p&&(v=l(u,w),(!v||De(u,v)||De(w,v))&&(w[2]=1)),y!==p)b=0,y?(c.lineStart(),v=l(w,u),c.point(v[0],v[1])):(v=l(u,w),c.point(v[0],v[1],2),c.lineEnd()),u=v;else if(s&&u&&i^y){var R;!(k&h)&&(R=l(w,u,!0))&&(b=0,i?(c.lineStart(),c.point(R[0][0],R[0][1]),c.point(R[1][0],R[1][1]),c.lineEnd()):(c.point(R[1][0],R[1][1]),c.lineEnd(),c.lineStart(),c.point(R[0][0],R[0][1],3)))}y&&(!u||!De(u,w))&&c.point(w[0],w[1]),u=w,p=y,h=k},lineEnd:function(){p&&c.lineEnd(),u=null},clean:function(){return b|(f&&p)<<1}}}function l(c,u,h){var p=te(c),f=te(u),b=[1,0,0],_=je(p,f),E=Ae(_,_),w=_[0],v=E-w*w;if(!v)return!h&&c;var y=t*E/v,k=-t*w/v,R=je(b,_),D=Ce(b,y),O=Ce(_,k);un(D,O);var S=R,C=Ae(D,S),x=Ae(S,S),I=C*C-x*(Ae(D,D)-1);if(!(I<0)){var N=qt(I),M=Ce(S,(-C-N)/x);if(un(M,D),M=Sn(M),!h)return M;var m=c[0],L=u[0],H=c[1],X=u[1],tt;L<m&&(tt=m,m=L,L=tt);var ht=L-m,yt=W(ht-z)<q,F=yt||ht<q;if(!yt&&X<H&&(tt=H,H=X,X=tt),F?yt?H+X>0^M[1]<(W(M[0]-m)<q?H:X):H<=M[1]&&M[1]<=X:ht>z^(m<=M[0]&&M[0]<=L)){var et=Ce(S,(-C+N)/x);return un(et,D),[M,Sn(et)]}}}function d(c,u){var h=i?n:z-n,p=0;return c<-h?p|=1:c>h&&(p|=2),u<-h?p|=4:u>h&&(p|=8),p}return ks(o,a,r,i?[0,-n]:[-z,n-z])}function Po(n,t,e,i,s,r){var o=n[0],a=n[1],l=t[0],d=t[1],c=0,u=1,h=l-o,p=d-a,f;if(f=e-o,!(!h&&f>0)){if(f/=h,h<0){if(f<c)return;f<u&&(u=f)}else if(h>0){if(f>u)return;f>c&&(c=f)}if(f=s-o,!(!h&&f<0)){if(f/=h,h<0){if(f>u)return;f>c&&(c=f)}else if(h>0){if(f<c)return;f<u&&(u=f)}if(f=i-a,!(!p&&f>0)){if(f/=p,p<0){if(f<c)return;f<u&&(u=f)}else if(p>0){if(f>u)return;f>c&&(c=f)}if(f=r-a,!(!p&&f<0)){if(f/=p,p<0){if(f>u)return;f>c&&(c=f)}else if(p>0){if(f<c)return;f<u&&(u=f)}return c>0&&(n[0]=o+c*h,n[1]=a+c*p),u<1&&(t[0]=o+u*h,t[1]=a+u*p),!0}}}}}var le=1e9,Oe=-le;function Do(n,t,e,i){function s(d,c){return n<=d&&d<=e&&t<=c&&c<=i}function r(d,c,u,h){var p=0,f=0;if(d==null||(p=o(d,u))!==(f=o(c,u))||l(d,c)<0^u>0)do h.point(p===0||p===3?n:e,p>1?i:t);while((p=(p+u+4)%4)!==f);else h.point(c[0],c[1])}function o(d,c){return W(d[0]-n)<q?c>0?0:3:W(d[0]-e)<q?c>0?2:1:W(d[1]-t)<q?c>0?1:0:c>0?3:2}function a(d,c){return l(d.x,c.x)}function l(d,c){var u=o(d,1),h=o(c,1);return u!==h?u-h:u===0?c[1]-d[1]:u===1?d[0]-c[0]:u===2?d[1]-c[1]:c[0]-d[0]}return function(d){var c=d,u=bs(),h,p,f,b,_,E,w,v,y,k,R,D={point:O,lineStart:I,lineEnd:N,polygonStart:C,polygonEnd:x};function O(m,L){s(m,L)&&c.point(m,L)}function S(){for(var m=0,L=0,H=p.length;L<H;++L)for(var X=p[L],tt=1,ht=X.length,yt=X[0],F,et,nt=yt[0],Ot=yt[1];tt<ht;++tt)F=nt,et=Ot,yt=X[tt],nt=yt[0],Ot=yt[1],et<=i?Ot>i&&(nt-F)*(i-et)>(Ot-et)*(n-F)&&++m:Ot<=i&&(nt-F)*(i-et)<(Ot-et)*(n-F)&&--m;return m}function C(){c=u,h=[],p=[],R=!0}function x(){var m=S(),L=R&&m,H=(h=ws(h)).length;(L||H)&&(d.polygonStart(),L&&(d.lineStart(),r(null,null,1,d),d.lineEnd()),H&&Es(h,a,m,r,d),d.polygonEnd()),c=d,h=p=f=null}function I(){D.point=M,p&&p.push(f=[]),k=!0,y=!1,w=v=NaN}function N(){h&&(M(b,_),E&&y&&u.rejoin(),h.push(u.result())),D.point=O,y&&c.lineEnd()}function M(m,L){var H=s(m,L);if(p&&f.push([m,L]),k)b=m,_=L,E=H,k=!1,H&&(c.lineStart(),c.point(m,L));else if(H&&y)c.point(m,L);else{var X=[w=Math.max(Oe,Math.min(le,w)),v=Math.max(Oe,Math.min(le,v))],tt=[m=Math.max(Oe,Math.min(le,m)),L=Math.max(Oe,Math.min(le,L))];Po(X,tt,n,t,e,i)?(y||(c.lineStart(),c.point(X[0],X[1])),c.point(tt[0],tt[1]),H||c.lineEnd(),R=!1):H&&(c.lineStart(),c.point(m,L),R=!1)}w=m,v=L,y=H}return D}}function Mi(n,t,e){var i=Kt(n,t-q,e).concat(t);return function(s){return i.map(function(r){return[s,r]})}}function Li(n,t,e){var i=Kt(n,t-q,e).concat(t);return function(s){return i.map(function(r){return[r,s]})}}function Io(){var n,t,e,i,s,r,o,a,l=10,d=l,c=90,u=360,h,p,f,b,_=2.5;function E(){return{type:"MultiLineString",coordinates:w()}}function w(){return Kt(Te(i/c)*c,e,c).map(f).concat(Kt(Te(a/u)*u,o,u).map(b)).concat(Kt(Te(t/l)*l,n,l).filter(function(v){return W(v%c)>q}).map(h)).concat(Kt(Te(r/d)*d,s,d).filter(function(v){return W(v%u)>q}).map(p))}return E.lines=function(){return w().map(function(v){return{type:"LineString",coordinates:v}})},E.outline=function(){return{type:"Polygon",coordinates:[f(i).concat(b(o).slice(1),f(e).reverse().slice(1),b(a).reverse().slice(1))]}},E.extent=function(v){return arguments.length?E.extentMajor(v).extentMinor(v):E.extentMinor()},E.extentMajor=function(v){return arguments.length?(i=+v[0][0],e=+v[1][0],a=+v[0][1],o=+v[1][1],i>e&&(v=i,i=e,e=v),a>o&&(v=a,a=o,o=v),E.precision(_)):[[i,a],[e,o]]},E.extentMinor=function(v){return arguments.length?(t=+v[0][0],n=+v[1][0],r=+v[0][1],s=+v[1][1],t>n&&(v=t,t=n,n=v),r>s&&(v=r,r=s,s=v),E.precision(_)):[[t,r],[n,s]]},E.step=function(v){return arguments.length?E.stepMajor(v).stepMinor(v):E.stepMinor()},E.stepMajor=function(v){return arguments.length?(c=+v[0],u=+v[1],E):[c,u]},E.stepMinor=function(v){return arguments.length?(l=+v[0],d=+v[1],E):[l,d]},E.precision=function(v){return arguments.length?(_=+v,h=Mi(r,s,90),p=Li(t,n,_),f=Mi(a,o,90),b=Li(i,e,_),E):_},E.extentMajor([[-180,-90+q],[180,90-q]]).extentMinor([[-180,-80-q],[180,80+q]])}const Cn=n=>n;var fn=new zt,Rn=new zt,Ss,xs,On,Mn,$t={point:vt,lineStart:vt,lineEnd:vt,polygonStart:function(){$t.lineStart=Vo,$t.lineEnd=jo},polygonEnd:function(){$t.lineStart=$t.lineEnd=$t.point=vt,fn.add(W(Rn)),Rn=new zt},result:function(){var n=fn/2;return fn=new zt,n}};function Vo(){$t.point=qo}function qo(n,t){$t.point=Ts,Ss=On=n,xs=Mn=t}function Ts(n,t){Rn.add(Mn*n-On*t),On=n,Mn=t}function jo(){Ts(Ss,xs)}var ee=1/0,Fe=ee,me=-ee,ze=me,Ue={point:Fo,lineStart:vt,lineEnd:vt,polygonStart:vt,polygonEnd:vt,result:function(){var n=[[ee,Fe],[me,ze]];return me=ze=-(Fe=ee=1/0),n}};function Fo(n,t){n<ee&&(ee=n),n>me&&(me=n),t<Fe&&(Fe=t),t>ze&&(ze=t)}var Ln=0,Nn=0,ue=0,Ye=0,He=0,Jt=0,$n=0,Bn=0,he=0,As,Cs,St,xt,dt={point:Yt,lineStart:Ni,lineEnd:$i,polygonStart:function(){dt.lineStart=Yo,dt.lineEnd=Ho},polygonEnd:function(){dt.point=Yt,dt.lineStart=Ni,dt.lineEnd=$i},result:function(){var n=he?[$n/he,Bn/he]:Jt?[Ye/Jt,He/Jt]:ue?[Ln/ue,Nn/ue]:[NaN,NaN];return Ln=Nn=ue=Ye=He=Jt=$n=Bn=he=0,n}};function Yt(n,t){Ln+=n,Nn+=t,++ue}function Ni(){dt.point=zo}function zo(n,t){dt.point=Uo,Yt(St=n,xt=t)}function Uo(n,t){var e=n-St,i=t-xt,s=qt(e*e+i*i);Ye+=s*(St+n)/2,He+=s*(xt+t)/2,Jt+=s,Yt(St=n,xt=t)}function $i(){dt.point=Yt}function Yo(){dt.point=Xo}function Ho(){Rs(As,Cs)}function Xo(n,t){dt.point=Rs,Yt(As=St=n,Cs=xt=t)}function Rs(n,t){var e=n-St,i=t-xt,s=qt(e*e+i*i);Ye+=s*(St+n)/2,He+=s*(xt+t)/2,Jt+=s,s=xt*n-St*t,$n+=s*(St+n),Bn+=s*(xt+t),he+=s*3,Yt(St=n,xt=t)}function Os(n){this._context=n}Os.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:{this._context.moveTo(n,t),this._point=1;break}case 1:{this._context.lineTo(n,t);break}default:{this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,gt);break}}},result:vt};var Pn=new zt,dn,Ms,Ls,fe,de,_e={point:vt,lineStart:function(){_e.point=Wo},lineEnd:function(){dn&&Ns(Ms,Ls),_e.point=vt},polygonStart:function(){dn=!0},polygonEnd:function(){dn=null},result:function(){var n=+Pn;return Pn=new zt,n}};function Wo(n,t){_e.point=Ns,Ms=fe=n,Ls=de=t}function Ns(n,t){fe-=n,de-=t,Pn.add(qt(fe*fe+de*de)),fe=n,de=t}let Bi,Xe,Pi,Di;class Ii{constructor(t){this._append=t==null?$s:Ko(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:{this._append`M${t},${e}`,this._point=1;break}case 1:{this._append`L${t},${e}`;break}default:{if(this._append`M${t},${e}`,this._radius!==Pi||this._append!==Xe){const i=this._radius,s=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,Pi=i,Xe=this._append,Di=this._,this._=s}this._+=Di;break}}}result(){const t=this._;return this._="",t.length?t:null}}function $s(n){let t=1;this._+=n[0];for(const e=n.length;t<e;++t)this._+=arguments[t]+n[t]}function Ko(n){const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);if(t>15)return $s;if(t!==Bi){const e=10**t;Bi=t,Xe=function(s){let r=1;this._+=s[0];for(const o=s.length;r<o;++r)this._+=Math.round(arguments[r]*e)/e+s[r]}}return Xe}function Jo(n,t){let e=3,i=4.5,s,r;function o(a){return a&&(typeof i=="function"&&r.pointRadius(+i.apply(this,arguments)),Ht(a,s(r))),r.result()}return o.area=function(a){return Ht(a,s($t)),$t.result()},o.measure=function(a){return Ht(a,s(_e)),_e.result()},o.bounds=function(a){return Ht(a,s(Ue)),Ue.result()},o.centroid=function(a){return Ht(a,s(dt)),dt.result()},o.projection=function(a){return arguments.length?(s=a==null?(n=null,Cn):(n=a).stream,o):n},o.context=function(a){return arguments.length?(r=a==null?(t=null,new Ii(e)):new Os(t=a),typeof i!="function"&&r.pointRadius(i),o):t},o.pointRadius=function(a){return arguments.length?(i=typeof a=="function"?a:(r.pointRadius(+a),+a),o):i},o.digits=function(a){if(!arguments.length)return e;if(a==null)e=null;else{const l=Math.floor(a);if(!(l>=0))throw new RangeError(`invalid digits: ${a}`);e=l}return t===null&&(r=new Ii(e)),o},o.projection(n).digits(e).context(t)}function Zn(n){return function(t){var e=new Dn;for(var i in n)e[i]=n[i];return e.stream=t,e}}function Dn(){}Dn.prototype={constructor:Dn,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Qn(n,t,e){var i=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),i!=null&&n.clipExtent(null),Ht(e,n.stream(Ue)),t(Ue.result()),i!=null&&n.clipExtent(i),n}function Bs(n,t,e){return Qn(n,function(i){var s=t[1][0]-t[0][0],r=t[1][1]-t[0][1],o=Math.min(s/(i[1][0]-i[0][0]),r/(i[1][1]-i[0][1])),a=+t[0][0]+(s-o*(i[1][0]+i[0][0]))/2,l=+t[0][1]+(r-o*(i[1][1]+i[0][1]))/2;n.scale(150*o).translate([a,l])},e)}function Zo(n,t,e){return Bs(n,[[0,0],t],e)}function Qo(n,t,e){return Qn(n,function(i){var s=+t,r=s/(i[1][0]-i[0][0]),o=(s-r*(i[1][0]+i[0][0]))/2,a=-r*i[0][1];n.scale(150*r).translate([o,a])},e)}function Go(n,t,e){return Qn(n,function(i){var s=+t,r=s/(i[1][1]-i[0][1]),o=-r*i[0][0],a=(s-r*(i[1][1]+i[0][1]))/2;n.scale(150*r).translate([o,a])},e)}var Vi=16,ta=J(30*lt);function qi(n,t){return+t?na(n,t):ea(n)}function ea(n){return Zn({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}})}function na(n,t){function e(i,s,r,o,a,l,d,c,u,h,p,f,b,_){var E=d-i,w=c-s,v=E*E+w*w;if(v>4*t&&b--){var y=o+h,k=a+p,R=l+f,D=qt(y*y+k*k+R*R),O=Ut(R/=D),S=W(W(R)-1)<q||W(r-u)<q?(r+u)/2:Gt(k,y),C=n(S,O),x=C[0],I=C[1],N=x-i,M=I-s,m=w*N-E*M;(m*m/v>t||W((E*N+w*M)/v-.5)>.3||o*h+a*p+l*f<ta)&&(e(i,s,r,o,a,l,x,I,S,y/=D,k/=D,R,b,_),_.point(x,I),e(x,I,S,y,k,R,d,c,u,h,p,f,b,_))}}return function(i){var s,r,o,a,l,d,c,u,h,p,f,b,_={point:E,lineStart:w,lineEnd:y,polygonStart:function(){i.polygonStart(),_.lineStart=k},polygonEnd:function(){i.polygonEnd(),_.lineStart=w}};function E(O,S){O=n(O,S),i.point(O[0],O[1])}function w(){u=NaN,_.point=v,i.lineStart()}function v(O,S){var C=te([O,S]),x=n(O,S);e(u,h,c,p,f,b,u=x[0],h=x[1],c=O,p=C[0],f=C[1],b=C[2],Vi,i),i.point(u,h)}function y(){_.point=E,i.lineEnd()}function k(){w(),_.point=R,_.lineEnd=D}function R(O,S){v(s=O,S),r=u,o=h,a=p,l=f,d=b,_.point=v}function D(){e(u,h,c,p,f,b,r,o,s,a,l,d,Vi,i),_.lineEnd=y,y()}return _}}var ia=Zn({point:function(n,t){this.stream.point(n*lt,t*lt)}});function sa(n){return Zn({point:function(t,e){var i=n(t,e);return this.stream.point(i[0],i[1])}})}function ra(n,t,e,i,s){function r(o,a){return o*=i,a*=s,[t+n*o,e-n*a]}return r.invert=function(o,a){return[(o-t)/n*i,(e-a)/n*s]},r}function ji(n,t,e,i,s,r){if(!r)return ra(n,t,e,i,s);var o=J(r),a=K(r),l=o*n,d=a*n,c=o/n,u=a/n,h=(a*e-o*t)/n,p=(a*t+o*e)/n;function f(b,_){return b*=i,_*=s,[l*b-d*_+t,e-d*b-l*_]}return f.invert=function(b,_){return[i*(c*b-u*_+h),s*(p-u*b-c*_)]},f}function oa(n){return aa(function(){return n})()}function aa(n){var t,e=150,i=480,s=250,r=0,o=0,a=0,l=0,d=0,c,u=0,h=1,p=1,f=null,b=Oi,_=null,E,w,v,y=Cn,k=.5,R,D,O,S,C;function x(m){return O(m[0]*lt,m[1]*lt)}function I(m){return m=O.invert(m[0],m[1]),m&&[m[0]*Lt,m[1]*Lt]}x.stream=function(m){return S&&C===m?S:S=ia(sa(c)(b(R(y(C=m)))))},x.preclip=function(m){return arguments.length?(b=m,f=void 0,M()):b},x.postclip=function(m){return arguments.length?(y=m,_=E=w=v=null,M()):y},x.clipAngle=function(m){return arguments.length?(b=+m?Bo(f=m*lt):(f=null,Oi),M()):f*Lt},x.clipExtent=function(m){return arguments.length?(y=m==null?(_=E=w=v=null,Cn):Do(_=+m[0][0],E=+m[0][1],w=+m[1][0],v=+m[1][1]),M()):_==null?null:[[_,E],[w,v]]},x.scale=function(m){return arguments.length?(e=+m,N()):e},x.translate=function(m){return arguments.length?(i=+m[0],s=+m[1],N()):[i,s]},x.center=function(m){return arguments.length?(r=m[0]%360*lt,o=m[1]%360*lt,N()):[r*Lt,o*Lt]},x.rotate=function(m){return arguments.length?(a=m[0]%360*lt,l=m[1]%360*lt,d=m.length>2?m[2]%360*lt:0,N()):[a*Lt,l*Lt,d*Lt]},x.angle=function(m){return arguments.length?(u=m%360*lt,N()):u*Lt},x.reflectX=function(m){return arguments.length?(h=m?-1:1,N()):h<0},x.reflectY=function(m){return arguments.length?(p=m?-1:1,N()):p<0},x.precision=function(m){return arguments.length?(R=qi(D,k=m*m),M()):qt(k)},x.fitExtent=function(m,L){return Bs(x,m,L)},x.fitSize=function(m,L){return Zo(x,m,L)},x.fitWidth=function(m,L){return Qo(x,m,L)},x.fitHeight=function(m,L){return Go(x,m,L)};function N(){var m=ji(e,0,0,h,p,u).apply(null,t(r,o)),L=ji(e,i-m[0],s-m[1],h,p,u);return c=Ao(a,l,d),D=Tn(t,L),O=Tn(c,D),R=qi(D,k),M()}function M(){return S=C=null,x}return function(){return t=n.apply(this,arguments),x.invert=t.invert&&I,N()}}function ca(n){return function(t,e){var i=qt(t*t+e*e),s=n(i),r=K(s),o=J(s);return[Gt(t*r,i*o),Ut(i&&e*r/i)]}}function Ps(n,t){return[J(t)*K(n),K(t)]}Ps.invert=ca(Ut);function la(){return oa(Ps).scale(249.5).clipAngle(90+q)}var ua=we('<path fill="none" class="graticule svelte-1yv80ee" stroke-width="0.3"></path>');function Fi(n,t){st(t,!0);let e=U(0),i=U(0);const s=ne.subscribe(h=>{P(e,Q(h.deg_x)),P(i,Q(h.deg_y))});mt(()=>{s&&s()});const r=Nt(t,"scale",3,2e3),o=Nt(t,"steps",3,5),a=Nt(t,"clipAngle",3,15),l=Io().stepMajor([45,45]).stepMinor([o(),o()]);let d=Vt(()=>la().scale(r()).rotate([-g(e),-g(i)]).translate([1080/2,810/2]).clipAngle(a())),c=Vt(()=>Jo().projection(g(d)));var u=ua();it(()=>Y(u,"d",g(c)(l()))),B(n,u),rt()}function In(n){return typeof n=="string"?n.toLowerCase().trim().replaceAll("ä","ae").replaceAll("ö","oe").replaceAll("ü","ue").replaceAll("ß","ss").replace(/\W+/g,"_").replace(/^_|_$/g,""):null}const zi={fid:"",geo:{addr:"",lat:53.6,lon:9.9},base:[{id:"home",name:"Primary target",pos:{x:-23900,y:0,f:500}},{id:"polaris",name:"Polaris",pos:{x:0,y:11912,f:600}}]};function ha(n,t){const e={...zi.geo,addr:t},i=[];for(let s of zi.base)i.push({...s,pos:{...s.pos}});return{fid:n,geo:e,base:i}}function Ui(n){return Math.PI*n/180}function Vn(n){return n*180/Math.PI}function fa(n){const t=Je(ne).spr;let e=Math.round(t*n/360);return Math.abs(e)>t/2&&(e=e>0?e-t:e+t),e}function Yi(n){const t=Vn(n);return fa(t)}var da=(n,t)=>t("A",n),pa=(n,t)=>t("B",n),va=j('<div id="camera-stream" class="svelte-zqlhxu"><button id="telescope-stream"><svg class="svg-img svelte-zqlhxu" preserveAspectRatio="xMidYMid slice"><foreignObject class="img-wrap svelte-zqlhxu" x="0" y="0"><img alt="Telescope" class="svg-img svelte-zqlhxu"></foreignObject><!></svg></button> <button id="viewfinder-stream"><svg class="svg-img svelte-zqlhxu" preserveAspectRatio="xMidYMid slice"><foreignObject class="img-wrap svelte-zqlhxu" x="0" y="0"><img alt="Viewfinder" class="svg-img svelte-zqlhxu"></foreignObject><g><circle r="0.0001" fill="none" stroke="none"></circle><rect class="crosshair svelte-zqlhxu"></rect><!></g></svg></button></div>');function ga(n,t){st(t,!0);const e=Rt(),i=()=>ut(Sr,"$locHost",e),s=()=>ut(Ne,"$swapPreview",e),r=()=>ut(Ie,"$displayCompass",e);let o=U(0),a=U(0);const l=1080,d=810;let c=U(void 0);const u=()=>{const F=g(c).getBoundingClientRect();return{x:g(h)==="B"?F.x:g(o)/2,y:g(h)==="B"?F.y:g(a)/2}};let h=U(void 0);const p=Ne.subscribe(F=>{P(h,Q(F))});let f=U(0),b=U(0);const _=ne.subscribe(F=>{P(f,Q(F.deg_x)),P(b,Q(F.deg_y))}),E=(F,et)=>{if(g(h)!==F)Ne.update(nt=>F);else{const nt=u(),Ot=Math.max(g(o)/l,g(a)/d),se={x:Math.round((et.clientX-nt.x)/Ot),y:-1*Math.round((et.clientY-nt.y)/Ot)},Is=g(h)==="B"?w.SphereScaleVF:w.SphereScaleTel,Ee=Ui(g(b)),Vs=Ui(g(f)),tn=Math.sqrt(Math.pow(se.x,2)+Math.pow(se.y,2)),re=Math.asin(tn/Is),qs=Math.asin(Math.cos(re)*Math.sin(Ee)+se.y*Math.sin(re)*Math.cos(Ee)/tn),js=Vs+Math.atan(se.x*Math.sin(re)/(tn*Math.cos(re)*Math.cos(Ee)-se.y*Math.sin(re)*Math.sin(Ee)));at(`/goto/${Yi(js)}/${Yi(qs)}`,Fs=>{console.log("GoTo cmd",Fs)})}};let w=Q({CrosshairSize:.4,CrosshairOffsetX:0,CrosshairOffsetY:0,SphereScaleVF:1500,SphereScaleTel:24e3}),v=ve.subscribe(F=>{for(let et of F)w[et.id]=et.value}),y=U("starfield-zoom.jpg"),k=U("starfield.jpg"),R=Vt(()=>Math.ceil(Vn(Math.asin(l/w.SphereScaleVF)))),D=Vt(()=>Math.ceil(Vn(Math.asin(l/w.SphereScaleTel))));be(()=>{P(y,`${i()}:7777/stream_a.mjpg`),P(k,`${i()}:7777/stream_b.mjpg`),at("/config/sphere/settings",F=>{console.log("MOUNT",F),ve.update(et=>et.map(nt=>nt!=null&&nt.id&&Object.hasOwn(F,nt.id)?{...nt,value:F[nt.id]}:{...nt}))})}),mt(()=>{p&&p(),v&&v(),_&&_()});var O=va(),S=A(O);S.__click=[da,E];var C=A(S);Y(C,"viewBox",`0 0 ${l} ${d}`);var x=A(C);Y(x,"width",l),Y(x,"height",d);var I=A(x);T(x);var N=$(x);Z(N,r,F=>{Fi(F,{get scale(){return w.SphereScaleTel},steps:"0.2",get clipAngle(){return g(D)},get width(){return g(o)},get height(){return g(a)}})}),T(C),T(S);var M=$(S,2);M.__click=[pa,E];var m=A(M);Y(m,"viewBox",`0 0 ${l} ${d}`);var L=A(m);Y(L,"width",l),Y(L,"height",d);var H=A(L);T(L);var X=$(L),tt=A(X);Y(tt,"cx",l/2),Y(tt,"cy",d/2),pr(tt,F=>P(c,F),()=>g(c));var ht=$(tt);Y(ht,"x",l/2),Y(ht,"y",d/2);var yt=$(ht);Z(yt,r,F=>{Fi(F,{get scale(){return w.SphereScaleVF},steps:"5",get clipAngle(){return g(R)},get width(){return g(o)},get height(){return g(a)}})}),T(X),T(m),T(M),T(O),it(()=>{At(S,`stream-wrapper ${(s()==="A"?"large":"")??""} svelte-zqlhxu`),Y(C,"width",g(o)),Y(C,"height",g(a)),Y(I,"src",g(y)),At(M,`stream-wrapper ${(s()==="B"?"large":"")??""} svelte-zqlhxu`),Y(m,"width",g(o)),Y(m,"height",g(a)),Y(H,"src",g(k)),Y(X,"transform",`translate(${l/4*w.CrosshairOffsetX} ${d/4*w.CrosshairOffsetY})`),Y(ht,"transform",`translate(${g(o)*w.CrosshairSize*-.5} ${g(a)*w.CrosshairSize*-.5})`),Y(ht,"width",g(o)*w.CrosshairSize),Y(ht,"height",g(a)*w.CrosshairSize)}),vi(O,"clientWidth",F=>P(o,F)),vi(O,"clientHeight",F=>P(a,F)),B(n,O),rt()}ct(["click"]);var ma=j('<div class="layer svelte-qmdbdl"><!></div>'),_a=j('<div class="visuals svelte-qmdbdl"><!> <!></div>');function ya(n){const t=Rt(),e=()=>ut(Ie,"$displayCompass",t);var i=_a(),s=A(i);ga(s,{});var r=$(s,2);Z(r,e,o=>{var a=ma(),l=A(a);Tr(l,{}),T(a),B(o,a)}),T(i),B(n,i)}class wa{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=200,this.deadZone=8,this.active=!1,this.value={x:0,y:0},this.counter=0,this.prev={x:0,y:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",i=>{this._handleDown(i)}),this.stick.addEventListener("touchstart",i=>{this._handleDown(i)}),document.addEventListener("mousemove",i=>{this._handleMove(i)},{passive:!1}),document.addEventListener("touchmove",i=>{this._handleMove(i)},{passive:!1}),document.addEventListener("mouseup",i=>{this._handleUp(i)}),document.addEventListener("touchend",i=>{this._handleUp(i)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.clientX,y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;let e=null;if(t.changedTouches){for(let _=0;_<t.changedTouches.length;_++)this.touchId===t.changedTouches[_].identifier&&(e=_,t.clientX=t.changedTouches[_].clientX,t.clientY=t.changedTouches[_].clientY);if(e==null)return}const i=this.stick.getBoundingClientRect(),s=i?Math.round(16e3/i.width)/100:1,r=t.clientX-this.dragStart.x,o=t.clientY-this.dragStart.y,a=Math.atan2(o,r),l=Math.min(this.maxDistance,Math.hypot(r,o)*s),d=l*Math.cos(a),c=l*Math.sin(a);this.stick.style.transform=`translate(${d}px, ${c}px)`;const u=l<this.deadZone?0:this.maxDistance/(this.maxDistance-this.deadZone)*(l-this.deadZone),h=u*Math.cos(a),p=u*Math.sin(a),f=parseFloat((h/this.maxDistance).toFixed(4)),b=parseFloat((p/this.maxDistance).toFixed(4));this.value={x:f,y:b},this._loop()}_handleUp(t){this.active&&(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier||(this.stick.style.transition=".2s",this.stick.style.transform="translate3d(0px, 0px, 0px)",this.value={x:0,y:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5+this.value.x*511.5),e=Math.round(511.5+this.value.y*511.5);this.callback(`/joystick/${t}/${e}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){(this.value.x!==this.prev.x||this.value.y!==this.prev.y)&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}class ba{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=230,this.deadZone=8,this.active=!1,this.value={f:0},this.counter=0,this.prev={f:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",i=>{this._handleDown(i)}),this.stick.addEventListener("touchstart",i=>{this._handleDown(i)}),document.addEventListener("mousemove",i=>{this._handleMove(i)},{passive:!1}),document.addEventListener("touchmove",i=>{this._handleMove(i)},{passive:!1}),document.addEventListener("mouseup",i=>{this._handleUp(i)}),document.addEventListener("touchend",i=>{this._handleUp(i)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{y:t.changedTouches[0].clientY}:{y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;t.preventDefault();let e=null;if(t.changedTouches){for(let l=0;l<t.changedTouches.length;l++)this.touchId===t.changedTouches[l].identifier&&(e=l,t.clientY=t.changedTouches[l].clientY);if(e==null)return}const i=this.stick.getBoundingClientRect(),s=i?Math.round(1e4/i.width)/100:1,r=t.clientY-this.dragStart.y,o=r>=0?Math.min(this.maxDistance,r*s):Math.max(-this.maxDistance,r*s);this.stick.style.transform=`translateY(${o}px)`;const a=Math.abs(o)>this.deadZone?parseFloat((o/this.maxDistance).toFixed(4)):0;this.value={f:a},this._loop()}_handleUp(t){this.active&&(t.preventDefault(),!(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier)&&(this.stick.style.transition=".2s",this.stick.style.transform="translateY(0px)",this.value={f:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5-this.value.f*511.5);this.callback(`/focus/${t}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){this.value.f!==this.prev.f&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}var Ea=we('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-1jgdvgh"><defs><circle id="joys-def-cir2" r="80" cy="0"></circle><path id="joys-def-arrow" d="M0 -120 -40 -100 40 -100z"></path><rect id="joys-def-slide" width="100" height="100" transform="translate(335 -50)" rx="15" ry="15"></rect></defs><g id="joys" transform="translate(320 355)" class="svelte-1jgdvgh"><use id="joys-arrow-top" href="#joys-def-arrow" class="svelte-1jgdvgh"></use><use id="joys-arrow-right" href="#joys-def-arrow" transform="rotate(90)" class="svelte-1jgdvgh"></use><use id="joys-arrow-left" href="#joys-def-arrow" transform="rotate(-90)" class="svelte-1jgdvgh"></use><use id="joys-arrow-bottom" href="#joys-def-arrow" transform="rotate(180)" class="svelte-1jgdvgh"></use><use id="joys-stick" href="#joys-def-cir2" style="transform: translate(0px, 0px)" class="svelte-1jgdvgh"></use><use id="joys-arrow-top" href="#joys-def-arrow" transform="translate(385 30)" class="svelte-1jgdvgh"></use><use id="joys-arrow-top" href="#joys-def-arrow" transform="translate(385 -30) rotate(180)" class="svelte-1jgdvgh"></use><use id="joys-slide" href="#joys-def-slide" style="transform: translateY(0px)" class="svelte-1jgdvgh"></use><a href="#toggle" role="button" tabindex="0" aria-label="Change to adjustment tool"><g id="joys-swap" transform="translate(-250,250)" class="svelte-1jgdvgh"><circle class="element svelte-1jgdvgh" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M6.121 13c-.553 0-1 .448-1 1s.447 1 1 1h1.465l-3.293 3.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.414-3.414v1.707c0 .552.447 1 1 1s.879-.448.879-1v-5h-4.879zM7 11c.552 0 1-.448 1-1v-2h2c.553 0 1-.448 1-1s-.447-1-1-1h-3.999l-.001 4c0 .552.447 1 1 1zM17 13c-.553 0-1 .448-1 1v2h-2c-.553 0-1 .448-1 1s.447 1 1 1h4v-4c0-.552-.447-1-1-1zM18.293 4.293l-3.293 3.293v-1.586c0-.552-.447-1-1-1s-1 .448-1 1v5h5c.552 0 1-.448 1-1s-.447-1-1-1h-1.586l3.293-3.292c.391-.391.391-1.023 0-1.414s-1.023-.392-1.414-.001z" class="svelte-1jgdvgh"></path></g></g></a></g></svg>');function ka(n,t){st(t,!0);let e=null,i=null;be(()=>{e=new wa(document.getElementById("joys-stick"),a=>{at(a,l=>{console.log("SVELTE Joystick",l)})}),i=new ba(document.getElementById("joys-slide"),a=>{at(a,l=>{console.log("SVELTE Focus",l)})})}),mt(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy(),i&&i.hasOwnProperty("destroy")&&i.destroy()});var s=Ea(),r=$(A(s)),o=$(A(r),8);o.__click=function(...a){var l;(l=t.toggle)==null||l.apply(this,a)},T(r),T(s),B(n,s),rt()}ct(["click"]);class Sa{constructor(t,e){if(this.adjust=t,this.adjust){this.callback=e;const i=8e4/360;this.axisSteps={lg:Math.round(i),md:Math.round(i/10),sm:Math.round(i/100)},this.adjust.addEventListener("mouseup",s=>{this.sendCommand(s.target.dataset)})}}destroy(){this.adjust.removeEventListener("mouseup",t=>{this.sendCommand(t.target.dataset)})}sendCommand(t){let e=t==null?void 0:t.dir,i=t==null?void 0:t.len;e&&i&&typeof this.axisSteps[i]=="number"&&(i=this.axisSteps[i],["closer","further"].indexOf(e)>=0&&(i=e==="closer"?-i:i,e="focus"),this.callback(`/adjust/${e}/${i}`))}}var xa=we('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-cf79tv"><defs><path id="arr1" d="M0 -80 40 -60 40 0 0 -20 -40 0 -40 -60z"></path><path id="arr2" d="M95 95 70 95 70 165 165 165 165 70 95 70z"></path><path id="arr3" d="M165 165 130 165 130 245 245 245 245 130 165 130z"></path><circle id="cir1" r="40" cy="30"></circle><circle id="cir2" r="50" cy="120"></circle><circle id="cir3" r="60" cy="230"></circle><path id="cir3" d="M-85 125 A 108 108 0 1 0 85 125 A 54 54 0 0 1 -85 125z"></path></defs><g id="adjust" transform="translate(355 355)" class="svelte-cf79tv"><g transform="rotate(0)"><use href="#arr1" transform="translate(0 -50)" data-dir="up" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="up" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="up" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(90)"><use href="#arr1" transform="translate(0 -50)" data-dir="right" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="right" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="right" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(180)"><use href="#arr1" transform="translate(0 -50)" data-dir="down" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="down" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="down" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(270)"><use href="#arr1" transform="translate(0 -50)" data-dir="left" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="left" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="left" data-len="lg" class="svelte-cf79tv"></use></g><g transform="translate(360 0)"><use href="#arr1" transform="translate(0 -50)" data-dir="further" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="further" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="further" data-len="lg" class="svelte-cf79tv"></use></g><g transform="translate(360 0) rotate(180)"><use href="#arr1" transform="translate(0 -50)" data-dir="closer" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="closer" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="closer" data-len="lg" class="svelte-cf79tv"></use></g><a href="#toggle" role="button" tabindex="0" aria-label="Change to Joystick"><g id="joys-swap" transform="translate(-285,250)" class="svelte-cf79tv"><circle class="element svelte-cf79tv" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M17.707 8.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l1.293 1.293h-4.586v-4.586l1.293 1.293c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-3.707-3.707-3.707 3.707c-.391.391-.391 1.023 0 1.414s1.023.391 1.414 0l1.293-1.293v4.586h-4.586l1.293-1.293c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-3.707 3.707 3.707 3.707c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-1.293-1.293h4.586v4.586l-1.293-1.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l3.707 3.707 3.707-3.707c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-1.293 1.293v-4.586h4.586l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707z" class="svelte-cf79tv"></path></g></g></a></g></svg>');function Ta(n,t){st(t,!0);let e=null;be(()=>{e=new Sa(document.getElementById("adjust"),o=>{at(o,a=>{console.log("SVELTE Adjust",a)})})}),mt(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy()});var i=xa(),s=$(A(i)),r=$(A(s),6);r.__click=function(...o){var a;(a=t.toggle)==null||a.apply(this,o)},T(s),T(i),B(n,i),rt()}ct(["click"]);var Aa=j('<div class="joystick-wrapper svelte-gruxg2"><!></div>');function Ca(n){let t=U("mov");const e=r=>{r.preventDefault(),P(t,Q(g(t)==="mov"?"adj":"mov"))};var i=Aa(),s=A(i);Z(s,()=>g(t)==="mov",r=>{ka(r,{toggle:e})},r=>{Ta(r,{toggle:e})}),T(i),B(n,i)}var Ra=(n,t)=>{P(t,!1)},Oa=j('<header><input type="text" id="address" placeholder="Address"></header> <div class="flexbox"><input type="text" id="latitude" placeholder="Latitude"> <input type="text" id="longitude" placeholder="Longitude"></div> <button class="button button-small">Save location</button> <button class="button">Cancel</button>',1),Ma=(n,t)=>{P(t,!0)},La=j('<header> <button class="edit-button icon-edit" aria-label="Edit"></button></header>'),Na=j("<div> </div>"),$a=j("<!> <!>",1),Ba=(n,t,e)=>t(n,`/navi/position/${g(e).id}`),Pa=(n,t,e)=>t(g(e).id),Da=j('<button class="delete-button icon-delete" aria-label="Delete" title="Delete"></button>'),Ia=j("<li><button> </button> <!></li>"),Va=j('<div class="nav-add"><label for="new-name">Save/update current position as ...</label> <input type="text" id="new-name" class="input" placeholder="Enter position name"> <div class="margin-bottom"><sub> </sub></div> <button class="button button-small">Save target</button></div>'),qa=j('<div class="nav-selector"><button class="button button-small">Change location</button></div>'),ja=j('<div class="content-card"><div class="nav-curr-pos"><!></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function Fa(n,t){st(t,!0);const e=Rt(),i=()=>ut(kt,"$positions",e),s=()=>ut(ne,"$arduinoSettings",e);let r=U(!1),o=U(""),a=Vt(()=>In(g(o))),l=U(""),d=U(""),c=U(""),u=U(Q([]));const h=kt.subscribe(S=>{S!=null&&S.fid&&(P(l,Q(S.geo.addr)),P(d,Q(S.geo.lat)),P(c,Q(S.geo.lon)),P(u,Q([...S.base])))});mt(()=>{h&&h()});const p=()=>{const S={...i()};Ge(`/navi/position/update/${S.fid}`,S,C=>{console.log("SVELTE saved",C)})},f=()=>{const S={addr:g(l),lat:parseFloat(g(d)),lon:parseFloat(g(c))};kt.update(C=>({...C,geo:S})),p(),P(r,!1)},b=()=>{const S=In(g(o));if(S){let C=!1;const x=(({x:N,y:M,f:m})=>({x:N,y:M,f:m}))(s());let I=g(u).map(N=>N.id!==S?N:(C=!0,{...N,pos:x}));C||I.push({id:S,name:g(o),pos:x}),kt.update(N=>({...N,base:I})),p(),P(o,"")}P(r,!1)},_=S=>S==="home"?"icon-home":S==="polaris"?"icon-star":"icon-target",E=S=>{if(confirm(`Do you really want to delete position: "${S}"`)){const C=[...i().base].filter(x=>x.id!==S);kt.update(x=>({...x,base:C})),p(),P(r,!1)}},w=(S,C)=>{S.preventDefault(),at(C,x=>{console.log("SVELTE position",x)})};var v=ja(),y=A(v),k=A(y);Z(k,()=>g(r),S=>{var C=Oa(),x=bt(C),I=A(x);Xt(I),T(x);var N=$(x,2),M=A(N);Xt(M);var m=$(M,2);Xt(m),T(N);var L=$(N,2);L.__click=f;var H=$(L,2);H.__click=[Ra,r],Wt(I,()=>g(l),X=>P(l,X)),Wt(M,()=>g(d),X=>P(d,X)),Wt(m,()=>g(c),X=>P(c,X)),B(S,C)},S=>{var C=$a(),x=bt(C);Z(x,()=>g(l),N=>{var M=La(),m=A(M),L=$(m);L.__click=[Ma,r],T(M),it(()=>Et(m,`${g(l)??""} `)),B(N,M)});var I=$(x,2);Z(I,()=>g(d)&&g(c),N=>{var M=Na(),m=A(M);T(M),it(()=>Et(m,`${g(d)??""}°, ${g(c)??""}°`)),B(N,M)}),B(S,C)}),T(y);var R=$(y,2),D=A(R);Ft(D,21,()=>g(u),Qt,(S,C)=>{var x=Ia(),I=A(x);const N=Vt(()=>`nav-button ${_(g(C).id)??""}`);I.__click=[Ba,w,C];var M=A(I,!0);T(I);var m=$(I,2);Z(m,()=>g(r)&&g(C).id!=="home"&&g(C).id!=="polaris",L=>{var H=Da();H.__click=[Pa,E,C],B(L,H)}),T(x),it(()=>{At(I,g(N)),Et(M,g(C).name)}),B(S,x)}),T(D),T(R);var O=$(R,2);Z(O,()=>g(r),S=>{var C=Va(),x=$(A(C),2);Xt(x);var I=$(x,2),N=A(I),M=A(N);T(N),T(I);var m=$(I,2);m.__click=b,T(C),it(()=>{Et(M,`ID: ${g(a)??""}`),m.disabled=g(a).length<3}),Wt(x,()=>g(o),L=>P(o,L)),B(S,C)},S=>{var C=qa(),x=A(C);x.__click=function(...I){var N;(N=t.toggleAdmin)==null||N.apply(this,I)},T(C),B(S,C)}),T(v),B(n,v),rt()}ct(["click"]);const za=(n,t)=>{P(t,!g(t))};var Ua=(n,t,e)=>t(g(e).fid),Ya=(n,t,e)=>t(g(e).fid),Ha=j('<button class="delete-button icon-delete" aria-label="Delete"></button>'),Xa=j('<li><button class="nav-button icon-location"> </button> <!></li>'),Wa=(n,t)=>t(),Ka=j('<div class="nav-add"><input type="text" id="new-location" class="input" placeholder="Enter new location name"> <button class="button">+&nbsp;Add</button></div> <div> </div>',1),Ja=j('<div class="nav-selector"><button class="button button-small">&laquo;&nbsp;Back</button></div>'),Za=j('<div class="content-card"><header>Locations <button aria-label="Edit"></button></header> <div class="nav-curr-pos"><div><p>The location is the place where your telescope is placed.</p></div></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function Qa(n,t){st(t,!0);const e=Rt(),i=()=>ut(ke,"$locations",e);let s=U("");const r=kt.subscribe(w=>{P(s,Q(w.fid))});mt(()=>{r&&r()});let o=U(!1),a=U(""),l=Vt(()=>In(g(a)));const d=w=>{w!==g(s)&&at(`/navi/location/${w}`,v=>{(v==null?void 0:v.fid)===w&&(kt.update(y=>({...v})),console.log("Loaded location"))})},c=()=>{if(g(l).length>=3){const w=ha(g(l),g(a));Ge(`/navi/position/update/${g(l)}`,w,v=>{kt.update(y=>w),ke.update(y=>[...y,{fid:g(l),addr:g(a)}]),P(a,""),console.log("Added new location",v)})}else console.error("ID is too short. At least 3 char are required.")},u=w=>{confirm(`Do you really want to delete location: "${w}"`)?at(`/navi/location/delete/${w}`,v=>{v.response===200&&(ke.update(y=>y.filter(k=>k.fid!==w)),alert(`Location "${w}" deleted`))}):alert(`Deletion of "${w}" canceled.`)};be(()=>{i().length===0&&at("/navi/location-list",w=>{ke.update(v=>[...w]),console.log("Loaded location list")})});var h=Za(),p=A(h),f=$(A(p));f.__click=[za,o],T(p);var b=$(p,4),_=A(b);Ft(_,5,i,Qt,(w,v)=>{var y=Xa(),k=A(y);k.__click=[Ua,d,v];var R=A(k,!0);T(k);var D=$(k,2);Z(D,()=>g(o)&&g(v).fid!==g(s)&&g(v).fid!=="index",O=>{var S=Ha();S.__click=[Ya,u,v],B(O,S)}),T(y),it(()=>{At(y,g(v).fid===g(s)?"active":""),Et(R,g(v).addr)}),B(w,y)}),T(_),T(b);var E=$(b,2);Z(E,()=>g(o),w=>{var v=Ka(),y=bt(v),k=A(y);Xt(k);var R=$(k,2);R.__click=[Wa,c],T(y);var D=$(y,2),O=A(D,!0);T(D),it(()=>Et(O,g(l))),Wt(k,()=>g(a),S=>P(a,S)),B(w,v)},w=>{var v=Ja(),y=A(v);y.__click=function(...k){var R;(R=t.toggleAdmin)==null||R.apply(this,k)},T(v),B(w,v)}),T(h),it(()=>At(f,`edit-button icon-edit${(g(o)?" active":"")??""}`)),B(n,h),rt()}ct(["click"]);function Ga(n,t){st(t,!0);const e=Rt(),i=()=>ut(kt,"$positions",e);let s=U(!1);const r=()=>{P(s,!g(s))};be(()=>{var l;(l=i())!=null&&l.fid||at("/navi/location/index",d=>{(d==null?void 0:d.fid)==="index"&&kt.update(c=>({...d}))})});var o=Bt(),a=bt(o);Z(a,()=>g(s),l=>{Qa(l,{toggleAdmin:r})},l=>{Fa(l,{toggleAdmin:r})}),B(n,o),rt()}var tc=(n,t,e,i)=>{t()(e.id,i())},ec=(n,t,e,i)=>{t()(e.id,i())},nc=j('<div class="slider-wrapper svelte-1qw7onx"><label class="svelte-1qw7onx"> </label> <input type="range" class="svelte-1qw7onx"></div>');function Ds(n,t){st(t,!0);let e=Nt(t,"oninput",3,()=>{}),i=Nt(t,"onchange",3,()=>{}),s=Nt(t,"value",7,0),r=Nt(t,"minValue",3,0),o=Nt(t,"maxValue",3,10),a=Nt(t,"steps",3,1);var l=nc(),d=A(l),c=A(d,!0);T(d);var u=$(d,2);Xt(u),u.__change=[tc,i,t,s],u.__input=[ec,e,t,s],T(l),it(()=>{Y(d,"for","slider_slide_"+t.id),Et(c,t.name),Y(u,"id","slider_slide_"+t.id),Y(u,"min",r()),Y(u,"max",o()),Y(u,"step",a())}),Wt(u,s),B(n,l),rt()}ct(["change","input"]);var ic=j('<div class="camera-options svelte-1x08sfe"><!> <div class="actions-wrapper svelte-1x08sfe"><button class="svelte-1x08sfe">Reset defaults</button></div></div>');function sc(n,t){st(t,!1);const e=Rt(),i=()=>ut(on,"$camControls",e),s=(c,u)=>{on.update(h=>h.map(p=>p.id===c?{...p,value:u}:{...p})),at(`/cam/ctrl/${c}/${u}`,h=>{console.log("SVELTE CamCtrl",h)})},r=()=>{on.update(u=>u.map(h=>({...h,value:h.defaultValue})));const c={};for(let u of i())u!=null&&u.id&&(c[u.id]=u.defaultValue);Ge("/cam/controls",c,u=>{console.log("SVELTE Cam Controls",u)})};ts();var o=ic(),a=A(o);Ft(a,3,i,c=>c.name,(c,u,h)=>{Ds(c,Gi(()=>g(u),{get index(){return g(h)},onchange:s}))});var l=$(a,2),d=A(l);d.__click=r,T(l),T(o),B(n,o),rt()}ct(["click"]);const rc=()=>{Ve.update(n=>!n)};var oc=we('<polygon points="-15,-15 -15,15 15,15 15,-15" stroke-width="5" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),ac=we('<polygon points="-7.5,-22.5 -7.5,22.5 20,0" stroke-width="10" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),cc=j('<div id="video-recording" class="svelte-1h8ia9r"><button aria-label="Record video" class="svelte-1h8ia9r"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" preserveAspectRatio="xMinYMin slice" class="svelte-1h8ia9r"><g transform="translate(42,42)"><circle r="38" stroke-width="5" class="svelte-1h8ia9r"></circle><!></g></svg></button></div>');function lc(n,t){st(t,!0);let e=U(!1);const i=Ve.subscribe(d=>{if(g(e)!==d){P(e,Q(d));const c=g(e)?"start":"stop";at(`/cam/video-rec/vid/${c}`,u=>{console.log("Video recording",u)})}});mt(()=>{i&&i()});var s=cc(),r=A(s);r.__click=[rc];var o=A(r),a=A(o),l=$(A(a));Z(l,()=>g(e),d=>{var c=oc();B(d,c)},d=>{var c=ac();B(d,c)}),T(a),T(o),T(r),T(s),B(n,s),rt()}ct(["click"]);var uc=j('<h3 class="message svelte-kc30aj"><!></h3>'),hc=j('<div class="sphere-config svelte-kc30aj"><!> <!> <div class="actions-wrapper svelte-kc30aj"><button class="svelte-kc30aj">Save settings</button></div></div>');function fc(n,t){st(t,!0);const e=Rt(),i=()=>ut(ve,"$sphereControls",e);let s=U(void 0),r=U(Q([]));const o=ve.subscribe(f=>{P(r,Q(f.map(b=>({...b}))))}),a=(f,b)=>{console.log(),ve.update(_=>_.map(E=>E.id===f?{...E,value:b}:{...E}))},l=()=>{const f={};for(let b of i())f[b.id]=b.value;Ge("/config/sphere/settings",f,b=>{P(s,Q((b==null?void 0:b.response)===200?'<span style="color:#090">Successfully saved settings.</span>':'<span style="color:#B00">Failed to save settings.</span>')),setTimeout(()=>{P(s,null)},5e3)})};mt(()=>{o&&o()});var d=hc(),c=A(d);Z(c,()=>g(s),f=>{var b=uc(),_=A(b);_r(_,()=>g(s)),T(b),B(f,b)});var u=$(c,2);Ft(u,17,()=>g(r),Qt,(f,b,_)=>{Ds(f,Gi(()=>g(b),{index:_,oninput:a}))});var h=$(u,2),p=A(h);p.__click=l,T(h),T(d),B(n,d),rt()}ct(["click"]);const dc=(n,t)=>{const e=t()==="B"?"cam_b":"cam_a";at(`/cam/capture-img/image/${e}`,i=>{console.log("Capture image",i)})},pc=(n,t,e,i)=>{const s=t()==="B"?"cam_b":"cam_a";at(`/cam/snail-shot/${g(e)}/${g(i)}/${s}`,r=>{console.log("Snails",r,s)})};var vc=(n,t)=>console.log("X:",g(t)),gc=j("<option></option>"),mc=(n,t)=>console.log("Y:",g(t)),_c=j("<option></option>"),yc=j('<div id="image-capture" class="svelte-2mcnnf"><button aria-label="Capture image" class="svelte-2mcnnf"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-2mcnnf"><g transform="translate(42,42)"><circle r="28" fill="#C00" stroke="#C00"></circle><circle r="38" class="capture-button svelte-2mcnnf"></circle></g></svg></button> <button aria-label="Snail shot" class="svelte-2mcnnf"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-2mcnnf"><g transform="translate(42,42)"><polyline points="0,0 20,0 20,15 -20,15 -20,-15 40,-15 40,30 -20,30 -12,28 -12,32 -20,30" class="svelte-2mcnnf"></polyline></g></svg></button> <div class="dimensions svelte-2mcnnf"><label class="svelte-2mcnnf"><span class="svelte-2mcnnf">hor</span><select class="svelte-2mcnnf"></select></label> <label class="svelte-2mcnnf"><span class="svelte-2mcnnf">ver</span><select class="svelte-2mcnnf"></select></label></div></div>');function wc(n,t){st(t,!0);const e=Rt(),i=()=>ut(Ne,"$swapPreview",e);let s=U(3),r=U(3);var o=yc(),a=A(o);a.__click=[dc,i];var l=$(a,2);l.__click=[pc,i,s,r];var d=$(l,2),c=A(d),u=$(A(c));u.__change=[vc,s],Ft(u,20,()=>Array.from({length:7}),Qt,(f,b,_)=>{var E=gc();E.value=(E.__value=_+3)==null?"":_+3,E.textContent=_+3,B(f,E)}),T(u),T(c);var h=$(c,2),p=$(A(h));p.__change=[mc,r],Ft(p,20,()=>Array.from({length:7}),Qt,(f,b,_)=>{var E=_c();E.value=(E.__value=_+3)==null?"":_+3,E.textContent=_+3,B(f,E)}),T(p),T(h),T(d),T(o),pi(u,()=>g(s),f=>P(s,f)),pi(p,()=>g(r),f=>P(r,f)),B(n,o),rt()}ct(["click","change"]);var bc=j('<div class="controls svelte-bwwnlr"><div class="tools svelte-bwwnlr"><!></div></div>');function Ec(n){const t=Rt(),e=()=>ut(gn,"$toolTab",t);var i=Bt(),s=bt(i);Z(s,e,r=>{var o=bc(),a=A(o),l=A(a);Z(l,()=>e()==="target",d=>{Ca(d)},d=>{var c=Bt(),u=bt(c);Z(u,()=>e()==="sphere",h=>{fc(h,{})},h=>{var p=Bt(),f=bt(p);Z(f,()=>e()==="location",b=>{Ga(b,{})},b=>{var _=Bt(),E=bt(_);Z(E,()=>e()==="adjust",w=>{sc(w,{})},w=>{var v=Bt(),y=bt(v);Z(y,()=>e()==="video",k=>{lc(k,{})},k=>{var R=Bt(),D=bt(R);Z(D,()=>e()==="picture",O=>{wc(O,{})},null,!0),B(k,R)},!0),B(w,v)},!0),B(b,_)},!0),B(h,p)},!0),B(d,c)}),T(a),T(o),B(r,o)}),B(n,i)}var kc=j('<li><button><span class="svelte-dso250"> </span></button></li>'),Sc=j('<div id="options-menu" class="svelte-dso250"><ul class="svelte-dso250"></ul></div>');function xc(n,t){st(t,!0);let e=U("");const i=gn.subscribe(c=>{P(e,Q(c))});let s=U(!1);const r=Ie.subscribe(c=>{P(s,Q(c))}),o=c=>{gn.update(u=>u===c?"":c)};mt(()=>{i&&i(),r&&r()});const a=[{id:"sphere",name:"Sphere",icon:"icon-settings",callback:()=>{o("sphere")},enabled:()=>g(e)==="sphere"},{id:"compass",name:"Compass",icon:"icon-compass",callback:()=>{Ie.update(c=>!c)},enabled:()=>g(s)},{id:"location",name:"Location",icon:"icon-location",callback:()=>{o("location")},enabled:()=>g(e)==="location"},{id:"target",name:"Target",icon:"icon-target",callback:()=>{o("target")},enabled:()=>g(e)==="target"},{id:"adjust",name:"Contrast",icon:"icon-adjust",callback:()=>{o("adjust")},enabled:()=>g(e)==="adjust"},{id:"video",name:"Video",icon:"icon-video",callback:()=>{o("video")},enabled:()=>g(e)==="video"},{id:"picture",name:"Picture",icon:"icon-image",callback:()=>{o("picture")},enabled:()=>g(e)==="picture"}];var l=Sc(),d=A(l);Ft(d,21,()=>a,Qt,(c,u)=>{var h=kc();const p=Vt(()=>`${(g(u).enabled()?"active":"")??""} svelte-dso250`);var f=A(h);f.__click=function(...E){var w;(w=g(u).callback)==null||w.apply(this,E)};var b=A(f),_=A(b,!0);T(b),T(f),T(h),it(()=>{At(h,g(p)),At(f,`${g(u).icon??""} svelte-dso250`),Et(_,g(u).name)}),B(c,h)}),T(d),T(l),B(n,l),rt()}ct(["click"]);var Tc=j('<div><button class="task--button video-recorder svelte-1btt76e" aria-label="Stop video recording"><span class="icon-stop"></span> <span class="time"> </span></button></div>');function Ac(n,t){st(t,!0);const e={elapsedTime:0};let i=U("00:00:00");function s(u,h,p){const f=[u,h,p].map(b=>b<10?`0${b}`:b);P(i,Q(f.join(":")))}function r(){e.startTime=Date.now(),e.intervalId=setInterval(()=>{const u=Date.now()-e.startTime+e.elapsedTime,h=parseInt(u/1e3%60,10),p=parseInt(u/(1e3*60)%60,10),f=parseInt(u/(1e3*60*60)%24,10);s(f,p,h)},1e3)}function o(){e.intervalId&&(clearInterval(e.intervalId),Ve.update(()=>!1),P(i,"00:00:00"))}let a=U(!1);const l=Ve.subscribe(u=>{u!==g(a)&&(u?r():o(),P(a,Q(u)))});mt(()=>{l&&l()});var d=Bt(),c=bt(d);Z(c,()=>g(a),u=>{var h=Tc(),p=A(h);p.__click=o;var f=$(A(p),2),b=A(f,!0);T(f),T(p),T(h),it(()=>Et(b,g(i))),B(u,h)}),B(n,d),rt()}ct(["click"]);const Cc=(n,t)=>{document.fullscreenElement?(document.exitFullscreen(),P(t,!1)):(document.documentElement.requestFullscreen(),P(t,!0))};var Rc=j('<button class="task--button" aria-label="Switch fullscreen mode"><span></span></button>');function Oc(n){let t=U(!1);var e=Rc();e.__click=[Cc,t];var i=A(e);T(e),it(()=>At(i,g(t)?"icon-viewport":"icon-fullscreen")),B(n,e)}ct(["click"]);const Mc=()=>{Yn.update(n=>!n)};var Lc=j('<button class="task--button daylight-button svelte-192ooay" aria-label="Switch daylight mode"><span></span></button>');function Nc(n,t){st(t,!0);let e=U(!1),i=Yn.subscribe(o=>{P(e,Q(o))});mt(()=>{i&&i()});var s=Lc();s.__click=[Mc];var r=A(s);T(s),it(()=>At(r,g(e)?"icon-dark":"icon-light")),B(n,s),rt()}ct(["click"]);var $c=j('<div class="tasks svelte-1laysiz"><!> <!> <!></div>');function Bc(n){var t=$c(),e=A(t);Ac(e,{});var i=$(e,2);Oc(i);var s=$(i,2);Nc(s,{}),T(t),B(n,t)}var Pc=j("<div><!> <!> <!> <!></div>");function Hc(n){const t=Rt(),e=()=>ut(Yn,"$daylight",t);var i=Pc(),s=A(i);Bc(s);var r=$(s,2);ya(r);var o=$(r,2);Ec(o);var a=$(o,2);xc(a,{}),T(i),it(()=>At(i,`${"container"+(e()?" daylight":"")} svelte-183uj8y`)),B(n,i)}export{Hc as component};
