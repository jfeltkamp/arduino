import{a as T,t as L,n as Ft,c as pt}from"../chunks/disclose-version.D-zl7_bA.js";import{x as Ze,h as ts,k as W,B as qt,C as es,M as ss,ai as je,P as rs,Q as de,R as Vt,l as yt,ar as Ot,N as Re,i as Oe,O as ns,an as is,z as fe,as as re,at as pe,au as ne,av as as,a4 as os,G as ve,aw as ls,ah as cs,ax as hs,j as us,ay as Le,y as ds,ae as fs,a9 as ps,az as vs,ac as ms,aA as _s,aB as gs,L as me,aC as ys,aD as xs,am as bs,al as Be,p as U,I as A,g as c,q as m,w as b,v,t as X,o as z,aE as At,aq as D,m as it,f as Pt}from"../chunks/runtime.BXMN-w1N.js";import{b as ws,c as nt,a as V,o as Tt,i as I,p as Ct,s as ks}from"../chunks/index-client.CJAqYlJa.js";import{a as Z,d as tt,s as ft,b as ct}from"../chunks/store.CK1C7IY5.js";import{i as Ne}from"../chunks/lifecycle.-hdmMjbE.js";import{w as ht}from"../chunks/index.DFaCUBO6.js";let Ut=null;function Et(r,t){return t}function Es(r,t,e,s){for(var n=[],i=t.length,a=0;a<i;a++)ls(t[a].e,n,!0);var o=i>0&&n.length===0&&e!==null;if(o){var l=e.parentNode;cs(l),l.append(e),s.clear(),ot(r,t[0].prev,t[i-1].next)}hs(n,()=>{for(var d=0;d<i;d++){var h=t[d];o||(s.delete(h.k),ot(r,h.prev,h.next)),us(h.e,!o)}})}function _t(r,t,e,s,n,i=null){var a=r,o={flags:t,items:new Map,first:null},l=(t&Le)!==0;if(l){var d=r;a=W?qt(ds(d)):d.appendChild(Ze())}W&&es();var h=null,f=!1;ts(()=>{var u=e(),_=ss(u)?u:u==null?[]:je(u),p=_.length;if(f&&p===0)return;f=p===0;let j=!1;if(W){var E=a.data===rs;E!==(p===0)&&(a=de(),qt(a),Vt(!1),j=!0)}if(W){for(var R=null,w,x=0;x<p;x++){if(yt.nodeType===8&&yt.data===fs){a=yt,j=!0,Vt(!1);break}var g=_[x],y=s(g,x);w=De(yt,o,R,null,g,y,x,n,t),o.items.set(y,w),R=w}p>0&&qt(de())}if(!W){var M=ps;Ts(_,o,a,n,t,(M.f&Ot)!==0,s)}i!==null&&(p===0?h?Re(h):h=Oe(()=>i(a)):h!==null&&ns(h,()=>{h=null})),j&&Vt(!0),e()}),W&&(a=yt)}function Ts(r,t,e,s,n,i,a){var P,F,Q,ut;var o=(n&vs)!==0,l=(n&(re|ne))!==0,d=r.length,h=t.items,f=t.first,u=f,_,p=null,j,E=[],R=[],w,x,g,y;if(o)for(y=0;y<d;y+=1)w=r[y],x=a(w,y),g=h.get(x),g!==void 0&&((P=g.a)==null||P.measure(),(j??(j=new Set)).add(g));for(y=0;y<d;y+=1){if(w=r[y],x=a(w,y),g=h.get(x),g===void 0){var M=u?u.e.nodes_start:e;p=De(M,t,p,p===null?t.first:p.next,w,x,y,s,n),h.set(x,p),E=[],R=[],u=p.next;continue}if(l&&As(g,w,y,n),g.e.f&Ot&&(Re(g.e),o&&((F=g.a)==null||F.unfix(),(j??(j=new Set)).delete(g))),g!==u){if(_!==void 0&&_.has(g)){if(E.length<R.length){var Y=R[0],q;p=Y.prev;var k=E[0],C=E[E.length-1];for(q=0;q<E.length;q+=1)_e(E[q],Y,e);for(q=0;q<R.length;q+=1)_.delete(R[q]);ot(t,k.prev,C.next),ot(t,p,k),ot(t,C,Y),u=Y,p=C,y-=1,E=[],R=[]}else _.delete(g),_e(g,u,e),ot(t,g.prev,g.next),ot(t,g,p===null?t.first:p.next),ot(t,p,g),p=g;continue}for(E=[],R=[];u!==null&&u.k!==x;)(i||!(u.e.f&Ot))&&(_??(_=new Set)).add(u),R.push(u),u=u.next;if(u===null)continue;g=u}E.push(g),p=g,u=g.next}if(u!==null||_!==void 0){for(var O=_===void 0?[]:je(_);u!==null;)(i||!(u.e.f&Ot))&&O.push(u),u=u.next;var N=O.length;if(N>0){var B=n&Le&&d===0?e:null;if(o){for(y=0;y<N;y+=1)(Q=O[y].a)==null||Q.measure();for(y=0;y<N;y+=1)(ut=O[y].a)==null||ut.fix()}Es(t,O,B,h)}}o&&is(()=>{var at;if(j!==void 0)for(g of j)(at=g.a)==null||at.apply()}),fe.first=t.first&&t.first.e,fe.last=p&&p.e}function As(r,t,e,s){s&re&&pe(r.v,t),s&ne?pe(r.i,e):r.i=e}function De(r,t,e,s,n,i,a,o,l){var d=Ut;try{var h=(l&re)!==0,f=(l&as)===0,u=h?f?os(n):ve(n):n,_=l&ne?ve(a):a,p={i:_,v:u,k:i,a:null,e:null,prev:e,next:s};return Ut=p,p.e=Oe(()=>o(r,u,_),W),p.e.prev=e&&e.e,p.e.next=s&&s.e,e===null?t.first=p:(e.next=p,e.e.next=p.e),s!==null&&(s.prev=p,s.e.prev=p.e),p}finally{Ut=d}}function _e(r,t,e){for(var s=r.next?r.next.e.nodes_start:e,n=t?t.e.nodes_start:e,i=r.e.nodes_start;i!==s;){var a=ms(i);n.before(i),i=a}}function ot(r,t,e){t===null?r.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}let ge=!1;function Pe(){ge||(ge=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var t;if(!r.defaultPrevented)for(const e of r.target.elements)(t=e.__on_r)==null||t.call(e)})},{capture:!0}))}function vt(r){if(W){var t=!1,e=()=>{if(!t){if(t=!0,r.hasAttribute("value")){var s=r.value;H(r,"value",null),r.value=s}if(r.hasAttribute("checked")){var n=r.checked;H(r,"checked",null),r.checked=n}}};r.__on_r=e,_s(e),Pe()}}function H(r,t,e,s){var n=r.__attributes??(r.__attributes={});W&&(n[t]=r.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&r.nodeName==="LINK")||n[t]!==(n[t]=e)&&(t==="style"&&"__styles"in r&&(r.__styles={}),t==="loading"&&(r[gs]=e),e==null?r.removeAttribute(t):typeof e!="string"&&Cs(r).includes(t)?r[t]=e:r.setAttribute(t,e))}var ye=new Map;function Cs(r){var t=ye.get(r.nodeName);if(t)return t;ye.set(r.nodeName,t=[]);for(var e,s=me(r),n=Element.prototype;n!==s;){e=ys(s);for(var i in e)e[i].set&&t.push(i);s=me(s)}return t}function dt(r,t){var e=r.__className,s=Ss(t);W&&r.className===s?r.__className=s:(e!==s||W&&r.className!==s)&&(t==null?r.removeAttribute("class"):r.className=s,r.__className=s)}function Ss(r){return r??""}function $e(r,t,e,s=e){r.addEventListener(t,e);const n=r.__on_r;n?r.__on_r=()=>{n(),s()}:r.__on_r=s,Pe()}function mt(r,t,e=t){var s=xs();$e(r,"input",()=>{var n=xe(r)?be(r.value):r.value;e(n),s&&n!==(n=t())&&(r.value=n??"")}),bs(()=>{var n=t();if(W&&r.defaultValue!==r.value){e(r.value);return}xe(r)&&n===be(r.value)||r.type==="date"&&!n&&!r.value||n!==r.value&&(r.value=n??"")})}function xe(r){var t=r.type;return t==="number"||t==="range"}function be(r){return r===""?null:+r}function Fe(r,t,e){if(r.multiple)return Rs(r,t);for(var s of r.options){var n=wt(s);if(ws(n,t)){s.selected=!0;return}}(!e||t!==void 0)&&(r.selectedIndex=-1)}function js(r,t){Be(()=>{var e=new MutationObserver(()=>{var s=r.__value;Fe(r,s)});return e.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{e.disconnect()}})}function we(r,t,e=t){var s=!0;$e(r,"change",()=>{var n;if(r.multiple)n=[].map.call(r.querySelectorAll(":checked"),wt);else{var i=r.querySelector(":checked");n=i&&wt(i)}e(n)}),Be(()=>{var n=t();if(Fe(r,n,s),s&&n===void 0){var i=r.querySelector(":checked");i!==null&&(n=wt(i),e(n))}r.__value=n,s=!1}),js(r)}function Rs(r,t){for(var e of r.options)e.selected=~t.indexOf(wt(e))}function wt(r){return"__value"in r?r.__value:r.value}const ie=ht({x:0,y:0,f:0,deg_x:0,deg_y:0,dx:1,dy:-1,df:1,acc:1e3,spr:8e4,mpa:2e4,minpx:-2e4,maxpx:2e4,mpf:5e3,vx:0,vy:0,va1:100,va2:1500,vf:0,vf1:100,vf2:1500}),zt=ht([{id:"Brightness",name:"Brightness",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.01},{id:"Contrast",name:"Contrast",defaultValue:1,value:1,minValue:0,maxValue:6,steps:.1},{id:"Saturation",name:"Saturation",defaultValue:1,value:1,minValue:0,maxValue:32,steps:.1},{id:"Sharpness",name:"Sharpness",defaultValue:1,value:1,minValue:0,maxValue:16,steps:.1},{id:"ExposureTime",name:"Exposure time",description:"Value > 0 will reduce video framerate.",defaultValue:0,value:0,minValue:-10,maxValue:10,steps:.1},{id:"AnalogueGain",name:"Analogue gain",defaultValue:1,value:1,minValue:1,maxValue:8,steps:.1}]),St=ht([]),et=ht({}),Kt=ht(""),Xt=ht(!1),Lt=ht("B"),$t=ht(!1);var Os=L('<div id="horizon-wrapper" class="svelte-1la5nj5"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 300" preserveAspectRatio="xMinYMin slice" class="svelte-1la5nj5"><defs><g id="horizon"><line x1="0" x2="0" y1="-600" y2="600" stroke="#FFF" stroke-dashoffset="6.75" stroke-dasharray="0.5,44" stroke-width="10"></line><line x1="-200" x2="200" y1="150" y2="150" stroke="#FFF" stroke-dashoffset="30" stroke-dasharray="40.5,9.5,0.5,9.5" stroke-width=".5"></line></g></defs><defs><polygon id="focusArrow" points="0,400 180,65 100,65 200,35 300,65 220,65 400,400"></polygon><linearGradient id="focusArrowGradClip" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#005"></stop><stop offset="50%" stop-color="#039" stop-opacity=".8"></stop><stop offset="100%" stop-color="#07f" stop-opacity=".4"></stop></linearGradient></defs><clipPath id="arrowStripesClip"><polygon points="200,0 -390,400 -370,400 200,0 -350,400 -330,400 200,0 -310,400 -290,400 200,0 -270,400 -250,400 200,0 -230,400 -210,400 200,0 -190,400 -170,400 200,0 -150,400 -130,400 200,0 -110,400 -90,400 200,0 -70,400 -50,400 200,0 -30,400 -10,400 200,0 10,400 30,400 200,0 50,400 70,400 200,0 90,400 110,400 200,0 130,400 150,400 200,0 170,400 190,400 200,0 210,400 230,400 200,0 250,400 270,400 200,0 290,400 310,400 200,0 330,400 350,400 200,0 370,400 390,400 200,0 410,400 430,400 200,0 450,400 470,400 200,0 490,400 510,400 200,0 530,400 550,400 200,0 570,400 590,400 200,0 610,400 630,400 200,0 650,400 670,400 200,0 690,400 710,400 200,0 730,400 750,400 200,0 770,400 790,400"></polygon></clipPath><clipPath id="focusRangeMeterClip"><rect id="focus-range-meter" width="400" height="400" class="svelte-1la5nj5"></rect></clipPath><use id="azimuth-sphere" href="#horizon" class="svelte-1la5nj5"></use><g transform="translate(200 150)"><g id="altitude-visual" class="svelte-1la5nj5"><circle r="1" fill="#FFF"></circle><path d="M-70 0 -10 0 A 10 10 0 0 0 10 0 " fill="none" stroke-width="1.2" stroke="#FFF"></path><text id="altitude-text" text-anchor="middle" transform="translate(-45 -5)" fill="#FFF" font-size="10"> </text></g></g><g transform="translate(200 150)"><path d="M-10 0 A 10 10 0 0 0 10 0 L 70 0" fill="none" stroke-width="1.22" stroke="#FFF"></path><path d="M -4,-150 0,-140 4,-150" fill="#FFF" stroke="#FFF" stroke-width=".5"></path><text id="azimuth-text" transform="translate(30 -5)" text-anchor="middle" fill="#FFF" font-size="10"> </text></g><g transform="translate(200 -390)"><g id="compass" class="svelte-1la5nj5"><circle r="400" class="grade svelte-1la5nj5" stroke-dasharray=".5 6.48131701" stroke-dashoffset=".15" stroke-width="20"></circle><circle r="400" class="grade svelte-1la5nj5" stroke-dasharray=".5 34.40658504" stroke-dashoffset=".15" stroke-width="30"></circle><circle r="400" class="grade svelte-1la5nj5" stroke-dasharray=".5 104.21975512" stroke-dashoffset=".15" stroke-width="40"></circle><circle r="400" fill="none" stroke-dasharray=".5 156.57963268" stroke-dashoffset=".15" stroke="#F00" stroke-width="40"></circle><text class="cmp-text svelte-1la5nj5" transform="rotate(0) translate(0 432)">N</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-15) translate(0 432)">15</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-30) translate(0 432)">30</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-45) translate(0 432)">45</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-60) translate(0 432)">60</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-75) translate(0 432)">75</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-90) translate(0 432)">E</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-105) translate(0 432)">105</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-120) translate(0 432)">120</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-135) translate(0 432)">135</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-150) translate(0 432)">150</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-165) translate(0 432)">165</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-180) translate(0 432)">S</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-195) translate(0 432)">195</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-210) translate(0 432)">210</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-225) translate(0 432)">225</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-240) translate(0 432)">240</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-255) translate(0 432)">255</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-270) translate(0 432)">W</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-285) translate(0 432)">285</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-300) translate(0 432)">300</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-315) translate(0 432)">315</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-330) translate(0 432)">330</text><text class="cmp-text svelte-1la5nj5" transform="rotate(-345) translate(0 432)">345</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(0) translate(0 422)">0</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-5) translate(0 422)">5</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-10) translate(0 422)">10</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-20) translate(0 422)">20</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-25) translate(0 422)">25</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-22.5) translate(0 422)">NNE</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-35) translate(0 422)">35</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-40) translate(0 422)">40</text><text class="cmp-text-sm left svelte-1la5nj5" transform="rotate(-45) translate(0 422)">NE</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-50) translate(0 422)">50</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-55) translate(0 422)">55</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-65) translate(0 422)">65</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-70) translate(0 422)">70</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-67.5) translate(0 422)">NEE</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-80) translate(0 422)">80</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-85) translate(0 422)">85</text><text class="cmp-text-sm left svelte-1la5nj5" transform="rotate(-90) translate(0 422)">90</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-95) translate(0 422)">95</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-95) translate(0 422)">95</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-100) translate(0 422)">100</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-110) translate(0 422)">110</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-112.5) translate(0 422)">SEE</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-115) translate(0 422)">115</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-125) translate(0 422)">125</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-130) translate(0 422)">130</text><text class="cmp-text-sm left svelte-1la5nj5" transform="rotate(-135) translate(0 422)">SE</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-140) translate(0 422)">140</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-145) translate(0 422)">145</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-155) translate(0 422)">155</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-157.5) translate(0 422)">SSE</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-160) translate(0 422)">160</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-170) translate(0 422)">170</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-175) translate(0 422)">175</text><text class="cmp-text-sm left svelte-1la5nj5" transform="rotate(-180) translate(0 422)">180</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-185) translate(0 422)">185</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-190) translate(0 422)">190</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-200) translate(0 422)">200</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-202.5) translate(0 422)">SSW</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-205) translate(0 422)">205</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-215) translate(0 422)">215</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-220) translate(0 422)">220</text><text class="cmp-text-sm left svelte-1la5nj5" transform="rotate(-225) translate(0 422)">SW</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-230) translate(0 422)">230</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-235) translate(0 422)">235</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-245) translate(0 422)">245</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-247.5) translate(0 422)">SWW</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-250) translate(0 422)">250</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-260) translate(0 422)">260</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-265) translate(0 422)">265</text><text class="cmp-text-sm left svelte-1la5nj5" transform="rotate(-270) translate(0 422)">270</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-275) translate(0 422)">275</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-280) translate(0 422)">280</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-290) translate(0 422)">290</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-292.5) translate(0 422)">NWW</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-295) translate(0 422)">295</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-305) translate(0 422)">305</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-310) translate(0 422)">310</text><text class="cmp-text-sm left svelte-1la5nj5" transform="rotate(-315) translate(0 422)">NW</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-320) translate(0 422)">320</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-325) translate(0 422)">325</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-335) translate(0 422)">335</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-340) translate(0 422)">340</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-350) translate(0 422)">350</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-355) translate(0 422)">355</text><text class="cmp-text-sm svelte-1la5nj5" transform="rotate(-337.5) translate(0 422)">NNW</text></g></g></svg></div>');function Ls(r,t){U(t,!1);let e=At(),s=At(),n=At(),i=At();const a=ie.subscribe(y=>{const M=y.f+y.mpf,q=(y.mpf-y.mpf/Math.pow(1.5/y.mpf*M+1,2))/y.mpf;A(e,(1-q)*133),A(s,y.deg_x),A(n,y.deg_y),A(i,c(n)/90*400)});nt(()=>{a&&a()}),Ne();var o=Os(),l=m(o),d=b(m(l),3),h=m(d);v(d);var f=b(d),u=b(f),_=m(u),p=b(m(_),2),j=m(p);v(p),v(_),v(u);var E=b(u),R=b(m(E),2),w=m(R);v(R),v(E);var x=b(E),g=m(x);v(x),v(l),v(o),X(()=>{H(h,"style",`y:${c(e)??""}%`),H(f,"style",`transform: translate(200px, ${c(i)??""}px)`),H(_,"style",`transform: rotate(${c(n)??""}deg)`),Z(j,`∠ ${c(n)??""}°`),Z(w,`➢ ${c(s)??""}°`),H(g,"transform",`rotate(${c(s)??""})`)}),T(r,o),z()}var Bs=(r,t)=>t("A"),Ns=(r,t)=>t("B"),Ds=L('<div id="camera-stream" class="svelte-1lxtj7p"><button id="telescope-stream"><img id="stream-object" alt="Telescope" width="1080" height="810" class="svelte-1lxtj7p"></button> <button id="viewfinder-stream"><img id="stream-object" alt="Viewfinder" width="1080" height="810" class="svelte-1lxtj7p"></button></div>');function Ps(r,t){U(t,!0);const e=ft(),s=()=>ct(Lt,"$swapPreview",e);let n=D(void 0);const i=Lt.subscribe(p=>{A(n,V(p))}),a=p=>{c(n)!==p&&Lt.update(j=>p)};let o=D("starfield.jpg"),l=D("starfield.jpg");Tt(()=>{A(o,`${location.protocol}//${location.hostname}:7777/stream_a.mjpg`),A(l,`${location.protocol}//${location.hostname}:7777/stream_b.mjpg`)}),nt(()=>{i&&i()});var d=Ds(),h=m(d);h.__click=[Bs,a];var f=m(h);v(h);var u=b(h,2);u.__click=[Ns,a];var _=m(u);v(u),v(d),X(()=>{dt(h,`stream-wrapper${(s()==="A"?" large":"")??""} svelte-1lxtj7p`),H(f,"src",c(o)),dt(u,`stream-wrapper${(s()==="B"?" large":"")??""} svelte-1lxtj7p`),H(_,"src",c(l))}),T(r,d),z()}tt(["click"]);var $s=L('<div class="layer svelte-qmdbdl"><!></div>'),Fs=L('<div class="visuals svelte-qmdbdl"><!> <!></div>');function Is(r){const t=ft(),e=()=>ct(Xt,"$displayCompass",t);var s=Fs(),n=m(s);Ps(n,{});var i=b(n,2);I(i,e,a=>{var o=$s(),l=m(o);Ls(l,{}),v(o),T(a,o)}),v(s),T(r,s)}const rt=Object.create(null);rt.open="0";rt.close="1";rt.ping="2";rt.pong="3";rt.message="4";rt.upgrade="5";rt.noop="6";const Bt=Object.create(null);Object.keys(rt).forEach(r=>{Bt[rt[r]]=r});const Jt={type:"error",data:"parser error"},Ie=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Me=typeof ArrayBuffer=="function",qe=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,ae=({type:r,data:t},e,s)=>Ie&&t instanceof Blob?e?s(t):ke(t,s):Me&&(t instanceof ArrayBuffer||qe(t))?e?s(t):ke(new Blob([t]),s):s(rt[r]+(t||"")),ke=(r,t)=>{const e=new FileReader;return e.onload=function(){const s=e.result.split(",")[1];t("b"+(s||""))},e.readAsDataURL(r)};function Ee(r){return r instanceof Uint8Array?r:r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}let Yt;function Ms(r,t){if(Ie&&r.data instanceof Blob)return r.data.arrayBuffer().then(Ee).then(t);if(Me&&(r.data instanceof ArrayBuffer||qe(r.data)))return t(Ee(r.data));ae(r,!1,e=>{Yt||(Yt=new TextEncoder),t(Yt.encode(e))})}const Te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bt=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let r=0;r<Te.length;r++)bt[Te.charCodeAt(r)]=r;const qs=r=>{let t=r.length*.75,e=r.length,s,n=0,i,a,o,l;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);const d=new ArrayBuffer(t),h=new Uint8Array(d);for(s=0;s<e;s+=4)i=bt[r.charCodeAt(s)],a=bt[r.charCodeAt(s+1)],o=bt[r.charCodeAt(s+2)],l=bt[r.charCodeAt(s+3)],h[n++]=i<<2|a>>4,h[n++]=(a&15)<<4|o>>2,h[n++]=(o&3)<<6|l&63;return d},Vs=typeof ArrayBuffer=="function",oe=(r,t)=>{if(typeof r!="string")return{type:"message",data:Ve(r,t)};const e=r.charAt(0);return e==="b"?{type:"message",data:Us(r.substring(1),t)}:Bt[e]?r.length>1?{type:Bt[e],data:r.substring(1)}:{type:Bt[e]}:Jt},Us=(r,t)=>{if(Vs){const e=qs(r);return Ve(e,t)}else return{base64:!0,data:r}},Ve=(r,t)=>{switch(t){case"blob":return r instanceof Blob?r:new Blob([r]);case"arraybuffer":default:return r instanceof ArrayBuffer?r:r.buffer}},Ue="",zs=(r,t)=>{const e=r.length,s=new Array(e);let n=0;r.forEach((i,a)=>{ae(i,!1,o=>{s[a]=o,++n===e&&t(s.join(Ue))})})},Ys=(r,t)=>{const e=r.split(Ue),s=[];for(let n=0;n<e.length;n++){const i=oe(e[n],t);if(s.push(i),i.type==="error")break}return s};function Hs(){return new TransformStream({transform(r,t){Ms(r,e=>{const s=e.length;let n;if(s<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,s);else if(s<65536){n=new Uint8Array(3);const i=new DataView(n.buffer);i.setUint8(0,126),i.setUint16(1,s)}else{n=new Uint8Array(9);const i=new DataView(n.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(s))}r.data&&typeof r.data!="string"&&(n[0]|=128),t.enqueue(n),t.enqueue(e)})}})}let Ht;function jt(r){return r.reduce((t,e)=>t+e.length,0)}function Rt(r,t){if(r[0].length===t)return r.shift();const e=new Uint8Array(t);let s=0;for(let n=0;n<t;n++)e[n]=r[0][s++],s===r[0].length&&(r.shift(),s=0);return r.length&&s<r[0].length&&(r[0]=r[0].slice(s)),e}function Ws(r,t){Ht||(Ht=new TextDecoder);const e=[];let s=0,n=-1,i=!1;return new TransformStream({transform(a,o){for(e.push(a);;){if(s===0){if(jt(e)<1)break;const l=Rt(e,1);i=(l[0]&128)===128,n=l[0]&127,n<126?s=3:n===126?s=1:s=2}else if(s===1){if(jt(e)<2)break;const l=Rt(e,2);n=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),s=3}else if(s===2){if(jt(e)<8)break;const l=Rt(e,8),d=new DataView(l.buffer,l.byteOffset,l.length),h=d.getUint32(0);if(h>Math.pow(2,21)-1){o.enqueue(Jt);break}n=h*Math.pow(2,32)+d.getUint32(4),s=3}else{if(jt(e)<n)break;const l=Rt(e,n);o.enqueue(oe(i?l:Ht.decode(l),t)),s=0}if(n===0||n>r){o.enqueue(Jt);break}}}})}const ze=4;function $(r){if(r)return Ks(r)}function Ks(r){for(var t in $.prototype)r[t]=$.prototype[t];return r}$.prototype.on=$.prototype.addEventListener=function(r,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(t),this};$.prototype.once=function(r,t){function e(){this.off(r,e),t.apply(this,arguments)}return e.fn=t,this.on(r,e),this};$.prototype.off=$.prototype.removeListener=$.prototype.removeAllListeners=$.prototype.removeEventListener=function(r,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+r];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var s,n=0;n<e.length;n++)if(s=e[n],s===t||s.fn===t){e.splice(n,1);break}return e.length===0&&delete this._callbacks["$"+r],this};$.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+r],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(e){e=e.slice(0);for(var s=0,n=e.length;s<n;++s)e[s].apply(this,t)}return this};$.prototype.emitReserved=$.prototype.emit;$.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};$.prototype.hasListeners=function(r){return!!this.listeners(r).length};const It=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0),K=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Xs="arraybuffer";function Ye(r,...t){return t.reduce((e,s)=>(r.hasOwnProperty(s)&&(e[s]=r[s]),e),{})}const Js=K.setTimeout,Qs=K.clearTimeout;function Mt(r,t){t.useNativeTimers?(r.setTimeoutFn=Js.bind(K),r.clearTimeoutFn=Qs.bind(K)):(r.setTimeoutFn=K.setTimeout.bind(K),r.clearTimeoutFn=K.clearTimeout.bind(K))}const Gs=1.33;function Zs(r){return typeof r=="string"?tr(r):Math.ceil((r.byteLength||r.size)*Gs)}function tr(r){let t=0,e=0;for(let s=0,n=r.length;s<n;s++)t=r.charCodeAt(s),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(s++,e+=4);return e}function He(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function er(r){let t="";for(let e in r)r.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(r[e]));return t}function sr(r){let t={},e=r.split("&");for(let s=0,n=e.length;s<n;s++){let i=e[s].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class rr extends Error{constructor(t,e,s){super(t),this.description=e,this.context=s,this.type="TransportError"}}class le extends ${constructor(t){super(),this.writable=!1,Mt(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,s){return super.emitReserved("error",new rr(t,e,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=oe(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const e=er(t);return e.length?"?"+e:""}}class nr extends le{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||e()})),this.writable||(s++,this.once("drain",function(){--s||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const e=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};Ys(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,zs(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=He()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(t,e)}}let We=!1;try{We=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const ir=We;function ar(){}class or extends nr{constructor(t){if(super(t),typeof location<"u"){const e=location.protocol==="https:";let s=location.port;s||(s=e?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||s!==t.port}}doWrite(t,e){const s=this.request({method:"POST",data:t});s.on("success",e),s.on("error",(n,i)=>{this.onError("xhr post error",n,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,s)=>{this.onError("xhr poll error",e,s)}),this.pollXhr=t}}class st extends ${constructor(t,e,s){super(),this.createRequest=t,Mt(this,s),this._opts=s,this._method=s.method||"GET",this._uri=e,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var t;const e=Ye(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(e);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let n in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(n)&&s.setRequestHeader(n,this._opts.extraHeaders[n])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var n;s.readyState===3&&((n=this._opts.cookieJar)===null||n===void 0||n.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(n){this.setTimeoutFn(()=>{this._onError(n)},0);return}typeof document<"u"&&(this._index=st.requestsCount++,st.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=ar,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete st.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}st.requestsCount=0;st.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Ae);else if(typeof addEventListener=="function"){const r="onpagehide"in K?"pagehide":"unload";addEventListener(r,Ae,!1)}}function Ae(){for(let r in st.requests)st.requests.hasOwnProperty(r)&&st.requests[r].abort()}const lr=function(){const r=Ke({xdomain:!1});return r&&r.responseType!==null}();class cr extends or{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=lr&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new st(Ke,this.uri(),t)}}function Ke(r){const t=r.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||ir))return new XMLHttpRequest}catch{}if(!t)try{return new K[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Xe=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class hr extends le{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,s=Xe?{}:Ye(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,s)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],n=e===t.length-1;ae(s,this.supportsBinary,i=>{try{this.doWrite(s,i)}catch{}n&&It(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=He()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const Wt=K.WebSocket||K.MozWebSocket;class ur extends hr{createSocket(t,e,s){return Xe?new Wt(t,e,s):e?new Wt(t,e):new Wt(t)}doWrite(t,e){this.ws.send(e)}}class dr extends le{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const e=Ws(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=t.readable.pipeThrough(e).getReader(),n=Hs();n.readable.pipeTo(t.writable),this._writer=n.writable.getWriter();const i=()=>{s.read().then(({done:o,value:l})=>{o||(this.onPacket(l),i())}).catch(o=>{})};i();const a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],n=e===t.length-1;this._writer.write(s).then(()=>{n&&It(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const fr={websocket:ur,webtransport:dr,polling:cr},pr=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,vr=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Qt(r){if(r.length>8e3)throw"URI too long";const t=r,e=r.indexOf("["),s=r.indexOf("]");e!=-1&&s!=-1&&(r=r.substring(0,e)+r.substring(e,s).replace(/:/g,";")+r.substring(s,r.length));let n=pr.exec(r||""),i={},a=14;for(;a--;)i[vr[a]]=n[a]||"";return e!=-1&&s!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=mr(i,i.path),i.queryKey=_r(i,i.query),i}function mr(r,t){const e=/\/{2,9}/g,s=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&s.splice(0,1),t.slice(-1)=="/"&&s.splice(s.length-1,1),s}function _r(r,t){const e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,n,i){n&&(e[n]=i)}),e}const Gt=typeof addEventListener=="function"&&typeof removeEventListener=="function",Nt=[];Gt&&addEventListener("offline",()=>{Nt.forEach(r=>r())},!1);class lt extends ${constructor(t,e){if(super(),this.binaryType=Xs,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(e=t,t=null),t){const s=Qt(t);e.hostname=s.host,e.secure=s.protocol==="https"||s.protocol==="wss",e.port=s.port,s.query&&(e.query=s.query)}else e.host&&(e.hostname=Qt(e.host).host);Mt(this,e),this.secure=e.secure!=null?e.secure:typeof location<"u"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach(s=>{const n=s.prototype.name;this.transports.push(n),this._transportsByName[n]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=sr(this.opts.query)),Gt&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Nt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=ze,e.transport=t,this.id&&(e.sid=this.id);const s=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&lt.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",lt.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let s=0;s<this.writeBuffer.length;s++){const n=this.writeBuffer[s].data;if(n&&(e+=Zs(n)),s>0&&e>this._maxPayload)return this.writeBuffer.slice(0,s);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,It(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,e,s){return this._sendPacket("message",t,e,s),this}send(t,e,s){return this._sendPacket("message",t,e,s),this}_sendPacket(t,e,s,n){if(typeof e=="function"&&(n=e,e=void 0),typeof s=="function"&&(n=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const i={type:t,data:e,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},s=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}_onError(t){if(lt.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Gt&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=Nt.indexOf(this._offlineEventListener);s!==-1&&Nt.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}lt.protocol=ze;class gr extends lt{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),s=!1;lt.priorWebsocketSuccess=!1;const n=()=>{s||(e.send([{type:"ping",data:"probe"}]),e.once("packet",f=>{if(!s)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;lt.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(h(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const u=new Error("probe error");u.transport=e.name,this.emitReserved("upgradeError",u)}}))};function i(){s||(s=!0,h(),e.close(),e=null)}const a=f=>{const u=new Error("probe error: "+f);u.transport=e.name,i(),this.emitReserved("upgradeError",u)};function o(){a("transport closed")}function l(){a("socket closed")}function d(f){e&&f.name!==e.name&&i()}const h=()=>{e.removeListener("open",n),e.removeListener("error",a),e.removeListener("close",o),this.off("close",l),this.off("upgrading",d)};e.once("open",n),e.once("error",a),e.once("close",o),this.once("close",l),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{s||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let s=0;s<t.length;s++)~this.transports.indexOf(t[s])&&e.push(t[s]);return e}}let yr=class extends gr{constructor(t,e={}){const s=typeof t=="object"?t:e;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(n=>fr[n]).filter(n=>!!n)),super(t,s)}};function xr(r,t="",e){let s=r;e=e||typeof location<"u"&&location,r==null&&(r=e.protocol+"//"+e.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=e.protocol+r:r=e.host+r),/^(https?|wss?):\/\//.test(r)||(typeof e<"u"?r=e.protocol+"//"+r:r="https://"+r),s=Qt(r)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const i=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+t,s.href=s.protocol+"://"+i+(e&&e.port===s.port?"":":"+s.port),s}const br=typeof ArrayBuffer=="function",wr=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,Je=Object.prototype.toString,kr=typeof Blob=="function"||typeof Blob<"u"&&Je.call(Blob)==="[object BlobConstructor]",Er=typeof File=="function"||typeof File<"u"&&Je.call(File)==="[object FileConstructor]";function ce(r){return br&&(r instanceof ArrayBuffer||wr(r))||kr&&r instanceof Blob||Er&&r instanceof File}function Dt(r,t){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let e=0,s=r.length;e<s;e++)if(Dt(r[e]))return!0;return!1}if(ce(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return Dt(r.toJSON(),!0);for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e)&&Dt(r[e]))return!0;return!1}function Tr(r){const t=[],e=r.data,s=r;return s.data=Zt(e,t),s.attachments=t.length,{packet:s,buffers:t}}function Zt(r,t){if(!r)return r;if(ce(r)){const e={_placeholder:!0,num:t.length};return t.push(r),e}else if(Array.isArray(r)){const e=new Array(r.length);for(let s=0;s<r.length;s++)e[s]=Zt(r[s],t);return e}else if(typeof r=="object"&&!(r instanceof Date)){const e={};for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=Zt(r[s],t));return e}return r}function Ar(r,t){return r.data=te(r.data,t),delete r.attachments,r}function te(r,t){if(!r)return r;if(r&&r._placeholder===!0){if(typeof r.num=="number"&&r.num>=0&&r.num<t.length)return t[r.num];throw new Error("illegal attachments")}else if(Array.isArray(r))for(let e=0;e<r.length;e++)r[e]=te(r[e],t);else if(typeof r=="object")for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&(r[e]=te(r[e],t));return r}const Cr=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Sr=5;var S;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(S||(S={}));class jr{constructor(t){this.replacer=t}encode(t){return(t.type===S.EVENT||t.type===S.ACK)&&Dt(t)?this.encodeAsBinary({type:t.type===S.EVENT?S.BINARY_EVENT:S.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===S.BINARY_EVENT||t.type===S.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=Tr(t),s=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(s),n}}function Ce(r){return Object.prototype.toString.call(r)==="[object Object]"}class he extends ${constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const s=e.type===S.BINARY_EVENT;s||e.type===S.BINARY_ACK?(e.type=s?S.EVENT:S.ACK,this.reconstructor=new Rr(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(ce(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0;const s={type:Number(t.charAt(0))};if(S[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===S.BINARY_EVENT||s.type===S.BINARY_ACK){const i=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);const a=t.substring(i,e);if(a!=Number(a)||t.charAt(e)!=="-")throw new Error("Illegal attachments");s.attachments=Number(a)}if(t.charAt(e+1)==="/"){const i=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););s.nsp=t.substring(i,e)}else s.nsp="/";const n=t.charAt(e+1);if(n!==""&&Number(n)==n){const i=e+1;for(;++e;){const a=t.charAt(e);if(a==null||Number(a)!=a){--e;break}if(e===t.length)break}s.id=Number(t.substring(i,e+1))}if(t.charAt(++e)){const i=this.tryParse(t.substr(e));if(he.isPayloadValid(s.type,i))s.data=i;else throw new Error("invalid payload")}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case S.CONNECT:return Ce(e);case S.DISCONNECT:return e===void 0;case S.CONNECT_ERROR:return typeof e=="string"||Ce(e);case S.EVENT:case S.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&Cr.indexOf(e[0])===-1);case S.ACK:case S.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Rr{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const e=Ar(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Or=Object.freeze(Object.defineProperty({__proto__:null,Decoder:he,Encoder:jr,get PacketType(){return S},protocol:Sr},Symbol.toStringTag,{value:"Module"}));function G(r,t,e){return r.on(t,e),function(){r.off(t,e)}}const Lr=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});let Qe=class extends ${constructor(t,e,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[G(t,"open",this.onopen.bind(this)),G(t,"packet",this.onpacket.bind(this)),G(t,"error",this.onerror.bind(this)),G(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var s,n,i;if(Lr.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const a={type:S.EVENT,data:e};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const h=this.ids++,f=e.pop();this._registerAckCallback(h,f),a.id=h}const o=(n=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||n===void 0?void 0:n.writable,l=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!o||(l?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(t,e){var s;const n=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(n===void 0){this.acks[t]=e;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===t&&this.sendBuffer.splice(o,1);e.call(this,new Error("operation has timed out"))},n),a=(...o)=>{this.io.clearTimeoutFn(i),e.apply(this,o)};a.withError=!0,this.acks[t]=a}emitWithAck(t,...e){return new Promise((s,n)=>{const i=(a,o)=>a?n(a):s(o);i.withError=!0,e.push(i),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((n,...i)=>s!==this._queue[0]?void 0:(n!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(n)):(this._queue.shift(),e&&e(null,...i)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:S.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(s=>String(s.id)===t)){const s=this.acks[t];delete this.acks[t],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case S.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case S.EVENT:case S.BINARY_EVENT:this.onevent(t);break;case S.ACK:case S.BINARY_ACK:this.onack(t);break;case S.DISCONNECT:this.ondisconnect();break;case S.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data,this.emitReserved("connect_error",s);break}}onevent(t){const e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const s of e)s.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let s=!1;return function(...n){s||(s=!0,e.packet({type:S.ACK,id:t,data:n}))}}onack(t){const e=this.acks[t.id];typeof e=="function"&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:S.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const s of e)s.apply(this,t.data)}}};function gt(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}gt.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*r);r=Math.floor(t*10)&1?r+e:r-e}return Math.min(r,this.max)|0};gt.prototype.reset=function(){this.attempts=0};gt.prototype.setMin=function(r){this.ms=r};gt.prototype.setMax=function(r){this.max=r};gt.prototype.setJitter=function(r){this.jitter=r};class ee extends ${constructor(t,e){var s;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,Mt(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((s=e.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new gt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;const n=e.parser||Or;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new yr(this.uri,this.opts);const e=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const n=G(e,"open",function(){s.onopen(),t&&t()}),i=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),t?t(o):this.maybeReconnectOnOpen()},a=G(e,"error",i);if(this._timeout!==!1){const o=this._timeout,l=this.setTimeoutFn(()=>{n(),i(new Error("timeout")),e.close()},o);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(n),this.subs.push(a),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(G(t,"ping",this.onping.bind(this)),G(t,"data",this.ondata.bind(this)),G(t,"error",this.onerror.bind(this)),G(t,"close",this.onclose.bind(this)),G(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){It(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let s=this.nsps[t];return s?this._autoConnect&&!s.active&&s.connect():(s=new Qe(this,t,e),this.nsps[t]=s),s}_destroy(t){const e=Object.keys(this.nsps);for(const s of e)if(this.nsps[s].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let s=0;s<e.length;s++)this.engine.write(e[s],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(n=>{n?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",n)):t.onreconnect()}))},e);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const xt={};function kt(r,t){typeof r=="object"&&(t=r,r=void 0),t=t||{};const e=xr(r,t.path||"/socket.io"),s=e.source,n=e.id,i=e.path,a=xt[n]&&i in xt[n].nsps,o=t.forceNew||t["force new connection"]||t.multiplex===!1||a;let l;return o?l=new ee(s,t):(xt[n]||(xt[n]=new ee(s,t)),l=xt[n]),e.query&&!t.query&&(t.query=e.queryKey),l.socket(e.path,t)}Object.assign(kt,{Manager:ee,Socket:Qe,io:kt,connect:kt});class Br{constructor(){if(this.enabled=!1,typeof kt=="function"){const t=location.origin;this.socket=kt(t),this.socket&&(this.socket.on("connect",()=>{this.enabled=!0,console.log("Connected to websocket Obelix 1.0")}),this.socket.on("update_settings",e=>{console.log("SOCKETio",e),typeof e=="object"&&!Array.isArray(e)&&e!==null&&ie.update(s=>({...s,...e}))}))}}destroy(){this.socket.offAny(),this.socket.disconnect()}emit(t){this.enabled&&this.socket.emit("message",t)}emitReply(t,e){this.enabled&&(console.log("emitReply"),this.socket.emit("message_reply",t,(s,n)=>{console.log("emitReply response",s,n),typeof e=="function"&&e(n)}))}}const Ge=new Br;function J(r,t){Ge.emit({get:"foo"});const e=location.origin;fetch(e+r).then(s=>s.json()).then(s=>{typeof t=="function"&&t(s)})}function ue(r,t,e){Ge.emitReply({post:"foo"},e);const s=location.origin;fetch(s+r,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(n=>n.json()).then(n=>{e&&e(n)})}class Nr{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=200,this.deadZone=8,this.active=!1,this.value={x:0,y:0},this.counter=0,this.prev={x:0,y:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",s=>{this._handleDown(s)}),this.stick.addEventListener("touchstart",s=>{this._handleDown(s)}),document.addEventListener("mousemove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("touchmove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("mouseup",s=>{this._handleUp(s)}),document.addEventListener("touchend",s=>{this._handleUp(s)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.clientX,y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;let e=null;if(t.changedTouches){for(let E=0;E<t.changedTouches.length;E++)this.touchId===t.changedTouches[E].identifier&&(e=E,t.clientX=t.changedTouches[E].clientX,t.clientY=t.changedTouches[E].clientY);if(e==null)return}const s=this.stick.getBoundingClientRect(),n=s?Math.round(16e3/s.width)/100:1,i=t.clientX-this.dragStart.x,a=t.clientY-this.dragStart.y,o=Math.atan2(a,i),l=Math.min(this.maxDistance,Math.hypot(i,a)*n),d=l*Math.cos(o),h=l*Math.sin(o);this.stick.style.transform=`translate(${d}px, ${h}px)`;const f=l<this.deadZone?0:this.maxDistance/(this.maxDistance-this.deadZone)*(l-this.deadZone),u=f*Math.cos(o),_=f*Math.sin(o),p=parseFloat((u/this.maxDistance).toFixed(4)),j=parseFloat((_/this.maxDistance).toFixed(4));this.value={x:p,y:j},this._loop()}_handleUp(t){this.active&&(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier||(this.stick.style.transition=".2s",this.stick.style.transform="translate3d(0px, 0px, 0px)",this.value={x:0,y:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5+this.value.x*511.5),e=Math.round(511.5+this.value.y*511.5);this.callback(`/joystick/${t}/${e}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){(this.value.x!==this.prev.x||this.value.y!==this.prev.y)&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}class Dr{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=230,this.deadZone=8,this.active=!1,this.value={f:0},this.counter=0,this.prev={f:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",s=>{this._handleDown(s)}),this.stick.addEventListener("touchstart",s=>{this._handleDown(s)}),document.addEventListener("mousemove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("touchmove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("mouseup",s=>{this._handleUp(s)}),document.addEventListener("touchend",s=>{this._handleUp(s)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{y:t.changedTouches[0].clientY}:{y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;t.preventDefault();let e=null;if(t.changedTouches){for(let l=0;l<t.changedTouches.length;l++)this.touchId===t.changedTouches[l].identifier&&(e=l,t.clientY=t.changedTouches[l].clientY);if(e==null)return}const s=this.stick.getBoundingClientRect(),n=s?Math.round(1e4/s.width)/100:1,i=t.clientY-this.dragStart.y,a=i>=0?Math.min(this.maxDistance,i*n):Math.max(-this.maxDistance,i*n);this.stick.style.transform=`translateY(${a}px)`;const o=Math.abs(a)>this.deadZone?parseFloat((a/this.maxDistance).toFixed(4)):0;this.value={f:o},this._loop()}_handleUp(t){this.active&&(t.preventDefault(),!(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier)&&(this.stick.style.transition=".2s",this.stick.style.transform="translateY(0px)",this.value={f:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5-this.value.f*511.5);this.callback(`/focus/${t}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){this.value.f!==this.prev.f&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}var Pr=Ft('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-8uha02"><defs><circle id="joys-def-cir1" r="280" cy="0"></circle><circle id="joys-def-cir2" r="80" cy="0"></circle><path id="joys-def-arrow" d="M0 -120 -40 -100 40 -100z"></path><rect id="joys-def-slider" width="70" height="560" transform="translate(350 -280)" rx="15" ry="15"></rect><rect id="joys-def-slide" width="100" height="100" transform="translate(335 -50)" rx="15" ry="15"></rect></defs><g id="joys" transform="translate(320 355)" class="svelte-8uha02"><use id="joys-plate" href="#joys-def-cir1" class="svelte-8uha02"></use><use id="joys-arrow-top" href="#joys-def-arrow" class="svelte-8uha02"></use><use id="joys-arrow-right" href="#joys-def-arrow" transform="rotate(90)" class="svelte-8uha02"></use><use id="joys-arrow-left" href="#joys-def-arrow" transform="rotate(-90)" class="svelte-8uha02"></use><use id="joys-arrow-bottom" href="#joys-def-arrow" transform="rotate(180)" class="svelte-8uha02"></use><use id="joys-stick" href="#joys-def-cir2" style="transform: translate(0px, 0px)" class="svelte-8uha02"></use><use id="joys-slider" href="#joys-def-slider" class="svelte-8uha02"></use><use id="joys-slide" href="#joys-def-slide" style="transform: translateY(0px)" class="svelte-8uha02"></use><a href="#toggle" role="button" tabindex="0" aria-label="Change to adjustment tool"><g id="joys-swap" transform="translate(-250,250)" class="svelte-8uha02"><circle class="element svelte-8uha02" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M6.121 13c-.553 0-1 .448-1 1s.447 1 1 1h1.465l-3.293 3.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.414-3.414v1.707c0 .552.447 1 1 1s.879-.448.879-1v-5h-4.879zM7 11c.552 0 1-.448 1-1v-2h2c.553 0 1-.448 1-1s-.447-1-1-1h-3.999l-.001 4c0 .552.447 1 1 1zM17 13c-.553 0-1 .448-1 1v2h-2c-.553 0-1 .448-1 1s.447 1 1 1h4v-4c0-.552-.447-1-1-1zM18.293 4.293l-3.293 3.293v-1.586c0-.552-.447-1-1-1s-1 .448-1 1v5h5c.552 0 1-.448 1-1s-.447-1-1-1h-1.586l3.293-3.292c.391-.391.391-1.023 0-1.414s-1.023-.392-1.414-.001z" class="svelte-8uha02"></path></g></g></a></g></svg>');function $r(r,t){U(t,!0);let e=null,s=null;Tt(()=>{e=new Nr(document.getElementById("joys-stick"),o=>{J(o,l=>{console.log("SVELTE Joystick",l)})}),s=new Dr(document.getElementById("joys-slide"),o=>{J(o,l=>{console.log("SVELTE Focus",l)})})}),nt(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy(),s&&s.hasOwnProperty("destroy")&&s.destroy()});var n=Pr(),i=b(m(n)),a=b(m(i),8);a.__click=function(...o){var l;(l=t.toggle)==null||l.apply(this,o)},v(i),v(n),T(r,n),z()}tt(["click"]);class Fr{constructor(t,e){if(this.adjust=t,this.adjust){this.callback=e;const s=8e4/360;this.axisSteps={lg:Math.round(s),md:Math.round(s/10),sm:Math.round(s/100)},this.adjust.addEventListener("mouseup",n=>{this.sendCommand(n.target.dataset)})}}destroy(){this.adjust.removeEventListener("mouseup",t=>{this.sendCommand(t.target.dataset)})}sendCommand(t){let e=t==null?void 0:t.dir,s=t==null?void 0:t.len;e&&s&&typeof this.axisSteps[s]=="number"&&(s=this.axisSteps[s],["closer","further"].indexOf(e)>=0&&(s=e==="closer"?-s:s,e="focus"),this.callback(`/adjust/${e}/${s}`))}}var Ir=Ft('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-1d0wo2a"><defs><path id="arr1" d="M45 45 5 45 10 95 95 95 95 10 45 5z"></path><path id="arr2" d="M105 105 11 105 17 165 165 165 165 17 105 11z"></path><path id="arr3" d="M175 175 18 175 25 245 245 245 245 25 175 18z"></path><circle id="cir1" r="44" cy="73"></circle><path id="cir2" d="M-54 73 A 75 75 0 1 0 54 73 A 54 54 0 0 1 -54 73z"></path><path id="cir3" d="M-85 125 A 108 108 0 1 0 85 125 A 54 54 0 0 1 -85 125z"></path></defs><g id="adjust" transform="translate(355 355)" class="svelte-1d0wo2a"><g transform="rotate(135)"><use href="#arr1" data-dir="left" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="left" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="left" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="rotate(-45)"><use href="#arr1" data-dir="right" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="right" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="right" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="rotate(-135)"><use href="#arr1" data-dir="up" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="up" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="up" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="rotate(45)"><use href="#arr1" data-dir="down" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="down" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="down" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="translate(360 -50) rotate(165)"><use href="#cir1" data-dir="further" data-len="sm" class="svelte-1d0wo2a"></use><use href="#cir2" data-dir="further" data-len="md" class="svelte-1d0wo2a"></use><use href="#cir3" data-dir="further" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="translate(360 50) rotate(15)"><use href="#cir1" data-dir="closer" data-len="sm" class="svelte-1d0wo2a"></use><use href="#cir2" data-dir="closer" data-len="md" class="svelte-1d0wo2a"></use><use href="#cir3" data-dir="closer" data-len="lg" class="svelte-1d0wo2a"></use></g><a href="#toggle" role="button" tabindex="0" aria-label="Change to Joystick"><g id="joys-swap" transform="translate(-285,250)" class="svelte-1d0wo2a"><circle class="element svelte-1d0wo2a" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M17.707 8.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l1.293 1.293h-4.586v-4.586l1.293 1.293c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-3.707-3.707-3.707 3.707c-.391.391-.391 1.023 0 1.414s1.023.391 1.414 0l1.293-1.293v4.586h-4.586l1.293-1.293c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-3.707 3.707 3.707 3.707c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-1.293-1.293h4.586v4.586l-1.293-1.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l3.707 3.707 3.707-3.707c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-1.293 1.293v-4.586h4.586l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707z" class="svelte-1d0wo2a"></path></g></g></a></g></svg>');function Mr(r,t){U(t,!0);let e=null;Tt(()=>{e=new Fr(document.getElementById("adjust"),a=>{J(a,o=>{console.log("SVELTE Adjust",o)})})}),nt(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy()});var s=Ir(),n=b(m(s)),i=b(m(n),6);i.__click=function(...a){var o;(o=t.toggle)==null||o.apply(this,a)},v(n),v(s),T(r,s),z()}tt(["click"]);var qr=L('<div class="joystick-wrapper svelte-gruxg2"><!></div>');function Vr(r){let t=D("mov");const e=i=>{i.preventDefault(),A(t,V(c(t)==="mov"?"adj":"mov"))};var s=qr(),n=m(s);I(n,()=>c(t)==="mov",i=>{$r(i,{toggle:e})},i=>{Mr(i,{toggle:e})}),v(s),T(r,s)}function se(r){return typeof r=="string"?r.toLowerCase().trim().replaceAll("ä","ae").replaceAll("ö","oe").replaceAll("ü","ue").replaceAll("ß","ss").replace(/\W+/g,"_").replace(/^_|_$/g,""):null}const Se={fid:"",geo:{addr:"",lat:53.6,lon:9.9},base:[{id:"home",name:"Primary target",pos:{x:-23900,y:0,f:500}},{id:"polaris",name:"Polaris",pos:{x:0,y:11912,f:600}}]};function Ur(r,t){const e={...Se.geo,addr:t},s=[];for(let n of Se.base)s.push({...n,pos:{...n.pos}});return{fid:r,geo:e,base:s}}var zr=(r,t)=>{A(t,!1)},Yr=L('<header><input type="text" id="address" placeholder="Address"></header> <div class="flexbox"><input type="text" id="latitude" placeholder="Latitude"> <input type="text" id="longitude" placeholder="Longitude"></div> <button class="button button-small">Save location</button> <button class="button">Cancel</button>',1),Hr=(r,t)=>{A(t,!0)},Wr=L('<header> <button class="edit-button icon-edit" aria-label="Edit"></button></header>'),Kr=L("<div> </div>"),Xr=L("<!> <!>",1),Jr=(r,t,e)=>t(r,`/navi/position/${c(e).id}`),Qr=(r,t,e)=>t(c(e).id),Gr=L('<button class="delete-button icon-delete" aria-label="Delete" title="Delete"></button>'),Zr=L("<li><button> </button> <!></li>"),tn=L('<div class="nav-add"><label for="new-name">Save/update current position as ...</label> <input type="text" id="new-name" class="input" placeholder="Enter position name"> <div class="margin-bottom"><sub> </sub></div> <button class="button button-small">Save target</button></div>'),en=L('<div class="nav-selector"><button class="button button-small">Change location</button></div>'),sn=L('<div class="content-card"><div class="nav-curr-pos"><!></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function rn(r,t){U(t,!0);const e=ft(),s=()=>ct(et,"$positions",e),n=()=>ct(ie,"$arduinoSettings",e);let i=D(!1),a=D(""),o=Pt(()=>se(c(a))),l=D(""),d=D(""),h=D(""),f=D(V([]));const u=et.subscribe(k=>{k!=null&&k.fid&&(A(l,V(k.geo.addr)),A(d,V(k.geo.lat)),A(h,V(k.geo.lon)),A(f,V([...k.base])))});nt(()=>{u&&u()});const _=()=>{const k={...s()};ue(`/navi/position/update/${k.fid}`,k,C=>{console.log("SVELTE saved",C)})},p=()=>{const k={addr:c(l),lat:parseFloat(c(d)),lon:parseFloat(c(h))};et.update(C=>({...C,geo:k})),_(),A(i,!1)},j=()=>{const k=se(c(a));if(k){let C=!1;const O=(({x:B,y:P,f:F})=>({x:B,y:P,f:F}))(n());let N=c(f).map(B=>B.id!==k?B:(C=!0,{...B,pos:O}));C||N.push({id:k,name:c(a),pos:O}),et.update(B=>({...B,base:N})),_(),A(a,"")}A(i,!1)},E=k=>k==="home"?"icon-home":k==="polaris"?"icon-star":"icon-target",R=k=>{if(confirm(`Do you really want to delete position: "${k}"`)){const C=[...s().base].filter(O=>O.id!==k);et.update(O=>({...O,base:C})),_(),A(i,!1)}},w=(k,C)=>{k.preventDefault(),J(C,O=>{console.log("SVELTE position",O)})};var x=sn(),g=m(x),y=m(g);I(y,()=>c(i),k=>{var C=Yr(),O=it(C),N=m(O);vt(N),v(O);var B=b(O,2),P=m(B);vt(P);var F=b(P,2);vt(F),v(B);var Q=b(B,2);Q.__click=p;var ut=b(Q,2);ut.__click=[zr,i],mt(N,()=>c(l),at=>A(l,at)),mt(P,()=>c(d),at=>A(d,at)),mt(F,()=>c(h),at=>A(h,at)),T(k,C)},k=>{var C=Xr(),O=it(C);I(O,()=>c(l),B=>{var P=Wr(),F=m(P),Q=b(F);Q.__click=[Hr,i],v(P),X(()=>Z(F,`${c(l)??""} `)),T(B,P)});var N=b(O,2);I(N,()=>c(d)&&c(h),B=>{var P=Kr(),F=m(P);v(P),X(()=>Z(F,`${c(d)??""}°, ${c(h)??""}°`)),T(B,P)}),T(k,C)}),v(g);var M=b(g,2),Y=m(M);_t(Y,21,()=>c(f),Et,(k,C)=>{var O=Zr(),N=m(O);const B=Pt(()=>`nav-button ${E(c(C).id)??""}`);N.__click=[Jr,w,C];var P=m(N,!0);v(N);var F=b(N,2);I(F,()=>c(i)&&c(C).id!=="home"&&c(C).id!=="polaris",Q=>{var ut=Gr();ut.__click=[Qr,R,C],T(Q,ut)}),v(O),X(()=>{dt(N,c(B)),Z(P,c(C).name)}),T(k,O)}),v(Y),v(M);var q=b(M,2);I(q,()=>c(i),k=>{var C=tn(),O=b(m(C),2);vt(O);var N=b(O,2),B=m(N),P=m(B);v(B),v(N);var F=b(N,2);F.__click=j,v(C),X(()=>{Z(P,`ID: ${c(o)??""}`),F.disabled=c(o).length<3}),mt(O,()=>c(a),Q=>A(a,Q)),T(k,C)},k=>{var C=en(),O=m(C);O.__click=function(...N){var B;(B=t.toggleAdmin)==null||B.apply(this,N)},v(C),T(k,C)}),v(x),T(r,x),z()}tt(["click"]);const nn=(r,t)=>{A(t,!c(t))};var an=(r,t,e)=>t(c(e).fid),on=(r,t,e)=>t(c(e).fid),ln=L('<button class="delete-button icon-delete" aria-label="Delete"></button>'),cn=L('<li><button class="nav-button icon-location"> </button> <!></li>'),hn=(r,t)=>t(),un=L('<div class="nav-add"><input type="text" id="new-location" class="input" placeholder="Enter new location name"> <button class="button">+&nbsp;Add</button></div> <div> </div>',1),dn=L('<div class="nav-selector"><button class="button button-small">&laquo;&nbsp;Back</button></div>'),fn=L('<div class="content-card"><header>Locations <button aria-label="Edit"></button></header> <div class="nav-curr-pos"><div><p>The location is the place where your telescope is placed.</p></div></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function pn(r,t){U(t,!0);const e=ft(),s=()=>ct(St,"$locations",e);let n=D("");const i=et.subscribe(w=>{A(n,V(w.fid))});nt(()=>{i&&i()});let a=D(!1),o=D(""),l=Pt(()=>se(c(o)));const d=w=>{w!==c(n)&&J(`/navi/location/${w}`,x=>{(x==null?void 0:x.fid)===w&&(et.update(g=>({...x})),console.log("Loaded location"))})},h=()=>{if(c(l).length>=3){const w=Ur(c(l),c(o));ue(`/navi/position/update/${c(l)}`,w,x=>{et.update(g=>w),St.update(g=>[...g,{fid:c(l),addr:c(o)}]),A(o,""),console.log("Added new location",x)})}else console.error("ID is too short. At least 3 char are required.")},f=w=>{confirm(`Do you really want to delete location: "${w}"`)?J(`/navi/location/delete/${w}`,x=>{x.response===200&&(St.update(g=>g.filter(y=>y.fid!==w)),alert(`Location "${w}" deleted`))}):alert(`Deletion of "${w}" canceled.`)};Tt(()=>{s().length===0&&J("/navi/location-list",w=>{St.update(x=>[...w]),console.log("Loaded location list")})});var u=fn(),_=m(u),p=b(m(_));p.__click=[nn,a],v(_);var j=b(_,4),E=m(j);_t(E,5,s,Et,(w,x)=>{var g=cn(),y=m(g);y.__click=[an,d,x];var M=m(y,!0);v(y);var Y=b(y,2);I(Y,()=>c(a)&&c(x).fid!==c(n)&&c(x).fid!=="index",q=>{var k=ln();k.__click=[on,f,x],T(q,k)}),v(g),X(()=>{dt(g,c(x).fid===c(n)?"active":""),Z(M,c(x).addr)}),T(w,g)}),v(E),v(j);var R=b(j,2);I(R,()=>c(a),w=>{var x=un(),g=it(x),y=m(g);vt(y);var M=b(y,2);M.__click=[hn,h],v(g);var Y=b(g,2),q=m(Y,!0);v(Y),X(()=>Z(q,c(l))),mt(y,()=>c(o),k=>A(o,k)),T(w,x)},w=>{var x=dn(),g=m(x);g.__click=function(...y){var M;(M=t.toggleAdmin)==null||M.apply(this,y)},v(x),T(w,x)}),v(u),X(()=>dt(p,`edit-button icon-edit${(c(a)?" active":"")??""}`)),T(r,u),z()}tt(["click"]);function vn(r,t){U(t,!0);const e=ft(),s=()=>ct(et,"$positions",e);let n=D(!1);const i=()=>{A(n,!c(n))};Tt(()=>{var l;(l=s())!=null&&l.fid||J("/navi/location/index",d=>{(d==null?void 0:d.fid)==="index"&&et.update(h=>({...d}))})});var a=pt(),o=it(a);I(o,()=>c(n),l=>{pn(l,{toggleAdmin:i})},l=>{rn(l,{toggleAdmin:i})}),T(r,a),z()}var mn=(r,t,e)=>{t.callback(t.id,e())},_n=L('<div class="slider-wrapper svelte-1eb8x9l"><label class="svelte-1eb8x9l"> </label> <input type="range" class="svelte-1eb8x9l"></div>');function gn(r,t){U(t,!0);let e=Ct(t,"value",7,0),s=Ct(t,"minValue",3,0),n=Ct(t,"maxValue",3,10),i=Ct(t,"steps",3,1);var a=_n(),o=m(a),l=m(o,!0);v(o);var d=b(o,2);vt(d),d.__change=[mn,t,e],v(a),X(()=>{H(o,"for","slider_slide_"+t.id),Z(l,t.name),H(d,"id","slider_slide_"+t.id),H(d,"min",s()),H(d,"max",n()),H(d,"step",i())}),mt(d,e),T(r,a),z()}tt(["change"]);var yn=L('<div class="camera-options svelte-1icpkjb"><!> <div class="actions-wrapper svelte-1icpkjb"><button class="svelte-1icpkjb">Reset defaults</button></div></div>');function xn(r,t){U(t,!1);const e=ft(),s=()=>ct(zt,"$camControls",e),n=(h,f)=>{zt.update(u=>u.map(_=>_.id===h?{..._,value:f}:{..._})),J(`/cam/ctrl/${h}/${f}`,u=>{console.log("SVELTE CamCtrl",u)})},i=()=>{zt.update(f=>f.map(u=>({...u,value:u.defaultValue})));const h={};for(let f of s())f!=null&&f.id&&(h[f.id]=f.defaultValue);ue("/cam/controls",h,f=>{console.log("SVELTE Cam Controls",f)})};Ne();var a=yn(),o=m(a);_t(o,3,s,h=>h.name,(h,f,u)=>{gn(h,ks(()=>c(f),{get index(){return c(u)},callback:n}))});var l=b(o,2),d=m(l);d.__click=i,v(l),v(a),T(r,a),z()}tt(["click"]);const bn=()=>{$t.update(r=>!r)};var wn=Ft('<polygon points="-15,-15 -15,15 15,15 15,-15" stroke-width="5" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),kn=Ft('<polygon points="-7.5,-22.5 -7.5,22.5 20,0" stroke-width="10" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),En=L('<div id="video-recording" class="svelte-1utn7qk"><button aria-label="Record video" class="svelte-1utn7qk"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" preserveAspectRatio="xMinYMin slice" class="svelte-1utn7qk"><g transform="translate(42,42)"><circle r="38" fill="none" stroke="#FFF" stroke-width="5"></circle><!></g></svg></button></div>');function Tn(r,t){U(t,!0);let e=D(!1);const s=$t.subscribe(d=>{if(c(e)!==d){A(e,V(d));const h=c(e)?"start":"stop";J(`/cam/video-rec/vid/${h}`,f=>{console.log("Video recording",f)})}});nt(()=>{s&&s()});var n=En(),i=m(n);i.__click=[bn];var a=m(i),o=m(a),l=b(m(o));I(l,()=>c(e),d=>{var h=wn();T(d,h)},d=>{var h=kn();T(d,h)}),v(o),v(a),v(i),v(n),T(r,n),z()}tt(["click"]);const An=(r,t)=>{const e=t()==="B"?"cam_b":"cam_a";J(`/cam/capture-img/image/${e}`,s=>{console.log("Capture image",s)})},Cn=(r,t,e,s)=>{const n=t()==="B"?"cam_b":"cam_a";J(`/cam/snail-shot/${c(e)}/${c(s)}/${n}`,i=>{console.log("Snails",i,n)})};var Sn=(r,t)=>console.log("X:",c(t)),jn=L("<option></option>"),Rn=(r,t)=>console.log("Y:",c(t)),On=L("<option></option>"),Ln=L('<div id="image-capture" class="svelte-15orivu"><button aria-label="Capture image" class="svelte-15orivu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-15orivu"><g transform="translate(42,42)"><circle r="28" fill="#C00" stroke="#C00"></circle><circle r="38" fill="none" stroke="#FFF" stroke-width="5"></circle></g></svg></button> <button aria-label="Snail shot" class="svelte-15orivu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-15orivu"><g transform="translate(42,42)"><polyline points="0,0 20,0 20,15 -20,15 -20,-15 40,-15 40,30 -20,30 -12,28 -12,32 -20,30" style="fill:none;stroke:#FFF;stroke-width:3;stroke-linejoin:round;"></polyline></g></svg></button> <div class="dimensions svelte-15orivu"><label class="svelte-15orivu"><span class="svelte-15orivu">hor</span><select class="svelte-15orivu"></select></label> <label class="svelte-15orivu"><span class="svelte-15orivu">ver</span><select class="svelte-15orivu"></select></label></div></div>');function Bn(r,t){U(t,!0);const e=ft(),s=()=>ct(Lt,"$swapPreview",e);let n=D(3),i=D(3);var a=Ln(),o=m(a);o.__click=[An,s];var l=b(o,2);l.__click=[Cn,s,n,i];var d=b(l,2),h=m(d),f=b(m(h));f.__change=[Sn,n],_t(f,20,()=>Array.from({length:7}),Et,(p,j,E)=>{var R=jn();R.value=(R.__value=E+3)==null?"":E+3,R.textContent=E+3,T(p,R)}),v(f),v(h);var u=b(h,2),_=b(m(u));_.__change=[Rn,i],_t(_,20,()=>Array.from({length:7}),Et,(p,j,E)=>{var R=On();R.value=(R.__value=E+3)==null?"":E+3,R.textContent=E+3,T(p,R)}),v(_),v(u),v(d),v(a),we(f,()=>c(n),p=>A(n,p)),we(_,()=>c(i),p=>A(i,p)),T(r,a),z()}tt(["click","change"]);var Nn=L('<div class="tools svelte-1isvhs1"><!></div>');function Dn(r,t){U(t,!0);let e=D("");const s=Kt.subscribe(a=>{A(e,V(a))});nt(()=>{s&&s()});var n=Nn(),i=m(n);I(i,()=>c(e)==="target",a=>{Vr(a)},a=>{var o=pt(),l=it(o);I(l,()=>c(e)==="location",d=>{vn(d,{})},d=>{var h=pt(),f=it(h);I(f,()=>c(e)==="adjust",u=>{xn(u,{})},u=>{var _=pt(),p=it(_);I(p,()=>c(e)==="video",j=>{Tn(j,{})},j=>{var E=pt(),R=it(E);I(R,()=>c(e)==="picture",w=>{Bn(w,{})},null,!0),T(j,E)},!0),T(u,_)},!0),T(d,h)},!0),T(a,o)}),v(n),T(r,n),z()}var Pn=L('<li><button><span class="svelte-wkzjji"> </span></button></li>'),$n=L('<div id="options-menu" class="svelte-wkzjji"><ul class="svelte-wkzjji"></ul></div>');function Fn(r,t){U(t,!0);let e=D("");const s=Kt.subscribe(h=>{A(e,V(h))});let n=D(!1);const i=Xt.subscribe(h=>{A(n,V(h))}),a=h=>{Kt.update(f=>f===h?"":h)};nt(()=>{s&&s(),i&&i()});const o=[{id:"compass",name:"Compass",icon:"icon-compass",callback:()=>{Xt.update(h=>!h)},enabled:()=>c(n)},{id:"location",name:"Location",icon:"icon-location",callback:()=>{a("location")},enabled:()=>c(e)==="location"},{id:"target",name:"Target",icon:"icon-target",callback:()=>{a("target")},enabled:()=>c(e)==="target"},{id:"adjust",name:"Contrast",icon:"icon-adjust",callback:()=>{a("adjust")},enabled:()=>c(e)==="adjust"},{id:"video",name:"Video",icon:"icon-video",callback:()=>{a("video")},enabled:()=>c(e)==="video"},{id:"picture",name:"Picture",icon:"icon-image",callback:()=>{a("picture")},enabled:()=>c(e)==="picture"}];var l=$n(),d=m(l);_t(d,21,()=>o,Et,(h,f)=>{var u=Pn();const _=Pt(()=>`${(c(f).enabled()?"active":"")??""} svelte-wkzjji`);var p=m(u);p.__click=function(...R){var w;(w=c(f).callback)==null||w.apply(this,R)};var j=m(p),E=m(j,!0);v(j),v(p),v(u),X(()=>{dt(u,c(_)),dt(p,`${c(f).icon??""} svelte-wkzjji`),Z(E,c(f).name)}),T(h,u)}),v(d),v(l),T(r,l),z()}tt(["click"]);var In=L('<div class="video-recorder svelte-tf4uvu"><button aria-label="Stop video recording" class="svelte-tf4uvu"><span class="icon-stop"></span> <span class="time"> </span></button></div>');function Mn(r,t){U(t,!0);const e={elapsedTime:0};let s=D("00:00:00");function n(f,u,_){const p=[f,u,_].map(j=>j<10?`0${j}`:j);A(s,V(p.join(":")))}function i(){e.startTime=Date.now(),e.intervalId=setInterval(()=>{const f=Date.now()-e.startTime+e.elapsedTime,u=parseInt(f/1e3%60,10),_=parseInt(f/(1e3*60)%60,10),p=parseInt(f/(1e3*60*60)%24,10);n(p,_,u)},1e3)}function a(){e.intervalId&&(clearInterval(e.intervalId),$t.update(()=>!1),A(s,"00:00:00"))}let o=D(!1);const l=$t.subscribe(f=>{f!==c(o)&&(f?i():a(),A(o,V(f)))});nt(()=>{l&&l()});var d=pt(),h=it(d);I(h,()=>c(o),f=>{var u=In(),_=m(u);_.__click=a;var p=b(m(_),2),j=m(p,!0);v(p),v(_),v(u),X(()=>Z(j,c(s))),T(f,u)}),T(r,d),z()}tt(["click"]);var qn=L('<div class="tasks svelte-1i0wqs5"><!></div>');function Vn(r){var t=qn(),e=m(t);Mn(e,{}),v(t),T(r,t)}var Un=L('<div class="container svelte-dzpa42"><!> <!> <div class="controls svelte-dzpa42"><!></div> <!></div>');function Gn(r){var t=Un(),e=m(t);Vn(e);var s=b(e,2);Is(s);var n=b(s,2),i=m(n);Dn(i,{}),v(n);var a=b(n,2);Fn(a,{}),v(t),T(r,t)}export{Gn as component};
