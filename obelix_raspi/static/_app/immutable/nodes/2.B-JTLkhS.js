var Or=Object.defineProperty;var Xn=n=>{throw TypeError(n)};var Nr=(n,t,e)=>t in n?Or(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var Kn=(n,t,e)=>Nr(n,typeof t!="symbol"?t+"":t,e),Ke=(n,t,e)=>t.has(n)||Xn("Cannot "+e);var St=(n,t,e)=>(Ke(n,t,"read from private field"),e?e.call(n):t.get(n)),ne=(n,t,e)=>t.has(n)?Xn("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),Je=(n,t,e,s)=>(Ke(n,t,"write to private field"),s?s.call(n,e):t.set(n,e),e),Jn=(n,t,e)=>(Ke(n,t,"access private method"),e);import{b as Gn,e as jr,a as B,t as q,n as me,c as Mt}from"../chunks/disclose-version.DtTo3Fw3.js";import{S as Lr,h as Is,k as et,K as Ae,L as cn,A as Mr,Q as Ds,a7 as Br,a8 as Zn,J as Ge,l as Bt,ar as Ce,a5 as Fs,i as Bn,a6 as $r,an as Pr,C as Qn,as as $n,at as ts,au as Pn,av as Ir,U as Dr,$ as es,aw as Fr,P as Vr,ax as qr,j as Vs,ay as qs,F as zs,M as zr,B as Ur,az as Yr,G as Us,N as Hr,I as Wr,aA as Xr,aB as Kr,a4 as ns,aC as Jr,aD as Gr,am as Zr,al as In,b as Qr,p as Q,V as I,g as m,q as A,w as M,v as T,t as st,o as tt,aE as Ze,aq as z,f as Kt,m as mt}from"../chunks/runtime.CU1g5Zbl.js";import{b as ti,c as ht,a as J,p as zt,o as ge,i as Z,s as Ys}from"../chunks/index-client.e01X6VAc.js";import{a as pt,d as ft,s as Nt,b as wt}from"../chunks/store.BOP7Go3N.js";import{i as Hs}from"../chunks/lifecycle.ByO6cL9D.js";import{w as vt,g as Dn}from"../chunks/index.CjejAYHo.js";let Qe=null;function Jt(n,t){return t}function ei(n,t,e,s){for(var r=[],i=t.length,o=0;o<i;o++)Fr(t[o].e,r,!0);var a=i>0&&r.length===0&&e!==null;if(a){var u=e.parentNode;Vr(u),u.append(e),s.clear(),Ct(n,t[0].prev,t[i-1].next)}qr(r,()=>{for(var d=0;d<i;d++){var l=t[d];a||(s.delete(l.k),Ct(n,l.prev,l.next)),Vs(l.e,!a)}})}function $t(n,t,e,s,r,i=null){var o=n,a={flags:t,items:new Map,first:null},u=(t&qs)!==0;if(u){var d=n;o=et?Ae(zs(d)):d.appendChild(Lr())}et&&cn();var l=null,c=!1;Is(()=>{var h=e(),p=Mr(h)?h:h==null?[]:Ds(h),f=p.length;if(c&&f===0)return;c=f===0;let x=!1;if(et){var g=o.data===Br;g!==(f===0)&&(o=Zn(),Ae(o),Ge(!1),x=!0)}if(et){for(var w=null,b,v=0;v<f;v++){if(Bt.nodeType===8&&Bt.data===zr){o=Bt,x=!0,Ge(!1);break}var _=p[v],k=s(_,v);b=Ws(Bt,a,w,null,_,k,v,r,t),a.items.set(k,b),w=b}f>0&&Ae(Zn())}if(!et){var R=Ur;ni(p,a,o,r,t,(R.f&Ce)!==0,s)}i!==null&&(f===0?l?Fs(l):l=Bn(()=>i(o)):l!==null&&$r(l,()=>{l=null})),x&&Ge(!0),e()}),et&&(o=Bt)}function ni(n,t,e,s,r,i,o){var j,y,L,U;var a=(r&Yr)!==0,u=(r&($n|Pn))!==0,d=n.length,l=t.items,c=t.first,h=c,p,f=null,x,g=[],w=[],b,v,_,k;if(a)for(k=0;k<d;k+=1)b=n[k],v=o(b,k),_=l.get(v),_!==void 0&&((j=_.a)==null||j.measure(),(x??(x=new Set)).add(_));for(k=0;k<d;k+=1){if(b=n[k],v=o(b,k),_=l.get(v),_===void 0){var R=h?h.e.nodes_start:e;f=Ws(R,t,f,f===null?t.first:f.next,b,v,k,s,r),l.set(v,f),g=[],w=[],h=f.next;continue}if(u&&si(_,b,k,r),_.e.f&Ce&&(Fs(_.e),a&&((y=_.a)==null||y.unfix(),(x??(x=new Set)).delete(_))),_!==h){if(p!==void 0&&p.has(_)){if(g.length<w.length){var P=w[0],N;f=P.prev;var S=g[0],C=g[g.length-1];for(N=0;N<g.length;N+=1)ss(g[N],P,e);for(N=0;N<w.length;N+=1)p.delete(w[N]);Ct(t,S.prev,C.next),Ct(t,f,S),Ct(t,C,P),h=P,f=C,k-=1,g=[],w=[]}else p.delete(_),ss(_,h,e),Ct(t,_.prev,_.next),Ct(t,_,f===null?t.first:f.next),Ct(t,f,_),f=_;continue}for(g=[],w=[];h!==null&&h.k!==v;)(i||!(h.e.f&Ce))&&(p??(p=new Set)).add(h),w.push(h),h=h.next;if(h===null)continue;_=h}g.push(_),f=_,h=_.next}if(h!==null||p!==void 0){for(var E=p===void 0?[]:Ds(p);h!==null;)(i||!(h.e.f&Ce))&&E.push(h),h=h.next;var $=E.length;if($>0){var O=r&qs&&d===0?e:null;if(a){for(k=0;k<$;k+=1)(L=E[k].a)==null||L.measure();for(k=0;k<$;k+=1)(U=E[k].a)==null||U.fix()}ei(t,E,O,l)}}a&&Pr(()=>{var W;if(x!==void 0)for(_ of x)(W=_.a)==null||W.apply()}),Qn.first=t.first&&t.first.e,Qn.last=f&&f.e}function si(n,t,e,s){s&$n&&ts(n.v,t),s&Pn?ts(n.i,e):n.i=e}function Ws(n,t,e,s,r,i,o,a,u){var d=Qe;try{var l=(u&$n)!==0,c=(u&Ir)===0,h=l?c?Dr(r):es(r):r,p=u&Pn?es(o):o,f={i:p,v:h,k:i,a:null,e:null,prev:e,next:s};return Qe=f,f.e=Bn(()=>a(n,h,p),et),f.e.prev=e&&e.e,f.e.next=s&&s.e,e===null?t.first=f:(e.next=f,e.e.next=f.e),s!==null&&(s.prev=f,s.e.prev=f.e),f}finally{Qe=d}}function ss(n,t,e){for(var s=n.next?n.next.e.nodes_start:e,r=t?t.e.nodes_start:e,i=n.e.nodes_start;i!==s;){var o=Us(i);r.before(i),i=o}}function Ct(n,t,e){t===null?n.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function ri(n,t,e,s,r){var i=n,o="",a;Is(()=>{if(o===(o=t()??"")){et&&cn();return}a!==void 0&&(Vs(a),a=void 0),o!==""&&(a=Bn(()=>{if(et){Bt.data;for(var u=cn(),d=u;u!==null&&(u.nodeType!==8||u.data!=="");)d=u,u=Us(u);if(u===null)throw Hr(),Wr;Gn(Bt,d),i=Ae(u);return}var l=o+"",c=jr(l);Gn(zs(c),c.lastChild),i.before(c)}))})}let rs=!1;function Xs(){rs||(rs=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{var t;if(!n.defaultPrevented)for(const e of n.target.elements)(t=e.__on_r)==null||t.call(e)})},{capture:!0}))}function Ut(n){if(et){var t=!1,e=()=>{if(!t){if(t=!0,n.hasAttribute("value")){var s=n.value;K(n,"value",null),n.value=s}if(n.hasAttribute("checked")){var r=n.checked;K(n,"checked",null),n.checked=r}}};n.__on_r=e,Xr(e),Xs()}}function K(n,t,e,s){var r=n.__attributes??(n.__attributes={});et&&(r[t]=n.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&n.nodeName==="LINK")||r[t]!==(r[t]=e)&&(t==="style"&&"__styles"in n&&(n.__styles={}),t==="loading"&&(n[Kr]=e),e==null?n.removeAttribute(t):typeof e!="string"&&ii(n).includes(t)?n[t]=e:n.setAttribute(t,e))}var is=new Map;function ii(n){var t=is.get(n.nodeName);if(t)return t;is.set(n.nodeName,t=[]);for(var e,s=ns(n),r=Element.prototype;r!==s;){e=Jr(s);for(var i in e)e[i].set&&t.push(i);s=ns(s)}return t}function Pt(n,t){var e=n.__className,s=oi(t);et&&n.className===s?n.__className=s:(e!==s||et&&n.className!==s)&&(t==null?n.removeAttribute("class"):n.className=s,n.__className=s)}function oi(n){return n??""}function Ks(n,t,e,s=e){n.addEventListener(t,e);const r=n.__on_r;r?n.__on_r=()=>{r(),s()}:n.__on_r=s,Xs()}function Yt(n,t,e=t){var s=Gr();Ks(n,"input",()=>{var r=os(n)?as(n.value):n.value;e(r),s&&r!==(r=t())&&(n.value=r??"")}),Zr(()=>{var r=t();if(et&&n.defaultValue!==n.value){e(n.value);return}os(n)&&r===as(n.value)||n.type==="date"&&!r&&!n.value||r!==n.value&&(n.value=r??"")})}function os(n){var t=n.type;return t==="number"||t==="range"}function as(n){return n===""?null:+n}function Js(n,t,e){if(n.multiple)return li(n,t);for(var s of n.options){var r=ue(s);if(ti(r,t)){s.selected=!0;return}}(!e||t!==void 0)&&(n.selectedIndex=-1)}function ai(n,t){In(()=>{var e=new MutationObserver(()=>{var s=n.__value;Js(n,s)});return e.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{e.disconnect()}})}function ls(n,t,e=t){var s=!0;Ks(n,"change",()=>{var r;if(n.multiple)r=[].map.call(n.querySelectorAll(":checked"),ue);else{var i=n.querySelector(":checked");r=i&&ue(i)}e(r)}),In(()=>{var r=t();if(Js(n,r,s),s&&r===void 0){var i=n.querySelector(":checked");i!==null&&(r=ue(i),e(r))}n.__value=r,s=!1}),ai(n)}function li(n,t){for(var e of n.options)e.selected=~t.indexOf(ue(e))}function ue(n){return"__value"in n?n.__value:n.value}var Rt,Xt,ve,ze,Gs;const Ue=class Ue{constructor(t){ne(this,ze);ne(this,Rt,new WeakMap);ne(this,Xt);ne(this,ve);Je(this,ve,t)}observe(t,e){var s=St(this,Rt).get(t)||new Set;return s.add(e),St(this,Rt).set(t,s),Jn(this,ze,Gs).call(this).observe(t,St(this,ve)),()=>{var r=St(this,Rt).get(t);r.delete(e),r.size===0&&(St(this,Rt).delete(t),St(this,Xt).unobserve(t))}}};Rt=new WeakMap,Xt=new WeakMap,ve=new WeakMap,ze=new WeakSet,Gs=function(){return St(this,Xt)??Je(this,Xt,new ResizeObserver(t=>{for(var e of t){Ue.entries.set(e.target,e);for(var s of St(this,Rt).get(e.target)||[])s(e)}}))},Kn(Ue,"entries",new WeakMap);let un=Ue;var ci=new un({box:"border-box"});function cs(n,t,e){var s=ci.observe(n,()=>e(n[t]));In(()=>(Qr(()=>e(n[t])),s))}const ui=vt(`${location.protocol}//${location.hostname}`),Fn=vt(location.origin),Ye=vt({x:0,y:0,f:0,deg_x:0,deg_y:0,dx:1,dy:-1,df:1,acc:1e3,spr:8e4,mpa:2e4,minpx:-2e4,maxpx:2e4,mpf:5e3,vx:0,vy:0,va1:100,va2:1500,vf:0,vf1:100,vf2:1500}),tn=vt([{id:"Brightness",name:"Brightness",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.01},{id:"Contrast",name:"Contrast",defaultValue:1,value:1,minValue:0,maxValue:6,steps:.1},{id:"Saturation",name:"Saturation",defaultValue:1,value:1,minValue:0,maxValue:32,steps:.1},{id:"Sharpness",name:"Sharpness",defaultValue:1,value:1,minValue:0,maxValue:16,steps:.1},{id:"ExposureTime",name:"Exposure time",description:"Value > 0 will reduce video framerate.",defaultValue:0,value:0,minValue:-10,maxValue:10,steps:.1},{id:"AnalogueGain",name:"Analogue gain",defaultValue:1,value:1,minValue:1,maxValue:8,steps:.1}]),ye=vt([]),gt=vt({}),hn=vt(""),fn=vt(!1),Re=vt("B"),Me=vt(!1),he=vt([{id:"CrosshairSize",name:"Crosshair Size",defaultValue:.04,value:.04,minValue:.005,maxValue:.25,steps:.005},{id:"CrosshairOffsetX",name:"Crosshair Offset X",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.005},{id:"CrosshairOffsetY",name:"Crosshair Offset Y",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.005},{id:"SphereScaleVF",name:"Sphere Scale Viewfinder",defaultValue:1500,value:1500,minValue:1e3,maxValue:1e4,steps:10},{id:"SphereScaleTel",name:"Sphere Scale Telescope",defaultValue:24e3,value:24e3,minValue:15e3,maxValue:6e4,steps:10}]);var hi=q('<div id="horizon-wrapper" class="svelte-160jhho"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 300" preserveAspectRatio="xMinYMin slice" class="svelte-160jhho"><defs><polygon id="focusArrow" points="0,400 180,65 100,65 200,35 300,65 220,65 400,400"></polygon><linearGradient id="focusArrowGradClip" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#005"></stop><stop offset="50%" stop-color="#039" stop-opacity=".8"></stop><stop offset="100%" stop-color="#07f" stop-opacity=".4"></stop></linearGradient></defs><clipPath id="arrowStripesClip"><polygon points="200,0 -390,400 -370,400 200,0 -350,400 -330,400 200,0 -310,400 -290,400 200,0 -270,400 -250,400 200,0 -230,400 -210,400 200,0 -190,400 -170,400 200,0 -150,400 -130,400 200,0 -110,400 -90,400 200,0 -70,400 -50,400 200,0 -30,400 -10,400 200,0 10,400 30,400 200,0 50,400 70,400 200,0 90,400 110,400 200,0 130,400 150,400 200,0 170,400 190,400 200,0 210,400 230,400 200,0 250,400 270,400 200,0 290,400 310,400 200,0 330,400 350,400 200,0 370,400 390,400 200,0 410,400 430,400 200,0 450,400 470,400 200,0 490,400 510,400 200,0 530,400 550,400 200,0 570,400 590,400 200,0 610,400 630,400 200,0 650,400 670,400 200,0 690,400 710,400 200,0 730,400 750,400 200,0 770,400 790,400"></polygon></clipPath><clipPath id="focusRangeMeterClip"><rect id="focus-range-meter" width="400" height="400" class="svelte-160jhho"></rect></clipPath><g transform="translate(200 150)"><g id="altitude-visual" class="svelte-160jhho"><circle r="1" fill="#FFF"></circle><path d="M-70 0 -10 0 A 10 10 0 0 0 10 0 " fill="none" stroke-width="1.2" stroke="#FFF"></path><text id="altitude-text" text-anchor="middle" transform="translate(-45 -5)" fill="#FFF" font-size="10"> </text></g></g><g transform="translate(200 150)"><path d="M-10 0 A 10 10 0 0 0 10 0 L 70 0" fill="none" stroke-width="1.22" stroke="#FFF"></path><path d="M -4,-150 0,-140 4,-150" fill="#FFF" stroke="#FFF" stroke-width=".5"></path><text id="azimuth-text" transform="translate(30 -5)" text-anchor="middle" fill="#FFF" font-size="10"> </text></g><g transform="translate(200 -390)"><g id="compass" class="svelte-160jhho"><circle r="400" class="grade svelte-160jhho" stroke-dasharray=".5 6.48131701" stroke-dashoffset=".15" stroke-width="20"></circle><circle r="400" class="grade svelte-160jhho" stroke-dasharray=".5 34.40658504" stroke-dashoffset=".15" stroke-width="30"></circle><circle r="400" class="grade svelte-160jhho" stroke-dasharray=".5 104.21975512" stroke-dashoffset=".15" stroke-width="40"></circle><circle r="400" fill="none" stroke-dasharray=".5 156.57963268" stroke-dashoffset=".15" stroke="#F00" stroke-width="40"></circle><text class="cmp-text svelte-160jhho" transform="rotate(0) translate(0 432)">N</text><text class="cmp-text svelte-160jhho" transform="rotate(-15) translate(0 432)">15</text><text class="cmp-text svelte-160jhho" transform="rotate(-30) translate(0 432)">30</text><text class="cmp-text svelte-160jhho" transform="rotate(-45) translate(0 432)">45</text><text class="cmp-text svelte-160jhho" transform="rotate(-60) translate(0 432)">60</text><text class="cmp-text svelte-160jhho" transform="rotate(-75) translate(0 432)">75</text><text class="cmp-text svelte-160jhho" transform="rotate(-90) translate(0 432)">E</text><text class="cmp-text svelte-160jhho" transform="rotate(-105) translate(0 432)">105</text><text class="cmp-text svelte-160jhho" transform="rotate(-120) translate(0 432)">120</text><text class="cmp-text svelte-160jhho" transform="rotate(-135) translate(0 432)">135</text><text class="cmp-text svelte-160jhho" transform="rotate(-150) translate(0 432)">150</text><text class="cmp-text svelte-160jhho" transform="rotate(-165) translate(0 432)">165</text><text class="cmp-text svelte-160jhho" transform="rotate(-180) translate(0 432)">S</text><text class="cmp-text svelte-160jhho" transform="rotate(-195) translate(0 432)">195</text><text class="cmp-text svelte-160jhho" transform="rotate(-210) translate(0 432)">210</text><text class="cmp-text svelte-160jhho" transform="rotate(-225) translate(0 432)">225</text><text class="cmp-text svelte-160jhho" transform="rotate(-240) translate(0 432)">240</text><text class="cmp-text svelte-160jhho" transform="rotate(-255) translate(0 432)">255</text><text class="cmp-text svelte-160jhho" transform="rotate(-270) translate(0 432)">W</text><text class="cmp-text svelte-160jhho" transform="rotate(-285) translate(0 432)">285</text><text class="cmp-text svelte-160jhho" transform="rotate(-300) translate(0 432)">300</text><text class="cmp-text svelte-160jhho" transform="rotate(-315) translate(0 432)">315</text><text class="cmp-text svelte-160jhho" transform="rotate(-330) translate(0 432)">330</text><text class="cmp-text svelte-160jhho" transform="rotate(-345) translate(0 432)">345</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(0) translate(0 422)">0</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-5) translate(0 422)">5</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-10) translate(0 422)">10</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-20) translate(0 422)">20</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-25) translate(0 422)">25</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-22.5) translate(0 422)">NNE</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-35) translate(0 422)">35</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-40) translate(0 422)">40</text><text class="cmp-text-sm left svelte-160jhho" transform="rotate(-45) translate(0 422)">NE</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-50) translate(0 422)">50</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-55) translate(0 422)">55</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-65) translate(0 422)">65</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-70) translate(0 422)">70</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-67.5) translate(0 422)">NEE</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-80) translate(0 422)">80</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-85) translate(0 422)">85</text><text class="cmp-text-sm left svelte-160jhho" transform="rotate(-90) translate(0 422)">90</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-95) translate(0 422)">95</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-95) translate(0 422)">95</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-100) translate(0 422)">100</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-110) translate(0 422)">110</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-112.5) translate(0 422)">SEE</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-115) translate(0 422)">115</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-125) translate(0 422)">125</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-130) translate(0 422)">130</text><text class="cmp-text-sm left svelte-160jhho" transform="rotate(-135) translate(0 422)">SE</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-140) translate(0 422)">140</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-145) translate(0 422)">145</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-155) translate(0 422)">155</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-157.5) translate(0 422)">SSE</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-160) translate(0 422)">160</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-170) translate(0 422)">170</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-175) translate(0 422)">175</text><text class="cmp-text-sm left svelte-160jhho" transform="rotate(-180) translate(0 422)">180</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-185) translate(0 422)">185</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-190) translate(0 422)">190</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-200) translate(0 422)">200</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-202.5) translate(0 422)">SSW</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-205) translate(0 422)">205</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-215) translate(0 422)">215</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-220) translate(0 422)">220</text><text class="cmp-text-sm left svelte-160jhho" transform="rotate(-225) translate(0 422)">SW</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-230) translate(0 422)">230</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-235) translate(0 422)">235</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-245) translate(0 422)">245</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-247.5) translate(0 422)">SWW</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-250) translate(0 422)">250</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-260) translate(0 422)">260</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-265) translate(0 422)">265</text><text class="cmp-text-sm left svelte-160jhho" transform="rotate(-270) translate(0 422)">270</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-275) translate(0 422)">275</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-280) translate(0 422)">280</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-290) translate(0 422)">290</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-292.5) translate(0 422)">NWW</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-295) translate(0 422)">295</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-305) translate(0 422)">305</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-310) translate(0 422)">310</text><text class="cmp-text-sm left svelte-160jhho" transform="rotate(-315) translate(0 422)">NW</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-320) translate(0 422)">320</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-325) translate(0 422)">325</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-335) translate(0 422)">335</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-340) translate(0 422)">340</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-350) translate(0 422)">350</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-355) translate(0 422)">355</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-337.5) translate(0 422)">NNW</text></g></g></svg></div>');function fi(n,t){Q(t,!1);let e=Ze(),s=Ze(),r=Ze();const i=Ye.subscribe(v=>{const _=v.f+v.mpf,R=(v.mpf-v.mpf/Math.pow(1.5/v.mpf*_+1,2))/v.mpf;I(e,(1-R)*133),I(s,v.deg_x),I(r,v.deg_y),m(r)/90*400});ht(()=>{i&&i()}),Hs();var o=hi(),a=A(o),u=M(A(a),2),d=A(u);T(u);var l=M(u),c=A(l),h=M(A(c),2),p=A(h);T(h),T(c),T(l);var f=M(l),x=M(A(f),2),g=A(x);T(x),T(f);var w=M(f),b=A(w);T(w),T(a),T(o),st(()=>{K(d,"style",`y:${m(e)??""}%`),K(c,"style",`transform: rotate(${m(r)??""}deg)`),pt(p,`∠ ${m(r)??""}°`),pt(g,`➢ ${m(s)??""}°`),K(b,"transform",`rotate(${m(s)??""})`)}),B(n,o),tt()}const bt=Object.create(null);bt.open="0";bt.close="1";bt.ping="2";bt.pong="3";bt.message="4";bt.upgrade="5";bt.noop="6";const Oe=Object.create(null);Object.keys(bt).forEach(n=>{Oe[bt[n]]=n});const dn={type:"error",data:"parser error"},Zs=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Qs=typeof ArrayBuffer=="function",tr=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,Vn=({type:n,data:t},e,s)=>Zs&&t instanceof Blob?e?s(t):us(t,s):Qs&&(t instanceof ArrayBuffer||tr(t))?e?s(t):us(new Blob([t]),s):s(bt[n]+(t||"")),us=(n,t)=>{const e=new FileReader;return e.onload=function(){const s=e.result.split(",")[1];t("b"+(s||""))},e.readAsDataURL(n)};function hs(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let en;function di(n,t){if(Zs&&n.data instanceof Blob)return n.data.arrayBuffer().then(hs).then(t);if(Qs&&(n.data instanceof ArrayBuffer||tr(n.data)))return t(hs(n.data));Vn(n,!1,e=>{en||(en=new TextEncoder),t(en.encode(e))})}const fs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",re=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<fs.length;n++)re[fs.charCodeAt(n)]=n;const pi=n=>{let t=n.length*.75,e=n.length,s,r=0,i,o,a,u;n[n.length-1]==="="&&(t--,n[n.length-2]==="="&&t--);const d=new ArrayBuffer(t),l=new Uint8Array(d);for(s=0;s<e;s+=4)i=re[n.charCodeAt(s)],o=re[n.charCodeAt(s+1)],a=re[n.charCodeAt(s+2)],u=re[n.charCodeAt(s+3)],l[r++]=i<<2|o>>4,l[r++]=(o&15)<<4|a>>2,l[r++]=(a&3)<<6|u&63;return d},vi=typeof ArrayBuffer=="function",qn=(n,t)=>{if(typeof n!="string")return{type:"message",data:er(n,t)};const e=n.charAt(0);return e==="b"?{type:"message",data:mi(n.substring(1),t)}:Oe[e]?n.length>1?{type:Oe[e],data:n.substring(1)}:{type:Oe[e]}:dn},mi=(n,t)=>{if(vi){const e=pi(n);return er(e,t)}else return{base64:!0,data:n}},er=(n,t)=>{switch(t){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},nr="",gi=(n,t)=>{const e=n.length,s=new Array(e);let r=0;n.forEach((i,o)=>{Vn(i,!1,a=>{s[o]=a,++r===e&&t(s.join(nr))})})},_i=(n,t)=>{const e=n.split(nr),s=[];for(let r=0;r<e.length;r++){const i=qn(e[r],t);if(s.push(i),i.type==="error")break}return s};function yi(){return new TransformStream({transform(n,t){di(n,e=>{const s=e.length;let r;if(s<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,s);else if(s<65536){r=new Uint8Array(3);const i=new DataView(r.buffer);i.setUint8(0,126),i.setUint16(1,s)}else{r=new Uint8Array(9);const i=new DataView(r.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(s))}n.data&&typeof n.data!="string"&&(r[0]|=128),t.enqueue(r),t.enqueue(e)})}})}let nn;function xe(n){return n.reduce((t,e)=>t+e.length,0)}function we(n,t){if(n[0].length===t)return n.shift();const e=new Uint8Array(t);let s=0;for(let r=0;r<t;r++)e[r]=n[0][s++],s===n[0].length&&(n.shift(),s=0);return n.length&&s<n[0].length&&(n[0]=n[0].slice(s)),e}function xi(n,t){nn||(nn=new TextDecoder);const e=[];let s=0,r=-1,i=!1;return new TransformStream({transform(o,a){for(e.push(o);;){if(s===0){if(xe(e)<1)break;const u=we(e,1);i=(u[0]&128)===128,r=u[0]&127,r<126?s=3:r===126?s=1:s=2}else if(s===1){if(xe(e)<2)break;const u=we(e,2);r=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),s=3}else if(s===2){if(xe(e)<8)break;const u=we(e,8),d=new DataView(u.buffer,u.byteOffset,u.length),l=d.getUint32(0);if(l>Math.pow(2,21)-1){a.enqueue(dn);break}r=l*Math.pow(2,32)+d.getUint32(4),s=3}else{if(xe(e)<r)break;const u=we(e,r);a.enqueue(qn(i?u:nn.decode(u),t)),s=0}if(r===0||r>n){a.enqueue(dn);break}}}})}const sr=4;function G(n){if(n)return wi(n)}function wi(n){for(var t in G.prototype)n[t]=G.prototype[t];return n}G.prototype.on=G.prototype.addEventListener=function(n,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(t),this};G.prototype.once=function(n,t){function e(){this.off(n,e),t.apply(this,arguments)}return e.fn=t,this.on(n,e),this};G.prototype.off=G.prototype.removeListener=G.prototype.removeAllListeners=G.prototype.removeEventListener=function(n,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+n];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var s,r=0;r<e.length;r++)if(s=e[r],s===t||s.fn===t){e.splice(r,1);break}return e.length===0&&delete this._callbacks["$"+n],this};G.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+n],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(e){e=e.slice(0);for(var s=0,r=e.length;s<r;++s)e[s].apply(this,t)}return this};G.prototype.emitReserved=G.prototype.emit;G.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};G.prototype.hasListeners=function(n){return!!this.listeners(n).length};const He=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0),ot=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),bi="arraybuffer";function rr(n,...t){return t.reduce((e,s)=>(n.hasOwnProperty(s)&&(e[s]=n[s]),e),{})}const Ei=ot.setTimeout,ki=ot.clearTimeout;function We(n,t){t.useNativeTimers?(n.setTimeoutFn=Ei.bind(ot),n.clearTimeoutFn=ki.bind(ot)):(n.setTimeoutFn=ot.setTimeout.bind(ot),n.clearTimeoutFn=ot.clearTimeout.bind(ot))}const Si=1.33;function Ti(n){return typeof n=="string"?Ai(n):Math.ceil((n.byteLength||n.size)*Si)}function Ai(n){let t=0,e=0;for(let s=0,r=n.length;s<r;s++)t=n.charCodeAt(s),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(s++,e+=4);return e}function ir(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Ci(n){let t="";for(let e in n)n.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(n[e]));return t}function Ri(n){let t={},e=n.split("&");for(let s=0,r=e.length;s<r;s++){let i=e[s].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class Oi extends Error{constructor(t,e,s){super(t),this.description=e,this.context=s,this.type="TransportError"}}class zn extends G{constructor(t){super(),this.writable=!1,We(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,s){return super.emitReserved("error",new Oi(t,e,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=qn(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const e=Ci(t);return e.length?"?"+e:""}}class Ni extends zn{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||e()})),this.writable||(s++,this.once("drain",function(){--s||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const e=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};_i(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,gi(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=ir()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(t,e)}}let or=!1;try{or=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const ji=or;function Li(){}class Mi extends Ni{constructor(t){if(super(t),typeof location<"u"){const e=location.protocol==="https:";let s=location.port;s||(s=e?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||s!==t.port}}doWrite(t,e){const s=this.request({method:"POST",data:t});s.on("success",e),s.on("error",(r,i)=>{this.onError("xhr post error",r,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,s)=>{this.onError("xhr poll error",e,s)}),this.pollXhr=t}}class xt extends G{constructor(t,e,s){super(),this.createRequest=t,We(this,s),this._opts=s,this._method=s.method||"GET",this._uri=e,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var t;const e=rr(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(e);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&s.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var r;s.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=xt.requestsCount++,xt.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Li,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete xt.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}xt.requestsCount=0;xt.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",ds);else if(typeof addEventListener=="function"){const n="onpagehide"in ot?"pagehide":"unload";addEventListener(n,ds,!1)}}function ds(){for(let n in xt.requests)xt.requests.hasOwnProperty(n)&&xt.requests[n].abort()}const Bi=function(){const n=ar({xdomain:!1});return n&&n.responseType!==null}();class $i extends Mi{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=Bi&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new xt(ar,this.uri(),t)}}function ar(n){const t=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||ji))return new XMLHttpRequest}catch{}if(!t)try{return new ot[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const lr=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Pi extends zn{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,s=lr?{}:rr(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,s)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],r=e===t.length-1;Vn(s,this.supportsBinary,i=>{try{this.doWrite(s,i)}catch{}r&&He(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=ir()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const sn=ot.WebSocket||ot.MozWebSocket;class Ii extends Pi{createSocket(t,e,s){return lr?new sn(t,e,s):e?new sn(t,e):new sn(t)}doWrite(t,e){this.ws.send(e)}}class Di extends zn{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const e=xi(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=t.readable.pipeThrough(e).getReader(),r=yi();r.readable.pipeTo(t.writable),this._writer=r.writable.getWriter();const i=()=>{s.read().then(({done:a,value:u})=>{a||(this.onPacket(u),i())}).catch(a=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],r=e===t.length-1;this._writer.write(s).then(()=>{r&&He(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const Fi={websocket:Ii,webtransport:Di,polling:$i},Vi=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,qi=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function pn(n){if(n.length>8e3)throw"URI too long";const t=n,e=n.indexOf("["),s=n.indexOf("]");e!=-1&&s!=-1&&(n=n.substring(0,e)+n.substring(e,s).replace(/:/g,";")+n.substring(s,n.length));let r=Vi.exec(n||""),i={},o=14;for(;o--;)i[qi[o]]=r[o]||"";return e!=-1&&s!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=zi(i,i.path),i.queryKey=Ui(i,i.query),i}function zi(n,t){const e=/\/{2,9}/g,s=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&s.splice(0,1),t.slice(-1)=="/"&&s.splice(s.length-1,1),s}function Ui(n,t){const e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,r,i){r&&(e[r]=i)}),e}const vn=typeof addEventListener=="function"&&typeof removeEventListener=="function",Ne=[];vn&&addEventListener("offline",()=>{Ne.forEach(n=>n())},!1);class Ot extends G{constructor(t,e){if(super(),this.binaryType=bi,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(e=t,t=null),t){const s=pn(t);e.hostname=s.host,e.secure=s.protocol==="https"||s.protocol==="wss",e.port=s.port,s.query&&(e.query=s.query)}else e.host&&(e.hostname=pn(e.host).host);We(this,e),this.secure=e.secure!=null?e.secure:typeof location<"u"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach(s=>{const r=s.prototype.name;this.transports.push(r),this._transportsByName[r]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Ri(this.opts.query)),vn&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Ne.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=sr,e.transport=t,this.id&&(e.sid=this.id);const s=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&Ot.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",Ot.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let s=0;s<this.writeBuffer.length;s++){const r=this.writeBuffer[s].data;if(r&&(e+=Ti(r)),s>0&&e>this._maxPayload)return this.writeBuffer.slice(0,s);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,He(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,e,s){return this._sendPacket("message",t,e,s),this}send(t,e,s){return this._sendPacket("message",t,e,s),this}_sendPacket(t,e,s,r){if(typeof e=="function"&&(r=e,e=void 0),typeof s=="function"&&(r=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const i={type:t,data:e,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},s=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}_onError(t){if(Ot.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),vn&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=Ne.indexOf(this._offlineEventListener);s!==-1&&Ne.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}Ot.protocol=sr;class Yi extends Ot{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),s=!1;Ot.priorWebsocketSuccess=!1;const r=()=>{s||(e.send([{type:"ping",data:"probe"}]),e.once("packet",c=>{if(!s)if(c.type==="pong"&&c.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;Ot.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(l(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=e.name,this.emitReserved("upgradeError",h)}}))};function i(){s||(s=!0,l(),e.close(),e=null)}const o=c=>{const h=new Error("probe error: "+c);h.transport=e.name,i(),this.emitReserved("upgradeError",h)};function a(){o("transport closed")}function u(){o("socket closed")}function d(c){e&&c.name!==e.name&&i()}const l=()=>{e.removeListener("open",r),e.removeListener("error",o),e.removeListener("close",a),this.off("close",u),this.off("upgrading",d)};e.once("open",r),e.once("error",o),e.once("close",a),this.once("close",u),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{s||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let s=0;s<t.length;s++)~this.transports.indexOf(t[s])&&e.push(t[s]);return e}}let Hi=class extends Yi{constructor(t,e={}){const s=typeof t=="object"?t:e;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(r=>Fi[r]).filter(r=>!!r)),super(t,s)}};function Wi(n,t="",e){let s=n;e=e||typeof location<"u"&&location,n==null&&(n=e.protocol+"//"+e.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=e.protocol+n:n=e.host+n),/^(https?|wss?):\/\//.test(n)||(typeof e<"u"?n=e.protocol+"//"+n:n="https://"+n),s=pn(n)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const i=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+t,s.href=s.protocol+"://"+i+(e&&e.port===s.port?"":":"+s.port),s}const Xi=typeof ArrayBuffer=="function",Ki=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,cr=Object.prototype.toString,Ji=typeof Blob=="function"||typeof Blob<"u"&&cr.call(Blob)==="[object BlobConstructor]",Gi=typeof File=="function"||typeof File<"u"&&cr.call(File)==="[object FileConstructor]";function Un(n){return Xi&&(n instanceof ArrayBuffer||Ki(n))||Ji&&n instanceof Blob||Gi&&n instanceof File}function je(n,t){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let e=0,s=n.length;e<s;e++)if(je(n[e]))return!0;return!1}if(Un(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return je(n.toJSON(),!0);for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)&&je(n[e]))return!0;return!1}function Zi(n){const t=[],e=n.data,s=n;return s.data=mn(e,t),s.attachments=t.length,{packet:s,buffers:t}}function mn(n,t){if(!n)return n;if(Un(n)){const e={_placeholder:!0,num:t.length};return t.push(n),e}else if(Array.isArray(n)){const e=new Array(n.length);for(let s=0;s<n.length;s++)e[s]=mn(n[s],t);return e}else if(typeof n=="object"&&!(n instanceof Date)){const e={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=mn(n[s],t));return e}return n}function Qi(n,t){return n.data=gn(n.data,t),delete n.attachments,n}function gn(n,t){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<t.length)return t[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let e=0;e<n.length;e++)n[e]=gn(n[e],t);else if(typeof n=="object")for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(n[e]=gn(n[e],t));return n}const to=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],eo=5;var D;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(D||(D={}));class no{constructor(t){this.replacer=t}encode(t){return(t.type===D.EVENT||t.type===D.ACK)&&je(t)?this.encodeAsBinary({type:t.type===D.EVENT?D.BINARY_EVENT:D.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===D.BINARY_EVENT||t.type===D.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=Zi(t),s=this.encodeAsString(e.packet),r=e.buffers;return r.unshift(s),r}}function ps(n){return Object.prototype.toString.call(n)==="[object Object]"}class Yn extends G{constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const s=e.type===D.BINARY_EVENT;s||e.type===D.BINARY_ACK?(e.type=s?D.EVENT:D.ACK,this.reconstructor=new so(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(Un(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0;const s={type:Number(t.charAt(0))};if(D[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===D.BINARY_EVENT||s.type===D.BINARY_ACK){const i=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);const o=t.substring(i,e);if(o!=Number(o)||t.charAt(e)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(t.charAt(e+1)==="/"){const i=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););s.nsp=t.substring(i,e)}else s.nsp="/";const r=t.charAt(e+1);if(r!==""&&Number(r)==r){const i=e+1;for(;++e;){const o=t.charAt(e);if(o==null||Number(o)!=o){--e;break}if(e===t.length)break}s.id=Number(t.substring(i,e+1))}if(t.charAt(++e)){const i=this.tryParse(t.substr(e));if(Yn.isPayloadValid(s.type,i))s.data=i;else throw new Error("invalid payload")}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case D.CONNECT:return ps(e);case D.DISCONNECT:return e===void 0;case D.CONNECT_ERROR:return typeof e=="string"||ps(e);case D.EVENT:case D.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&to.indexOf(e[0])===-1);case D.ACK:case D.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class so{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const e=Qi(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const ro=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Yn,Encoder:no,get PacketType(){return D},protocol:eo},Symbol.toStringTag,{value:"Module"}));function dt(n,t,e){return n.on(t,e),function(){n.off(t,e)}}const io=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});let ur=class extends G{constructor(t,e,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[dt(t,"open",this.onopen.bind(this)),dt(t,"packet",this.onpacket.bind(this)),dt(t,"error",this.onerror.bind(this)),dt(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var s,r,i;if(io.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const o={type:D.EVENT,data:e};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const l=this.ids++,c=e.pop();this._registerAckCallback(l,c),o.id=l}const a=(r=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||r===void 0?void 0:r.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!a||(u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,e){var s;const r=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(r===void 0){this.acks[t]=e;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===t&&this.sendBuffer.splice(a,1);e.call(this,new Error("operation has timed out"))},r),o=(...a)=>{this.io.clearTimeoutFn(i),e.apply(this,a)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...e){return new Promise((s,r)=>{const i=(o,a)=>o?r(o):s(a);i.withError=!0,e.push(i),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((r,...i)=>s!==this._queue[0]?void 0:(r!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(r)):(this._queue.shift(),e&&e(null,...i)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:D.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(s=>String(s.id)===t)){const s=this.acks[t];delete this.acks[t],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case D.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case D.EVENT:case D.BINARY_EVENT:this.onevent(t);break;case D.ACK:case D.BINARY_ACK:this.onack(t);break;case D.DISCONNECT:this.ondisconnect();break;case D.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data,this.emitReserved("connect_error",s);break}}onevent(t){const e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const s of e)s.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let s=!1;return function(...r){s||(s=!0,e.packet({type:D.ACK,id:t,data:r}))}}onack(t){const e=this.acks[t.id];typeof e=="function"&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:D.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const s of e)s.apply(this,t.data)}}};function te(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}te.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*n);n=Math.floor(t*10)&1?n+e:n-e}return Math.min(n,this.max)|0};te.prototype.reset=function(){this.attempts=0};te.prototype.setMin=function(n){this.ms=n};te.prototype.setMax=function(n){this.max=n};te.prototype.setJitter=function(n){this.jitter=n};class _n extends G{constructor(t,e){var s;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,We(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((s=e.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new te({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;const r=e.parser||ro;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Hi(this.uri,this.opts);const e=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const r=dt(e,"open",function(){s.onopen(),t&&t()}),i=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),t?t(a):this.maybeReconnectOnOpen()},o=dt(e,"error",i);if(this._timeout!==!1){const a=this._timeout,u=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),e.close()},a);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(r),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(dt(t,"ping",this.onping.bind(this)),dt(t,"data",this.ondata.bind(this)),dt(t,"error",this.onerror.bind(this)),dt(t,"close",this.onclose.bind(this)),dt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){He(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let s=this.nsps[t];return s?this._autoConnect&&!s.active&&s.connect():(s=new ur(this,t,e),this.nsps[t]=s),s}_destroy(t){const e=Object.keys(this.nsps);for(const s of e)if(this.nsps[s].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let s=0;s<e.length;s++)this.engine.write(e[s],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(r=>{r?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",r)):t.onreconnect()}))},e);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const se={};function fe(n,t){typeof n=="object"&&(t=n,n=void 0),t=t||{};const e=Wi(n,t.path||"/socket.io"),s=e.source,r=e.id,i=e.path,o=se[r]&&i in se[r].nsps,a=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let u;return a?u=new _n(s,t):(se[r]||(se[r]=new _n(s,t)),u=se[r]),e.query&&!t.query&&(t.query=e.queryKey),u.socket(e.path,t)}Object.assign(fe,{Manager:_n,Socket:ur,io:fe,connect:fe});class oo{constructor(){if(this.enabled=!1,typeof fe=="function"){const t=Dn(Fn);this.socket=fe(t),this.socket&&(this.socket.on("connect",()=>{this.enabled=!0,console.log("Connected to websocket Obelix 1.0")}),this.socket.on("update_settings",e=>{console.log("SOCKETio",e),typeof e=="object"&&!Array.isArray(e)&&e!==null&&Ye.update(s=>({...s,...e}))}))}}destroy(){this.socket.offAny(),this.socket.disconnect()}emit(t){this.enabled&&this.socket.emit("message",t)}emitReply(t,e){this.enabled&&(console.log("emitReply"),this.socket.emit("message_reply",t,(s,r)=>{console.log("emitReply response",s,r),typeof e=="function"&&e(r)}))}}const hr=new oo;function rt(n,t){hr.emit({get:"foo"}),fetch(Dn(Fn)+n).then(e=>e.json()).then(e=>{typeof t=="function"&&t(e)})}function Xe(n,t,e){hr.emitReply({post:"foo"},e),fetch(Dn(Fn)+n,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(s=>s.json()).then(s=>{e&&e(s)})}class It{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let s=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],o=t+i,a=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);a&&(e[s++]=a),t=o}return e[s]=t,this._n=s+1,this}valueOf(){const t=this._partials;let e=this._n,s,r,i,o=0;if(e>0){for(o=t[--e];e>0&&(s=o,r=t[--e],o=s+r,i=r-(o-s),!i););e>0&&(i<0&&t[e-1]<0||i>0&&t[e-1]>0)&&(r=i*2,s=o+r,r==s-o&&(o=s))}return o}}function*ao(n){for(const t of n)yield*t}function fr(n){return Array.from(ao(n))}function Ht(n,t,e){n=+n,t=+t,e=(r=arguments.length)<2?(t=n,n=0,1):r<3?1:+e;for(var s=-1,r=Math.max(0,Math.ceil((t-n)/e))|0,i=new Array(r);++s<r;)i[s]=n+s*e;return i}var F=1e-6,lo=1e-12,V=Math.PI,lt=V/2,vs=V/4,ut=V*2,Tt=180/V,nt=V/180,Y=Math.abs,co=Math.atan,Gt=Math.atan2,X=Math.cos,be=Math.ceil,H=Math.sin,uo=Math.sign||function(n){return n>0?1:n<0?-1:0},jt=Math.sqrt;function ho(n){return n>1?0:n<-1?V:Math.acos(n)}function Dt(n){return n>1?lt:n<-1?-lt:Math.asin(n)}function ct(){}function Be(n,t){n&&gs.hasOwnProperty(n.type)&&gs[n.type](n,t)}var ms={Feature:function(n,t){Be(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,s=-1,r=e.length;++s<r;)Be(e[s].geometry,t)}},gs={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,s=-1,r=e.length;++s<r;)n=e[s],t.point(n[0],n[1],n[2])},LineString:function(n,t){yn(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,s=-1,r=e.length;++s<r;)yn(e[s],t,0)},Polygon:function(n,t){_s(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,s=-1,r=e.length;++s<r;)_s(e[s],t)},GeometryCollection:function(n,t){for(var e=n.geometries,s=-1,r=e.length;++s<r;)Be(e[s],t)}};function yn(n,t,e){var s=-1,r=n.length-e,i;for(t.lineStart();++s<r;)i=n[s],t.point(i[0],i[1],i[2]);t.lineEnd()}function _s(n,t){var e=-1,s=n.length;for(t.polygonStart();++e<s;)yn(n[e],t,1);t.polygonEnd()}function qt(n,t){n&&ms.hasOwnProperty(n.type)?ms[n.type](n,t):Be(n,t)}function xn(n){return[Gt(n[1],n[0]),Dt(n[2])]}function Zt(n){var t=n[0],e=n[1],s=X(e);return[s*X(t),s*H(t),H(e)]}function Ee(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function $e(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function rn(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function ke(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function wn(n){var t=jt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function bn(n,t){function e(s,r){return s=n(s,r),t(s[0],s[1])}return n.invert&&t.invert&&(e.invert=function(s,r){return s=t.invert(s,r),s&&n.invert(s[0],s[1])}),e}function En(n,t){return Y(n)>V&&(n-=Math.round(n/ut)*ut),[n,t]}En.invert=En;function fo(n,t,e){return(n%=ut)?t||e?bn(xs(n),ws(t,e)):xs(n):t||e?ws(t,e):En}function ys(n){return function(t,e){return t+=n,Y(t)>V&&(t-=Math.round(t/ut)*ut),[t,e]}}function xs(n){var t=ys(n);return t.invert=ys(-n),t}function ws(n,t){var e=X(n),s=H(n),r=X(t),i=H(t);function o(a,u){var d=X(u),l=X(a)*d,c=H(a)*d,h=H(u),p=h*e+l*s;return[Gt(c*r-p*i,l*e-h*s),Dt(p*r+c*i)]}return o.invert=function(a,u){var d=X(u),l=X(a)*d,c=H(a)*d,h=H(u),p=h*r-c*i;return[Gt(c*r+h*i,l*e+p*s),Dt(p*e-l*s)]},o}function po(n,t,e,s,r,i){if(e){var o=X(t),a=H(t),u=s*e;r==null?(r=t+s*ut,i=t-u/2):(r=bs(o,r),i=bs(o,i),(s>0?r<i:r>i)&&(r+=s*ut));for(var d,l=r;s>0?l>i:l<i;l-=u)d=xn([o,-a*X(l),-a*H(l)]),n.point(d[0],d[1])}}function bs(n,t){t=Zt(t),t[0]-=n,wn(t);var e=ho(-t[1]);return((-t[2]<0?-e:e)+ut-F)%ut}function dr(){var n=[],t;return{point:function(e,s,r){t.push([e,s,r])},lineStart:function(){n.push(t=[])},lineEnd:ct,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}}function Le(n,t){return Y(n[0]-t[0])<F&&Y(n[1]-t[1])<F}function Se(n,t,e,s){this.x=n,this.z=t,this.o=e,this.e=s,this.v=!1,this.n=this.p=null}function pr(n,t,e,s,r){var i=[],o=[],a,u;if(n.forEach(function(f){if(!((x=f.length-1)<=0)){var x,g=f[0],w=f[x],b;if(Le(g,w)){if(!g[2]&&!w[2]){for(r.lineStart(),a=0;a<x;++a)r.point((g=f[a])[0],g[1]);r.lineEnd();return}w[0]+=2*F}i.push(b=new Se(g,f,null,!0)),o.push(b.o=new Se(g,null,b,!1)),i.push(b=new Se(w,f,null,!1)),o.push(b.o=new Se(w,null,b,!0))}}),!!i.length){for(o.sort(t),Es(i),Es(o),a=0,u=o.length;a<u;++a)o[a].e=e=!e;for(var d=i[0],l,c;;){for(var h=d,p=!0;h.v;)if((h=h.n)===d)return;l=h.z,r.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(a=0,u=l.length;a<u;++a)r.point((c=l[a])[0],c[1]);else s(h.x,h.n.x,1,r);h=h.n}else{if(p)for(l=h.p.z,a=l.length-1;a>=0;--a)r.point((c=l[a])[0],c[1]);else s(h.x,h.p.x,-1,r);h=h.p}h=h.o,l=h.z,p=!p}while(!h.v);r.lineEnd()}}}function Es(n){if(t=n.length){for(var t,e=0,s=n[0],r;++e<t;)s.n=r=n[e],r.p=s,s=r;s.n=r=n[0],r.p=s}}function on(n){return Y(n[0])<=V?n[0]:uo(n[0])*((Y(n[0])+V)%ut-V)}function vo(n,t){var e=on(t),s=t[1],r=H(s),i=[H(e),-X(e),0],o=0,a=0,u=new It;r===1?s=lt+F:r===-1&&(s=-lt-F);for(var d=0,l=n.length;d<l;++d)if(h=(c=n[d]).length)for(var c,h,p=c[h-1],f=on(p),x=p[1]/2+vs,g=H(x),w=X(x),b=0;b<h;++b,f=_,g=R,w=P,p=v){var v=c[b],_=on(v),k=v[1]/2+vs,R=H(k),P=X(k),N=_-f,S=N>=0?1:-1,C=S*N,E=C>V,$=g*R;if(u.add(Gt($*S*H(C),w*P+$*X(C))),o+=E?N+S*ut:N,E^f>=e^_>=e){var O=$e(Zt(p),Zt(v));wn(O);var j=$e(i,O);wn(j);var y=(E^N>=0?-1:1)*Dt(j[2]);(s>y||s===y&&(O[0]||O[1]))&&(a+=E^N>=0?1:-1)}}return(o<-F||o<F&&u<-lo)^a&1}function vr(n,t,e,s){return function(r){var i=t(r),o=dr(),a=t(o),u=!1,d,l,c,h={point:p,lineStart:x,lineEnd:g,polygonStart:function(){h.point=w,h.lineStart=b,h.lineEnd=v,l=[],d=[]},polygonEnd:function(){h.point=p,h.lineStart=x,h.lineEnd=g,l=fr(l);var _=vo(d,s);l.length?(u||(r.polygonStart(),u=!0),pr(l,go,_,e,r)):_&&(u||(r.polygonStart(),u=!0),r.lineStart(),e(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),l=d=null},sphere:function(){r.polygonStart(),r.lineStart(),e(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(_,k){n(_,k)&&r.point(_,k)}function f(_,k){i.point(_,k)}function x(){h.point=f,i.lineStart()}function g(){h.point=p,i.lineEnd()}function w(_,k){c.push([_,k]),a.point(_,k)}function b(){a.lineStart(),c=[]}function v(){w(c[0][0],c[0][1]),a.lineEnd();var _=a.clean(),k=o.result(),R,P=k.length,N,S,C;if(c.pop(),d.push(c),c=null,!!P){if(_&1){if(S=k[0],(N=S.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),R=0;R<N;++R)r.point((C=S[R])[0],C[1]);r.lineEnd()}return}P>1&&_&2&&k.push(k.pop().concat(k.shift())),l.push(k.filter(mo))}}return h}}function mo(n){return n.length>1}function go(n,t){return((n=n.x)[0]<0?n[1]-lt-F:lt-n[1])-((t=t.x)[0]<0?t[1]-lt-F:lt-t[1])}const ks=vr(function(){return!0},_o,xo,[-V,-lt]);function _o(n){var t=NaN,e=NaN,s=NaN,r;return{lineStart:function(){n.lineStart(),r=1},point:function(i,o){var a=i>0?V:-V,u=Y(i-t);Y(u-V)<F?(n.point(t,e=(e+o)/2>0?lt:-lt),n.point(s,e),n.lineEnd(),n.lineStart(),n.point(a,e),n.point(i,e),r=0):s!==a&&u>=V&&(Y(t-s)<F&&(t-=s*F),Y(i-a)<F&&(i-=a*F),e=yo(t,e,i,o),n.point(s,e),n.lineEnd(),n.lineStart(),n.point(a,e),r=0),n.point(t=i,e=o),s=a},lineEnd:function(){n.lineEnd(),t=e=NaN},clean:function(){return 2-r}}}function yo(n,t,e,s){var r,i,o=H(n-e);return Y(o)>F?co((H(t)*(i=X(s))*H(e)-H(s)*(r=X(t))*H(n))/(r*i*o)):(t+s)/2}function xo(n,t,e,s){var r;if(n==null)r=e*lt,s.point(-V,r),s.point(0,r),s.point(V,r),s.point(V,0),s.point(V,-r),s.point(0,-r),s.point(-V,-r),s.point(-V,0),s.point(-V,r);else if(Y(n[0]-t[0])>F){var i=n[0]<t[0]?V:-V;r=e*i/2,s.point(-i,r),s.point(0,r),s.point(i,r)}else s.point(t[0],t[1])}function wo(n){var t=X(n),e=2*nt,s=t>0,r=Y(t)>F;function i(l,c,h,p){po(p,n,e,h,l,c)}function o(l,c){return X(l)*X(c)>t}function a(l){var c,h,p,f,x;return{lineStart:function(){f=p=!1,x=1},point:function(g,w){var b=[g,w],v,_=o(g,w),k=s?_?0:d(g,w):_?d(g+(g<0?V:-V),w):0;if(!c&&(f=p=_)&&l.lineStart(),_!==p&&(v=u(c,b),(!v||Le(c,v)||Le(b,v))&&(b[2]=1)),_!==p)x=0,_?(l.lineStart(),v=u(b,c),l.point(v[0],v[1])):(v=u(c,b),l.point(v[0],v[1],2),l.lineEnd()),c=v;else if(r&&c&&s^_){var R;!(k&h)&&(R=u(b,c,!0))&&(x=0,s?(l.lineStart(),l.point(R[0][0],R[0][1]),l.point(R[1][0],R[1][1]),l.lineEnd()):(l.point(R[1][0],R[1][1]),l.lineEnd(),l.lineStart(),l.point(R[0][0],R[0][1],3)))}_&&(!c||!Le(c,b))&&l.point(b[0],b[1]),c=b,p=_,h=k},lineEnd:function(){p&&l.lineEnd(),c=null},clean:function(){return x|(f&&p)<<1}}}function u(l,c,h){var p=Zt(l),f=Zt(c),x=[1,0,0],g=$e(p,f),w=Ee(g,g),b=g[0],v=w-b*b;if(!v)return!h&&l;var _=t*w/v,k=-t*b/v,R=$e(x,g),P=ke(x,_),N=ke(g,k);rn(P,N);var S=R,C=Ee(P,S),E=Ee(S,S),$=C*C-E*(Ee(P,P)-1);if(!($<0)){var O=jt($),j=ke(S,(-C-O)/E);if(rn(j,P),j=xn(j),!h)return j;var y=l[0],L=c[0],U=l[1],W=c[1],it;L<y&&(it=y,y=L,L=it);var ee=L-y,Et=Y(ee-V)<F,Lt=Et||ee<F;if(!Et&&W<U&&(it=U,U=W,W=it),Lt?Et?U+W>0^j[1]<(Y(j[0]-y)<F?U:W):U<=j[1]&&j[1]<=W:ee>V^(y<=j[0]&&j[0]<=L)){var kt=ke(S,(-C+O)/E);return rn(kt,P),[j,xn(kt)]}}}function d(l,c){var h=s?n:V-n,p=0;return l<-h?p|=1:l>h&&(p|=2),c<-h?p|=4:c>h&&(p|=8),p}return vr(o,a,i,s?[0,-n]:[-V,n-V])}function bo(n,t,e,s,r,i){var o=n[0],a=n[1],u=t[0],d=t[1],l=0,c=1,h=u-o,p=d-a,f;if(f=e-o,!(!h&&f>0)){if(f/=h,h<0){if(f<l)return;f<c&&(c=f)}else if(h>0){if(f>c)return;f>l&&(l=f)}if(f=r-o,!(!h&&f<0)){if(f/=h,h<0){if(f>c)return;f>l&&(l=f)}else if(h>0){if(f<l)return;f<c&&(c=f)}if(f=s-a,!(!p&&f>0)){if(f/=p,p<0){if(f<l)return;f<c&&(c=f)}else if(p>0){if(f>c)return;f>l&&(l=f)}if(f=i-a,!(!p&&f<0)){if(f/=p,p<0){if(f>c)return;f>l&&(l=f)}else if(p>0){if(f<l)return;f<c&&(c=f)}return l>0&&(n[0]=o+l*h,n[1]=a+l*p),c<1&&(t[0]=o+c*h,t[1]=a+c*p),!0}}}}}var ie=1e9,Te=-ie;function Eo(n,t,e,s){function r(d,l){return n<=d&&d<=e&&t<=l&&l<=s}function i(d,l,c,h){var p=0,f=0;if(d==null||(p=o(d,c))!==(f=o(l,c))||u(d,l)<0^c>0)do h.point(p===0||p===3?n:e,p>1?s:t);while((p=(p+c+4)%4)!==f);else h.point(l[0],l[1])}function o(d,l){return Y(d[0]-n)<F?l>0?0:3:Y(d[0]-e)<F?l>0?2:1:Y(d[1]-t)<F?l>0?1:0:l>0?3:2}function a(d,l){return u(d.x,l.x)}function u(d,l){var c=o(d,1),h=o(l,1);return c!==h?c-h:c===0?l[1]-d[1]:c===1?d[0]-l[0]:c===2?d[1]-l[1]:l[0]-d[0]}return function(d){var l=d,c=dr(),h,p,f,x,g,w,b,v,_,k,R,P={point:N,lineStart:$,lineEnd:O,polygonStart:C,polygonEnd:E};function N(y,L){r(y,L)&&l.point(y,L)}function S(){for(var y=0,L=0,U=p.length;L<U;++L)for(var W=p[L],it=1,ee=W.length,Et=W[0],Lt,kt,_e=Et[0],Vt=Et[1];it<ee;++it)Lt=_e,kt=Vt,Et=W[it],_e=Et[0],Vt=Et[1],kt<=s?Vt>s&&(_e-Lt)*(s-kt)>(Vt-kt)*(n-Lt)&&++y:Vt<=s&&(_e-Lt)*(s-kt)<(Vt-kt)*(n-Lt)&&--y;return y}function C(){l=c,h=[],p=[],R=!0}function E(){var y=S(),L=R&&y,U=(h=fr(h)).length;(L||U)&&(d.polygonStart(),L&&(d.lineStart(),i(null,null,1,d),d.lineEnd()),U&&pr(h,a,y,i,d),d.polygonEnd()),l=d,h=p=f=null}function $(){P.point=j,p&&p.push(f=[]),k=!0,_=!1,b=v=NaN}function O(){h&&(j(x,g),w&&_&&c.rejoin(),h.push(c.result())),P.point=N,_&&l.lineEnd()}function j(y,L){var U=r(y,L);if(p&&f.push([y,L]),k)x=y,g=L,w=U,k=!1,U&&(l.lineStart(),l.point(y,L));else if(U&&_)l.point(y,L);else{var W=[b=Math.max(Te,Math.min(ie,b)),v=Math.max(Te,Math.min(ie,v))],it=[y=Math.max(Te,Math.min(ie,y)),L=Math.max(Te,Math.min(ie,L))];bo(W,it,n,t,e,s)?(_||(l.lineStart(),l.point(W[0],W[1])),l.point(it[0],it[1]),U||l.lineEnd(),R=!1):U&&(l.lineStart(),l.point(y,L),R=!1)}b=y,v=L,_=U}return P}}function Ss(n,t,e){var s=Ht(n,t-F,e).concat(t);return function(r){return s.map(function(i){return[r,i]})}}function Ts(n,t,e){var s=Ht(n,t-F,e).concat(t);return function(r){return s.map(function(i){return[i,r]})}}function ko(){var n,t,e,s,r,i,o,a,u=10,d=u,l=90,c=360,h,p,f,x,g=2.5;function w(){return{type:"MultiLineString",coordinates:b()}}function b(){return Ht(be(s/l)*l,e,l).map(f).concat(Ht(be(a/c)*c,o,c).map(x)).concat(Ht(be(t/u)*u,n,u).filter(function(v){return Y(v%l)>F}).map(h)).concat(Ht(be(i/d)*d,r,d).filter(function(v){return Y(v%c)>F}).map(p))}return w.lines=function(){return b().map(function(v){return{type:"LineString",coordinates:v}})},w.outline=function(){return{type:"Polygon",coordinates:[f(s).concat(x(o).slice(1),f(e).reverse().slice(1),x(a).reverse().slice(1))]}},w.extent=function(v){return arguments.length?w.extentMajor(v).extentMinor(v):w.extentMinor()},w.extentMajor=function(v){return arguments.length?(s=+v[0][0],e=+v[1][0],a=+v[0][1],o=+v[1][1],s>e&&(v=s,s=e,e=v),a>o&&(v=a,a=o,o=v),w.precision(g)):[[s,a],[e,o]]},w.extentMinor=function(v){return arguments.length?(t=+v[0][0],n=+v[1][0],i=+v[0][1],r=+v[1][1],t>n&&(v=t,t=n,n=v),i>r&&(v=i,i=r,r=v),w.precision(g)):[[t,i],[n,r]]},w.step=function(v){return arguments.length?w.stepMajor(v).stepMinor(v):w.stepMinor()},w.stepMajor=function(v){return arguments.length?(l=+v[0],c=+v[1],w):[l,c]},w.stepMinor=function(v){return arguments.length?(u=+v[0],d=+v[1],w):[u,d]},w.precision=function(v){return arguments.length?(g=+v,h=Ss(i,r,90),p=Ts(t,n,g),f=Ss(a,o,90),x=Ts(s,e,g),w):g},w.extentMajor([[-180,-90+F],[180,90-F]]).extentMinor([[-180,-80-F],[180,80+F]])}const kn=n=>n;var an=new It,Sn=new It,mr,gr,Tn,An,At={point:ct,lineStart:ct,lineEnd:ct,polygonStart:function(){At.lineStart=So,At.lineEnd=Ao},polygonEnd:function(){At.lineStart=At.lineEnd=At.point=ct,an.add(Y(Sn)),Sn=new It},result:function(){var n=an/2;return an=new It,n}};function So(){At.point=To}function To(n,t){At.point=_r,mr=Tn=n,gr=An=t}function _r(n,t){Sn.add(An*n-Tn*t),Tn=n,An=t}function Ao(){_r(mr,gr)}var Qt=1/0,Pe=Qt,de=-Qt,Ie=de,De={point:Co,lineStart:ct,lineEnd:ct,polygonStart:ct,polygonEnd:ct,result:function(){var n=[[Qt,Pe],[de,Ie]];return de=Ie=-(Pe=Qt=1/0),n}};function Co(n,t){n<Qt&&(Qt=n),n>de&&(de=n),t<Pe&&(Pe=t),t>Ie&&(Ie=t)}var Cn=0,Rn=0,oe=0,Fe=0,Ve=0,Wt=0,On=0,Nn=0,ae=0,yr,xr,_t,yt,at={point:Ft,lineStart:As,lineEnd:Cs,polygonStart:function(){at.lineStart=No,at.lineEnd=jo},polygonEnd:function(){at.point=Ft,at.lineStart=As,at.lineEnd=Cs},result:function(){var n=ae?[On/ae,Nn/ae]:Wt?[Fe/Wt,Ve/Wt]:oe?[Cn/oe,Rn/oe]:[NaN,NaN];return Cn=Rn=oe=Fe=Ve=Wt=On=Nn=ae=0,n}};function Ft(n,t){Cn+=n,Rn+=t,++oe}function As(){at.point=Ro}function Ro(n,t){at.point=Oo,Ft(_t=n,yt=t)}function Oo(n,t){var e=n-_t,s=t-yt,r=jt(e*e+s*s);Fe+=r*(_t+n)/2,Ve+=r*(yt+t)/2,Wt+=r,Ft(_t=n,yt=t)}function Cs(){at.point=Ft}function No(){at.point=Lo}function jo(){wr(yr,xr)}function Lo(n,t){at.point=wr,Ft(yr=_t=n,xr=yt=t)}function wr(n,t){var e=n-_t,s=t-yt,r=jt(e*e+s*s);Fe+=r*(_t+n)/2,Ve+=r*(yt+t)/2,Wt+=r,r=yt*n-_t*t,On+=r*(_t+n),Nn+=r*(yt+t),ae+=r*3,Ft(_t=n,yt=t)}function br(n){this._context=n}br.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:{this._context.moveTo(n,t),this._point=1;break}case 1:{this._context.lineTo(n,t);break}default:{this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,ut);break}}},result:ct};var jn=new It,ln,Er,kr,le,ce,pe={point:ct,lineStart:function(){pe.point=Mo},lineEnd:function(){ln&&Sr(Er,kr),pe.point=ct},polygonStart:function(){ln=!0},polygonEnd:function(){ln=null},result:function(){var n=+jn;return jn=new It,n}};function Mo(n,t){pe.point=Sr,Er=le=n,kr=ce=t}function Sr(n,t){le-=n,ce-=t,jn.add(jt(le*le+ce*ce)),le=n,ce=t}let Rs,qe,Os,Ns;class js{constructor(t){this._append=t==null?Tr:Bo(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:{this._append`M${t},${e}`,this._point=1;break}case 1:{this._append`L${t},${e}`;break}default:{if(this._append`M${t},${e}`,this._radius!==Os||this._append!==qe){const s=this._radius,r=this._;this._="",this._append`m0,${s}a${s},${s} 0 1,1 0,${-2*s}a${s},${s} 0 1,1 0,${2*s}z`,Os=s,qe=this._append,Ns=this._,this._=r}this._+=Ns;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Tr(n){let t=1;this._+=n[0];for(const e=n.length;t<e;++t)this._+=arguments[t]+n[t]}function Bo(n){const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);if(t>15)return Tr;if(t!==Rs){const e=10**t;Rs=t,qe=function(r){let i=1;this._+=r[0];for(const o=r.length;i<o;++i)this._+=Math.round(arguments[i]*e)/e+r[i]}}return qe}function $o(n,t){let e=3,s=4.5,r,i;function o(a){return a&&(typeof s=="function"&&i.pointRadius(+s.apply(this,arguments)),qt(a,r(i))),i.result()}return o.area=function(a){return qt(a,r(At)),At.result()},o.measure=function(a){return qt(a,r(pe)),pe.result()},o.bounds=function(a){return qt(a,r(De)),De.result()},o.centroid=function(a){return qt(a,r(at)),at.result()},o.projection=function(a){return arguments.length?(r=a==null?(n=null,kn):(n=a).stream,o):n},o.context=function(a){return arguments.length?(i=a==null?(t=null,new js(e)):new br(t=a),typeof s!="function"&&i.pointRadius(s),o):t},o.pointRadius=function(a){return arguments.length?(s=typeof a=="function"?a:(i.pointRadius(+a),+a),o):s},o.digits=function(a){if(!arguments.length)return e;if(a==null)e=null;else{const u=Math.floor(a);if(!(u>=0))throw new RangeError(`invalid digits: ${a}`);e=u}return t===null&&(i=new js(e)),o},o.projection(n).digits(e).context(t)}function Hn(n){return function(t){var e=new Ln;for(var s in n)e[s]=n[s];return e.stream=t,e}}function Ln(){}Ln.prototype={constructor:Ln,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Wn(n,t,e){var s=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),s!=null&&n.clipExtent(null),qt(e,n.stream(De)),t(De.result()),s!=null&&n.clipExtent(s),n}function Ar(n,t,e){return Wn(n,function(s){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=Math.min(r/(s[1][0]-s[0][0]),i/(s[1][1]-s[0][1])),a=+t[0][0]+(r-o*(s[1][0]+s[0][0]))/2,u=+t[0][1]+(i-o*(s[1][1]+s[0][1]))/2;n.scale(150*o).translate([a,u])},e)}function Po(n,t,e){return Ar(n,[[0,0],t],e)}function Io(n,t,e){return Wn(n,function(s){var r=+t,i=r/(s[1][0]-s[0][0]),o=(r-i*(s[1][0]+s[0][0]))/2,a=-i*s[0][1];n.scale(150*i).translate([o,a])},e)}function Do(n,t,e){return Wn(n,function(s){var r=+t,i=r/(s[1][1]-s[0][1]),o=-i*s[0][0],a=(r-i*(s[1][1]+s[0][1]))/2;n.scale(150*i).translate([o,a])},e)}var Ls=16,Fo=X(30*nt);function Ms(n,t){return+t?qo(n,t):Vo(n)}function Vo(n){return Hn({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}})}function qo(n,t){function e(s,r,i,o,a,u,d,l,c,h,p,f,x,g){var w=d-s,b=l-r,v=w*w+b*b;if(v>4*t&&x--){var _=o+h,k=a+p,R=u+f,P=jt(_*_+k*k+R*R),N=Dt(R/=P),S=Y(Y(R)-1)<F||Y(i-c)<F?(i+c)/2:Gt(k,_),C=n(S,N),E=C[0],$=C[1],O=E-s,j=$-r,y=b*O-w*j;(y*y/v>t||Y((w*O+b*j)/v-.5)>.3||o*h+a*p+u*f<Fo)&&(e(s,r,i,o,a,u,E,$,S,_/=P,k/=P,R,x,g),g.point(E,$),e(E,$,S,_,k,R,d,l,c,h,p,f,x,g))}}return function(s){var r,i,o,a,u,d,l,c,h,p,f,x,g={point:w,lineStart:b,lineEnd:_,polygonStart:function(){s.polygonStart(),g.lineStart=k},polygonEnd:function(){s.polygonEnd(),g.lineStart=b}};function w(N,S){N=n(N,S),s.point(N[0],N[1])}function b(){c=NaN,g.point=v,s.lineStart()}function v(N,S){var C=Zt([N,S]),E=n(N,S);e(c,h,l,p,f,x,c=E[0],h=E[1],l=N,p=C[0],f=C[1],x=C[2],Ls,s),s.point(c,h)}function _(){g.point=w,s.lineEnd()}function k(){b(),g.point=R,g.lineEnd=P}function R(N,S){v(r=N,S),i=c,o=h,a=p,u=f,d=x,g.point=v}function P(){e(c,h,l,p,f,x,i,o,r,a,u,d,Ls,s),g.lineEnd=_,_()}return g}}var zo=Hn({point:function(n,t){this.stream.point(n*nt,t*nt)}});function Uo(n){return Hn({point:function(t,e){var s=n(t,e);return this.stream.point(s[0],s[1])}})}function Yo(n,t,e,s,r){function i(o,a){return o*=s,a*=r,[t+n*o,e-n*a]}return i.invert=function(o,a){return[(o-t)/n*s,(e-a)/n*r]},i}function Bs(n,t,e,s,r,i){if(!i)return Yo(n,t,e,s,r);var o=X(i),a=H(i),u=o*n,d=a*n,l=o/n,c=a/n,h=(a*e-o*t)/n,p=(a*t+o*e)/n;function f(x,g){return x*=s,g*=r,[u*x-d*g+t,e-d*x-u*g]}return f.invert=function(x,g){return[s*(l*x-c*g+h),r*(p-c*x-l*g)]},f}function Ho(n){return Wo(function(){return n})()}function Wo(n){var t,e=150,s=480,r=250,i=0,o=0,a=0,u=0,d=0,l,c=0,h=1,p=1,f=null,x=ks,g=null,w,b,v,_=kn,k=.5,R,P,N,S,C;function E(y){return N(y[0]*nt,y[1]*nt)}function $(y){return y=N.invert(y[0],y[1]),y&&[y[0]*Tt,y[1]*Tt]}E.stream=function(y){return S&&C===y?S:S=zo(Uo(l)(x(R(_(C=y)))))},E.preclip=function(y){return arguments.length?(x=y,f=void 0,j()):x},E.postclip=function(y){return arguments.length?(_=y,g=w=b=v=null,j()):_},E.clipAngle=function(y){return arguments.length?(x=+y?wo(f=y*nt):(f=null,ks),j()):f*Tt},E.clipExtent=function(y){return arguments.length?(_=y==null?(g=w=b=v=null,kn):Eo(g=+y[0][0],w=+y[0][1],b=+y[1][0],v=+y[1][1]),j()):g==null?null:[[g,w],[b,v]]},E.scale=function(y){return arguments.length?(e=+y,O()):e},E.translate=function(y){return arguments.length?(s=+y[0],r=+y[1],O()):[s,r]},E.center=function(y){return arguments.length?(i=y[0]%360*nt,o=y[1]%360*nt,O()):[i*Tt,o*Tt]},E.rotate=function(y){return arguments.length?(a=y[0]%360*nt,u=y[1]%360*nt,d=y.length>2?y[2]%360*nt:0,O()):[a*Tt,u*Tt,d*Tt]},E.angle=function(y){return arguments.length?(c=y%360*nt,O()):c*Tt},E.reflectX=function(y){return arguments.length?(h=y?-1:1,O()):h<0},E.reflectY=function(y){return arguments.length?(p=y?-1:1,O()):p<0},E.precision=function(y){return arguments.length?(R=Ms(P,k=y*y),j()):jt(k)},E.fitExtent=function(y,L){return Ar(E,y,L)},E.fitSize=function(y,L){return Po(E,y,L)},E.fitWidth=function(y,L){return Io(E,y,L)},E.fitHeight=function(y,L){return Do(E,y,L)};function O(){var y=Bs(e,0,0,h,p,c).apply(null,t(i,o)),L=Bs(e,s-y[0],r-y[1],h,p,c);return l=fo(a,u,d),P=bn(t,L),N=bn(l,P),R=Ms(P,k),j()}function j(){return S=C=null,E}return function(){return t=n.apply(this,arguments),E.invert=t.invert&&$,O()}}function Xo(n){return function(t,e){var s=jt(t*t+e*e),r=n(s),i=H(r),o=X(r);return[Gt(t*i,s*o),Dt(s&&e*i/s)]}}function Cr(n,t){return[X(t)*H(n),H(t)]}Cr.invert=Xo(Dt);function Ko(){return Ho(Cr).scale(249.5).clipAngle(90+F)}var Jo=me('<path fill="none" stroke="rgb(255,255,255)" stroke-width="0.3"></path>');function $s(n,t){Q(t,!0);let e=z(0),s=z(0);const r=Ye.subscribe(c=>{I(e,J(c.deg_x)),I(s,J(c.deg_y))});ht(()=>{r&&r()});const i=zt(t,"scale",3,2e3),o=zt(t,"steps",3,5),a=ko().stepMajor([45,45]).stepMinor([o(),o()]);let u=Kt(()=>Ko().scale(i()).rotate([-m(e),-m(s)]).translate([1080/2,810/2]).clipAngle(40)),d=Kt(()=>$o().projection(m(u)));var l=Jo();st(()=>K(l,"d",m(d)(a()))),B(n,l),tt()}var Go=(n,t)=>t("A"),Zo=(n,t)=>t("B"),Qo=q('<div id="camera-stream" class="svelte-zqlhxu"><button id="telescope-stream"><svg class="svg-img svelte-zqlhxu" viewBox="0 0 1080 810" preserveAspectRatio="xMidYMid slice"><foreignObject class="img-wrap svelte-zqlhxu" x="0" y="0" width="1080" height="810"><img alt="Telescope" class="svg-img svelte-zqlhxu"></foreignObject><!></svg></button> <button id="viewfinder-stream"><svg class="svg-img svelte-zqlhxu" viewBox="0 0 1080 810" preserveAspectRatio="xMidYMid slice"><foreignObject class="img-wrap svelte-zqlhxu" x="0" y="0" width="1080" height="810"><img alt="Viewfinder" class="svg-img svelte-zqlhxu"></foreignObject><g><rect class="crosshair svelte-zqlhxu" x="540" y="405"></rect><!></g></svg></button></div>');function ta(n,t){Q(t,!0);const e=Nt(),s=()=>wt(ui,"$locHost",e),r=()=>wt(Re,"$swapPreview",e);let i=z(0),o=z(0),a=z(void 0);const u=Re.subscribe(E=>{I(a,J(E))}),d=E=>{m(a)!==E&&Re.update($=>E)};let l=J({CrosshairSize:.4,CrosshairOffsetX:0,CrosshairOffsetY:0,SphereScaleVF:1500,SphereScaleTel:24e3}),c=he.subscribe(E=>{for(let $ of E)l[$.id]=$.value}),h=z("starfield-zoom.jpg"),p=z("starfield.jpg");ge(()=>{I(h,`${s()}:7777/stream_a.mjpg`),I(p,`${s()}:7777/stream_b.mjpg`),rt("/config/sphere/settings",E=>{console.log("MOUNT ",E),he.update($=>$.map(O=>O!=null&&O.id&&Object.hasOwn(E,O.id)?{...O,value:E[O.id]}:{...O}))})}),ht(()=>{u&&u(),c&&c()});var f=Qo(),x=A(f);x.__click=[Go,d];var g=A(x),w=A(g),b=A(w);T(w);var v=M(w);$s(v,{get scale(){return l.SphereScaleTel},steps:"1",get width(){return m(i)},get height(){return m(o)}}),T(g),T(x);var _=M(x,2);_.__click=[Zo,d];var k=A(_),R=A(k),P=A(R);T(R);var N=M(R),S=A(N),C=M(S);$s(C,{get scale(){return l.SphereScaleVF},steps:"5",get width(){return m(i)},get height(){return m(o)}}),T(N),T(k),T(_),T(f),st(()=>{Pt(x,`stream-wrapper ${(r()==="A"?"large":"")??""} svelte-zqlhxu`),K(g,"width",m(i)),K(g,"height",m(o)),K(b,"src",m(h)),Pt(_,`stream-wrapper ${(r()==="B"?"large":"")??""} svelte-zqlhxu`),K(k,"width",m(i)),K(k,"height",m(o)),K(P,"src",m(p)),K(N,"transform",`translate(${m(i)/4*l.CrosshairOffsetX} ${m(o)/4*l.CrosshairOffsetY})`),K(S,"transform",`translate(${m(i)*l.CrosshairSize*-.5} ${m(o)*l.CrosshairSize*-.5})`),K(S,"width",m(i)*l.CrosshairSize),K(S,"height",m(o)*l.CrosshairSize)}),cs(f,"clientWidth",E=>I(i,E)),cs(f,"clientHeight",E=>I(o,E)),B(n,f),tt()}ft(["click"]);var ea=q('<div class="layer svelte-qmdbdl"><!></div>'),na=q('<div class="visuals svelte-qmdbdl"><!> <!></div>');function sa(n){const t=Nt(),e=()=>wt(fn,"$displayCompass",t);var s=na(),r=A(s);ta(r,{});var i=M(r,2);Z(i,e,o=>{var a=ea(),u=A(a);fi(u,{}),T(a),B(o,a)}),T(s),B(n,s)}class ra{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=200,this.deadZone=8,this.active=!1,this.value={x:0,y:0},this.counter=0,this.prev={x:0,y:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",s=>{this._handleDown(s)}),this.stick.addEventListener("touchstart",s=>{this._handleDown(s)}),document.addEventListener("mousemove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("touchmove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("mouseup",s=>{this._handleUp(s)}),document.addEventListener("touchend",s=>{this._handleUp(s)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.clientX,y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;let e=null;if(t.changedTouches){for(let g=0;g<t.changedTouches.length;g++)this.touchId===t.changedTouches[g].identifier&&(e=g,t.clientX=t.changedTouches[g].clientX,t.clientY=t.changedTouches[g].clientY);if(e==null)return}const s=this.stick.getBoundingClientRect(),r=s?Math.round(16e3/s.width)/100:1,i=t.clientX-this.dragStart.x,o=t.clientY-this.dragStart.y,a=Math.atan2(o,i),u=Math.min(this.maxDistance,Math.hypot(i,o)*r),d=u*Math.cos(a),l=u*Math.sin(a);this.stick.style.transform=`translate(${d}px, ${l}px)`;const c=u<this.deadZone?0:this.maxDistance/(this.maxDistance-this.deadZone)*(u-this.deadZone),h=c*Math.cos(a),p=c*Math.sin(a),f=parseFloat((h/this.maxDistance).toFixed(4)),x=parseFloat((p/this.maxDistance).toFixed(4));this.value={x:f,y:x},this._loop()}_handleUp(t){this.active&&(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier||(this.stick.style.transition=".2s",this.stick.style.transform="translate3d(0px, 0px, 0px)",this.value={x:0,y:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5+this.value.x*511.5),e=Math.round(511.5+this.value.y*511.5);this.callback(`/joystick/${t}/${e}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){(this.value.x!==this.prev.x||this.value.y!==this.prev.y)&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}class ia{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=230,this.deadZone=8,this.active=!1,this.value={f:0},this.counter=0,this.prev={f:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",s=>{this._handleDown(s)}),this.stick.addEventListener("touchstart",s=>{this._handleDown(s)}),document.addEventListener("mousemove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("touchmove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("mouseup",s=>{this._handleUp(s)}),document.addEventListener("touchend",s=>{this._handleUp(s)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{y:t.changedTouches[0].clientY}:{y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;t.preventDefault();let e=null;if(t.changedTouches){for(let u=0;u<t.changedTouches.length;u++)this.touchId===t.changedTouches[u].identifier&&(e=u,t.clientY=t.changedTouches[u].clientY);if(e==null)return}const s=this.stick.getBoundingClientRect(),r=s?Math.round(1e4/s.width)/100:1,i=t.clientY-this.dragStart.y,o=i>=0?Math.min(this.maxDistance,i*r):Math.max(-this.maxDistance,i*r);this.stick.style.transform=`translateY(${o}px)`;const a=Math.abs(o)>this.deadZone?parseFloat((o/this.maxDistance).toFixed(4)):0;this.value={f:a},this._loop()}_handleUp(t){this.active&&(t.preventDefault(),!(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier)&&(this.stick.style.transition=".2s",this.stick.style.transform="translateY(0px)",this.value={f:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5-this.value.f*511.5);this.callback(`/focus/${t}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){this.value.f!==this.prev.f&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}var oa=me('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-8uha02"><defs><circle id="joys-def-cir1" r="280" cy="0"></circle><circle id="joys-def-cir2" r="80" cy="0"></circle><path id="joys-def-arrow" d="M0 -120 -40 -100 40 -100z"></path><rect id="joys-def-slider" width="70" height="560" transform="translate(350 -280)" rx="15" ry="15"></rect><rect id="joys-def-slide" width="100" height="100" transform="translate(335 -50)" rx="15" ry="15"></rect></defs><g id="joys" transform="translate(320 355)" class="svelte-8uha02"><use id="joys-plate" href="#joys-def-cir1" class="svelte-8uha02"></use><use id="joys-arrow-top" href="#joys-def-arrow" class="svelte-8uha02"></use><use id="joys-arrow-right" href="#joys-def-arrow" transform="rotate(90)" class="svelte-8uha02"></use><use id="joys-arrow-left" href="#joys-def-arrow" transform="rotate(-90)" class="svelte-8uha02"></use><use id="joys-arrow-bottom" href="#joys-def-arrow" transform="rotate(180)" class="svelte-8uha02"></use><use id="joys-stick" href="#joys-def-cir2" style="transform: translate(0px, 0px)" class="svelte-8uha02"></use><use id="joys-slider" href="#joys-def-slider" class="svelte-8uha02"></use><use id="joys-slide" href="#joys-def-slide" style="transform: translateY(0px)" class="svelte-8uha02"></use><a href="#toggle" role="button" tabindex="0" aria-label="Change to adjustment tool"><g id="joys-swap" transform="translate(-250,250)" class="svelte-8uha02"><circle class="element svelte-8uha02" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M6.121 13c-.553 0-1 .448-1 1s.447 1 1 1h1.465l-3.293 3.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.414-3.414v1.707c0 .552.447 1 1 1s.879-.448.879-1v-5h-4.879zM7 11c.552 0 1-.448 1-1v-2h2c.553 0 1-.448 1-1s-.447-1-1-1h-3.999l-.001 4c0 .552.447 1 1 1zM17 13c-.553 0-1 .448-1 1v2h-2c-.553 0-1 .448-1 1s.447 1 1 1h4v-4c0-.552-.447-1-1-1zM18.293 4.293l-3.293 3.293v-1.586c0-.552-.447-1-1-1s-1 .448-1 1v5h5c.552 0 1-.448 1-1s-.447-1-1-1h-1.586l3.293-3.292c.391-.391.391-1.023 0-1.414s-1.023-.392-1.414-.001z" class="svelte-8uha02"></path></g></g></a></g></svg>');function aa(n,t){Q(t,!0);let e=null,s=null;ge(()=>{e=new ra(document.getElementById("joys-stick"),a=>{rt(a,u=>{console.log("SVELTE Joystick",u)})}),s=new ia(document.getElementById("joys-slide"),a=>{rt(a,u=>{console.log("SVELTE Focus",u)})})}),ht(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy(),s&&s.hasOwnProperty("destroy")&&s.destroy()});var r=oa(),i=M(A(r)),o=M(A(i),8);o.__click=function(...a){var u;(u=t.toggle)==null||u.apply(this,a)},T(i),T(r),B(n,r),tt()}ft(["click"]);class la{constructor(t,e){if(this.adjust=t,this.adjust){this.callback=e;const s=8e4/360;this.axisSteps={lg:Math.round(s),md:Math.round(s/10),sm:Math.round(s/100)},this.adjust.addEventListener("mouseup",r=>{this.sendCommand(r.target.dataset)})}}destroy(){this.adjust.removeEventListener("mouseup",t=>{this.sendCommand(t.target.dataset)})}sendCommand(t){let e=t==null?void 0:t.dir,s=t==null?void 0:t.len;e&&s&&typeof this.axisSteps[s]=="number"&&(s=this.axisSteps[s],["closer","further"].indexOf(e)>=0&&(s=e==="closer"?-s:s,e="focus"),this.callback(`/adjust/${e}/${s}`))}}var ca=me('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-1d0wo2a"><defs><path id="arr1" d="M45 45 5 45 10 95 95 95 95 10 45 5z"></path><path id="arr2" d="M105 105 11 105 17 165 165 165 165 17 105 11z"></path><path id="arr3" d="M175 175 18 175 25 245 245 245 245 25 175 18z"></path><circle id="cir1" r="44" cy="73"></circle><path id="cir2" d="M-54 73 A 75 75 0 1 0 54 73 A 54 54 0 0 1 -54 73z"></path><path id="cir3" d="M-85 125 A 108 108 0 1 0 85 125 A 54 54 0 0 1 -85 125z"></path></defs><g id="adjust" transform="translate(355 355)" class="svelte-1d0wo2a"><g transform="rotate(135)"><use href="#arr1" data-dir="left" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="left" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="left" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="rotate(-45)"><use href="#arr1" data-dir="right" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="right" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="right" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="rotate(-135)"><use href="#arr1" data-dir="up" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="up" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="up" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="rotate(45)"><use href="#arr1" data-dir="down" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="down" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="down" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="translate(360 -50) rotate(165)"><use href="#cir1" data-dir="further" data-len="sm" class="svelte-1d0wo2a"></use><use href="#cir2" data-dir="further" data-len="md" class="svelte-1d0wo2a"></use><use href="#cir3" data-dir="further" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="translate(360 50) rotate(15)"><use href="#cir1" data-dir="closer" data-len="sm" class="svelte-1d0wo2a"></use><use href="#cir2" data-dir="closer" data-len="md" class="svelte-1d0wo2a"></use><use href="#cir3" data-dir="closer" data-len="lg" class="svelte-1d0wo2a"></use></g><a href="#toggle" role="button" tabindex="0" aria-label="Change to Joystick"><g id="joys-swap" transform="translate(-285,250)" class="svelte-1d0wo2a"><circle class="element svelte-1d0wo2a" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M17.707 8.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l1.293 1.293h-4.586v-4.586l1.293 1.293c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-3.707-3.707-3.707 3.707c-.391.391-.391 1.023 0 1.414s1.023.391 1.414 0l1.293-1.293v4.586h-4.586l1.293-1.293c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-3.707 3.707 3.707 3.707c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-1.293-1.293h4.586v4.586l-1.293-1.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l3.707 3.707 3.707-3.707c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-1.293 1.293v-4.586h4.586l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707z" class="svelte-1d0wo2a"></path></g></g></a></g></svg>');function ua(n,t){Q(t,!0);let e=null;ge(()=>{e=new la(document.getElementById("adjust"),o=>{rt(o,a=>{console.log("SVELTE Adjust",a)})})}),ht(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy()});var s=ca(),r=M(A(s)),i=M(A(r),6);i.__click=function(...o){var a;(a=t.toggle)==null||a.apply(this,o)},T(r),T(s),B(n,s),tt()}ft(["click"]);var ha=q('<div class="joystick-wrapper svelte-gruxg2"><!></div>');function fa(n){let t=z("mov");const e=i=>{i.preventDefault(),I(t,J(m(t)==="mov"?"adj":"mov"))};var s=ha(),r=A(s);Z(r,()=>m(t)==="mov",i=>{aa(i,{toggle:e})},i=>{ua(i,{toggle:e})}),T(s),B(n,s)}function Mn(n){return typeof n=="string"?n.toLowerCase().trim().replaceAll("ä","ae").replaceAll("ö","oe").replaceAll("ü","ue").replaceAll("ß","ss").replace(/\W+/g,"_").replace(/^_|_$/g,""):null}const Ps={fid:"",geo:{addr:"",lat:53.6,lon:9.9},base:[{id:"home",name:"Primary target",pos:{x:-23900,y:0,f:500}},{id:"polaris",name:"Polaris",pos:{x:0,y:11912,f:600}}]};function da(n,t){const e={...Ps.geo,addr:t},s=[];for(let r of Ps.base)s.push({...r,pos:{...r.pos}});return{fid:n,geo:e,base:s}}var pa=(n,t)=>{I(t,!1)},va=q('<header><input type="text" id="address" placeholder="Address"></header> <div class="flexbox"><input type="text" id="latitude" placeholder="Latitude"> <input type="text" id="longitude" placeholder="Longitude"></div> <button class="button button-small">Save location</button> <button class="button">Cancel</button>',1),ma=(n,t)=>{I(t,!0)},ga=q('<header> <button class="edit-button icon-edit" aria-label="Edit"></button></header>'),_a=q("<div> </div>"),ya=q("<!> <!>",1),xa=(n,t,e)=>t(n,`/navi/position/${m(e).id}`),wa=(n,t,e)=>t(m(e).id),ba=q('<button class="delete-button icon-delete" aria-label="Delete" title="Delete"></button>'),Ea=q("<li><button> </button> <!></li>"),ka=q('<div class="nav-add"><label for="new-name">Save/update current position as ...</label> <input type="text" id="new-name" class="input" placeholder="Enter position name"> <div class="margin-bottom"><sub> </sub></div> <button class="button button-small">Save target</button></div>'),Sa=q('<div class="nav-selector"><button class="button button-small">Change location</button></div>'),Ta=q('<div class="content-card"><div class="nav-curr-pos"><!></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function Aa(n,t){Q(t,!0);const e=Nt(),s=()=>wt(gt,"$positions",e),r=()=>wt(Ye,"$arduinoSettings",e);let i=z(!1),o=z(""),a=Kt(()=>Mn(m(o))),u=z(""),d=z(""),l=z(""),c=z(J([]));const h=gt.subscribe(S=>{S!=null&&S.fid&&(I(u,J(S.geo.addr)),I(d,J(S.geo.lat)),I(l,J(S.geo.lon)),I(c,J([...S.base])))});ht(()=>{h&&h()});const p=()=>{const S={...s()};Xe(`/navi/position/update/${S.fid}`,S,C=>{console.log("SVELTE saved",C)})},f=()=>{const S={addr:m(u),lat:parseFloat(m(d)),lon:parseFloat(m(l))};gt.update(C=>({...C,geo:S})),p(),I(i,!1)},x=()=>{const S=Mn(m(o));if(S){let C=!1;const E=(({x:O,y:j,f:y})=>({x:O,y:j,f:y}))(r());let $=m(c).map(O=>O.id!==S?O:(C=!0,{...O,pos:E}));C||$.push({id:S,name:m(o),pos:E}),gt.update(O=>({...O,base:$})),p(),I(o,"")}I(i,!1)},g=S=>S==="home"?"icon-home":S==="polaris"?"icon-star":"icon-target",w=S=>{if(confirm(`Do you really want to delete position: "${S}"`)){const C=[...s().base].filter(E=>E.id!==S);gt.update(E=>({...E,base:C})),p(),I(i,!1)}},b=(S,C)=>{S.preventDefault(),rt(C,E=>{console.log("SVELTE position",E)})};var v=Ta(),_=A(v),k=A(_);Z(k,()=>m(i),S=>{var C=va(),E=mt(C),$=A(E);Ut($),T(E);var O=M(E,2),j=A(O);Ut(j);var y=M(j,2);Ut(y),T(O);var L=M(O,2);L.__click=f;var U=M(L,2);U.__click=[pa,i],Yt($,()=>m(u),W=>I(u,W)),Yt(j,()=>m(d),W=>I(d,W)),Yt(y,()=>m(l),W=>I(l,W)),B(S,C)},S=>{var C=ya(),E=mt(C);Z(E,()=>m(u),O=>{var j=ga(),y=A(j),L=M(y);L.__click=[ma,i],T(j),st(()=>pt(y,`${m(u)??""} `)),B(O,j)});var $=M(E,2);Z($,()=>m(d)&&m(l),O=>{var j=_a(),y=A(j);T(j),st(()=>pt(y,`${m(d)??""}°, ${m(l)??""}°`)),B(O,j)}),B(S,C)}),T(_);var R=M(_,2),P=A(R);$t(P,21,()=>m(c),Jt,(S,C)=>{var E=Ea(),$=A(E);const O=Kt(()=>`nav-button ${g(m(C).id)??""}`);$.__click=[xa,b,C];var j=A($,!0);T($);var y=M($,2);Z(y,()=>m(i)&&m(C).id!=="home"&&m(C).id!=="polaris",L=>{var U=ba();U.__click=[wa,w,C],B(L,U)}),T(E),st(()=>{Pt($,m(O)),pt(j,m(C).name)}),B(S,E)}),T(P),T(R);var N=M(R,2);Z(N,()=>m(i),S=>{var C=ka(),E=M(A(C),2);Ut(E);var $=M(E,2),O=A($),j=A(O);T(O),T($);var y=M($,2);y.__click=x,T(C),st(()=>{pt(j,`ID: ${m(a)??""}`),y.disabled=m(a).length<3}),Yt(E,()=>m(o),L=>I(o,L)),B(S,C)},S=>{var C=Sa(),E=A(C);E.__click=function(...$){var O;(O=t.toggleAdmin)==null||O.apply(this,$)},T(C),B(S,C)}),T(v),B(n,v),tt()}ft(["click"]);const Ca=(n,t)=>{I(t,!m(t))};var Ra=(n,t,e)=>t(m(e).fid),Oa=(n,t,e)=>t(m(e).fid),Na=q('<button class="delete-button icon-delete" aria-label="Delete"></button>'),ja=q('<li><button class="nav-button icon-location"> </button> <!></li>'),La=(n,t)=>t(),Ma=q('<div class="nav-add"><input type="text" id="new-location" class="input" placeholder="Enter new location name"> <button class="button">+&nbsp;Add</button></div> <div> </div>',1),Ba=q('<div class="nav-selector"><button class="button button-small">&laquo;&nbsp;Back</button></div>'),$a=q('<div class="content-card"><header>Locations <button aria-label="Edit"></button></header> <div class="nav-curr-pos"><div><p>The location is the place where your telescope is placed.</p></div></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function Pa(n,t){Q(t,!0);const e=Nt(),s=()=>wt(ye,"$locations",e);let r=z("");const i=gt.subscribe(b=>{I(r,J(b.fid))});ht(()=>{i&&i()});let o=z(!1),a=z(""),u=Kt(()=>Mn(m(a)));const d=b=>{b!==m(r)&&rt(`/navi/location/${b}`,v=>{(v==null?void 0:v.fid)===b&&(gt.update(_=>({...v})),console.log("Loaded location"))})},l=()=>{if(m(u).length>=3){const b=da(m(u),m(a));Xe(`/navi/position/update/${m(u)}`,b,v=>{gt.update(_=>b),ye.update(_=>[..._,{fid:m(u),addr:m(a)}]),I(a,""),console.log("Added new location",v)})}else console.error("ID is too short. At least 3 char are required.")},c=b=>{confirm(`Do you really want to delete location: "${b}"`)?rt(`/navi/location/delete/${b}`,v=>{v.response===200&&(ye.update(_=>_.filter(k=>k.fid!==b)),alert(`Location "${b}" deleted`))}):alert(`Deletion of "${b}" canceled.`)};ge(()=>{s().length===0&&rt("/navi/location-list",b=>{ye.update(v=>[...b]),console.log("Loaded location list")})});var h=$a(),p=A(h),f=M(A(p));f.__click=[Ca,o],T(p);var x=M(p,4),g=A(x);$t(g,5,s,Jt,(b,v)=>{var _=ja(),k=A(_);k.__click=[Ra,d,v];var R=A(k,!0);T(k);var P=M(k,2);Z(P,()=>m(o)&&m(v).fid!==m(r)&&m(v).fid!=="index",N=>{var S=Na();S.__click=[Oa,c,v],B(N,S)}),T(_),st(()=>{Pt(_,m(v).fid===m(r)?"active":""),pt(R,m(v).addr)}),B(b,_)}),T(g),T(x);var w=M(x,2);Z(w,()=>m(o),b=>{var v=Ma(),_=mt(v),k=A(_);Ut(k);var R=M(k,2);R.__click=[La,l],T(_);var P=M(_,2),N=A(P,!0);T(P),st(()=>pt(N,m(u))),Yt(k,()=>m(a),S=>I(a,S)),B(b,v)},b=>{var v=Ba(),_=A(v);_.__click=function(...k){var R;(R=t.toggleAdmin)==null||R.apply(this,k)},T(v),B(b,v)}),T(h),st(()=>Pt(f,`edit-button icon-edit${(m(o)?" active":"")??""}`)),B(n,h),tt()}ft(["click"]);function Ia(n,t){Q(t,!0);const e=Nt(),s=()=>wt(gt,"$positions",e);let r=z(!1);const i=()=>{I(r,!m(r))};ge(()=>{var u;(u=s())!=null&&u.fid||rt("/navi/location/index",d=>{(d==null?void 0:d.fid)==="index"&&gt.update(l=>({...d}))})});var o=Mt(),a=mt(o);Z(a,()=>m(r),u=>{Pa(u,{toggleAdmin:i})},u=>{Aa(u,{toggleAdmin:i})}),B(n,o),tt()}var Da=(n,t,e)=>{t.callback(t.id,e())},Fa=q('<div class="slider-wrapper svelte-1eb8x9l"><label class="svelte-1eb8x9l"> </label> <input type="range" class="svelte-1eb8x9l"></div>');function Rr(n,t){Q(t,!0);let e=zt(t,"value",7,0),s=zt(t,"minValue",3,0),r=zt(t,"maxValue",3,10),i=zt(t,"steps",3,1);var o=Fa(),a=A(o),u=A(a,!0);T(a);var d=M(a,2);Ut(d),d.__change=[Da,t,e],T(o),st(()=>{K(a,"for","slider_slide_"+t.id),pt(u,t.name),K(d,"id","slider_slide_"+t.id),K(d,"min",s()),K(d,"max",r()),K(d,"step",i())}),Yt(d,e),B(n,o),tt()}ft(["change"]);var Va=q('<div class="camera-options svelte-1icpkjb"><!> <div class="actions-wrapper svelte-1icpkjb"><button class="svelte-1icpkjb">Reset defaults</button></div></div>');function qa(n,t){Q(t,!1);const e=Nt(),s=()=>wt(tn,"$camControls",e),r=(l,c)=>{tn.update(h=>h.map(p=>p.id===l?{...p,value:c}:{...p})),rt(`/cam/ctrl/${l}/${c}`,h=>{console.log("SVELTE CamCtrl",h)})},i=()=>{tn.update(c=>c.map(h=>({...h,value:h.defaultValue})));const l={};for(let c of s())c!=null&&c.id&&(l[c.id]=c.defaultValue);Xe("/cam/controls",l,c=>{console.log("SVELTE Cam Controls",c)})};Hs();var o=Va(),a=A(o);$t(a,3,s,l=>l.name,(l,c,h)=>{Rr(l,Ys(()=>m(c),{get index(){return m(h)},callback:r}))});var u=M(a,2),d=A(u);d.__click=i,T(u),T(o),B(n,o),tt()}ft(["click"]);const za=()=>{Me.update(n=>!n)};var Ua=me('<polygon points="-15,-15 -15,15 15,15 15,-15" stroke-width="5" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),Ya=me('<polygon points="-7.5,-22.5 -7.5,22.5 20,0" stroke-width="10" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),Ha=q('<div id="video-recording" class="svelte-1utn7qk"><button aria-label="Record video" class="svelte-1utn7qk"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" preserveAspectRatio="xMinYMin slice" class="svelte-1utn7qk"><g transform="translate(42,42)"><circle r="38" fill="none" stroke="#FFF" stroke-width="5"></circle><!></g></svg></button></div>');function Wa(n,t){Q(t,!0);let e=z(!1);const s=Me.subscribe(d=>{if(m(e)!==d){I(e,J(d));const l=m(e)?"start":"stop";rt(`/cam/video-rec/vid/${l}`,c=>{console.log("Video recording",c)})}});ht(()=>{s&&s()});var r=Ha(),i=A(r);i.__click=[za];var o=A(i),a=A(o),u=M(A(a));Z(u,()=>m(e),d=>{var l=Ua();B(d,l)},d=>{var l=Ya();B(d,l)}),T(a),T(o),T(i),T(r),B(n,r),tt()}ft(["click"]);var Xa=q('<h3 class="message svelte-19e5760"><!></h3>'),Ka=q('<div class="sphere-config svelte-19e5760"><!> <!> <div class="actions-wrapper svelte-19e5760"><button class="svelte-19e5760">Save settings</button></div></div>');function Ja(n,t){Q(t,!0);const e=Nt(),s=()=>wt(he,"$sphereControls",e);let r=z(void 0),i=z(J([]));const o=he.subscribe(f=>{I(i,J(f.map(x=>({...x}))))}),a=(f,x)=>{console.log(),he.update(g=>g.map(w=>w.id===f?{...w,value:x}:{...w}))},u=()=>{const f={};for(let x of s())f[x.id]=x.value;Xe("/config/sphere/settings",f,x=>{I(r,J((x==null?void 0:x.response)===200?'<span style="color:#090">Successfully saved settings.</span>':'<span style="color:#B00">Failed to save settings.</span>')),setTimeout(()=>{I(r,null)},5e3)})};ht(()=>{o&&o()});var d=Ka(),l=A(d);Z(l,()=>m(r),f=>{var x=Xa(),g=A(x);ri(g,()=>m(r)),T(x),B(f,x)});var c=M(l,2);$t(c,17,()=>m(i),Jt,(f,x,g)=>{Rr(f,Ys(()=>m(x),{index:g,callback:a}))});var h=M(c,2),p=A(h);p.__click=u,T(h),T(d),B(n,d),tt()}ft(["click"]);const Ga=(n,t)=>{const e=t()==="B"?"cam_b":"cam_a";rt(`/cam/capture-img/image/${e}`,s=>{console.log("Capture image",s)})},Za=(n,t,e,s)=>{const r=t()==="B"?"cam_b":"cam_a";rt(`/cam/snail-shot/${m(e)}/${m(s)}/${r}`,i=>{console.log("Snails",i,r)})};var Qa=(n,t)=>console.log("X:",m(t)),tl=q("<option></option>"),el=(n,t)=>console.log("Y:",m(t)),nl=q("<option></option>"),sl=q('<div id="image-capture" class="svelte-15orivu"><button aria-label="Capture image" class="svelte-15orivu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-15orivu"><g transform="translate(42,42)"><circle r="28" fill="#C00" stroke="#C00"></circle><circle r="38" fill="none" stroke="#FFF" stroke-width="5"></circle></g></svg></button> <button aria-label="Snail shot" class="svelte-15orivu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-15orivu"><g transform="translate(42,42)"><polyline points="0,0 20,0 20,15 -20,15 -20,-15 40,-15 40,30 -20,30 -12,28 -12,32 -20,30" style="fill:none;stroke:#FFF;stroke-width:3;stroke-linejoin:round;"></polyline></g></svg></button> <div class="dimensions svelte-15orivu"><label class="svelte-15orivu"><span class="svelte-15orivu">hor</span><select class="svelte-15orivu"></select></label> <label class="svelte-15orivu"><span class="svelte-15orivu">ver</span><select class="svelte-15orivu"></select></label></div></div>');function rl(n,t){Q(t,!0);const e=Nt(),s=()=>wt(Re,"$swapPreview",e);let r=z(3),i=z(3);var o=sl(),a=A(o);a.__click=[Ga,s];var u=M(a,2);u.__click=[Za,s,r,i];var d=M(u,2),l=A(d),c=M(A(l));c.__change=[Qa,r],$t(c,20,()=>Array.from({length:7}),Jt,(f,x,g)=>{var w=tl();w.value=(w.__value=g+3)==null?"":g+3,w.textContent=g+3,B(f,w)}),T(c),T(l);var h=M(l,2),p=M(A(h));p.__change=[el,i],$t(p,20,()=>Array.from({length:7}),Jt,(f,x,g)=>{var w=nl();w.value=(w.__value=g+3)==null?"":g+3,w.textContent=g+3,B(f,w)}),T(p),T(h),T(d),T(o),ls(c,()=>m(r),f=>I(r,f)),ls(p,()=>m(i),f=>I(i,f)),B(n,o),tt()}ft(["click","change"]);var il=q('<div class="tools svelte-1isvhs1"><!></div>');function ol(n,t){Q(t,!0);let e=z("");const s=hn.subscribe(o=>{I(e,J(o))});ht(()=>{s&&s()});var r=il(),i=A(r);Z(i,()=>m(e)==="target",o=>{fa(o)},o=>{var a=Mt(),u=mt(a);Z(u,()=>m(e)==="sphere",d=>{Ja(d,{})},d=>{var l=Mt(),c=mt(l);Z(c,()=>m(e)==="location",h=>{Ia(h,{})},h=>{var p=Mt(),f=mt(p);Z(f,()=>m(e)==="adjust",x=>{qa(x,{})},x=>{var g=Mt(),w=mt(g);Z(w,()=>m(e)==="video",b=>{Wa(b,{})},b=>{var v=Mt(),_=mt(v);Z(_,()=>m(e)==="picture",k=>{rl(k,{})},null,!0),B(b,v)},!0),B(x,g)},!0),B(h,p)},!0),B(d,l)},!0),B(o,a)}),T(r),B(n,r),tt()}var al=q('<li><button><span class="svelte-wkzjji"> </span></button></li>'),ll=q('<div id="options-menu" class="svelte-wkzjji"><ul class="svelte-wkzjji"></ul></div>');function cl(n,t){Q(t,!0);let e=z("");const s=hn.subscribe(l=>{I(e,J(l))});let r=z(!1);const i=fn.subscribe(l=>{I(r,J(l))}),o=l=>{hn.update(c=>c===l?"":l)};ht(()=>{s&&s(),i&&i()});const a=[{id:"sphere",name:"Sphere",icon:"icon-settings",callback:()=>{o("sphere")},enabled:()=>m(e)==="sphere"},{id:"compass",name:"Compass",icon:"icon-compass",callback:()=>{fn.update(l=>!l)},enabled:()=>m(r)},{id:"location",name:"Location",icon:"icon-location",callback:()=>{o("location")},enabled:()=>m(e)==="location"},{id:"target",name:"Target",icon:"icon-target",callback:()=>{o("target")},enabled:()=>m(e)==="target"},{id:"adjust",name:"Contrast",icon:"icon-adjust",callback:()=>{o("adjust")},enabled:()=>m(e)==="adjust"},{id:"video",name:"Video",icon:"icon-video",callback:()=>{o("video")},enabled:()=>m(e)==="video"},{id:"picture",name:"Picture",icon:"icon-image",callback:()=>{o("picture")},enabled:()=>m(e)==="picture"}];var u=ll(),d=A(u);$t(d,21,()=>a,Jt,(l,c)=>{var h=al();const p=Kt(()=>`${(m(c).enabled()?"active":"")??""} svelte-wkzjji`);var f=A(h);f.__click=function(...w){var b;(b=m(c).callback)==null||b.apply(this,w)};var x=A(f),g=A(x,!0);T(x),T(f),T(h),st(()=>{Pt(h,m(p)),Pt(f,`${m(c).icon??""} svelte-wkzjji`),pt(g,m(c).name)}),B(l,h)}),T(d),T(u),B(n,u),tt()}ft(["click"]);var ul=q('<div class="video-recorder svelte-tf4uvu"><button aria-label="Stop video recording" class="svelte-tf4uvu"><span class="icon-stop"></span> <span class="time"> </span></button></div>');function hl(n,t){Q(t,!0);const e={elapsedTime:0};let s=z("00:00:00");function r(c,h,p){const f=[c,h,p].map(x=>x<10?`0${x}`:x);I(s,J(f.join(":")))}function i(){e.startTime=Date.now(),e.intervalId=setInterval(()=>{const c=Date.now()-e.startTime+e.elapsedTime,h=parseInt(c/1e3%60,10),p=parseInt(c/(1e3*60)%60,10),f=parseInt(c/(1e3*60*60)%24,10);r(f,p,h)},1e3)}function o(){e.intervalId&&(clearInterval(e.intervalId),Me.update(()=>!1),I(s,"00:00:00"))}let a=z(!1);const u=Me.subscribe(c=>{c!==m(a)&&(c?i():o(),I(a,J(c)))});ht(()=>{u&&u()});var d=Mt(),l=mt(d);Z(l,()=>m(a),c=>{var h=ul(),p=A(h);p.__click=o;var f=M(A(p),2),x=A(f,!0);T(f),T(p),T(h),st(()=>pt(x,m(s))),B(c,h)}),B(n,d),tt()}ft(["click"]);var fl=q('<div class="tasks svelte-1i0wqs5"><!></div>');function dl(n){var t=fl(),e=A(t);hl(e,{}),T(t),B(n,t)}var pl=q('<div class="container svelte-dzpa42"><!> <!> <div class="controls svelte-dzpa42"><!></div> <!></div>');function kl(n){var t=pl(),e=A(t);dl(e);var s=M(e,2);sa(s);var r=M(s,2),i=A(r);ol(i,{}),T(r);var o=M(r,2);cl(o,{}),T(t),B(n,t)}export{kl as component};
