import{a as E,t as L,n as Bt,c as xt}from"../chunks/disclose-version.D-zl7_bA.js";import{x as Ke,h as Xe,k as z,B as Ft,C as Je,M as Qe,ai as Ae,P as Ge,Q as le,R as It,l as gt,ar as St,N as Ce,i as Se,O as Ze,an as ts,z as he,as as Zt,at as ue,au as te,av as es,a4 as ss,G as de,aw as rs,ah as ns,ax as is,j as as,ay as Re,y as os,ae as cs,a9 as ls,az as hs,ac as us,aA as ds,aB as fs,L as fe,aC as ps,aD as ms,am as vs,p as H,I as R,g as l,q as p,w as k,v as f,t as Q,o as W,aE as kt,aq as I,m as at,f as Nt}from"../chunks/runtime.BXMN-w1N.js";import{b as ct,o as wt,i as V,a as J,p as Et,s as gs}from"../chunks/index-client.BpDUxJDC.js";import{a as Z,d as st,s as mt,b as ut}from"../chunks/store.CK1C7IY5.js";import{i as Le}from"../chunks/lifecycle.-hdmMjbE.js";import{w as lt}from"../chunks/index.DFaCUBO6.js";let qt=null;function ee(r,t){return t}function _s(r,t,e,s){for(var n=[],i=t.length,a=0;a<i;a++)rs(t[a].e,n,!0);var o=i>0&&n.length===0&&e!==null;if(o){var c=e.parentNode;ns(c),c.append(e),s.clear(),it(r,t[0].prev,t[i-1].next)}is(n,()=>{for(var d=0;d<i;d++){var h=t[d];o||(s.delete(h.k),it(r,h.prev,h.next)),as(h.e,!o)}})}function Dt(r,t,e,s,n,i=null){var a=r,o={flags:t,items:new Map,first:null},c=(t&Re)!==0;if(c){var d=r;a=z?Ft(os(d)):d.appendChild(Ke())}z&&Je();var h=null,m=!1;Xe(()=>{var u=e(),w=Qe(u)?u:u==null?[]:Ae(u),g=w.length;if(m&&g===0)return;m=g===0;let O=!1;if(z){var C=a.data===Ge;C!==(g===0)&&(a=le(),Ft(a),It(!1),O=!0)}if(z){for(var D=null,y,x=0;x<g;x++){if(gt.nodeType===8&&gt.data===cs){a=gt,O=!0,It(!1);break}var v=w[x],_=s(v,x);y=Oe(gt,o,D,null,v,_,x,n,t),o.items.set(_,y),D=y}g>0&&Ft(le())}if(!z){var q=ls;xs(w,o,a,n,t,(q.f&St)!==0,s)}i!==null&&(g===0?h?Ce(h):h=Se(()=>i(a)):h!==null&&Ze(h,()=>{h=null})),O&&It(!0),e()}),z&&(a=gt)}function xs(r,t,e,s,n,i,a){var P,F,K,ht;var o=(n&hs)!==0,c=(n&(Zt|te))!==0,d=r.length,h=t.items,m=t.first,u=m,w,g=null,O,C=[],D=[],y,x,v,_;if(o)for(_=0;_<d;_+=1)y=r[_],x=a(y,_),v=h.get(x),v!==void 0&&((P=v.a)==null||P.measure(),(O??(O=new Set)).add(v));for(_=0;_<d;_+=1){if(y=r[_],x=a(y,_),v=h.get(x),v===void 0){var q=u?u.e.nodes_start:e;g=Oe(q,t,g,g===null?t.first:g.next,y,x,_,s,n),h.set(x,g),C=[],D=[],u=g.next;continue}if(c&&ys(v,y,_,n),v.e.f&St&&(Ce(v.e),o&&((F=v.a)==null||F.unfix(),(O??(O=new Set)).delete(v))),v!==u){if(w!==void 0&&w.has(v)){if(C.length<D.length){var j=D[0],$;g=j.prev;var b=C[0],T=C[C.length-1];for($=0;$<C.length;$+=1)pe(C[$],j,e);for($=0;$<D.length;$+=1)w.delete(D[$]);it(t,b.prev,T.next),it(t,g,b),it(t,T,j),u=j,g=T,_-=1,C=[],D=[]}else w.delete(v),pe(v,u,e),it(t,v.prev,v.next),it(t,v,g===null?t.first:g.next),it(t,g,v),g=v;continue}for(C=[],D=[];u!==null&&u.k!==x;)(i||!(u.e.f&St))&&(w??(w=new Set)).add(u),D.push(u),u=u.next;if(u===null)continue;v=u}C.push(v),g=v,u=v.next}if(u!==null||w!==void 0){for(var S=w===void 0?[]:Ae(w);u!==null;)(i||!(u.e.f&St))&&S.push(u),u=u.next;var B=S.length;if(B>0){var N=n&Re&&d===0?e:null;if(o){for(_=0;_<B;_+=1)(K=S[_].a)==null||K.measure();for(_=0;_<B;_+=1)(ht=S[_].a)==null||ht.fix()}_s(t,S,N,h)}}o&&ts(()=>{var nt;if(O!==void 0)for(v of O)(nt=v.a)==null||nt.apply()}),he.first=t.first&&t.first.e,he.last=g&&g.e}function ys(r,t,e,s){s&Zt&&ue(r.v,t),s&te?ue(r.i,e):r.i=e}function Oe(r,t,e,s,n,i,a,o,c){var d=qt;try{var h=(c&Zt)!==0,m=(c&es)===0,u=h?m?ss(n):de(n):n,w=c&te?de(a):a,g={i:w,v:u,k:i,a:null,e:null,prev:e,next:s};return qt=g,g.e=Se(()=>o(r,u,w),z),g.e.prev=e&&e.e,g.e.next=s&&s.e,e===null?t.first=g:(e.next=g,e.e.next=g.e),s!==null&&(s.prev=g,s.e.prev=g.e),g}finally{qt=d}}function pe(r,t,e){for(var s=r.next?r.next.e.nodes_start:e,n=t?t.e.nodes_start:e,i=r.e.nodes_start;i!==s;){var a=us(i);n.before(i),i=a}}function it(r,t,e){t===null?r.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}let me=!1;function Ne(){me||(me=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var t;if(!r.defaultPrevented)for(const e of r.target.elements)(t=e.__on_r)==null||t.call(e)})},{capture:!0}))}function ft(r){if(z){var t=!1,e=()=>{if(!t){if(t=!0,r.hasAttribute("value")){var s=r.value;U(r,"value",null),r.value=s}if(r.hasAttribute("checked")){var n=r.checked;U(r,"checked",null),r.checked=n}}};r.__on_r=e,ds(e),Ne()}}function U(r,t,e,s){var n=r.__attributes??(r.__attributes={});z&&(n[t]=r.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&r.nodeName==="LINK")||n[t]!==(n[t]=e)&&(t==="style"&&"__styles"in r&&(r.__styles={}),t==="loading"&&(r[fs]=e),e==null?r.removeAttribute(t):typeof e!="string"&&bs(r).includes(t)?r[t]=e:r.setAttribute(t,e))}var ve=new Map;function bs(r){var t=ve.get(r.nodeName);if(t)return t;ve.set(r.nodeName,t=[]);for(var e,s=fe(r),n=Element.prototype;n!==s;){e=ps(s);for(var i in e)e[i].set&&t.push(i);s=fe(s)}return t}function dt(r,t){var e=r.__className,s=ws(t);z&&r.className===s?r.__className=s:(e!==s||z&&r.className!==s)&&(t==null?r.removeAttribute("class"):r.className=s,r.__className=s)}function ws(r){return r??""}function ks(r,t,e,s=e){r.addEventListener(t,e);const n=r.__on_r;n?r.__on_r=()=>{n(),s()}:r.__on_r=s,Ne()}function pt(r,t,e=t){var s=ms();ks(r,"input",()=>{var n=ge(r)?_e(r.value):r.value;e(n),s&&n!==(n=t())&&(r.value=n??"")}),vs(()=>{var n=t();if(z&&r.defaultValue!==r.value){e(r.value);return}ge(r)&&n===_e(r.value)||r.type==="date"&&!n&&!r.value||n!==r.value&&(r.value=n??"")})}function ge(r){var t=r.type;return t==="number"||t==="range"}function _e(r){return r===""?null:+r}const se=lt({x:0,y:0,f:0,deg_x:0,deg_y:0,dx:1,dy:-1,df:1,acc:1e3,spr:8e4,mpa:2e4,minpx:-2e4,maxpx:2e4,mpf:5e3,vx:0,vy:0,va1:100,va2:1500,vf:0,vf1:100,vf2:1500}),$t=lt([{id:"Brightness",name:"Brightness",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.01},{id:"Contrast",name:"Contrast",defaultValue:1,value:1,minValue:0,maxValue:6,steps:.1},{id:"Saturation",name:"Saturation",defaultValue:1,value:1,minValue:0,maxValue:32,steps:.1},{id:"Sharpness",name:"Sharpness",defaultValue:1,value:1,minValue:0,maxValue:16,steps:.1},{id:"ExposureTime",name:"Exposure time",description:"Value > 0 will reduce video framerate.",defaultValue:0,value:0,minValue:-10,maxValue:10,steps:.1},{id:"AnalogueGain",name:"Analogue gain",defaultValue:1,value:1,minValue:1,maxValue:8,steps:.1}]),Tt=lt([]),G=lt({}),zt=lt(""),Yt=lt(!1),xe=lt(!1),Be=lt(!1);var Es=L('<div id="horizon-wrapper" class="svelte-1gx25as"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 300" preserveAspectRatio="xMinYMin slice" class="svelte-1gx25as"><defs><g id="horizon"><line x1="0" x2="0" y1="-600" y2="600" stroke="#FFF" stroke-dashoffset="6.75" stroke-dasharray="0.5,44" stroke-width="10"></line><line x1="-200" x2="200" y1="150" y2="150" stroke="#FFF" stroke-dashoffset="30" stroke-dasharray="40.5,9.5,0.5,9.5" stroke-width=".5"></line></g></defs><defs><polygon id="focusArrow" points="0,400 180,65 100,65 200,35 300,65 220,65 400,400"></polygon><linearGradient id="focusArrowGradClip" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#005"></stop><stop offset="50%" stop-color="#039" stop-opacity=".8"></stop><stop offset="100%" stop-color="#07f" stop-opacity=".4"></stop></linearGradient></defs><clipPath id="arrowStripesClip"><polygon points="200,0 -390,400 -370,400 200,0 -350,400 -330,400 200,0 -310,400 -290,400 200,0 -270,400 -250,400 200,0 -230,400 -210,400 200,0 -190,400 -170,400 200,0 -150,400 -130,400 200,0 -110,400 -90,400 200,0 -70,400 -50,400 200,0 -30,400 -10,400 200,0 10,400 30,400 200,0 50,400 70,400 200,0 90,400 110,400 200,0 130,400 150,400 200,0 170,400 190,400 200,0 210,400 230,400 200,0 250,400 270,400 200,0 290,400 310,400 200,0 330,400 350,400 200,0 370,400 390,400 200,0 410,400 430,400 200,0 450,400 470,400 200,0 490,400 510,400 200,0 530,400 550,400 200,0 570,400 590,400 200,0 610,400 630,400 200,0 650,400 670,400 200,0 690,400 710,400 200,0 730,400 750,400 200,0 770,400 790,400"></polygon></clipPath><clipPath id="focusRangeMeterClip"><rect id="focus-range-meter" width="400" height="400" class="svelte-1gx25as"></rect></clipPath><use id="azimuth-sphere" href="#horizon" class="svelte-1gx25as"></use><g transform="translate(200 150)"><g id="altitude-visual" class="svelte-1gx25as"><circle r="1" fill="#FFF"></circle><path d="M-70 0 -10 0 A 10 10 0 0 0 10 0 " fill="none" stroke-width="1.2" stroke="#FFF"></path><text id="altitude-text" text-anchor="middle" transform="translate(-45 -5)" fill="#FFF" font-size="15"> </text></g></g><g transform="translate(200 150)"><path d="M-10 0 A 10 10 0 0 0 10 0 L 70 0" fill="none" stroke-width="1.22" stroke="#FFF"></path><path d="M -4,-87 0,-100 4,-87z" fill="#FFF"></path><text id="azimuth-text" transform="translate(0 -70)" text-anchor="middle" fill="#FFF" font-size="15"> </text></g><g transform="translate(200 -390)"><g id="compass" class="svelte-1gx25as"><circle r="400" class="grade svelte-1gx25as" stroke-dasharray="1 5.98131701" stroke-width="20"></circle><circle r="400" class="grade svelte-1gx25as" stroke-dasharray="1 33.90658504" stroke-width="30"></circle><circle r="400" class="grade svelte-1gx25as" stroke-dasharray="1 103.71975512" stroke-width="40"></circle><circle r="400" fill="none" stroke-dasharray="1 156.07963268" stroke="#F00" stroke-width="40"></circle><text class="cmp-text svelte-1gx25as" transform="rotate(0) translate(0 432)">N</text><text class="cmp-text svelte-1gx25as" transform="rotate(-15) translate(0 432)">15</text><text class="cmp-text svelte-1gx25as" transform="rotate(-30) translate(0 432)">30</text><text class="cmp-text svelte-1gx25as" transform="rotate(-45) translate(0 432)">45</text><text class="cmp-text svelte-1gx25as" transform="rotate(-60) translate(0 432)">60</text><text class="cmp-text svelte-1gx25as" transform="rotate(-75) translate(0 432)">75</text><text class="cmp-text svelte-1gx25as" transform="rotate(-90) translate(0 432)">E</text><text class="cmp-text svelte-1gx25as" transform="rotate(-105) translate(0 432)">105</text><text class="cmp-text svelte-1gx25as" transform="rotate(-120) translate(0 432)">120</text><text class="cmp-text svelte-1gx25as" transform="rotate(-135) translate(0 432)">135</text><text class="cmp-text svelte-1gx25as" transform="rotate(-150) translate(0 432)">150</text><text class="cmp-text svelte-1gx25as" transform="rotate(-165) translate(0 432)">165</text><text class="cmp-text svelte-1gx25as" transform="rotate(-180) translate(0 432)">S</text><text class="cmp-text svelte-1gx25as" transform="rotate(-195) translate(0 432)">195</text><text class="cmp-text svelte-1gx25as" transform="rotate(-210) translate(0 432)">210</text><text class="cmp-text svelte-1gx25as" transform="rotate(-225) translate(0 432)">225</text><text class="cmp-text svelte-1gx25as" transform="rotate(-240) translate(0 432)">240</text><text class="cmp-text svelte-1gx25as" transform="rotate(-255) translate(0 432)">255</text><text class="cmp-text svelte-1gx25as" transform="rotate(-270) translate(0 432)">W</text><text class="cmp-text svelte-1gx25as" transform="rotate(-285) translate(0 432)">285</text><text class="cmp-text svelte-1gx25as" transform="rotate(-300) translate(0 432)">300</text><text class="cmp-text svelte-1gx25as" transform="rotate(-315) translate(0 432)">315</text><text class="cmp-text svelte-1gx25as" transform="rotate(-330) translate(0 432)">330</text><text class="cmp-text svelte-1gx25as" transform="rotate(-345) translate(0 432)">345</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(0) translate(0 422)">0</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-5) translate(0 422)">5</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-10) translate(0 422)">10</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-20) translate(0 422)">20</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-25) translate(0 422)">25</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-22.5) translate(0 422)">NNE</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-35) translate(0 422)">35</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-40) translate(0 422)">40</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(-45) translate(0 422)">NE</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-50) translate(0 422)">50</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-55) translate(0 422)">55</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-65) translate(0 422)">65</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-70) translate(0 422)">70</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-67.5) translate(0 422)">NEE</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-80) translate(0 422)">80</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-85) translate(0 422)">85</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(-90) translate(0 422)">90</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-95) translate(0 422)">95</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-95) translate(0 422)">95</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-100) translate(0 422)">100</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-110) translate(0 422)">110</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-112.5) translate(0 422)">SEE</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-115) translate(0 422)">115</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-125) translate(0 422)">125</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-130) translate(0 422)">130</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(-135) translate(0 422)">SE</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-140) translate(0 422)">140</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-145) translate(0 422)">145</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-155) translate(0 422)">155</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-157.5) translate(0 422)">SSE</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-160) translate(0 422)">160</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-170) translate(0 422)">170</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-175) translate(0 422)">175</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(-180) translate(0 422)">180</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-185) translate(0 422)">185</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-190) translate(0 422)">190</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-200) translate(0 422)">200</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-202.5) translate(0 422)">SSW</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-205) translate(0 422)">205</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-215) translate(0 422)">215</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-220) translate(0 422)">220</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(-225) translate(0 422)">SW</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-230) translate(0 422)">230</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-235) translate(0 422)">235</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-245) translate(0 422)">245</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-247.5) translate(0 422)">SWW</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-250) translate(0 422)">250</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-260) translate(0 422)">260</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-265) translate(0 422)">265</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(-270) translate(0 422)">270</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-275) translate(0 422)">275</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-280) translate(0 422)">280</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-290) translate(0 422)">290</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-292.5) translate(0 422)">NWW</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-295) translate(0 422)">295</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-305) translate(0 422)">305</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-310) translate(0 422)">310</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(-315) translate(0 422)">NW</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-320) translate(0 422)">320</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-325) translate(0 422)">325</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-335) translate(0 422)">335</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-340) translate(0 422)">340</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-350) translate(0 422)">350</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-355) translate(0 422)">355</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-337.5) translate(0 422)">NNW</text></g></g></svg></div>');function Ts(r,t){H(t,!1);let e=kt(),s=kt(),n=kt(),i=kt();const a=se.subscribe(_=>{const q=_.f+_.mpf,$=(_.mpf-_.mpf/Math.pow(1.5/_.mpf*q+1,2))/_.mpf;R(e,(1-$)*133),R(s,_.deg_x),R(n,_.deg_y),R(i,l(n)/90*400)});ct(()=>{a&&a()}),Le();var o=Es(),c=p(o),d=k(p(c),3),h=p(d);f(d);var m=k(d),u=k(m),w=p(u),g=k(p(w),2),O=p(g);f(g),f(w),f(u);var C=k(u),D=k(p(C),2),y=p(D);f(D),f(C);var x=k(C),v=p(x);f(x),f(c),f(o),Q(()=>{U(h,"style",`y:${l(e)??""}%`),U(m,"style",`transform: translate(200px, ${l(i)??""}px)`),U(w,"style",`transform: rotate(${l(n)??""}deg)`),Z(O,`∠ ${l(n)??""}°`),Z(y,`${l(s)??""}°`),U(v,"transform",`rotate(${l(s)??""})`)}),E(r,o),W()}var As=L('<div id="camera-stream" class="svelte-1lxtj7p"><button id="telescope-stream"><img id="stream-object" alt="Telescope" width="1080" height="810" class="svelte-1lxtj7p"></button> <button id="viewfinder-stream"><img id="stream-object" alt="Viewfinder" width="1080" height="810" class="svelte-1lxtj7p"></button></div>');function Cs(r,t){H(t,!0);const e=mt(),s=()=>ut(xe,"$swapPreview",e),n=u=>{u.target.classList.contains("large")||xe.update(w=>!w)};let i=I("starfield.jpg"),a=I("starfield.jpg");wt(()=>{R(i,"http://192.168.178.33:7777/stream_a.mjpg"),R(a,"http://192.168.178.33:7777/stream_b.mjpg")});var o=As(),c=p(o);c.__click=n;var d=p(c);f(c);var h=k(c,2);h.__click=n;var m=p(h);f(h),f(o),Q(()=>{dt(c,`${(s()?"stream-wrapper":"stream-wrapper large")??""} svelte-1lxtj7p`),U(d,"src",l(i)),dt(h,`${(s()?"stream-wrapper large":"stream-wrapper")??""} svelte-1lxtj7p`),U(m,"src",l(a))}),E(r,o),W()}st(["click"]);var Ss=L('<div class="layer svelte-qmdbdl"><!></div>'),Rs=L('<div class="visuals svelte-qmdbdl"><!> <!></div>');function Ls(r){const t=mt(),e=()=>ut(Yt,"$displayCompass",t);var s=Rs(),n=p(s);Cs(n,{});var i=k(n,2);V(i,e,a=>{var o=Ss(),c=p(o);Ts(c,{}),f(o),E(a,o)}),f(s),E(r,s)}const et=Object.create(null);et.open="0";et.close="1";et.ping="2";et.pong="3";et.message="4";et.upgrade="5";et.noop="6";const Rt=Object.create(null);Object.keys(et).forEach(r=>{Rt[et[r]]=r});const Ht={type:"error",data:"parser error"},De=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Pe=typeof ArrayBuffer=="function",Me=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,re=({type:r,data:t},e,s)=>De&&t instanceof Blob?e?s(t):ye(t,s):Pe&&(t instanceof ArrayBuffer||Me(t))?e?s(t):ye(new Blob([t]),s):s(et[r]+(t||"")),ye=(r,t)=>{const e=new FileReader;return e.onload=function(){const s=e.result.split(",")[1];t("b"+(s||""))},e.readAsDataURL(r)};function be(r){return r instanceof Uint8Array?r:r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}let Vt;function Os(r,t){if(De&&r.data instanceof Blob)return r.data.arrayBuffer().then(be).then(t);if(Pe&&(r.data instanceof ArrayBuffer||Me(r.data)))return t(be(r.data));re(r,!1,e=>{Vt||(Vt=new TextEncoder),t(Vt.encode(e))})}const we="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yt=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let r=0;r<we.length;r++)yt[we.charCodeAt(r)]=r;const Ns=r=>{let t=r.length*.75,e=r.length,s,n=0,i,a,o,c;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);const d=new ArrayBuffer(t),h=new Uint8Array(d);for(s=0;s<e;s+=4)i=yt[r.charCodeAt(s)],a=yt[r.charCodeAt(s+1)],o=yt[r.charCodeAt(s+2)],c=yt[r.charCodeAt(s+3)],h[n++]=i<<2|a>>4,h[n++]=(a&15)<<4|o>>2,h[n++]=(o&3)<<6|c&63;return d},Bs=typeof ArrayBuffer=="function",ne=(r,t)=>{if(typeof r!="string")return{type:"message",data:Fe(r,t)};const e=r.charAt(0);return e==="b"?{type:"message",data:Ds(r.substring(1),t)}:Rt[e]?r.length>1?{type:Rt[e],data:r.substring(1)}:{type:Rt[e]}:Ht},Ds=(r,t)=>{if(Bs){const e=Ns(r);return Fe(e,t)}else return{base64:!0,data:r}},Fe=(r,t)=>{switch(t){case"blob":return r instanceof Blob?r:new Blob([r]);case"arraybuffer":default:return r instanceof ArrayBuffer?r:r.buffer}},Ie="",Ps=(r,t)=>{const e=r.length,s=new Array(e);let n=0;r.forEach((i,a)=>{re(i,!1,o=>{s[a]=o,++n===e&&t(s.join(Ie))})})},Ms=(r,t)=>{const e=r.split(Ie),s=[];for(let n=0;n<e.length;n++){const i=ne(e[n],t);if(s.push(i),i.type==="error")break}return s};function Fs(){return new TransformStream({transform(r,t){Os(r,e=>{const s=e.length;let n;if(s<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,s);else if(s<65536){n=new Uint8Array(3);const i=new DataView(n.buffer);i.setUint8(0,126),i.setUint16(1,s)}else{n=new Uint8Array(9);const i=new DataView(n.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(s))}r.data&&typeof r.data!="string"&&(n[0]|=128),t.enqueue(n),t.enqueue(e)})}})}let jt;function At(r){return r.reduce((t,e)=>t+e.length,0)}function Ct(r,t){if(r[0].length===t)return r.shift();const e=new Uint8Array(t);let s=0;for(let n=0;n<t;n++)e[n]=r[0][s++],s===r[0].length&&(r.shift(),s=0);return r.length&&s<r[0].length&&(r[0]=r[0].slice(s)),e}function Is(r,t){jt||(jt=new TextDecoder);const e=[];let s=0,n=-1,i=!1;return new TransformStream({transform(a,o){for(e.push(a);;){if(s===0){if(At(e)<1)break;const c=Ct(e,1);i=(c[0]&128)===128,n=c[0]&127,n<126?s=3:n===126?s=1:s=2}else if(s===1){if(At(e)<2)break;const c=Ct(e,2);n=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),s=3}else if(s===2){if(At(e)<8)break;const c=Ct(e,8),d=new DataView(c.buffer,c.byteOffset,c.length),h=d.getUint32(0);if(h>Math.pow(2,21)-1){o.enqueue(Ht);break}n=h*Math.pow(2,32)+d.getUint32(4),s=3}else{if(At(e)<n)break;const c=Ct(e,n);o.enqueue(ne(i?c:jt.decode(c),t)),s=0}if(n===0||n>r){o.enqueue(Ht);break}}}})}const qe=4;function M(r){if(r)return qs(r)}function qs(r){for(var t in M.prototype)r[t]=M.prototype[t];return r}M.prototype.on=M.prototype.addEventListener=function(r,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(t),this};M.prototype.once=function(r,t){function e(){this.off(r,e),t.apply(this,arguments)}return e.fn=t,this.on(r,e),this};M.prototype.off=M.prototype.removeListener=M.prototype.removeAllListeners=M.prototype.removeEventListener=function(r,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+r];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var s,n=0;n<e.length;n++)if(s=e[n],s===t||s.fn===t){e.splice(n,1);break}return e.length===0&&delete this._callbacks["$"+r],this};M.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+r],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(e){e=e.slice(0);for(var s=0,n=e.length;s<n;++s)e[s].apply(this,t)}return this};M.prototype.emitReserved=M.prototype.emit;M.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};M.prototype.hasListeners=function(r){return!!this.listeners(r).length};const Pt=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0),Y=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),$s="arraybuffer";function $e(r,...t){return t.reduce((e,s)=>(r.hasOwnProperty(s)&&(e[s]=r[s]),e),{})}const Vs=Y.setTimeout,js=Y.clearTimeout;function Mt(r,t){t.useNativeTimers?(r.setTimeoutFn=Vs.bind(Y),r.clearTimeoutFn=js.bind(Y)):(r.setTimeoutFn=Y.setTimeout.bind(Y),r.clearTimeoutFn=Y.clearTimeout.bind(Y))}const Us=1.33;function zs(r){return typeof r=="string"?Ys(r):Math.ceil((r.byteLength||r.size)*Us)}function Ys(r){let t=0,e=0;for(let s=0,n=r.length;s<n;s++)t=r.charCodeAt(s),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(s++,e+=4);return e}function Ve(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Hs(r){let t="";for(let e in r)r.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(r[e]));return t}function Ws(r){let t={},e=r.split("&");for(let s=0,n=e.length;s<n;s++){let i=e[s].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class Ks extends Error{constructor(t,e,s){super(t),this.description=e,this.context=s,this.type="TransportError"}}class ie extends M{constructor(t){super(),this.writable=!1,Mt(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,s){return super.emitReserved("error",new Ks(t,e,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=ne(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const e=Hs(t);return e.length?"?"+e:""}}class Xs extends ie{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||e()})),this.writable||(s++,this.once("drain",function(){--s||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const e=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};Ms(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Ps(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=Ve()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(t,e)}}let je=!1;try{je=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Js=je;function Qs(){}class Gs extends Xs{constructor(t){if(super(t),typeof location<"u"){const e=location.protocol==="https:";let s=location.port;s||(s=e?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||s!==t.port}}doWrite(t,e){const s=this.request({method:"POST",data:t});s.on("success",e),s.on("error",(n,i)=>{this.onError("xhr post error",n,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,s)=>{this.onError("xhr poll error",e,s)}),this.pollXhr=t}}class tt extends M{constructor(t,e,s){super(),this.createRequest=t,Mt(this,s),this._opts=s,this._method=s.method||"GET",this._uri=e,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var t;const e=$e(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(e);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let n in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(n)&&s.setRequestHeader(n,this._opts.extraHeaders[n])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var n;s.readyState===3&&((n=this._opts.cookieJar)===null||n===void 0||n.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(n){this.setTimeoutFn(()=>{this._onError(n)},0);return}typeof document<"u"&&(this._index=tt.requestsCount++,tt.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Qs,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete tt.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}tt.requestsCount=0;tt.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",ke);else if(typeof addEventListener=="function"){const r="onpagehide"in Y?"pagehide":"unload";addEventListener(r,ke,!1)}}function ke(){for(let r in tt.requests)tt.requests.hasOwnProperty(r)&&tt.requests[r].abort()}const Zs=function(){const r=Ue({xdomain:!1});return r&&r.responseType!==null}();class tr extends Gs{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=Zs&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new tt(Ue,this.uri(),t)}}function Ue(r){const t=r.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Js))return new XMLHttpRequest}catch{}if(!t)try{return new Y[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const ze=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class er extends ie{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,s=ze?{}:$e(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,s)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],n=e===t.length-1;re(s,this.supportsBinary,i=>{try{this.doWrite(s,i)}catch{}n&&Pt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=Ve()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const Ut=Y.WebSocket||Y.MozWebSocket;class sr extends er{createSocket(t,e,s){return ze?new Ut(t,e,s):e?new Ut(t,e):new Ut(t)}doWrite(t,e){this.ws.send(e)}}class rr extends ie{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const e=Is(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=t.readable.pipeThrough(e).getReader(),n=Fs();n.readable.pipeTo(t.writable),this._writer=n.writable.getWriter();const i=()=>{s.read().then(({done:o,value:c})=>{o||(this.onPacket(c),i())}).catch(o=>{})};i();const a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],n=e===t.length-1;this._writer.write(s).then(()=>{n&&Pt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const nr={websocket:sr,webtransport:rr,polling:tr},ir=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ar=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Wt(r){if(r.length>8e3)throw"URI too long";const t=r,e=r.indexOf("["),s=r.indexOf("]");e!=-1&&s!=-1&&(r=r.substring(0,e)+r.substring(e,s).replace(/:/g,";")+r.substring(s,r.length));let n=ir.exec(r||""),i={},a=14;for(;a--;)i[ar[a]]=n[a]||"";return e!=-1&&s!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=or(i,i.path),i.queryKey=cr(i,i.query),i}function or(r,t){const e=/\/{2,9}/g,s=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&s.splice(0,1),t.slice(-1)=="/"&&s.splice(s.length-1,1),s}function cr(r,t){const e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,n,i){n&&(e[n]=i)}),e}const Kt=typeof addEventListener=="function"&&typeof removeEventListener=="function",Lt=[];Kt&&addEventListener("offline",()=>{Lt.forEach(r=>r())},!1);class ot extends M{constructor(t,e){if(super(),this.binaryType=$s,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(e=t,t=null),t){const s=Wt(t);e.hostname=s.host,e.secure=s.protocol==="https"||s.protocol==="wss",e.port=s.port,s.query&&(e.query=s.query)}else e.host&&(e.hostname=Wt(e.host).host);Mt(this,e),this.secure=e.secure!=null?e.secure:typeof location<"u"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach(s=>{const n=s.prototype.name;this.transports.push(n),this._transportsByName[n]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Ws(this.opts.query)),Kt&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Lt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=qe,e.transport=t,this.id&&(e.sid=this.id);const s=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&ot.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",ot.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let s=0;s<this.writeBuffer.length;s++){const n=this.writeBuffer[s].data;if(n&&(e+=zs(n)),s>0&&e>this._maxPayload)return this.writeBuffer.slice(0,s);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Pt(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,e,s){return this._sendPacket("message",t,e,s),this}send(t,e,s){return this._sendPacket("message",t,e,s),this}_sendPacket(t,e,s,n){if(typeof e=="function"&&(n=e,e=void 0),typeof s=="function"&&(n=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const i={type:t,data:e,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},s=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}_onError(t){if(ot.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Kt&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=Lt.indexOf(this._offlineEventListener);s!==-1&&Lt.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}ot.protocol=qe;class lr extends ot{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),s=!1;ot.priorWebsocketSuccess=!1;const n=()=>{s||(e.send([{type:"ping",data:"probe"}]),e.once("packet",m=>{if(!s)if(m.type==="pong"&&m.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;ot.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(h(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const u=new Error("probe error");u.transport=e.name,this.emitReserved("upgradeError",u)}}))};function i(){s||(s=!0,h(),e.close(),e=null)}const a=m=>{const u=new Error("probe error: "+m);u.transport=e.name,i(),this.emitReserved("upgradeError",u)};function o(){a("transport closed")}function c(){a("socket closed")}function d(m){e&&m.name!==e.name&&i()}const h=()=>{e.removeListener("open",n),e.removeListener("error",a),e.removeListener("close",o),this.off("close",c),this.off("upgrading",d)};e.once("open",n),e.once("error",a),e.once("close",o),this.once("close",c),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{s||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let s=0;s<t.length;s++)~this.transports.indexOf(t[s])&&e.push(t[s]);return e}}let hr=class extends lr{constructor(t,e={}){const s=typeof t=="object"?t:e;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(n=>nr[n]).filter(n=>!!n)),super(t,s)}};function ur(r,t="",e){let s=r;e=e||typeof location<"u"&&location,r==null&&(r=e.protocol+"//"+e.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=e.protocol+r:r=e.host+r),/^(https?|wss?):\/\//.test(r)||(typeof e<"u"?r=e.protocol+"//"+r:r="https://"+r),s=Wt(r)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const i=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+t,s.href=s.protocol+"://"+i+(e&&e.port===s.port?"":":"+s.port),s}const dr=typeof ArrayBuffer=="function",fr=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,Ye=Object.prototype.toString,pr=typeof Blob=="function"||typeof Blob<"u"&&Ye.call(Blob)==="[object BlobConstructor]",mr=typeof File=="function"||typeof File<"u"&&Ye.call(File)==="[object FileConstructor]";function ae(r){return dr&&(r instanceof ArrayBuffer||fr(r))||pr&&r instanceof Blob||mr&&r instanceof File}function Ot(r,t){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let e=0,s=r.length;e<s;e++)if(Ot(r[e]))return!0;return!1}if(ae(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return Ot(r.toJSON(),!0);for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e)&&Ot(r[e]))return!0;return!1}function vr(r){const t=[],e=r.data,s=r;return s.data=Xt(e,t),s.attachments=t.length,{packet:s,buffers:t}}function Xt(r,t){if(!r)return r;if(ae(r)){const e={_placeholder:!0,num:t.length};return t.push(r),e}else if(Array.isArray(r)){const e=new Array(r.length);for(let s=0;s<r.length;s++)e[s]=Xt(r[s],t);return e}else if(typeof r=="object"&&!(r instanceof Date)){const e={};for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=Xt(r[s],t));return e}return r}function gr(r,t){return r.data=Jt(r.data,t),delete r.attachments,r}function Jt(r,t){if(!r)return r;if(r&&r._placeholder===!0){if(typeof r.num=="number"&&r.num>=0&&r.num<t.length)return t[r.num];throw new Error("illegal attachments")}else if(Array.isArray(r))for(let e=0;e<r.length;e++)r[e]=Jt(r[e],t);else if(typeof r=="object")for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&(r[e]=Jt(r[e],t));return r}const _r=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],xr=5;var A;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(A||(A={}));class yr{constructor(t){this.replacer=t}encode(t){return(t.type===A.EVENT||t.type===A.ACK)&&Ot(t)?this.encodeAsBinary({type:t.type===A.EVENT?A.BINARY_EVENT:A.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===A.BINARY_EVENT||t.type===A.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=vr(t),s=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(s),n}}function Ee(r){return Object.prototype.toString.call(r)==="[object Object]"}class oe extends M{constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const s=e.type===A.BINARY_EVENT;s||e.type===A.BINARY_ACK?(e.type=s?A.EVENT:A.ACK,this.reconstructor=new br(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(ae(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0;const s={type:Number(t.charAt(0))};if(A[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===A.BINARY_EVENT||s.type===A.BINARY_ACK){const i=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);const a=t.substring(i,e);if(a!=Number(a)||t.charAt(e)!=="-")throw new Error("Illegal attachments");s.attachments=Number(a)}if(t.charAt(e+1)==="/"){const i=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););s.nsp=t.substring(i,e)}else s.nsp="/";const n=t.charAt(e+1);if(n!==""&&Number(n)==n){const i=e+1;for(;++e;){const a=t.charAt(e);if(a==null||Number(a)!=a){--e;break}if(e===t.length)break}s.id=Number(t.substring(i,e+1))}if(t.charAt(++e)){const i=this.tryParse(t.substr(e));if(oe.isPayloadValid(s.type,i))s.data=i;else throw new Error("invalid payload")}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case A.CONNECT:return Ee(e);case A.DISCONNECT:return e===void 0;case A.CONNECT_ERROR:return typeof e=="string"||Ee(e);case A.EVENT:case A.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&_r.indexOf(e[0])===-1);case A.ACK:case A.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class br{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const e=gr(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const wr=Object.freeze(Object.defineProperty({__proto__:null,Decoder:oe,Encoder:yr,get PacketType(){return A},protocol:xr},Symbol.toStringTag,{value:"Module"}));function X(r,t,e){return r.on(t,e),function(){r.off(t,e)}}const kr=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});let He=class extends M{constructor(t,e,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[X(t,"open",this.onopen.bind(this)),X(t,"packet",this.onpacket.bind(this)),X(t,"error",this.onerror.bind(this)),X(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var s,n,i;if(kr.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const a={type:A.EVENT,data:e};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const h=this.ids++,m=e.pop();this._registerAckCallback(h,m),a.id=h}const o=(n=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||n===void 0?void 0:n.writable,c=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!o||(c?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(t,e){var s;const n=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(n===void 0){this.acks[t]=e;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===t&&this.sendBuffer.splice(o,1);e.call(this,new Error("operation has timed out"))},n),a=(...o)=>{this.io.clearTimeoutFn(i),e.apply(this,o)};a.withError=!0,this.acks[t]=a}emitWithAck(t,...e){return new Promise((s,n)=>{const i=(a,o)=>a?n(a):s(o);i.withError=!0,e.push(i),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((n,...i)=>s!==this._queue[0]?void 0:(n!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(n)):(this._queue.shift(),e&&e(null,...i)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:A.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(s=>String(s.id)===t)){const s=this.acks[t];delete this.acks[t],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case A.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case A.EVENT:case A.BINARY_EVENT:this.onevent(t);break;case A.ACK:case A.BINARY_ACK:this.onack(t);break;case A.DISCONNECT:this.ondisconnect();break;case A.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data,this.emitReserved("connect_error",s);break}}onevent(t){const e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const s of e)s.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let s=!1;return function(...n){s||(s=!0,e.packet({type:A.ACK,id:t,data:n}))}}onack(t){const e=this.acks[t.id];typeof e=="function"&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:A.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const s of e)s.apply(this,t.data)}}};function vt(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}vt.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*r);r=Math.floor(t*10)&1?r+e:r-e}return Math.min(r,this.max)|0};vt.prototype.reset=function(){this.attempts=0};vt.prototype.setMin=function(r){this.ms=r};vt.prototype.setMax=function(r){this.max=r};vt.prototype.setJitter=function(r){this.jitter=r};class Qt extends M{constructor(t,e){var s;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,Mt(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((s=e.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new vt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;const n=e.parser||wr;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new hr(this.uri,this.opts);const e=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const n=X(e,"open",function(){s.onopen(),t&&t()}),i=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),t?t(o):this.maybeReconnectOnOpen()},a=X(e,"error",i);if(this._timeout!==!1){const o=this._timeout,c=this.setTimeoutFn(()=>{n(),i(new Error("timeout")),e.close()},o);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(n),this.subs.push(a),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(X(t,"ping",this.onping.bind(this)),X(t,"data",this.ondata.bind(this)),X(t,"error",this.onerror.bind(this)),X(t,"close",this.onclose.bind(this)),X(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){Pt(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let s=this.nsps[t];return s?this._autoConnect&&!s.active&&s.connect():(s=new He(this,t,e),this.nsps[t]=s),s}_destroy(t){const e=Object.keys(this.nsps);for(const s of e)if(this.nsps[s].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let s=0;s<e.length;s++)this.engine.write(e[s],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(n=>{n?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",n)):t.onreconnect()}))},e);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const _t={};function bt(r,t){typeof r=="object"&&(t=r,r=void 0),t=t||{};const e=ur(r,t.path||"/socket.io"),s=e.source,n=e.id,i=e.path,a=_t[n]&&i in _t[n].nsps,o=t.forceNew||t["force new connection"]||t.multiplex===!1||a;let c;return o?c=new Qt(s,t):(_t[n]||(_t[n]=new Qt(s,t)),c=_t[n]),e.query&&!t.query&&(t.query=e.queryKey),c.socket(e.path,t)}Object.assign(bt,{Manager:Qt,Socket:He,io:bt,connect:bt});class Er{constructor(){if(this.enabled=!1,typeof bt=="function"){const t=location.origin;this.socket=bt(t),this.socket&&(this.socket.on("connect",()=>{this.enabled=!0,console.log("Connected to websocket Obelix 1.0")}),this.socket.on("update_settings",e=>{console.log("SOCKETio",e),typeof e=="object"&&!Array.isArray(e)&&e!==null&&se.update(s=>({...s,...e}))}))}}destroy(){this.socket.offAny(),this.socket.disconnect()}emit(t){this.enabled&&this.socket.emit("message",t)}emitReply(t,e){this.enabled&&(console.log("emitReply"),this.socket.emit("message_reply",t,(s,n)=>{console.log("emitReply response",s,n),typeof e=="function"&&e(n)}))}}const We=new Er;function rt(r,t){We.emit({get:"foo"}),fetch(""+r).then(s=>s.json()).then(s=>{typeof t=="function"&&t(s)})}function ce(r,t,e){We.emitReply({post:"foo"},e),fetch(""+r,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(n=>n.json()).then(n=>{e&&e(n)})}class Tr{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=200,this.deadZone=8,this.active=!1,this.value={x:0,y:0},this.counter=0,this.prev={x:0,y:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",s=>{this._handleDown(s)}),this.stick.addEventListener("touchstart",s=>{this._handleDown(s)}),document.addEventListener("mousemove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("touchmove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("mouseup",s=>{this._handleUp(s)}),document.addEventListener("touchend",s=>{this._handleUp(s)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.clientX,y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;let e=null;if(t.changedTouches){for(let C=0;C<t.changedTouches.length;C++)this.touchId===t.changedTouches[C].identifier&&(e=C,t.clientX=t.changedTouches[C].clientX,t.clientY=t.changedTouches[C].clientY);if(e==null)return}const s=this.stick.getBoundingClientRect(),n=s?Math.round(16e3/s.width)/100:1,i=t.clientX-this.dragStart.x,a=t.clientY-this.dragStart.y,o=Math.atan2(a,i),c=Math.min(this.maxDistance,Math.hypot(i,a)*n),d=c*Math.cos(o),h=c*Math.sin(o);this.stick.style.transform=`translate(${d}px, ${h}px)`;const m=c<this.deadZone?0:this.maxDistance/(this.maxDistance-this.deadZone)*(c-this.deadZone),u=m*Math.cos(o),w=m*Math.sin(o),g=parseFloat((u/this.maxDistance).toFixed(4)),O=parseFloat((w/this.maxDistance).toFixed(4));this.value={x:g,y:O},this._loop()}_handleUp(t){this.active&&(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier||(this.stick.style.transition=".2s",this.stick.style.transform="translate3d(0px, 0px, 0px)",this.value={x:0,y:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5+this.value.x*511.5),e=Math.round(511.5+this.value.y*511.5);this.callback(`/joystick/${t}/${e}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){(this.value.x!==this.prev.x||this.value.y!==this.prev.y)&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}class Ar{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=230,this.deadZone=8,this.active=!1,this.value={f:0},this.counter=0,this.prev={f:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",s=>{this._handleDown(s)}),this.stick.addEventListener("touchstart",s=>{this._handleDown(s)}),document.addEventListener("mousemove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("touchmove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("mouseup",s=>{this._handleUp(s)}),document.addEventListener("touchend",s=>{this._handleUp(s)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{y:t.changedTouches[0].clientY}:{y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;t.preventDefault();let e=null;if(t.changedTouches){for(let c=0;c<t.changedTouches.length;c++)this.touchId===t.changedTouches[c].identifier&&(e=c,t.clientY=t.changedTouches[c].clientY);if(e==null)return}const s=this.stick.getBoundingClientRect(),n=s?Math.round(1e4/s.width)/100:1,i=t.clientY-this.dragStart.y,a=i>=0?Math.min(this.maxDistance,i*n):Math.max(-this.maxDistance,i*n);this.stick.style.transform=`translateY(${a}px)`;const o=Math.abs(a)>this.deadZone?parseFloat((a/this.maxDistance).toFixed(4)):0;this.value={f:o},this._loop()}_handleUp(t){this.active&&(t.preventDefault(),!(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier)&&(this.stick.style.transition=".2s",this.stick.style.transform="translateY(0px)",this.value={f:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5-this.value.f*511.5);this.callback(`/focus/${t}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){this.value.f!==this.prev.f&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}var Cr=Bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-8uha02"><defs><circle id="joys-def-cir1" r="280" cy="0"></circle><circle id="joys-def-cir2" r="80" cy="0"></circle><path id="joys-def-arrow" d="M0 -120 -40 -100 40 -100z"></path><rect id="joys-def-slider" width="70" height="560" transform="translate(350 -280)" rx="15" ry="15"></rect><rect id="joys-def-slide" width="100" height="100" transform="translate(335 -50)" rx="15" ry="15"></rect></defs><g id="joys" transform="translate(320 355)" class="svelte-8uha02"><use id="joys-plate" href="#joys-def-cir1" class="svelte-8uha02"></use><use id="joys-arrow-top" href="#joys-def-arrow" class="svelte-8uha02"></use><use id="joys-arrow-right" href="#joys-def-arrow" transform="rotate(90)" class="svelte-8uha02"></use><use id="joys-arrow-left" href="#joys-def-arrow" transform="rotate(-90)" class="svelte-8uha02"></use><use id="joys-arrow-bottom" href="#joys-def-arrow" transform="rotate(180)" class="svelte-8uha02"></use><use id="joys-stick" href="#joys-def-cir2" style="transform: translate(0px, 0px)" class="svelte-8uha02"></use><use id="joys-slider" href="#joys-def-slider" class="svelte-8uha02"></use><use id="joys-slide" href="#joys-def-slide" style="transform: translateY(0px)" class="svelte-8uha02"></use><a href="#toggle" role="button" tabindex="0" aria-label="Change to adjustment tool"><g id="joys-swap" transform="translate(-250,250)" class="svelte-8uha02"><circle class="element svelte-8uha02" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M6.121 13c-.553 0-1 .448-1 1s.447 1 1 1h1.465l-3.293 3.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.414-3.414v1.707c0 .552.447 1 1 1s.879-.448.879-1v-5h-4.879zM7 11c.552 0 1-.448 1-1v-2h2c.553 0 1-.448 1-1s-.447-1-1-1h-3.999l-.001 4c0 .552.447 1 1 1zM17 13c-.553 0-1 .448-1 1v2h-2c-.553 0-1 .448-1 1s.447 1 1 1h4v-4c0-.552-.447-1-1-1zM18.293 4.293l-3.293 3.293v-1.586c0-.552-.447-1-1-1s-1 .448-1 1v5h5c.552 0 1-.448 1-1s-.447-1-1-1h-1.586l3.293-3.292c.391-.391.391-1.023 0-1.414s-1.023-.392-1.414-.001z" class="svelte-8uha02"></path></g></g></a></g></svg>');function Sr(r,t){H(t,!0);let e=null,s=null;wt(()=>{e=new Tr(document.getElementById("joys-stick"),o=>{rt(o,c=>{console.log("SVELTE Joystick",c)})}),s=new Ar(document.getElementById("joys-slide"),o=>{rt(o,c=>{console.log("SVELTE Focus",c)})})}),ct(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy(),s&&s.hasOwnProperty("destroy")&&s.destroy()});var n=Cr(),i=k(p(n)),a=k(p(i),8);a.__click=function(...o){var c;(c=t.toggle)==null||c.apply(this,o)},f(i),f(n),E(r,n),W()}st(["click"]);class Rr{constructor(t,e){if(this.adjust=t,this.adjust){this.callback=e;const s=8e4/360;this.axisSteps={lg:Math.round(s),md:Math.round(s/10),sm:Math.round(s/100)},this.adjust.addEventListener("mouseup",n=>{this.sendCommand(n.target.dataset)})}}destroy(){this.adjust.removeEventListener("mouseup",t=>{this.sendCommand(t.target.dataset)})}sendCommand(t){let e=t==null?void 0:t.dir,s=t==null?void 0:t.len;e&&s&&typeof this.axisSteps[s]=="number"&&(s=this.axisSteps[s],["closer","further"].indexOf(e)>=0&&(s=e==="closer"?-s:s,e="focus"),this.callback(`/adjust/${e}/${s}`))}}var Lr=Bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-1d0wo2a"><defs><path id="arr1" d="M45 45 5 45 10 95 95 95 95 10 45 5z"></path><path id="arr2" d="M105 105 11 105 17 165 165 165 165 17 105 11z"></path><path id="arr3" d="M175 175 18 175 25 245 245 245 245 25 175 18z"></path><circle id="cir1" r="44" cy="73"></circle><path id="cir2" d="M-54 73 A 75 75 0 1 0 54 73 A 54 54 0 0 1 -54 73z"></path><path id="cir3" d="M-85 125 A 108 108 0 1 0 85 125 A 54 54 0 0 1 -85 125z"></path></defs><g id="adjust" transform="translate(355 355)" class="svelte-1d0wo2a"><g transform="rotate(135)"><use href="#arr1" data-dir="left" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="left" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="left" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="rotate(-45)"><use href="#arr1" data-dir="right" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="right" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="right" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="rotate(-135)"><use href="#arr1" data-dir="up" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="up" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="up" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="rotate(45)"><use href="#arr1" data-dir="down" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="down" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="down" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="translate(360 -50) rotate(165)"><use href="#cir1" data-dir="further" data-len="sm" class="svelte-1d0wo2a"></use><use href="#cir2" data-dir="further" data-len="md" class="svelte-1d0wo2a"></use><use href="#cir3" data-dir="further" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="translate(360 50) rotate(15)"><use href="#cir1" data-dir="closer" data-len="sm" class="svelte-1d0wo2a"></use><use href="#cir2" data-dir="closer" data-len="md" class="svelte-1d0wo2a"></use><use href="#cir3" data-dir="closer" data-len="lg" class="svelte-1d0wo2a"></use></g><a href="#toggle" role="button" tabindex="0" aria-label="Change to Joystick"><g id="joys-swap" transform="translate(-285,250)" class="svelte-1d0wo2a"><circle class="element svelte-1d0wo2a" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M17.707 8.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l1.293 1.293h-4.586v-4.586l1.293 1.293c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-3.707-3.707-3.707 3.707c-.391.391-.391 1.023 0 1.414s1.023.391 1.414 0l1.293-1.293v4.586h-4.586l1.293-1.293c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-3.707 3.707 3.707 3.707c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-1.293-1.293h4.586v4.586l-1.293-1.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l3.707 3.707 3.707-3.707c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-1.293 1.293v-4.586h4.586l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707z" class="svelte-1d0wo2a"></path></g></g></a></g></svg>');function Or(r,t){H(t,!0);let e=null;wt(()=>{e=new Rr(document.getElementById("adjust"),a=>{rt(a,o=>{console.log("SVELTE Adjust",o)})})}),ct(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy()});var s=Lr(),n=k(p(s)),i=k(p(n),6);i.__click=function(...a){var o;(o=t.toggle)==null||o.apply(this,a)},f(n),f(s),E(r,s),W()}st(["click"]);var Nr=L('<div class="joystick-wrapper svelte-gruxg2"><!></div>');function Br(r){let t=I("mov");const e=i=>{i.preventDefault(),R(t,J(l(t)==="mov"?"adj":"mov"))};var s=Nr(),n=p(s);V(n,()=>l(t)==="mov",i=>{Sr(i,{toggle:e})},i=>{Or(i,{toggle:e})}),f(s),E(r,s)}function Gt(r){return typeof r=="string"?r.toLowerCase().trim().replaceAll("ä","ae").replaceAll("ö","oe").replaceAll("ü","ue").replaceAll("ß","ss").replace(/\W+/g,"_").replace(/^_|_$/g,""):null}const Te={fid:"",geo:{addr:"",lat:53.6,lon:9.9},base:[{id:"home",name:"Primary target",pos:{x:-23900,y:0,f:500}},{id:"polaris",name:"Polaris",pos:{x:0,y:11912,f:600}}]};function Dr(r,t){const e={...Te.geo,addr:t},s=[];for(let n of Te.base)s.push({...n,pos:{...n.pos}});return{fid:r,geo:e,base:s}}var Pr=(r,t)=>{R(t,!1)},Mr=L('<header><input type="text" id="address" placeholder="Address"></header> <div class="flexbox"><input type="text" id="latitude" placeholder="Latitude"> <input type="text" id="longitude" placeholder="Longitude"></div> <button class="button button-small">Save location</button> <button class="button">Cancel</button>',1),Fr=(r,t)=>{R(t,!0)},Ir=L('<header> <button class="edit-button icon-edit" aria-label="Edit"></button></header>'),qr=L("<div> </div>"),$r=L("<!> <!>",1),Vr=(r,t,e)=>t(r,`/navi/position/${l(e).id}`),jr=(r,t,e)=>t(l(e).id),Ur=L('<button class="delete-button icon-delete" aria-label="Delete" title="Delete"></button>'),zr=L("<li><button> </button> <!></li>"),Yr=L('<div class="nav-add"><label for="new-name">Save/update current position as ...</label> <input type="text" id="new-name" class="input" placeholder="Enter position name"> <div class="margin-bottom"><sub> </sub></div> <button class="button button-small">Save target</button></div>'),Hr=L('<div class="nav-selector"><button class="button button-small">Change location</button></div>'),Wr=L('<div class="content-card"><div class="nav-curr-pos"><!></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function Kr(r,t){H(t,!0);const e=mt(),s=()=>ut(G,"$positions",e),n=()=>ut(se,"$arduinoSettings",e);let i=I(!1),a=I(""),o=Nt(()=>Gt(l(a))),c=I(""),d=I(""),h=I(""),m=I(J([]));const u=G.subscribe(b=>{b!=null&&b.fid&&(R(c,J(b.geo.addr)),R(d,J(b.geo.lat)),R(h,J(b.geo.lon)),R(m,J([...b.base])))});ct(()=>{u&&u()});const w=()=>{const b={...s()};ce(`/navi/position/update/${b.fid}`,b,T=>{console.log("SVELTE saved",T)})},g=()=>{const b={addr:l(c),lat:parseFloat(l(d)),lon:parseFloat(l(h))};G.update(T=>({...T,geo:b})),w(),R(i,!1)},O=()=>{const b=Gt(l(a));if(b){let T=!1;const S=(({x:N,y:P,f:F})=>({x:N,y:P,f:F}))(n());let B=l(m).map(N=>N.id!==b?N:(T=!0,{...N,pos:S}));T||B.push({id:b,name:l(a),pos:S}),G.update(N=>({...N,base:B})),w(),R(a,"")}R(i,!1)},C=b=>b==="home"?"icon-home":b==="polaris"?"icon-star":"icon-target",D=b=>{if(confirm(`Do you really want to delete position: "${b}"`)){const T=[...s().base].filter(S=>S.id!==b);G.update(S=>({...S,base:T})),w(),R(i,!1)}},y=(b,T)=>{b.preventDefault(),rt(T,S=>{console.log("SVELTE position",S)})};var x=Wr(),v=p(x),_=p(v);V(_,()=>l(i),b=>{var T=Mr(),S=at(T),B=p(S);ft(B),f(S);var N=k(S,2),P=p(N);ft(P);var F=k(P,2);ft(F),f(N);var K=k(N,2);K.__click=g;var ht=k(K,2);ht.__click=[Pr,i],pt(B,()=>l(c),nt=>R(c,nt)),pt(P,()=>l(d),nt=>R(d,nt)),pt(F,()=>l(h),nt=>R(h,nt)),E(b,T)},b=>{var T=$r(),S=at(T);V(S,()=>l(c),N=>{var P=Ir(),F=p(P),K=k(F);K.__click=[Fr,i],f(P),Q(()=>Z(F,`${l(c)??""} `)),E(N,P)});var B=k(S,2);V(B,()=>l(d)&&l(h),N=>{var P=qr(),F=p(P);f(P),Q(()=>Z(F,`${l(d)??""}°, ${l(h)??""}°`)),E(N,P)}),E(b,T)}),f(v);var q=k(v,2),j=p(q);Dt(j,21,()=>l(m),ee,(b,T)=>{var S=zr(),B=p(S);const N=Nt(()=>`nav-button ${C(l(T).id)??""}`);B.__click=[Vr,y,T];var P=p(B,!0);f(B);var F=k(B,2);V(F,()=>l(i)&&l(T).id!=="home"&&l(T).id!=="polaris",K=>{var ht=Ur();ht.__click=[jr,D,T],E(K,ht)}),f(S),Q(()=>{dt(B,l(N)),Z(P,l(T).name)}),E(b,S)}),f(j),f(q);var $=k(q,2);V($,()=>l(i),b=>{var T=Yr(),S=k(p(T),2);ft(S);var B=k(S,2),N=p(B),P=p(N);f(N),f(B);var F=k(B,2);F.__click=O,f(T),Q(()=>{Z(P,`ID: ${l(o)??""}`),F.disabled=l(o).length<3}),pt(S,()=>l(a),K=>R(a,K)),E(b,T)},b=>{var T=Hr(),S=p(T);S.__click=function(...B){var N;(N=t.toggleAdmin)==null||N.apply(this,B)},f(T),E(b,T)}),f(x),E(r,x),W()}st(["click"]);const Xr=(r,t)=>{R(t,!l(t))};var Jr=(r,t,e)=>t(l(e).fid),Qr=(r,t,e)=>t(l(e).fid),Gr=L('<button class="delete-button icon-delete" aria-label="Delete"></button>'),Zr=L('<li><button class="nav-button icon-location"> </button> <!></li>'),tn=(r,t)=>t(),en=L('<div class="nav-add"><input type="text" id="new-location" class="input" placeholder="Enter new location name"> <button class="button">+&nbsp;Add</button></div> <div> </div>',1),sn=L('<div class="nav-selector"><button class="button button-small">&laquo;&nbsp;Back</button></div>'),rn=L('<div class="content-card"><header>Locations <button aria-label="Edit"></button></header> <div class="nav-curr-pos"><div><p>The location is the place where your telescope is placed.</p></div></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function nn(r,t){H(t,!0);const e=mt(),s=()=>ut(Tt,"$locations",e);let n=I("");const i=G.subscribe(y=>{R(n,J(y.fid))});ct(()=>{i&&i()});let a=I(!1),o=I(""),c=Nt(()=>Gt(l(o)));const d=y=>{y!==l(n)&&rt(`/navi/location/${y}`,x=>{(x==null?void 0:x.fid)===y&&(G.update(v=>({...x})),console.log("Loaded location"))})},h=()=>{if(l(c).length>=3){const y=Dr(l(c),l(o));ce(`/navi/position/update/${l(c)}`,y,x=>{G.update(v=>y),Tt.update(v=>[...v,{fid:l(c),addr:l(o)}]),R(o,""),console.log("Added new location",x)})}else console.error("ID is too short. At least 3 char are required.")},m=y=>{confirm(`Do you really want to delete location: "${y}"`)?rt(`/navi/location/delete/${y}`,x=>{x.response===200&&(Tt.update(v=>v.filter(_=>_.fid!==y)),alert(`Location "${y}" deleted`))}):alert(`Deletion of "${y}" canceled.`)};wt(()=>{s().length===0&&rt("/navi/location-list",y=>{Tt.update(x=>[...y]),console.log("Loaded location list")})});var u=rn(),w=p(u),g=k(p(w));g.__click=[Xr,a],f(w);var O=k(w,4),C=p(O);Dt(C,5,s,ee,(y,x)=>{var v=Zr(),_=p(v);_.__click=[Jr,d,x];var q=p(_,!0);f(_);var j=k(_,2);V(j,()=>l(a)&&l(x).fid!==l(n)&&l(x).fid!=="index",$=>{var b=Gr();b.__click=[Qr,m,x],E($,b)}),f(v),Q(()=>{dt(v,l(x).fid===l(n)?"active":""),Z(q,l(x).addr)}),E(y,v)}),f(C),f(O);var D=k(O,2);V(D,()=>l(a),y=>{var x=en(),v=at(x),_=p(v);ft(_);var q=k(_,2);q.__click=[tn,h],f(v);var j=k(v,2),$=p(j,!0);f(j),Q(()=>Z($,l(c))),pt(_,()=>l(o),b=>R(o,b)),E(y,x)},y=>{var x=sn(),v=p(x);v.__click=function(..._){var q;(q=t.toggleAdmin)==null||q.apply(this,_)},f(x),E(y,x)}),f(u),Q(()=>dt(g,`edit-button icon-edit${(l(a)?" active":"")??""}`)),E(r,u),W()}st(["click"]);function an(r,t){H(t,!0);const e=mt(),s=()=>ut(G,"$positions",e);let n=I(!1);const i=()=>{R(n,!l(n))};wt(()=>{var c;(c=s())!=null&&c.fid||rt("/navi/location/index",d=>{(d==null?void 0:d.fid)==="index"&&G.update(h=>({...d}))})});var a=xt(),o=at(a);V(o,()=>l(n),c=>{nn(c,{toggleAdmin:i})},c=>{Kr(c,{toggleAdmin:i})}),E(r,a),W()}var on=(r,t,e)=>{t.callback(t.id,e())},cn=L('<div class="slider-wrapper svelte-1eb8x9l"><label class="svelte-1eb8x9l"> </label> <input type="range" class="svelte-1eb8x9l"></div>');function ln(r,t){H(t,!0);let e=Et(t,"value",7,0),s=Et(t,"minValue",3,0),n=Et(t,"maxValue",3,10),i=Et(t,"steps",3,1);var a=cn(),o=p(a),c=p(o,!0);f(o);var d=k(o,2);ft(d),d.__change=[on,t,e],f(a),Q(()=>{U(o,"for","slider_slide_"+t.id),Z(c,t.name),U(d,"id","slider_slide_"+t.id),U(d,"min",s()),U(d,"max",n()),U(d,"step",i())}),pt(d,e),E(r,a),W()}st(["change"]);var hn=L('<div class="camera-options svelte-1icpkjb"><!> <div class="actions-wrapper svelte-1icpkjb"><button class="svelte-1icpkjb">Reset defaults</button></div></div>');function un(r,t){H(t,!1);const e=mt(),s=()=>ut($t,"$camControls",e),n=(h,m)=>{$t.update(u=>u.map(w=>w.id===h?{...w,value:m}:{...w})),rt(`/cam/ctrl/${h}/${m}`,u=>{console.log("SVELTE CamCtrl",u)})},i=()=>{$t.update(m=>m.map(u=>({...u,value:u.defaultValue})));const h={};for(let m of s())m!=null&&m.id&&(h[m.id]=m.defaultValue);ce("/cam/controls",h,m=>{console.log("SVELTE Cam Controls",m)})};Le();var a=hn(),o=p(a);Dt(o,3,s,h=>h.name,(h,m,u)=>{ln(h,gs(()=>l(m),{get index(){return l(u)},callback:n}))});var c=k(o,2),d=p(c);d.__click=i,f(c),f(a),E(r,a),W()}st(["click"]);const dn=()=>{Be.update(r=>!r)};var fn=Bt('<polygon points="-15,-15 -15,15 15,15 15,-15" stroke-width="5" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),pn=Bt('<polygon points="-10,-25 -10,25 22,0" stroke-width="5" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),mn=L('<div id="video-recording" class="svelte-1utn7qk"><button aria-label="Record video" class="svelte-1utn7qk"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" preserveAspectRatio="xMinYMin slice" class="svelte-1utn7qk"><g transform="translate(42,42)"><circle r="38" fill="none" stroke="#FFF" stroke-width="5"></circle><!></g></svg></button></div>');function vn(r,t){H(t,!0);let e=I(!1);const s=Be.subscribe(d=>{R(e,J(d))});ct(()=>{s&&s()});var n=mn(),i=p(n);i.__click=[dn];var a=p(i),o=p(a),c=k(p(o));V(c,()=>l(e),d=>{var h=fn();E(d,h)},d=>{var h=pn();E(d,h)}),f(o),f(a),f(i),f(n),E(r,n),W()}st(["click"]);const gn=()=>{console.log("Capture image ==> ;-)")};var _n=L('<div id="image-capture" class="svelte-1g966mt"><button aria-label="Capture image" class="svelte-1g966mt"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-1g966mt"><g transform="translate(42,42)"><circle r="28" fill="#C00" stroke="#C00"></circle><circle r="38" fill="none" stroke="#FFF" stroke-width="5"></circle></g></svg></button></div>');function xn(r){var t=_n(),e=p(t);e.__click=[gn],f(t),E(r,t)}st(["click"]);var yn=L('<div class="tools svelte-1isvhs1"><!></div>');function bn(r,t){H(t,!0);let e=I("");const s=zt.subscribe(a=>{R(e,J(a))});ct(()=>{s&&s()});var n=yn(),i=p(n);V(i,()=>l(e)==="target",a=>{Br(a)},a=>{var o=xt(),c=at(o);V(c,()=>l(e)==="location",d=>{an(d,{})},d=>{var h=xt(),m=at(h);V(m,()=>l(e)==="adjust",u=>{un(u,{})},u=>{var w=xt(),g=at(w);V(g,()=>l(e)==="video",O=>{vn(O,{})},O=>{var C=xt(),D=at(C);V(D,()=>l(e)==="picture",y=>{xn(y)},null,!0),E(O,C)},!0),E(u,w)},!0),E(d,h)},!0),E(a,o)}),f(n),E(r,n),W()}var wn=L('<li><button><span class="svelte-wkzjji"> </span></button></li>'),kn=L('<div id="options-menu" class="svelte-wkzjji"><ul class="svelte-wkzjji"></ul></div>');function En(r,t){H(t,!0);let e=I("");const s=zt.subscribe(h=>{R(e,J(h))});let n=I(!1);const i=Yt.subscribe(h=>{R(n,J(h))}),a=h=>{zt.update(m=>m===h?"":h)};ct(()=>{s&&s(),i&&i()});const o=[{id:"compass",name:"Compass",icon:"icon-compass",callback:()=>{Yt.update(h=>!h)},enabled:()=>l(n)},{id:"location",name:"Location",icon:"icon-location",callback:()=>{a("location")},enabled:()=>l(e)==="location"},{id:"target",name:"Target",icon:"icon-target",callback:()=>{a("target")},enabled:()=>l(e)==="target"},{id:"adjust",name:"Contrast",icon:"icon-adjust",callback:()=>{a("adjust")},enabled:()=>l(e)==="adjust"},{id:"video",name:"Video",icon:"icon-video",callback:()=>{a("video")},enabled:()=>l(e)==="video"},{id:"picture",name:"Picture",icon:"icon-image",callback:()=>{a("picture")},enabled:()=>l(e)==="picture"}];var c=kn(),d=p(c);Dt(d,21,()=>o,ee,(h,m)=>{var u=wn();const w=Nt(()=>`${(l(m).enabled()?"active":"")??""} svelte-wkzjji`);var g=p(u);g.__click=function(...D){var y;(y=l(m).callback)==null||y.apply(this,D)};var O=p(g),C=p(O,!0);f(O),f(g),f(u),Q(()=>{dt(u,l(w)),dt(g,`${l(m).icon??""} svelte-wkzjji`),Z(C,l(m).name)}),E(h,u)}),f(d),f(c),E(r,c),W()}st(["click"]);var Tn=L('<div class="container svelte-166kgzw"><!> <div class="controls svelte-166kgzw"><!></div> <!></div>');function Dn(r){var t=Tn(),e=p(t);Ls(e);var s=k(e,2),n=p(s);bn(n,{}),f(s);var i=k(s,2);En(i,{}),f(t),E(r,t)}export{Dn as component};
