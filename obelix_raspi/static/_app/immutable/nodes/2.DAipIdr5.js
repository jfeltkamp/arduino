var br=Object.defineProperty;var Un=n=>{throw TypeError(n)};var Er=(n,t,e)=>t in n?br(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var Yn=(n,t,e)=>Er(n,typeof t!="symbol"?t+"":t,e),We=(n,t,e)=>t.has(n)||Un("Cannot "+e);var Et=(n,t,e)=>(We(n,t,"read from private field"),e?e.call(n):t.get(n)),ee=(n,t,e)=>t.has(n)?Un("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),Xe=(n,t,e,s)=>(We(n,t,"write to private field"),s?s.call(n,e):t.set(n,e),e),Hn=(n,t,e)=>(We(n,t,"access private method"),e);import{a as $,t as q,n as ve,c as Lt}from"../chunks/disclose-version.Dza1u5i4.js";import{x as kr,h as Sr,k as it,B as Ke,C as Tr,M as Ar,ai as Ls,P as Cr,Q as Wn,R as Je,l as ne,ar as Te,N as Ms,i as Bs,O as Rr,an as Or,z as Xn,as as Ln,at as Kn,au as Mn,av as Nr,a5 as jr,G as Jn,aw as Lr,ah as Mr,ax as Br,j as Pr,ay as Ps,y as $r,ae as Ir,a9 as Dr,az as Fr,ac as Vr,aA as qr,aB as zr,L as Gn,aC as Ur,aD as Yr,am as Hr,al as Bn,b as Wr,p as Q,I,g as m,q as C,w as M,v as A,t as nt,o as tt,aE as Ge,f as Xt,aq as U,m as vt}from"../chunks/runtime.DmEZcW8Y.js";import{b as Xr,c as ht,p as qt,a as Z,o as me,i as G,s as $s}from"../chunks/index-client.Bjs8yFsM.js";import{a as dt,d as pt,s as Dt,b as Ot}from"../chunks/store.BXYhOZWn.js";import{i as Is}from"../chunks/lifecycle.DdPVWzb9.js";import{w as Tt}from"../chunks/index.z00wikzL.js";let Ze=null;function Kt(n,t){return t}function Kr(n,t,e,s){for(var r=[],i=t.length,o=0;o<i;o++)Lr(t[o].e,r,!0);var a=i>0&&r.length===0&&e!==null;if(a){var h=e.parentNode;Mr(h),h.append(e),s.clear(),At(n,t[0].prev,t[i-1].next)}Br(r,()=>{for(var f=0;f<i;f++){var c=t[f];a||(s.delete(c.k),At(n,c.prev,c.next)),Pr(c.e,!a)}})}function Mt(n,t,e,s,r,i=null){var o=n,a={flags:t,items:new Map,first:null},h=(t&Ps)!==0;if(h){var f=n;o=it?Ke($r(f)):f.appendChild(kr())}it&&Tr();var c=null,l=!1;Sr(()=>{var u=e(),p=Ar(u)?u:u==null?[]:Ls(u),d=p.length;if(l&&d===0)return;l=d===0;let b=!1;if(it){var y=o.data===Cr;y!==(d===0)&&(o=Wn(),Ke(o),Je(!1),b=!0)}if(it){for(var w=null,x,v=0;v<d;v++){if(ne.nodeType===8&&ne.data===Ir){o=ne,b=!0,Je(!1);break}var g=p[v],E=s(g,v);x=Ds(ne,a,w,null,g,E,v,r,t),a.items.set(E,x),w=x}d>0&&Ke(Wn())}if(!it){var R=Dr;Jr(p,a,o,r,t,(R.f&Te)!==0,s)}i!==null&&(d===0?c?Ms(c):c=Bs(()=>i(o)):c!==null&&Rr(c,()=>{c=null})),b&&Je(!0),e()}),it&&(o=ne)}function Jr(n,t,e,s,r,i,o){var N,_,L,z;var a=(r&Fr)!==0,h=(r&(Ln|Mn))!==0,f=n.length,c=t.items,l=t.first,u=l,p,d=null,b,y=[],w=[],x,v,g,E;if(a)for(E=0;E<f;E+=1)x=n[E],v=o(x,E),g=c.get(v),g!==void 0&&((N=g.a)==null||N.measure(),(b??(b=new Set)).add(g));for(E=0;E<f;E+=1){if(x=n[E],v=o(x,E),g=c.get(v),g===void 0){var R=u?u.e.nodes_start:e;d=Ds(R,t,d,d===null?t.first:d.next,x,v,E,s,r),c.set(v,d),y=[],w=[],u=d.next;continue}if(h&&Gr(g,x,E,r),g.e.f&Te&&(Ms(g.e),a&&((_=g.a)==null||_.unfix(),(b??(b=new Set)).delete(g))),g!==u){if(p!==void 0&&p.has(g)){if(y.length<w.length){var B=w[0],O;d=B.prev;var S=y[0],T=y[y.length-1];for(O=0;O<y.length;O+=1)Zn(y[O],B,e);for(O=0;O<w.length;O+=1)p.delete(w[O]);At(t,S.prev,T.next),At(t,d,S),At(t,T,B),u=B,d=T,E-=1,y=[],w=[]}else p.delete(g),Zn(g,u,e),At(t,g.prev,g.next),At(t,g,d===null?t.first:d.next),At(t,d,g),d=g;continue}for(y=[],w=[];u!==null&&u.k!==v;)(i||!(u.e.f&Te))&&(p??(p=new Set)).add(u),w.push(u),u=u.next;if(u===null)continue;g=u}y.push(g),d=g,u=g.next}if(u!==null||p!==void 0){for(var k=p===void 0?[]:Ls(p);u!==null;)(i||!(u.e.f&Te))&&k.push(u),u=u.next;var P=k.length;if(P>0){var j=r&Ps&&f===0?e:null;if(a){for(E=0;E<P;E+=1)(L=k[E].a)==null||L.measure();for(E=0;E<P;E+=1)(z=k[E].a)==null||z.fix()}Kr(t,k,j,c)}}a&&Or(()=>{var W;if(b!==void 0)for(g of b)(W=g.a)==null||W.apply()}),Xn.first=t.first&&t.first.e,Xn.last=d&&d.e}function Gr(n,t,e,s){s&Ln&&Kn(n.v,t),s&Mn?Kn(n.i,e):n.i=e}function Ds(n,t,e,s,r,i,o,a,h){var f=Ze;try{var c=(h&Ln)!==0,l=(h&Nr)===0,u=c?l?jr(r):Jn(r):r,p=h&Mn?Jn(o):o,d={i:p,v:u,k:i,a:null,e:null,prev:e,next:s};return Ze=d,d.e=Bs(()=>a(n,u,p),it),d.e.prev=e&&e.e,d.e.next=s&&s.e,e===null?t.first=d:(e.next=d,e.e.next=d.e),s!==null&&(s.prev=d,s.e.prev=d.e),d}finally{Ze=f}}function Zn(n,t,e){for(var s=n.next?n.next.e.nodes_start:e,r=t?t.e.nodes_start:e,i=n.e.nodes_start;i!==s;){var o=Vr(i);r.before(i),i=o}}function At(n,t,e){t===null?n.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}let Qn=!1;function Fs(){Qn||(Qn=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{var t;if(!n.defaultPrevented)for(const e of n.target.elements)(t=e.__on_r)==null||t.call(e)})},{capture:!0}))}function zt(n){if(it){var t=!1,e=()=>{if(!t){if(t=!0,n.hasAttribute("value")){var s=n.value;K(n,"value",null),n.value=s}if(n.hasAttribute("checked")){var r=n.checked;K(n,"checked",null),n.checked=r}}};n.__on_r=e,qr(e),Fs()}}function K(n,t,e,s){var r=n.__attributes??(n.__attributes={});it&&(r[t]=n.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&n.nodeName==="LINK")||r[t]!==(r[t]=e)&&(t==="style"&&"__styles"in n&&(n.__styles={}),t==="loading"&&(n[zr]=e),e==null?n.removeAttribute(t):typeof e!="string"&&Zr(n).includes(t)?n[t]=e:n.setAttribute(t,e))}var ts=new Map;function Zr(n){var t=ts.get(n.nodeName);if(t)return t;ts.set(n.nodeName,t=[]);for(var e,s=Gn(n),r=Element.prototype;r!==s;){e=Ur(s);for(var i in e)e[i].set&&t.push(i);s=Gn(s)}return t}function Bt(n,t){var e=n.__className,s=Qr(t);it&&n.className===s?n.__className=s:(e!==s||it&&n.className!==s)&&(t==null?n.removeAttribute("class"):n.className=s,n.__className=s)}function Qr(n){return n??""}function Vs(n,t,e,s=e){n.addEventListener(t,e);const r=n.__on_r;r?n.__on_r=()=>{r(),s()}:n.__on_r=s,Fs()}function Ut(n,t,e=t){var s=Yr();Vs(n,"input",()=>{var r=es(n)?ns(n.value):n.value;e(r),s&&r!==(r=t())&&(n.value=r??"")}),Hr(()=>{var r=t();if(it&&n.defaultValue!==n.value){e(n.value);return}es(n)&&r===ns(n.value)||n.type==="date"&&!r&&!n.value||r!==n.value&&(n.value=r??"")})}function es(n){var t=n.type;return t==="number"||t==="range"}function ns(n){return n===""?null:+n}function qs(n,t,e){if(n.multiple)return ei(n,t);for(var s of n.options){var r=ue(s);if(Xr(r,t)){s.selected=!0;return}}(!e||t!==void 0)&&(n.selectedIndex=-1)}function ti(n,t){Bn(()=>{var e=new MutationObserver(()=>{var s=n.__value;qs(n,s)});return e.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{e.disconnect()}})}function ss(n,t,e=t){var s=!0;Vs(n,"change",()=>{var r;if(n.multiple)r=[].map.call(n.querySelectorAll(":checked"),ue);else{var i=n.querySelector(":checked");r=i&&ue(i)}e(r)}),Bn(()=>{var r=t();if(qs(n,r,s),s&&r===void 0){var i=n.querySelector(":checked");i!==null&&(r=ue(i),e(r))}n.__value=r,s=!1}),ti(n)}function ei(n,t){for(var e of n.options)e.selected=~t.indexOf(ue(e))}function ue(n){return"__value"in n?n.__value:n.value}var Ct,Wt,pe,qe,zs;const ze=class ze{constructor(t){ee(this,qe);ee(this,Ct,new WeakMap);ee(this,Wt);ee(this,pe);Xe(this,pe,t)}observe(t,e){var s=Et(this,Ct).get(t)||new Set;return s.add(e),Et(this,Ct).set(t,s),Hn(this,qe,zs).call(this).observe(t,Et(this,pe)),()=>{var r=Et(this,Ct).get(t);r.delete(e),r.size===0&&(Et(this,Ct).delete(t),Et(this,Wt).unobserve(t))}}};Ct=new WeakMap,Wt=new WeakMap,pe=new WeakMap,qe=new WeakSet,zs=function(){return Et(this,Wt)??Xe(this,Wt,new ResizeObserver(t=>{for(var e of t){ze.entries.set(e.target,e);for(var s of Et(this,Ct).get(e.target)||[])s(e)}}))},Yn(ze,"entries",new WeakMap);let cn=ze;var ni=new cn({box:"border-box"});function rs(n,t,e){var s=ni.observe(n,()=>e(n[t]));Bn(()=>(Wr(()=>e(n[t])),s))}const Ue=Tt({x:0,y:0,f:0,deg_x:0,deg_y:0,dx:1,dy:-1,df:1,acc:1e3,spr:8e4,mpa:2e4,minpx:-2e4,maxpx:2e4,mpf:5e3,vx:0,vy:0,va1:100,va2:1500,vf:0,vf1:100,vf2:1500}),Qe=Tt([{id:"Brightness",name:"Brightness",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.01},{id:"Contrast",name:"Contrast",defaultValue:1,value:1,minValue:0,maxValue:6,steps:.1},{id:"Saturation",name:"Saturation",defaultValue:1,value:1,minValue:0,maxValue:32,steps:.1},{id:"Sharpness",name:"Sharpness",defaultValue:1,value:1,minValue:0,maxValue:16,steps:.1},{id:"ExposureTime",name:"Exposure time",description:"Value > 0 will reduce video framerate.",defaultValue:0,value:0,minValue:-10,maxValue:10,steps:.1},{id:"AnalogueGain",name:"Analogue gain",defaultValue:1,value:1,minValue:1,maxValue:8,steps:.1}]),_e=Tt([]),mt=Tt({}),ln=Tt(""),un=Tt(!1),Ae=Tt("B"),je=Tt(!1),Le=Tt([{id:"CrosshairSize",name:"Crosshair Size",defaultValue:.04,value:.04,minValue:.005,maxValue:.25,steps:.005},{id:"CrosshairOffsetX",name:"Crosshair Offset X",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.005},{id:"CrosshairOffsetY",name:"Crosshair Offset Y",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.005},{id:"SphereScaleVF",name:"Sphere Scale Viewfinder",defaultValue:1500,value:1500,minValue:1e3,maxValue:1e4,steps:10},{id:"SphereScaleTel",name:"Sphere Scale Telescope",defaultValue:24e3,value:24e3,minValue:15e3,maxValue:6e4,steps:10}]);var si=q('<div id="horizon-wrapper" class="svelte-160jhho"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 300" preserveAspectRatio="xMinYMin slice" class="svelte-160jhho"><defs><polygon id="focusArrow" points="0,400 180,65 100,65 200,35 300,65 220,65 400,400"></polygon><linearGradient id="focusArrowGradClip" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#005"></stop><stop offset="50%" stop-color="#039" stop-opacity=".8"></stop><stop offset="100%" stop-color="#07f" stop-opacity=".4"></stop></linearGradient></defs><clipPath id="arrowStripesClip"><polygon points="200,0 -390,400 -370,400 200,0 -350,400 -330,400 200,0 -310,400 -290,400 200,0 -270,400 -250,400 200,0 -230,400 -210,400 200,0 -190,400 -170,400 200,0 -150,400 -130,400 200,0 -110,400 -90,400 200,0 -70,400 -50,400 200,0 -30,400 -10,400 200,0 10,400 30,400 200,0 50,400 70,400 200,0 90,400 110,400 200,0 130,400 150,400 200,0 170,400 190,400 200,0 210,400 230,400 200,0 250,400 270,400 200,0 290,400 310,400 200,0 330,400 350,400 200,0 370,400 390,400 200,0 410,400 430,400 200,0 450,400 470,400 200,0 490,400 510,400 200,0 530,400 550,400 200,0 570,400 590,400 200,0 610,400 630,400 200,0 650,400 670,400 200,0 690,400 710,400 200,0 730,400 750,400 200,0 770,400 790,400"></polygon></clipPath><clipPath id="focusRangeMeterClip"><rect id="focus-range-meter" width="400" height="400" class="svelte-160jhho"></rect></clipPath><g transform="translate(200 150)"><g id="altitude-visual" class="svelte-160jhho"><circle r="1" fill="#FFF"></circle><path d="M-70 0 -10 0 A 10 10 0 0 0 10 0 " fill="none" stroke-width="1.2" stroke="#FFF"></path><text id="altitude-text" text-anchor="middle" transform="translate(-45 -5)" fill="#FFF" font-size="10"> </text></g></g><g transform="translate(200 150)"><path d="M-10 0 A 10 10 0 0 0 10 0 L 70 0" fill="none" stroke-width="1.22" stroke="#FFF"></path><path d="M -4,-150 0,-140 4,-150" fill="#FFF" stroke="#FFF" stroke-width=".5"></path><text id="azimuth-text" transform="translate(30 -5)" text-anchor="middle" fill="#FFF" font-size="10"> </text></g><g transform="translate(200 -390)"><g id="compass" class="svelte-160jhho"><circle r="400" class="grade svelte-160jhho" stroke-dasharray=".5 6.48131701" stroke-dashoffset=".15" stroke-width="20"></circle><circle r="400" class="grade svelte-160jhho" stroke-dasharray=".5 34.40658504" stroke-dashoffset=".15" stroke-width="30"></circle><circle r="400" class="grade svelte-160jhho" stroke-dasharray=".5 104.21975512" stroke-dashoffset=".15" stroke-width="40"></circle><circle r="400" fill="none" stroke-dasharray=".5 156.57963268" stroke-dashoffset=".15" stroke="#F00" stroke-width="40"></circle><text class="cmp-text svelte-160jhho" transform="rotate(0) translate(0 432)">N</text><text class="cmp-text svelte-160jhho" transform="rotate(-15) translate(0 432)">15</text><text class="cmp-text svelte-160jhho" transform="rotate(-30) translate(0 432)">30</text><text class="cmp-text svelte-160jhho" transform="rotate(-45) translate(0 432)">45</text><text class="cmp-text svelte-160jhho" transform="rotate(-60) translate(0 432)">60</text><text class="cmp-text svelte-160jhho" transform="rotate(-75) translate(0 432)">75</text><text class="cmp-text svelte-160jhho" transform="rotate(-90) translate(0 432)">E</text><text class="cmp-text svelte-160jhho" transform="rotate(-105) translate(0 432)">105</text><text class="cmp-text svelte-160jhho" transform="rotate(-120) translate(0 432)">120</text><text class="cmp-text svelte-160jhho" transform="rotate(-135) translate(0 432)">135</text><text class="cmp-text svelte-160jhho" transform="rotate(-150) translate(0 432)">150</text><text class="cmp-text svelte-160jhho" transform="rotate(-165) translate(0 432)">165</text><text class="cmp-text svelte-160jhho" transform="rotate(-180) translate(0 432)">S</text><text class="cmp-text svelte-160jhho" transform="rotate(-195) translate(0 432)">195</text><text class="cmp-text svelte-160jhho" transform="rotate(-210) translate(0 432)">210</text><text class="cmp-text svelte-160jhho" transform="rotate(-225) translate(0 432)">225</text><text class="cmp-text svelte-160jhho" transform="rotate(-240) translate(0 432)">240</text><text class="cmp-text svelte-160jhho" transform="rotate(-255) translate(0 432)">255</text><text class="cmp-text svelte-160jhho" transform="rotate(-270) translate(0 432)">W</text><text class="cmp-text svelte-160jhho" transform="rotate(-285) translate(0 432)">285</text><text class="cmp-text svelte-160jhho" transform="rotate(-300) translate(0 432)">300</text><text class="cmp-text svelte-160jhho" transform="rotate(-315) translate(0 432)">315</text><text class="cmp-text svelte-160jhho" transform="rotate(-330) translate(0 432)">330</text><text class="cmp-text svelte-160jhho" transform="rotate(-345) translate(0 432)">345</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(0) translate(0 422)">0</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-5) translate(0 422)">5</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-10) translate(0 422)">10</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-20) translate(0 422)">20</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-25) translate(0 422)">25</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-22.5) translate(0 422)">NNE</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-35) translate(0 422)">35</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-40) translate(0 422)">40</text><text class="cmp-text-sm left svelte-160jhho" transform="rotate(-45) translate(0 422)">NE</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-50) translate(0 422)">50</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-55) translate(0 422)">55</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-65) translate(0 422)">65</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-70) translate(0 422)">70</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-67.5) translate(0 422)">NEE</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-80) translate(0 422)">80</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-85) translate(0 422)">85</text><text class="cmp-text-sm left svelte-160jhho" transform="rotate(-90) translate(0 422)">90</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-95) translate(0 422)">95</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-95) translate(0 422)">95</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-100) translate(0 422)">100</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-110) translate(0 422)">110</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-112.5) translate(0 422)">SEE</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-115) translate(0 422)">115</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-125) translate(0 422)">125</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-130) translate(0 422)">130</text><text class="cmp-text-sm left svelte-160jhho" transform="rotate(-135) translate(0 422)">SE</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-140) translate(0 422)">140</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-145) translate(0 422)">145</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-155) translate(0 422)">155</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-157.5) translate(0 422)">SSE</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-160) translate(0 422)">160</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-170) translate(0 422)">170</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-175) translate(0 422)">175</text><text class="cmp-text-sm left svelte-160jhho" transform="rotate(-180) translate(0 422)">180</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-185) translate(0 422)">185</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-190) translate(0 422)">190</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-200) translate(0 422)">200</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-202.5) translate(0 422)">SSW</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-205) translate(0 422)">205</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-215) translate(0 422)">215</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-220) translate(0 422)">220</text><text class="cmp-text-sm left svelte-160jhho" transform="rotate(-225) translate(0 422)">SW</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-230) translate(0 422)">230</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-235) translate(0 422)">235</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-245) translate(0 422)">245</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-247.5) translate(0 422)">SWW</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-250) translate(0 422)">250</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-260) translate(0 422)">260</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-265) translate(0 422)">265</text><text class="cmp-text-sm left svelte-160jhho" transform="rotate(-270) translate(0 422)">270</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-275) translate(0 422)">275</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-280) translate(0 422)">280</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-290) translate(0 422)">290</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-292.5) translate(0 422)">NWW</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-295) translate(0 422)">295</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-305) translate(0 422)">305</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-310) translate(0 422)">310</text><text class="cmp-text-sm left svelte-160jhho" transform="rotate(-315) translate(0 422)">NW</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-320) translate(0 422)">320</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-325) translate(0 422)">325</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-335) translate(0 422)">335</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-340) translate(0 422)">340</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-350) translate(0 422)">350</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-355) translate(0 422)">355</text><text class="cmp-text-sm svelte-160jhho" transform="rotate(-337.5) translate(0 422)">NNW</text></g></g></svg></div>');function ri(n,t){Q(t,!1);let e=Ge(),s=Ge(),r=Ge();const i=Ue.subscribe(v=>{const g=v.f+v.mpf,R=(v.mpf-v.mpf/Math.pow(1.5/v.mpf*g+1,2))/v.mpf;I(e,(1-R)*133),I(s,v.deg_x),I(r,v.deg_y),m(r)/90*400});ht(()=>{i&&i()}),Is();var o=si(),a=C(o),h=M(C(a),2),f=C(h);A(h);var c=M(h),l=C(c),u=M(C(l),2),p=C(u);A(u),A(l),A(c);var d=M(c),b=M(C(d),2),y=C(b);A(b),A(d);var w=M(d),x=C(w);A(w),A(a),A(o),nt(()=>{K(f,"style",`y:${m(e)??""}%`),K(l,"style",`transform: rotate(${m(r)??""}deg)`),dt(p,`∠ ${m(r)??""}°`),dt(y,`➢ ${m(s)??""}°`),K(x,"transform",`rotate(${m(s)??""})`)}),$(n,o),tt()}const xt=Object.create(null);xt.open="0";xt.close="1";xt.ping="2";xt.pong="3";xt.message="4";xt.upgrade="5";xt.noop="6";const Ce=Object.create(null);Object.keys(xt).forEach(n=>{Ce[xt[n]]=n});const hn={type:"error",data:"parser error"},Us=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ys=typeof ArrayBuffer=="function",Hs=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,Pn=({type:n,data:t},e,s)=>Us&&t instanceof Blob?e?s(t):is(t,s):Ys&&(t instanceof ArrayBuffer||Hs(t))?e?s(t):is(new Blob([t]),s):s(xt[n]+(t||"")),is=(n,t)=>{const e=new FileReader;return e.onload=function(){const s=e.result.split(",")[1];t("b"+(s||""))},e.readAsDataURL(n)};function os(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let tn;function ii(n,t){if(Us&&n.data instanceof Blob)return n.data.arrayBuffer().then(os).then(t);if(Ys&&(n.data instanceof ArrayBuffer||Hs(n.data)))return t(os(n.data));Pn(n,!1,e=>{tn||(tn=new TextEncoder),t(tn.encode(e))})}const as="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",re=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<as.length;n++)re[as.charCodeAt(n)]=n;const oi=n=>{let t=n.length*.75,e=n.length,s,r=0,i,o,a,h;n[n.length-1]==="="&&(t--,n[n.length-2]==="="&&t--);const f=new ArrayBuffer(t),c=new Uint8Array(f);for(s=0;s<e;s+=4)i=re[n.charCodeAt(s)],o=re[n.charCodeAt(s+1)],a=re[n.charCodeAt(s+2)],h=re[n.charCodeAt(s+3)],c[r++]=i<<2|o>>4,c[r++]=(o&15)<<4|a>>2,c[r++]=(a&3)<<6|h&63;return f},ai=typeof ArrayBuffer=="function",$n=(n,t)=>{if(typeof n!="string")return{type:"message",data:Ws(n,t)};const e=n.charAt(0);return e==="b"?{type:"message",data:ci(n.substring(1),t)}:Ce[e]?n.length>1?{type:Ce[e],data:n.substring(1)}:{type:Ce[e]}:hn},ci=(n,t)=>{if(ai){const e=oi(n);return Ws(e,t)}else return{base64:!0,data:n}},Ws=(n,t)=>{switch(t){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},Xs="",li=(n,t)=>{const e=n.length,s=new Array(e);let r=0;n.forEach((i,o)=>{Pn(i,!1,a=>{s[o]=a,++r===e&&t(s.join(Xs))})})},ui=(n,t)=>{const e=n.split(Xs),s=[];for(let r=0;r<e.length;r++){const i=$n(e[r],t);if(s.push(i),i.type==="error")break}return s};function hi(){return new TransformStream({transform(n,t){ii(n,e=>{const s=e.length;let r;if(s<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,s);else if(s<65536){r=new Uint8Array(3);const i=new DataView(r.buffer);i.setUint8(0,126),i.setUint16(1,s)}else{r=new Uint8Array(9);const i=new DataView(r.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(s))}n.data&&typeof n.data!="string"&&(r[0]|=128),t.enqueue(r),t.enqueue(e)})}})}let en;function ye(n){return n.reduce((t,e)=>t+e.length,0)}function xe(n,t){if(n[0].length===t)return n.shift();const e=new Uint8Array(t);let s=0;for(let r=0;r<t;r++)e[r]=n[0][s++],s===n[0].length&&(n.shift(),s=0);return n.length&&s<n[0].length&&(n[0]=n[0].slice(s)),e}function fi(n,t){en||(en=new TextDecoder);const e=[];let s=0,r=-1,i=!1;return new TransformStream({transform(o,a){for(e.push(o);;){if(s===0){if(ye(e)<1)break;const h=xe(e,1);i=(h[0]&128)===128,r=h[0]&127,r<126?s=3:r===126?s=1:s=2}else if(s===1){if(ye(e)<2)break;const h=xe(e,2);r=new DataView(h.buffer,h.byteOffset,h.length).getUint16(0),s=3}else if(s===2){if(ye(e)<8)break;const h=xe(e,8),f=new DataView(h.buffer,h.byteOffset,h.length),c=f.getUint32(0);if(c>Math.pow(2,21)-1){a.enqueue(hn);break}r=c*Math.pow(2,32)+f.getUint32(4),s=3}else{if(ye(e)<r)break;const h=xe(e,r);a.enqueue($n(i?h:en.decode(h),t)),s=0}if(r===0||r>n){a.enqueue(hn);break}}}})}const Ks=4;function J(n){if(n)return di(n)}function di(n){for(var t in J.prototype)n[t]=J.prototype[t];return n}J.prototype.on=J.prototype.addEventListener=function(n,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(t),this};J.prototype.once=function(n,t){function e(){this.off(n,e),t.apply(this,arguments)}return e.fn=t,this.on(n,e),this};J.prototype.off=J.prototype.removeListener=J.prototype.removeAllListeners=J.prototype.removeEventListener=function(n,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+n];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var s,r=0;r<e.length;r++)if(s=e[r],s===t||s.fn===t){e.splice(r,1);break}return e.length===0&&delete this._callbacks["$"+n],this};J.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+n],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(e){e=e.slice(0);for(var s=0,r=e.length;s<r;++s)e[s].apply(this,t)}return this};J.prototype.emitReserved=J.prototype.emit;J.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};J.prototype.hasListeners=function(n){return!!this.listeners(n).length};const Ye=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0),ot=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),pi="arraybuffer";function Js(n,...t){return t.reduce((e,s)=>(n.hasOwnProperty(s)&&(e[s]=n[s]),e),{})}const vi=ot.setTimeout,mi=ot.clearTimeout;function He(n,t){t.useNativeTimers?(n.setTimeoutFn=vi.bind(ot),n.clearTimeoutFn=mi.bind(ot)):(n.setTimeoutFn=ot.setTimeout.bind(ot),n.clearTimeoutFn=ot.clearTimeout.bind(ot))}const gi=1.33;function _i(n){return typeof n=="string"?yi(n):Math.ceil((n.byteLength||n.size)*gi)}function yi(n){let t=0,e=0;for(let s=0,r=n.length;s<r;s++)t=n.charCodeAt(s),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(s++,e+=4);return e}function Gs(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function xi(n){let t="";for(let e in n)n.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(n[e]));return t}function wi(n){let t={},e=n.split("&");for(let s=0,r=e.length;s<r;s++){let i=e[s].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class bi extends Error{constructor(t,e,s){super(t),this.description=e,this.context=s,this.type="TransportError"}}class In extends J{constructor(t){super(),this.writable=!1,He(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,s){return super.emitReserved("error",new bi(t,e,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=$n(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const e=xi(t);return e.length?"?"+e:""}}class Ei extends In{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||e()})),this.writable||(s++,this.once("drain",function(){--s||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const e=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};ui(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,li(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=Gs()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(t,e)}}let Zs=!1;try{Zs=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const ki=Zs;function Si(){}class Ti extends Ei{constructor(t){if(super(t),typeof location<"u"){const e=location.protocol==="https:";let s=location.port;s||(s=e?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||s!==t.port}}doWrite(t,e){const s=this.request({method:"POST",data:t});s.on("success",e),s.on("error",(r,i)=>{this.onError("xhr post error",r,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,s)=>{this.onError("xhr poll error",e,s)}),this.pollXhr=t}}class yt extends J{constructor(t,e,s){super(),this.createRequest=t,He(this,s),this._opts=s,this._method=s.method||"GET",this._uri=e,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var t;const e=Js(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(e);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&s.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var r;s.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=yt.requestsCount++,yt.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Si,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete yt.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}yt.requestsCount=0;yt.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",cs);else if(typeof addEventListener=="function"){const n="onpagehide"in ot?"pagehide":"unload";addEventListener(n,cs,!1)}}function cs(){for(let n in yt.requests)yt.requests.hasOwnProperty(n)&&yt.requests[n].abort()}const Ai=function(){const n=Qs({xdomain:!1});return n&&n.responseType!==null}();class Ci extends Ti{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=Ai&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new yt(Qs,this.uri(),t)}}function Qs(n){const t=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||ki))return new XMLHttpRequest}catch{}if(!t)try{return new ot[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const tr=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Ri extends In{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,s=tr?{}:Js(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,s)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],r=e===t.length-1;Pn(s,this.supportsBinary,i=>{try{this.doWrite(s,i)}catch{}r&&Ye(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=Gs()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const nn=ot.WebSocket||ot.MozWebSocket;class Oi extends Ri{createSocket(t,e,s){return tr?new nn(t,e,s):e?new nn(t,e):new nn(t)}doWrite(t,e){this.ws.send(e)}}class Ni extends In{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const e=fi(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=t.readable.pipeThrough(e).getReader(),r=hi();r.readable.pipeTo(t.writable),this._writer=r.writable.getWriter();const i=()=>{s.read().then(({done:a,value:h})=>{a||(this.onPacket(h),i())}).catch(a=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],r=e===t.length-1;this._writer.write(s).then(()=>{r&&Ye(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const ji={websocket:Oi,webtransport:Ni,polling:Ci},Li=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Mi=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function fn(n){if(n.length>8e3)throw"URI too long";const t=n,e=n.indexOf("["),s=n.indexOf("]");e!=-1&&s!=-1&&(n=n.substring(0,e)+n.substring(e,s).replace(/:/g,";")+n.substring(s,n.length));let r=Li.exec(n||""),i={},o=14;for(;o--;)i[Mi[o]]=r[o]||"";return e!=-1&&s!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=Bi(i,i.path),i.queryKey=Pi(i,i.query),i}function Bi(n,t){const e=/\/{2,9}/g,s=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&s.splice(0,1),t.slice(-1)=="/"&&s.splice(s.length-1,1),s}function Pi(n,t){const e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,r,i){r&&(e[r]=i)}),e}const dn=typeof addEventListener=="function"&&typeof removeEventListener=="function",Re=[];dn&&addEventListener("offline",()=>{Re.forEach(n=>n())},!1);class Rt extends J{constructor(t,e){if(super(),this.binaryType=pi,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(e=t,t=null),t){const s=fn(t);e.hostname=s.host,e.secure=s.protocol==="https"||s.protocol==="wss",e.port=s.port,s.query&&(e.query=s.query)}else e.host&&(e.hostname=fn(e.host).host);He(this,e),this.secure=e.secure!=null?e.secure:typeof location<"u"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach(s=>{const r=s.prototype.name;this.transports.push(r),this._transportsByName[r]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=wi(this.opts.query)),dn&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Re.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=Ks,e.transport=t,this.id&&(e.sid=this.id);const s=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&Rt.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",Rt.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let s=0;s<this.writeBuffer.length;s++){const r=this.writeBuffer[s].data;if(r&&(e+=_i(r)),s>0&&e>this._maxPayload)return this.writeBuffer.slice(0,s);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Ye(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,e,s){return this._sendPacket("message",t,e,s),this}send(t,e,s){return this._sendPacket("message",t,e,s),this}_sendPacket(t,e,s,r){if(typeof e=="function"&&(r=e,e=void 0),typeof s=="function"&&(r=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const i={type:t,data:e,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},s=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}_onError(t){if(Rt.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),dn&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=Re.indexOf(this._offlineEventListener);s!==-1&&Re.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}Rt.protocol=Ks;class $i extends Rt{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),s=!1;Rt.priorWebsocketSuccess=!1;const r=()=>{s||(e.send([{type:"ping",data:"probe"}]),e.once("packet",l=>{if(!s)if(l.type==="pong"&&l.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;Rt.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(c(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const u=new Error("probe error");u.transport=e.name,this.emitReserved("upgradeError",u)}}))};function i(){s||(s=!0,c(),e.close(),e=null)}const o=l=>{const u=new Error("probe error: "+l);u.transport=e.name,i(),this.emitReserved("upgradeError",u)};function a(){o("transport closed")}function h(){o("socket closed")}function f(l){e&&l.name!==e.name&&i()}const c=()=>{e.removeListener("open",r),e.removeListener("error",o),e.removeListener("close",a),this.off("close",h),this.off("upgrading",f)};e.once("open",r),e.once("error",o),e.once("close",a),this.once("close",h),this.once("upgrading",f),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{s||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let s=0;s<t.length;s++)~this.transports.indexOf(t[s])&&e.push(t[s]);return e}}let Ii=class extends $i{constructor(t,e={}){const s=typeof t=="object"?t:e;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(r=>ji[r]).filter(r=>!!r)),super(t,s)}};function Di(n,t="",e){let s=n;e=e||typeof location<"u"&&location,n==null&&(n=e.protocol+"//"+e.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=e.protocol+n:n=e.host+n),/^(https?|wss?):\/\//.test(n)||(typeof e<"u"?n=e.protocol+"//"+n:n="https://"+n),s=fn(n)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const i=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+t,s.href=s.protocol+"://"+i+(e&&e.port===s.port?"":":"+s.port),s}const Fi=typeof ArrayBuffer=="function",Vi=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,er=Object.prototype.toString,qi=typeof Blob=="function"||typeof Blob<"u"&&er.call(Blob)==="[object BlobConstructor]",zi=typeof File=="function"||typeof File<"u"&&er.call(File)==="[object FileConstructor]";function Dn(n){return Fi&&(n instanceof ArrayBuffer||Vi(n))||qi&&n instanceof Blob||zi&&n instanceof File}function Oe(n,t){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let e=0,s=n.length;e<s;e++)if(Oe(n[e]))return!0;return!1}if(Dn(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return Oe(n.toJSON(),!0);for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)&&Oe(n[e]))return!0;return!1}function Ui(n){const t=[],e=n.data,s=n;return s.data=pn(e,t),s.attachments=t.length,{packet:s,buffers:t}}function pn(n,t){if(!n)return n;if(Dn(n)){const e={_placeholder:!0,num:t.length};return t.push(n),e}else if(Array.isArray(n)){const e=new Array(n.length);for(let s=0;s<n.length;s++)e[s]=pn(n[s],t);return e}else if(typeof n=="object"&&!(n instanceof Date)){const e={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=pn(n[s],t));return e}return n}function Yi(n,t){return n.data=vn(n.data,t),delete n.attachments,n}function vn(n,t){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<t.length)return t[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let e=0;e<n.length;e++)n[e]=vn(n[e],t);else if(typeof n=="object")for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(n[e]=vn(n[e],t));return n}const Hi=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Wi=5;var D;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(D||(D={}));class Xi{constructor(t){this.replacer=t}encode(t){return(t.type===D.EVENT||t.type===D.ACK)&&Oe(t)?this.encodeAsBinary({type:t.type===D.EVENT?D.BINARY_EVENT:D.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===D.BINARY_EVENT||t.type===D.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=Ui(t),s=this.encodeAsString(e.packet),r=e.buffers;return r.unshift(s),r}}function ls(n){return Object.prototype.toString.call(n)==="[object Object]"}class Fn extends J{constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const s=e.type===D.BINARY_EVENT;s||e.type===D.BINARY_ACK?(e.type=s?D.EVENT:D.ACK,this.reconstructor=new Ki(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(Dn(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0;const s={type:Number(t.charAt(0))};if(D[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===D.BINARY_EVENT||s.type===D.BINARY_ACK){const i=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);const o=t.substring(i,e);if(o!=Number(o)||t.charAt(e)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(t.charAt(e+1)==="/"){const i=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););s.nsp=t.substring(i,e)}else s.nsp="/";const r=t.charAt(e+1);if(r!==""&&Number(r)==r){const i=e+1;for(;++e;){const o=t.charAt(e);if(o==null||Number(o)!=o){--e;break}if(e===t.length)break}s.id=Number(t.substring(i,e+1))}if(t.charAt(++e)){const i=this.tryParse(t.substr(e));if(Fn.isPayloadValid(s.type,i))s.data=i;else throw new Error("invalid payload")}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case D.CONNECT:return ls(e);case D.DISCONNECT:return e===void 0;case D.CONNECT_ERROR:return typeof e=="string"||ls(e);case D.EVENT:case D.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&Hi.indexOf(e[0])===-1);case D.ACK:case D.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Ki{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const e=Yi(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Ji=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Fn,Encoder:Xi,get PacketType(){return D},protocol:Wi},Symbol.toStringTag,{value:"Module"}));function ft(n,t,e){return n.on(t,e),function(){n.off(t,e)}}const Gi=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});let nr=class extends J{constructor(t,e,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[ft(t,"open",this.onopen.bind(this)),ft(t,"packet",this.onpacket.bind(this)),ft(t,"error",this.onerror.bind(this)),ft(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var s,r,i;if(Gi.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const o={type:D.EVENT,data:e};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const c=this.ids++,l=e.pop();this._registerAckCallback(c,l),o.id=c}const a=(r=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||r===void 0?void 0:r.writable,h=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!a||(h?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,e){var s;const r=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(r===void 0){this.acks[t]=e;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===t&&this.sendBuffer.splice(a,1);e.call(this,new Error("operation has timed out"))},r),o=(...a)=>{this.io.clearTimeoutFn(i),e.apply(this,a)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...e){return new Promise((s,r)=>{const i=(o,a)=>o?r(o):s(a);i.withError=!0,e.push(i),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((r,...i)=>s!==this._queue[0]?void 0:(r!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(r)):(this._queue.shift(),e&&e(null,...i)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:D.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(s=>String(s.id)===t)){const s=this.acks[t];delete this.acks[t],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case D.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case D.EVENT:case D.BINARY_EVENT:this.onevent(t);break;case D.ACK:case D.BINARY_ACK:this.onack(t);break;case D.DISCONNECT:this.ondisconnect();break;case D.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data,this.emitReserved("connect_error",s);break}}onevent(t){const e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const s of e)s.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let s=!1;return function(...r){s||(s=!0,e.packet({type:D.ACK,id:t,data:r}))}}onack(t){const e=this.acks[t.id];typeof e=="function"&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:D.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const s of e)s.apply(this,t.data)}}};function Qt(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}Qt.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*n);n=Math.floor(t*10)&1?n+e:n-e}return Math.min(n,this.max)|0};Qt.prototype.reset=function(){this.attempts=0};Qt.prototype.setMin=function(n){this.ms=n};Qt.prototype.setMax=function(n){this.max=n};Qt.prototype.setJitter=function(n){this.jitter=n};class mn extends J{constructor(t,e){var s;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,He(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((s=e.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new Qt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;const r=e.parser||Ji;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Ii(this.uri,this.opts);const e=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const r=ft(e,"open",function(){s.onopen(),t&&t()}),i=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),t?t(a):this.maybeReconnectOnOpen()},o=ft(e,"error",i);if(this._timeout!==!1){const a=this._timeout,h=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),e.close()},a);this.opts.autoUnref&&h.unref(),this.subs.push(()=>{this.clearTimeoutFn(h)})}return this.subs.push(r),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(ft(t,"ping",this.onping.bind(this)),ft(t,"data",this.ondata.bind(this)),ft(t,"error",this.onerror.bind(this)),ft(t,"close",this.onclose.bind(this)),ft(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){Ye(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let s=this.nsps[t];return s?this._autoConnect&&!s.active&&s.connect():(s=new nr(this,t,e),this.nsps[t]=s),s}_destroy(t){const e=Object.keys(this.nsps);for(const s of e)if(this.nsps[s].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let s=0;s<e.length;s++)this.engine.write(e[s],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(r=>{r?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",r)):t.onreconnect()}))},e);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const se={};function he(n,t){typeof n=="object"&&(t=n,n=void 0),t=t||{};const e=Di(n,t.path||"/socket.io"),s=e.source,r=e.id,i=e.path,o=se[r]&&i in se[r].nsps,a=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let h;return a?h=new mn(s,t):(se[r]||(se[r]=new mn(s,t)),h=se[r]),e.query&&!t.query&&(t.query=e.queryKey),h.socket(e.path,t)}Object.assign(he,{Manager:mn,Socket:nr,io:he,connect:he});class Zi{constructor(){if(this.enabled=!1,typeof he=="function"){const t=location.origin;this.socket=he(t),this.socket&&(this.socket.on("connect",()=>{this.enabled=!0,console.log("Connected to websocket Obelix 1.0")}),this.socket.on("update_settings",e=>{console.log("SOCKETio",e),typeof e=="object"&&!Array.isArray(e)&&e!==null&&Ue.update(s=>({...s,...e}))}))}}destroy(){this.socket.offAny(),this.socket.disconnect()}emit(t){this.enabled&&this.socket.emit("message",t)}emitReply(t,e){this.enabled&&(console.log("emitReply"),this.socket.emit("message_reply",t,(s,r)=>{console.log("emitReply response",s,r),typeof e=="function"&&e(r)}))}}const sr=new Zi;function st(n,t){sr.emit({get:"foo"});const e=location.origin;fetch(e+n).then(s=>s.json()).then(s=>{typeof t=="function"&&t(s)})}function Vn(n,t,e){sr.emitReply({post:"foo"},e);const s=location.origin;fetch(s+n,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(r=>r.json()).then(r=>{e&&e(r)})}class Pt{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let s=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],o=t+i,a=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);a&&(e[s++]=a),t=o}return e[s]=t,this._n=s+1,this}valueOf(){const t=this._partials;let e=this._n,s,r,i,o=0;if(e>0){for(o=t[--e];e>0&&(s=o,r=t[--e],o=s+r,i=r-(o-s),!i););e>0&&(i<0&&t[e-1]<0||i>0&&t[e-1]>0)&&(r=i*2,s=o+r,r==s-o&&(o=s))}return o}}function*Qi(n){for(const t of n)yield*t}function rr(n){return Array.from(Qi(n))}function Yt(n,t,e){n=+n,t=+t,e=(r=arguments.length)<2?(t=n,n=0,1):r<3?1:+e;for(var s=-1,r=Math.max(0,Math.ceil((t-n)/e))|0,i=new Array(r);++s<r;)i[s]=n+s*e;return i}var F=1e-6,to=1e-12,V=Math.PI,ct=V/2,us=V/4,ut=V*2,kt=180/V,et=V/180,Y=Math.abs,eo=Math.atan,Jt=Math.atan2,X=Math.cos,we=Math.ceil,H=Math.sin,no=Math.sign||function(n){return n>0?1:n<0?-1:0},Nt=Math.sqrt;function so(n){return n>1?0:n<-1?V:Math.acos(n)}function $t(n){return n>1?ct:n<-1?-ct:Math.asin(n)}function lt(){}function Me(n,t){n&&fs.hasOwnProperty(n.type)&&fs[n.type](n,t)}var hs={Feature:function(n,t){Me(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,s=-1,r=e.length;++s<r;)Me(e[s].geometry,t)}},fs={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,s=-1,r=e.length;++s<r;)n=e[s],t.point(n[0],n[1],n[2])},LineString:function(n,t){gn(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,s=-1,r=e.length;++s<r;)gn(e[s],t,0)},Polygon:function(n,t){ds(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,s=-1,r=e.length;++s<r;)ds(e[s],t)},GeometryCollection:function(n,t){for(var e=n.geometries,s=-1,r=e.length;++s<r;)Me(e[s],t)}};function gn(n,t,e){var s=-1,r=n.length-e,i;for(t.lineStart();++s<r;)i=n[s],t.point(i[0],i[1],i[2]);t.lineEnd()}function ds(n,t){var e=-1,s=n.length;for(t.polygonStart();++e<s;)gn(n[e],t,1);t.polygonEnd()}function Vt(n,t){n&&hs.hasOwnProperty(n.type)?hs[n.type](n,t):Me(n,t)}function _n(n){return[Jt(n[1],n[0]),$t(n[2])]}function Gt(n){var t=n[0],e=n[1],s=X(e);return[s*X(t),s*H(t),H(e)]}function be(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function Be(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function sn(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function Ee(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function yn(n){var t=Nt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function xn(n,t){function e(s,r){return s=n(s,r),t(s[0],s[1])}return n.invert&&t.invert&&(e.invert=function(s,r){return s=t.invert(s,r),s&&n.invert(s[0],s[1])}),e}function wn(n,t){return Y(n)>V&&(n-=Math.round(n/ut)*ut),[n,t]}wn.invert=wn;function ro(n,t,e){return(n%=ut)?t||e?xn(vs(n),ms(t,e)):vs(n):t||e?ms(t,e):wn}function ps(n){return function(t,e){return t+=n,Y(t)>V&&(t-=Math.round(t/ut)*ut),[t,e]}}function vs(n){var t=ps(n);return t.invert=ps(-n),t}function ms(n,t){var e=X(n),s=H(n),r=X(t),i=H(t);function o(a,h){var f=X(h),c=X(a)*f,l=H(a)*f,u=H(h),p=u*e+c*s;return[Jt(l*r-p*i,c*e-u*s),$t(p*r+l*i)]}return o.invert=function(a,h){var f=X(h),c=X(a)*f,l=H(a)*f,u=H(h),p=u*r-l*i;return[Jt(l*r+u*i,c*e+p*s),$t(p*e-c*s)]},o}function io(n,t,e,s,r,i){if(e){var o=X(t),a=H(t),h=s*e;r==null?(r=t+s*ut,i=t-h/2):(r=gs(o,r),i=gs(o,i),(s>0?r<i:r>i)&&(r+=s*ut));for(var f,c=r;s>0?c>i:c<i;c-=h)f=_n([o,-a*X(c),-a*H(c)]),n.point(f[0],f[1])}}function gs(n,t){t=Gt(t),t[0]-=n,yn(t);var e=so(-t[1]);return((-t[2]<0?-e:e)+ut-F)%ut}function ir(){var n=[],t;return{point:function(e,s,r){t.push([e,s,r])},lineStart:function(){n.push(t=[])},lineEnd:lt,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}}function Ne(n,t){return Y(n[0]-t[0])<F&&Y(n[1]-t[1])<F}function ke(n,t,e,s){this.x=n,this.z=t,this.o=e,this.e=s,this.v=!1,this.n=this.p=null}function or(n,t,e,s,r){var i=[],o=[],a,h;if(n.forEach(function(d){if(!((b=d.length-1)<=0)){var b,y=d[0],w=d[b],x;if(Ne(y,w)){if(!y[2]&&!w[2]){for(r.lineStart(),a=0;a<b;++a)r.point((y=d[a])[0],y[1]);r.lineEnd();return}w[0]+=2*F}i.push(x=new ke(y,d,null,!0)),o.push(x.o=new ke(y,null,x,!1)),i.push(x=new ke(w,d,null,!1)),o.push(x.o=new ke(w,null,x,!0))}}),!!i.length){for(o.sort(t),_s(i),_s(o),a=0,h=o.length;a<h;++a)o[a].e=e=!e;for(var f=i[0],c,l;;){for(var u=f,p=!0;u.v;)if((u=u.n)===f)return;c=u.z,r.lineStart();do{if(u.v=u.o.v=!0,u.e){if(p)for(a=0,h=c.length;a<h;++a)r.point((l=c[a])[0],l[1]);else s(u.x,u.n.x,1,r);u=u.n}else{if(p)for(c=u.p.z,a=c.length-1;a>=0;--a)r.point((l=c[a])[0],l[1]);else s(u.x,u.p.x,-1,r);u=u.p}u=u.o,c=u.z,p=!p}while(!u.v);r.lineEnd()}}}function _s(n){if(t=n.length){for(var t,e=0,s=n[0],r;++e<t;)s.n=r=n[e],r.p=s,s=r;s.n=r=n[0],r.p=s}}function rn(n){return Y(n[0])<=V?n[0]:no(n[0])*((Y(n[0])+V)%ut-V)}function oo(n,t){var e=rn(t),s=t[1],r=H(s),i=[H(e),-X(e),0],o=0,a=0,h=new Pt;r===1?s=ct+F:r===-1&&(s=-ct-F);for(var f=0,c=n.length;f<c;++f)if(u=(l=n[f]).length)for(var l,u,p=l[u-1],d=rn(p),b=p[1]/2+us,y=H(b),w=X(b),x=0;x<u;++x,d=g,y=R,w=B,p=v){var v=l[x],g=rn(v),E=v[1]/2+us,R=H(E),B=X(E),O=g-d,S=O>=0?1:-1,T=S*O,k=T>V,P=y*R;if(h.add(Jt(P*S*H(T),w*B+P*X(T))),o+=k?O+S*ut:O,k^d>=e^g>=e){var j=Be(Gt(p),Gt(v));yn(j);var N=Be(i,j);yn(N);var _=(k^O>=0?-1:1)*$t(N[2]);(s>_||s===_&&(j[0]||j[1]))&&(a+=k^O>=0?1:-1)}}return(o<-F||o<F&&h<-to)^a&1}function ar(n,t,e,s){return function(r){var i=t(r),o=ir(),a=t(o),h=!1,f,c,l,u={point:p,lineStart:b,lineEnd:y,polygonStart:function(){u.point=w,u.lineStart=x,u.lineEnd=v,c=[],f=[]},polygonEnd:function(){u.point=p,u.lineStart=b,u.lineEnd=y,c=rr(c);var g=oo(f,s);c.length?(h||(r.polygonStart(),h=!0),or(c,co,g,e,r)):g&&(h||(r.polygonStart(),h=!0),r.lineStart(),e(null,null,1,r),r.lineEnd()),h&&(r.polygonEnd(),h=!1),c=f=null},sphere:function(){r.polygonStart(),r.lineStart(),e(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(g,E){n(g,E)&&r.point(g,E)}function d(g,E){i.point(g,E)}function b(){u.point=d,i.lineStart()}function y(){u.point=p,i.lineEnd()}function w(g,E){l.push([g,E]),a.point(g,E)}function x(){a.lineStart(),l=[]}function v(){w(l[0][0],l[0][1]),a.lineEnd();var g=a.clean(),E=o.result(),R,B=E.length,O,S,T;if(l.pop(),f.push(l),l=null,!!B){if(g&1){if(S=E[0],(O=S.length-1)>0){for(h||(r.polygonStart(),h=!0),r.lineStart(),R=0;R<O;++R)r.point((T=S[R])[0],T[1]);r.lineEnd()}return}B>1&&g&2&&E.push(E.pop().concat(E.shift())),c.push(E.filter(ao))}}return u}}function ao(n){return n.length>1}function co(n,t){return((n=n.x)[0]<0?n[1]-ct-F:ct-n[1])-((t=t.x)[0]<0?t[1]-ct-F:ct-t[1])}const ys=ar(function(){return!0},lo,ho,[-V,-ct]);function lo(n){var t=NaN,e=NaN,s=NaN,r;return{lineStart:function(){n.lineStart(),r=1},point:function(i,o){var a=i>0?V:-V,h=Y(i-t);Y(h-V)<F?(n.point(t,e=(e+o)/2>0?ct:-ct),n.point(s,e),n.lineEnd(),n.lineStart(),n.point(a,e),n.point(i,e),r=0):s!==a&&h>=V&&(Y(t-s)<F&&(t-=s*F),Y(i-a)<F&&(i-=a*F),e=uo(t,e,i,o),n.point(s,e),n.lineEnd(),n.lineStart(),n.point(a,e),r=0),n.point(t=i,e=o),s=a},lineEnd:function(){n.lineEnd(),t=e=NaN},clean:function(){return 2-r}}}function uo(n,t,e,s){var r,i,o=H(n-e);return Y(o)>F?eo((H(t)*(i=X(s))*H(e)-H(s)*(r=X(t))*H(n))/(r*i*o)):(t+s)/2}function ho(n,t,e,s){var r;if(n==null)r=e*ct,s.point(-V,r),s.point(0,r),s.point(V,r),s.point(V,0),s.point(V,-r),s.point(0,-r),s.point(-V,-r),s.point(-V,0),s.point(-V,r);else if(Y(n[0]-t[0])>F){var i=n[0]<t[0]?V:-V;r=e*i/2,s.point(-i,r),s.point(0,r),s.point(i,r)}else s.point(t[0],t[1])}function fo(n){var t=X(n),e=2*et,s=t>0,r=Y(t)>F;function i(c,l,u,p){io(p,n,e,u,c,l)}function o(c,l){return X(c)*X(l)>t}function a(c){var l,u,p,d,b;return{lineStart:function(){d=p=!1,b=1},point:function(y,w){var x=[y,w],v,g=o(y,w),E=s?g?0:f(y,w):g?f(y+(y<0?V:-V),w):0;if(!l&&(d=p=g)&&c.lineStart(),g!==p&&(v=h(l,x),(!v||Ne(l,v)||Ne(x,v))&&(x[2]=1)),g!==p)b=0,g?(c.lineStart(),v=h(x,l),c.point(v[0],v[1])):(v=h(l,x),c.point(v[0],v[1],2),c.lineEnd()),l=v;else if(r&&l&&s^g){var R;!(E&u)&&(R=h(x,l,!0))&&(b=0,s?(c.lineStart(),c.point(R[0][0],R[0][1]),c.point(R[1][0],R[1][1]),c.lineEnd()):(c.point(R[1][0],R[1][1]),c.lineEnd(),c.lineStart(),c.point(R[0][0],R[0][1],3)))}g&&(!l||!Ne(l,x))&&c.point(x[0],x[1]),l=x,p=g,u=E},lineEnd:function(){p&&c.lineEnd(),l=null},clean:function(){return b|(d&&p)<<1}}}function h(c,l,u){var p=Gt(c),d=Gt(l),b=[1,0,0],y=Be(p,d),w=be(y,y),x=y[0],v=w-x*x;if(!v)return!u&&c;var g=t*w/v,E=-t*x/v,R=Be(b,y),B=Ee(b,g),O=Ee(y,E);sn(B,O);var S=R,T=be(B,S),k=be(S,S),P=T*T-k*(be(B,B)-1);if(!(P<0)){var j=Nt(P),N=Ee(S,(-T-j)/k);if(sn(N,B),N=_n(N),!u)return N;var _=c[0],L=l[0],z=c[1],W=l[1],rt;L<_&&(rt=_,_=L,L=rt);var te=L-_,wt=Y(te-V)<F,jt=wt||te<F;if(!wt&&W<z&&(rt=z,z=W,W=rt),jt?wt?z+W>0^N[1]<(Y(N[0]-_)<F?z:W):z<=N[1]&&N[1]<=W:te>V^(_<=N[0]&&N[0]<=L)){var bt=Ee(S,(-T+j)/k);return sn(bt,B),[N,_n(bt)]}}}function f(c,l){var u=s?n:V-n,p=0;return c<-u?p|=1:c>u&&(p|=2),l<-u?p|=4:l>u&&(p|=8),p}return ar(o,a,i,s?[0,-n]:[-V,n-V])}function po(n,t,e,s,r,i){var o=n[0],a=n[1],h=t[0],f=t[1],c=0,l=1,u=h-o,p=f-a,d;if(d=e-o,!(!u&&d>0)){if(d/=u,u<0){if(d<c)return;d<l&&(l=d)}else if(u>0){if(d>l)return;d>c&&(c=d)}if(d=r-o,!(!u&&d<0)){if(d/=u,u<0){if(d>l)return;d>c&&(c=d)}else if(u>0){if(d<c)return;d<l&&(l=d)}if(d=s-a,!(!p&&d>0)){if(d/=p,p<0){if(d<c)return;d<l&&(l=d)}else if(p>0){if(d>l)return;d>c&&(c=d)}if(d=i-a,!(!p&&d<0)){if(d/=p,p<0){if(d>l)return;d>c&&(c=d)}else if(p>0){if(d<c)return;d<l&&(l=d)}return c>0&&(n[0]=o+c*u,n[1]=a+c*p),l<1&&(t[0]=o+l*u,t[1]=a+l*p),!0}}}}}var ie=1e9,Se=-ie;function vo(n,t,e,s){function r(f,c){return n<=f&&f<=e&&t<=c&&c<=s}function i(f,c,l,u){var p=0,d=0;if(f==null||(p=o(f,l))!==(d=o(c,l))||h(f,c)<0^l>0)do u.point(p===0||p===3?n:e,p>1?s:t);while((p=(p+l+4)%4)!==d);else u.point(c[0],c[1])}function o(f,c){return Y(f[0]-n)<F?c>0?0:3:Y(f[0]-e)<F?c>0?2:1:Y(f[1]-t)<F?c>0?1:0:c>0?3:2}function a(f,c){return h(f.x,c.x)}function h(f,c){var l=o(f,1),u=o(c,1);return l!==u?l-u:l===0?c[1]-f[1]:l===1?f[0]-c[0]:l===2?f[1]-c[1]:c[0]-f[0]}return function(f){var c=f,l=ir(),u,p,d,b,y,w,x,v,g,E,R,B={point:O,lineStart:P,lineEnd:j,polygonStart:T,polygonEnd:k};function O(_,L){r(_,L)&&c.point(_,L)}function S(){for(var _=0,L=0,z=p.length;L<z;++L)for(var W=p[L],rt=1,te=W.length,wt=W[0],jt,bt,ge=wt[0],Ft=wt[1];rt<te;++rt)jt=ge,bt=Ft,wt=W[rt],ge=wt[0],Ft=wt[1],bt<=s?Ft>s&&(ge-jt)*(s-bt)>(Ft-bt)*(n-jt)&&++_:Ft<=s&&(ge-jt)*(s-bt)<(Ft-bt)*(n-jt)&&--_;return _}function T(){c=l,u=[],p=[],R=!0}function k(){var _=S(),L=R&&_,z=(u=rr(u)).length;(L||z)&&(f.polygonStart(),L&&(f.lineStart(),i(null,null,1,f),f.lineEnd()),z&&or(u,a,_,i,f),f.polygonEnd()),c=f,u=p=d=null}function P(){B.point=N,p&&p.push(d=[]),E=!0,g=!1,x=v=NaN}function j(){u&&(N(b,y),w&&g&&l.rejoin(),u.push(l.result())),B.point=O,g&&c.lineEnd()}function N(_,L){var z=r(_,L);if(p&&d.push([_,L]),E)b=_,y=L,w=z,E=!1,z&&(c.lineStart(),c.point(_,L));else if(z&&g)c.point(_,L);else{var W=[x=Math.max(Se,Math.min(ie,x)),v=Math.max(Se,Math.min(ie,v))],rt=[_=Math.max(Se,Math.min(ie,_)),L=Math.max(Se,Math.min(ie,L))];po(W,rt,n,t,e,s)?(g||(c.lineStart(),c.point(W[0],W[1])),c.point(rt[0],rt[1]),z||c.lineEnd(),R=!1):z&&(c.lineStart(),c.point(_,L),R=!1)}x=_,v=L,g=z}return B}}function xs(n,t,e){var s=Yt(n,t-F,e).concat(t);return function(r){return s.map(function(i){return[r,i]})}}function ws(n,t,e){var s=Yt(n,t-F,e).concat(t);return function(r){return s.map(function(i){return[i,r]})}}function mo(){var n,t,e,s,r,i,o,a,h=10,f=h,c=90,l=360,u,p,d,b,y=2.5;function w(){return{type:"MultiLineString",coordinates:x()}}function x(){return Yt(we(s/c)*c,e,c).map(d).concat(Yt(we(a/l)*l,o,l).map(b)).concat(Yt(we(t/h)*h,n,h).filter(function(v){return Y(v%c)>F}).map(u)).concat(Yt(we(i/f)*f,r,f).filter(function(v){return Y(v%l)>F}).map(p))}return w.lines=function(){return x().map(function(v){return{type:"LineString",coordinates:v}})},w.outline=function(){return{type:"Polygon",coordinates:[d(s).concat(b(o).slice(1),d(e).reverse().slice(1),b(a).reverse().slice(1))]}},w.extent=function(v){return arguments.length?w.extentMajor(v).extentMinor(v):w.extentMinor()},w.extentMajor=function(v){return arguments.length?(s=+v[0][0],e=+v[1][0],a=+v[0][1],o=+v[1][1],s>e&&(v=s,s=e,e=v),a>o&&(v=a,a=o,o=v),w.precision(y)):[[s,a],[e,o]]},w.extentMinor=function(v){return arguments.length?(t=+v[0][0],n=+v[1][0],i=+v[0][1],r=+v[1][1],t>n&&(v=t,t=n,n=v),i>r&&(v=i,i=r,r=v),w.precision(y)):[[t,i],[n,r]]},w.step=function(v){return arguments.length?w.stepMajor(v).stepMinor(v):w.stepMinor()},w.stepMajor=function(v){return arguments.length?(c=+v[0],l=+v[1],w):[c,l]},w.stepMinor=function(v){return arguments.length?(h=+v[0],f=+v[1],w):[h,f]},w.precision=function(v){return arguments.length?(y=+v,u=xs(i,r,90),p=ws(t,n,y),d=xs(a,o,90),b=ws(s,e,y),w):y},w.extentMajor([[-180,-90+F],[180,90-F]]).extentMinor([[-180,-80-F],[180,80+F]])}const bn=n=>n;var on=new Pt,En=new Pt,cr,lr,kn,Sn,St={point:lt,lineStart:lt,lineEnd:lt,polygonStart:function(){St.lineStart=go,St.lineEnd=yo},polygonEnd:function(){St.lineStart=St.lineEnd=St.point=lt,on.add(Y(En)),En=new Pt},result:function(){var n=on/2;return on=new Pt,n}};function go(){St.point=_o}function _o(n,t){St.point=ur,cr=kn=n,lr=Sn=t}function ur(n,t){En.add(Sn*n-kn*t),kn=n,Sn=t}function yo(){ur(cr,lr)}var Zt=1/0,Pe=Zt,fe=-Zt,$e=fe,Ie={point:xo,lineStart:lt,lineEnd:lt,polygonStart:lt,polygonEnd:lt,result:function(){var n=[[Zt,Pe],[fe,$e]];return fe=$e=-(Pe=Zt=1/0),n}};function xo(n,t){n<Zt&&(Zt=n),n>fe&&(fe=n),t<Pe&&(Pe=t),t>$e&&($e=t)}var Tn=0,An=0,oe=0,De=0,Fe=0,Ht=0,Cn=0,Rn=0,ae=0,hr,fr,gt,_t,at={point:It,lineStart:bs,lineEnd:Es,polygonStart:function(){at.lineStart=Eo,at.lineEnd=ko},polygonEnd:function(){at.point=It,at.lineStart=bs,at.lineEnd=Es},result:function(){var n=ae?[Cn/ae,Rn/ae]:Ht?[De/Ht,Fe/Ht]:oe?[Tn/oe,An/oe]:[NaN,NaN];return Tn=An=oe=De=Fe=Ht=Cn=Rn=ae=0,n}};function It(n,t){Tn+=n,An+=t,++oe}function bs(){at.point=wo}function wo(n,t){at.point=bo,It(gt=n,_t=t)}function bo(n,t){var e=n-gt,s=t-_t,r=Nt(e*e+s*s);De+=r*(gt+n)/2,Fe+=r*(_t+t)/2,Ht+=r,It(gt=n,_t=t)}function Es(){at.point=It}function Eo(){at.point=So}function ko(){dr(hr,fr)}function So(n,t){at.point=dr,It(hr=gt=n,fr=_t=t)}function dr(n,t){var e=n-gt,s=t-_t,r=Nt(e*e+s*s);De+=r*(gt+n)/2,Fe+=r*(_t+t)/2,Ht+=r,r=_t*n-gt*t,Cn+=r*(gt+n),Rn+=r*(_t+t),ae+=r*3,It(gt=n,_t=t)}function pr(n){this._context=n}pr.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:{this._context.moveTo(n,t),this._point=1;break}case 1:{this._context.lineTo(n,t);break}default:{this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,ut);break}}},result:lt};var On=new Pt,an,vr,mr,ce,le,de={point:lt,lineStart:function(){de.point=To},lineEnd:function(){an&&gr(vr,mr),de.point=lt},polygonStart:function(){an=!0},polygonEnd:function(){an=null},result:function(){var n=+On;return On=new Pt,n}};function To(n,t){de.point=gr,vr=ce=n,mr=le=t}function gr(n,t){ce-=n,le-=t,On.add(Nt(ce*ce+le*le)),ce=n,le=t}let ks,Ve,Ss,Ts;class As{constructor(t){this._append=t==null?_r:Ao(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:{this._append`M${t},${e}`,this._point=1;break}case 1:{this._append`L${t},${e}`;break}default:{if(this._append`M${t},${e}`,this._radius!==Ss||this._append!==Ve){const s=this._radius,r=this._;this._="",this._append`m0,${s}a${s},${s} 0 1,1 0,${-2*s}a${s},${s} 0 1,1 0,${2*s}z`,Ss=s,Ve=this._append,Ts=this._,this._=r}this._+=Ts;break}}}result(){const t=this._;return this._="",t.length?t:null}}function _r(n){let t=1;this._+=n[0];for(const e=n.length;t<e;++t)this._+=arguments[t]+n[t]}function Ao(n){const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);if(t>15)return _r;if(t!==ks){const e=10**t;ks=t,Ve=function(r){let i=1;this._+=r[0];for(const o=r.length;i<o;++i)this._+=Math.round(arguments[i]*e)/e+r[i]}}return Ve}function Co(n,t){let e=3,s=4.5,r,i;function o(a){return a&&(typeof s=="function"&&i.pointRadius(+s.apply(this,arguments)),Vt(a,r(i))),i.result()}return o.area=function(a){return Vt(a,r(St)),St.result()},o.measure=function(a){return Vt(a,r(de)),de.result()},o.bounds=function(a){return Vt(a,r(Ie)),Ie.result()},o.centroid=function(a){return Vt(a,r(at)),at.result()},o.projection=function(a){return arguments.length?(r=a==null?(n=null,bn):(n=a).stream,o):n},o.context=function(a){return arguments.length?(i=a==null?(t=null,new As(e)):new pr(t=a),typeof s!="function"&&i.pointRadius(s),o):t},o.pointRadius=function(a){return arguments.length?(s=typeof a=="function"?a:(i.pointRadius(+a),+a),o):s},o.digits=function(a){if(!arguments.length)return e;if(a==null)e=null;else{const h=Math.floor(a);if(!(h>=0))throw new RangeError(`invalid digits: ${a}`);e=h}return t===null&&(i=new As(e)),o},o.projection(n).digits(e).context(t)}function qn(n){return function(t){var e=new Nn;for(var s in n)e[s]=n[s];return e.stream=t,e}}function Nn(){}Nn.prototype={constructor:Nn,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function zn(n,t,e){var s=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),s!=null&&n.clipExtent(null),Vt(e,n.stream(Ie)),t(Ie.result()),s!=null&&n.clipExtent(s),n}function yr(n,t,e){return zn(n,function(s){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=Math.min(r/(s[1][0]-s[0][0]),i/(s[1][1]-s[0][1])),a=+t[0][0]+(r-o*(s[1][0]+s[0][0]))/2,h=+t[0][1]+(i-o*(s[1][1]+s[0][1]))/2;n.scale(150*o).translate([a,h])},e)}function Ro(n,t,e){return yr(n,[[0,0],t],e)}function Oo(n,t,e){return zn(n,function(s){var r=+t,i=r/(s[1][0]-s[0][0]),o=(r-i*(s[1][0]+s[0][0]))/2,a=-i*s[0][1];n.scale(150*i).translate([o,a])},e)}function No(n,t,e){return zn(n,function(s){var r=+t,i=r/(s[1][1]-s[0][1]),o=-i*s[0][0],a=(r-i*(s[1][1]+s[0][1]))/2;n.scale(150*i).translate([o,a])},e)}var Cs=16,jo=X(30*et);function Rs(n,t){return+t?Mo(n,t):Lo(n)}function Lo(n){return qn({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}})}function Mo(n,t){function e(s,r,i,o,a,h,f,c,l,u,p,d,b,y){var w=f-s,x=c-r,v=w*w+x*x;if(v>4*t&&b--){var g=o+u,E=a+p,R=h+d,B=Nt(g*g+E*E+R*R),O=$t(R/=B),S=Y(Y(R)-1)<F||Y(i-l)<F?(i+l)/2:Jt(E,g),T=n(S,O),k=T[0],P=T[1],j=k-s,N=P-r,_=x*j-w*N;(_*_/v>t||Y((w*j+x*N)/v-.5)>.3||o*u+a*p+h*d<jo)&&(e(s,r,i,o,a,h,k,P,S,g/=B,E/=B,R,b,y),y.point(k,P),e(k,P,S,g,E,R,f,c,l,u,p,d,b,y))}}return function(s){var r,i,o,a,h,f,c,l,u,p,d,b,y={point:w,lineStart:x,lineEnd:g,polygonStart:function(){s.polygonStart(),y.lineStart=E},polygonEnd:function(){s.polygonEnd(),y.lineStart=x}};function w(O,S){O=n(O,S),s.point(O[0],O[1])}function x(){l=NaN,y.point=v,s.lineStart()}function v(O,S){var T=Gt([O,S]),k=n(O,S);e(l,u,c,p,d,b,l=k[0],u=k[1],c=O,p=T[0],d=T[1],b=T[2],Cs,s),s.point(l,u)}function g(){y.point=w,s.lineEnd()}function E(){x(),y.point=R,y.lineEnd=B}function R(O,S){v(r=O,S),i=l,o=u,a=p,h=d,f=b,y.point=v}function B(){e(l,u,c,p,d,b,i,o,r,a,h,f,Cs,s),y.lineEnd=g,g()}return y}}var Bo=qn({point:function(n,t){this.stream.point(n*et,t*et)}});function Po(n){return qn({point:function(t,e){var s=n(t,e);return this.stream.point(s[0],s[1])}})}function $o(n,t,e,s,r){function i(o,a){return o*=s,a*=r,[t+n*o,e-n*a]}return i.invert=function(o,a){return[(o-t)/n*s,(e-a)/n*r]},i}function Os(n,t,e,s,r,i){if(!i)return $o(n,t,e,s,r);var o=X(i),a=H(i),h=o*n,f=a*n,c=o/n,l=a/n,u=(a*e-o*t)/n,p=(a*t+o*e)/n;function d(b,y){return b*=s,y*=r,[h*b-f*y+t,e-f*b-h*y]}return d.invert=function(b,y){return[s*(c*b-l*y+u),r*(p-l*b-c*y)]},d}function Io(n){return Do(function(){return n})()}function Do(n){var t,e=150,s=480,r=250,i=0,o=0,a=0,h=0,f=0,c,l=0,u=1,p=1,d=null,b=ys,y=null,w,x,v,g=bn,E=.5,R,B,O,S,T;function k(_){return O(_[0]*et,_[1]*et)}function P(_){return _=O.invert(_[0],_[1]),_&&[_[0]*kt,_[1]*kt]}k.stream=function(_){return S&&T===_?S:S=Bo(Po(c)(b(R(g(T=_)))))},k.preclip=function(_){return arguments.length?(b=_,d=void 0,N()):b},k.postclip=function(_){return arguments.length?(g=_,y=w=x=v=null,N()):g},k.clipAngle=function(_){return arguments.length?(b=+_?fo(d=_*et):(d=null,ys),N()):d*kt},k.clipExtent=function(_){return arguments.length?(g=_==null?(y=w=x=v=null,bn):vo(y=+_[0][0],w=+_[0][1],x=+_[1][0],v=+_[1][1]),N()):y==null?null:[[y,w],[x,v]]},k.scale=function(_){return arguments.length?(e=+_,j()):e},k.translate=function(_){return arguments.length?(s=+_[0],r=+_[1],j()):[s,r]},k.center=function(_){return arguments.length?(i=_[0]%360*et,o=_[1]%360*et,j()):[i*kt,o*kt]},k.rotate=function(_){return arguments.length?(a=_[0]%360*et,h=_[1]%360*et,f=_.length>2?_[2]%360*et:0,j()):[a*kt,h*kt,f*kt]},k.angle=function(_){return arguments.length?(l=_%360*et,j()):l*kt},k.reflectX=function(_){return arguments.length?(u=_?-1:1,j()):u<0},k.reflectY=function(_){return arguments.length?(p=_?-1:1,j()):p<0},k.precision=function(_){return arguments.length?(R=Rs(B,E=_*_),N()):Nt(E)},k.fitExtent=function(_,L){return yr(k,_,L)},k.fitSize=function(_,L){return Ro(k,_,L)},k.fitWidth=function(_,L){return Oo(k,_,L)},k.fitHeight=function(_,L){return No(k,_,L)};function j(){var _=Os(e,0,0,u,p,l).apply(null,t(i,o)),L=Os(e,s-_[0],r-_[1],u,p,l);return c=ro(a,h,f),B=xn(t,L),O=xn(c,B),R=Rs(B,E),N()}function N(){return S=T=null,k}return function(){return t=n.apply(this,arguments),k.invert=t.invert&&P,j()}}function Fo(n){return function(t,e){var s=Nt(t*t+e*e),r=n(s),i=H(r),o=X(r);return[Jt(t*i,s*o),$t(s&&e*i/s)]}}function xr(n,t){return[X(t)*H(n),H(t)]}xr.invert=Fo($t);function Vo(){return Io(xr).scale(249.5).clipAngle(90+F)}var qo=ve('<path fill="none" stroke="rgb(255,255,255)" stroke-width="0.3"></path>');function Ns(n,t){Q(t,!0);let e,s;const r=Ue.subscribe(l=>{e=l.deg_x,s=l.deg_y});ht(()=>{r&&r()});const i=qt(t,"scale",3,2e3),o=qt(t,"steps",3,5),a=mo().stepMajor([45,45]).stepMinor([o(),o()]);let h=Xt(()=>Vo().scale(i()).rotate([e,-s]).translate([1080/2,810/2]).clipAngle(40)),f=Xt(()=>Co().projection(m(h)));var c=qo();nt(()=>K(c,"d",m(f)(a()))),$(n,c),tt()}var zo=(n,t)=>t("A"),Uo=(n,t)=>t("B"),Yo=q('<div id="camera-stream" class="svelte-zqlhxu"><button id="telescope-stream"><svg class="svg-img svelte-zqlhxu" viewBox="0 0 1080 810" preserveAspectRatio="xMidYMid slice"><foreignObject class="img-wrap svelte-zqlhxu" x="0" y="0" width="1080" height="810"><img alt="Telescope" class="svg-img svelte-zqlhxu"></foreignObject><!></svg></button> <button id="viewfinder-stream"><svg class="svg-img svelte-zqlhxu" viewBox="0 0 1080 810" preserveAspectRatio="xMidYMid slice"><foreignObject class="img-wrap svelte-zqlhxu" x="0" y="0" width="1080" height="810"><img alt="Viewfinder" class="svg-img svelte-zqlhxu"></foreignObject><g><rect class="crosshair svelte-zqlhxu" x="540" y="405"></rect><!></g></svg></button></div>');function Ho(n,t){Q(t,!0);const e=Dt(),s=()=>Ot(Ae,"$swapPreview",e);let r=U(0),i=U(0),o=U(void 0);const a=Ae.subscribe(T=>{I(o,Z(T))}),h=T=>{m(o)!==T&&Ae.update(k=>T)};let f=Z({CrosshairSize:.4,CrosshairOffsetX:0,CrosshairOffsetY:0,SphereScaleVF:1500,SphereScaleTel:24e3}),c=Le.subscribe(T=>{for(let k of T)f[k.id]=k.value}),l=U("starfield-zoom.jpg"),u=U("starfield.jpg");me(()=>{I(l,`${location.protocol}//${location.hostname}:7777/stream_a.mjpg`),I(u,`${location.protocol}//${location.hostname}:7777/stream_b.mjpg`),st("/config/graticule/settings",T=>{Le.update(k=>k.map(P=>P!=null&&P.id&&Object.hasOwn(T,P.id)?{...k,value:T[P.id]}:{...k}))})}),ht(()=>{a&&a(),c&&c()});var p=Yo(),d=C(p);d.__click=[zo,h];var b=C(d),y=C(b),w=C(y);A(y);var x=M(y);Ns(x,{get scale(){return f.SphereScaleTel},steps:"1",get width(){return m(r)},get height(){return m(i)}}),A(b),A(d);var v=M(d,2);v.__click=[Uo,h];var g=C(v),E=C(g),R=C(E);A(E);var B=M(E),O=C(B),S=M(O);Ns(S,{get scale(){return f.SphereScaleVF},steps:"5",get width(){return m(r)},get height(){return m(i)}}),A(B),A(g),A(v),A(p),nt(()=>{Bt(d,`stream-wrapper ${(s()==="A"?"large":"")??""} svelte-zqlhxu`),K(b,"width",m(r)),K(b,"height",m(i)),K(w,"src",m(l)),Bt(v,`stream-wrapper ${(s()==="B"?"large":"")??""} svelte-zqlhxu`),K(g,"width",m(r)),K(g,"height",m(i)),K(R,"src",m(u)),K(B,"transform",`translate(${m(r)/4*f.CrosshairOffsetX} ${m(i)/4*f.CrosshairOffsetY})`),K(O,"transform",`translate(${m(r)*f.CrosshairSize*-.5} ${m(i)*f.CrosshairSize*-.5})`),K(O,"width",m(r)*f.CrosshairSize),K(O,"height",m(i)*f.CrosshairSize)}),rs(p,"clientWidth",T=>I(r,T)),rs(p,"clientHeight",T=>I(i,T)),$(n,p),tt()}pt(["click"]);var Wo=q('<div class="layer svelte-qmdbdl"><!></div>'),Xo=q('<div class="visuals svelte-qmdbdl"><!> <!></div>');function Ko(n){const t=Dt(),e=()=>Ot(un,"$displayCompass",t);var s=Xo(),r=C(s);Ho(r,{});var i=M(r,2);G(i,e,o=>{var a=Wo(),h=C(a);ri(h,{}),A(a),$(o,a)}),A(s),$(n,s)}class Jo{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=200,this.deadZone=8,this.active=!1,this.value={x:0,y:0},this.counter=0,this.prev={x:0,y:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",s=>{this._handleDown(s)}),this.stick.addEventListener("touchstart",s=>{this._handleDown(s)}),document.addEventListener("mousemove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("touchmove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("mouseup",s=>{this._handleUp(s)}),document.addEventListener("touchend",s=>{this._handleUp(s)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.clientX,y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;let e=null;if(t.changedTouches){for(let y=0;y<t.changedTouches.length;y++)this.touchId===t.changedTouches[y].identifier&&(e=y,t.clientX=t.changedTouches[y].clientX,t.clientY=t.changedTouches[y].clientY);if(e==null)return}const s=this.stick.getBoundingClientRect(),r=s?Math.round(16e3/s.width)/100:1,i=t.clientX-this.dragStart.x,o=t.clientY-this.dragStart.y,a=Math.atan2(o,i),h=Math.min(this.maxDistance,Math.hypot(i,o)*r),f=h*Math.cos(a),c=h*Math.sin(a);this.stick.style.transform=`translate(${f}px, ${c}px)`;const l=h<this.deadZone?0:this.maxDistance/(this.maxDistance-this.deadZone)*(h-this.deadZone),u=l*Math.cos(a),p=l*Math.sin(a),d=parseFloat((u/this.maxDistance).toFixed(4)),b=parseFloat((p/this.maxDistance).toFixed(4));this.value={x:d,y:b},this._loop()}_handleUp(t){this.active&&(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier||(this.stick.style.transition=".2s",this.stick.style.transform="translate3d(0px, 0px, 0px)",this.value={x:0,y:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5+this.value.x*511.5),e=Math.round(511.5+this.value.y*511.5);this.callback(`/joystick/${t}/${e}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){(this.value.x!==this.prev.x||this.value.y!==this.prev.y)&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}class Go{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=230,this.deadZone=8,this.active=!1,this.value={f:0},this.counter=0,this.prev={f:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",s=>{this._handleDown(s)}),this.stick.addEventListener("touchstart",s=>{this._handleDown(s)}),document.addEventListener("mousemove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("touchmove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("mouseup",s=>{this._handleUp(s)}),document.addEventListener("touchend",s=>{this._handleUp(s)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{y:t.changedTouches[0].clientY}:{y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;t.preventDefault();let e=null;if(t.changedTouches){for(let h=0;h<t.changedTouches.length;h++)this.touchId===t.changedTouches[h].identifier&&(e=h,t.clientY=t.changedTouches[h].clientY);if(e==null)return}const s=this.stick.getBoundingClientRect(),r=s?Math.round(1e4/s.width)/100:1,i=t.clientY-this.dragStart.y,o=i>=0?Math.min(this.maxDistance,i*r):Math.max(-this.maxDistance,i*r);this.stick.style.transform=`translateY(${o}px)`;const a=Math.abs(o)>this.deadZone?parseFloat((o/this.maxDistance).toFixed(4)):0;this.value={f:a},this._loop()}_handleUp(t){this.active&&(t.preventDefault(),!(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier)&&(this.stick.style.transition=".2s",this.stick.style.transform="translateY(0px)",this.value={f:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5-this.value.f*511.5);this.callback(`/focus/${t}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){this.value.f!==this.prev.f&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}var Zo=ve('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-8uha02"><defs><circle id="joys-def-cir1" r="280" cy="0"></circle><circle id="joys-def-cir2" r="80" cy="0"></circle><path id="joys-def-arrow" d="M0 -120 -40 -100 40 -100z"></path><rect id="joys-def-slider" width="70" height="560" transform="translate(350 -280)" rx="15" ry="15"></rect><rect id="joys-def-slide" width="100" height="100" transform="translate(335 -50)" rx="15" ry="15"></rect></defs><g id="joys" transform="translate(320 355)" class="svelte-8uha02"><use id="joys-plate" href="#joys-def-cir1" class="svelte-8uha02"></use><use id="joys-arrow-top" href="#joys-def-arrow" class="svelte-8uha02"></use><use id="joys-arrow-right" href="#joys-def-arrow" transform="rotate(90)" class="svelte-8uha02"></use><use id="joys-arrow-left" href="#joys-def-arrow" transform="rotate(-90)" class="svelte-8uha02"></use><use id="joys-arrow-bottom" href="#joys-def-arrow" transform="rotate(180)" class="svelte-8uha02"></use><use id="joys-stick" href="#joys-def-cir2" style="transform: translate(0px, 0px)" class="svelte-8uha02"></use><use id="joys-slider" href="#joys-def-slider" class="svelte-8uha02"></use><use id="joys-slide" href="#joys-def-slide" style="transform: translateY(0px)" class="svelte-8uha02"></use><a href="#toggle" role="button" tabindex="0" aria-label="Change to adjustment tool"><g id="joys-swap" transform="translate(-250,250)" class="svelte-8uha02"><circle class="element svelte-8uha02" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M6.121 13c-.553 0-1 .448-1 1s.447 1 1 1h1.465l-3.293 3.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.414-3.414v1.707c0 .552.447 1 1 1s.879-.448.879-1v-5h-4.879zM7 11c.552 0 1-.448 1-1v-2h2c.553 0 1-.448 1-1s-.447-1-1-1h-3.999l-.001 4c0 .552.447 1 1 1zM17 13c-.553 0-1 .448-1 1v2h-2c-.553 0-1 .448-1 1s.447 1 1 1h4v-4c0-.552-.447-1-1-1zM18.293 4.293l-3.293 3.293v-1.586c0-.552-.447-1-1-1s-1 .448-1 1v5h5c.552 0 1-.448 1-1s-.447-1-1-1h-1.586l3.293-3.292c.391-.391.391-1.023 0-1.414s-1.023-.392-1.414-.001z" class="svelte-8uha02"></path></g></g></a></g></svg>');function Qo(n,t){Q(t,!0);let e=null,s=null;me(()=>{e=new Jo(document.getElementById("joys-stick"),a=>{st(a,h=>{console.log("SVELTE Joystick",h)})}),s=new Go(document.getElementById("joys-slide"),a=>{st(a,h=>{console.log("SVELTE Focus",h)})})}),ht(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy(),s&&s.hasOwnProperty("destroy")&&s.destroy()});var r=Zo(),i=M(C(r)),o=M(C(i),8);o.__click=function(...a){var h;(h=t.toggle)==null||h.apply(this,a)},A(i),A(r),$(n,r),tt()}pt(["click"]);class ta{constructor(t,e){if(this.adjust=t,this.adjust){this.callback=e;const s=8e4/360;this.axisSteps={lg:Math.round(s),md:Math.round(s/10),sm:Math.round(s/100)},this.adjust.addEventListener("mouseup",r=>{this.sendCommand(r.target.dataset)})}}destroy(){this.adjust.removeEventListener("mouseup",t=>{this.sendCommand(t.target.dataset)})}sendCommand(t){let e=t==null?void 0:t.dir,s=t==null?void 0:t.len;e&&s&&typeof this.axisSteps[s]=="number"&&(s=this.axisSteps[s],["closer","further"].indexOf(e)>=0&&(s=e==="closer"?-s:s,e="focus"),this.callback(`/adjust/${e}/${s}`))}}var ea=ve('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-1d0wo2a"><defs><path id="arr1" d="M45 45 5 45 10 95 95 95 95 10 45 5z"></path><path id="arr2" d="M105 105 11 105 17 165 165 165 165 17 105 11z"></path><path id="arr3" d="M175 175 18 175 25 245 245 245 245 25 175 18z"></path><circle id="cir1" r="44" cy="73"></circle><path id="cir2" d="M-54 73 A 75 75 0 1 0 54 73 A 54 54 0 0 1 -54 73z"></path><path id="cir3" d="M-85 125 A 108 108 0 1 0 85 125 A 54 54 0 0 1 -85 125z"></path></defs><g id="adjust" transform="translate(355 355)" class="svelte-1d0wo2a"><g transform="rotate(135)"><use href="#arr1" data-dir="left" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="left" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="left" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="rotate(-45)"><use href="#arr1" data-dir="right" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="right" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="right" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="rotate(-135)"><use href="#arr1" data-dir="up" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="up" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="up" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="rotate(45)"><use href="#arr1" data-dir="down" data-len="sm" class="svelte-1d0wo2a"></use><use href="#arr2" data-dir="down" data-len="md" class="svelte-1d0wo2a"></use><use href="#arr3" data-dir="down" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="translate(360 -50) rotate(165)"><use href="#cir1" data-dir="further" data-len="sm" class="svelte-1d0wo2a"></use><use href="#cir2" data-dir="further" data-len="md" class="svelte-1d0wo2a"></use><use href="#cir3" data-dir="further" data-len="lg" class="svelte-1d0wo2a"></use></g><g transform="translate(360 50) rotate(15)"><use href="#cir1" data-dir="closer" data-len="sm" class="svelte-1d0wo2a"></use><use href="#cir2" data-dir="closer" data-len="md" class="svelte-1d0wo2a"></use><use href="#cir3" data-dir="closer" data-len="lg" class="svelte-1d0wo2a"></use></g><a href="#toggle" role="button" tabindex="0" aria-label="Change to Joystick"><g id="joys-swap" transform="translate(-285,250)" class="svelte-1d0wo2a"><circle class="element svelte-1d0wo2a" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M17.707 8.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l1.293 1.293h-4.586v-4.586l1.293 1.293c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-3.707-3.707-3.707 3.707c-.391.391-.391 1.023 0 1.414s1.023.391 1.414 0l1.293-1.293v4.586h-4.586l1.293-1.293c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-3.707 3.707 3.707 3.707c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-1.293-1.293h4.586v4.586l-1.293-1.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l3.707 3.707 3.707-3.707c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-1.293 1.293v-4.586h4.586l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707z" class="svelte-1d0wo2a"></path></g></g></a></g></svg>');function na(n,t){Q(t,!0);let e=null;me(()=>{e=new ta(document.getElementById("adjust"),o=>{st(o,a=>{console.log("SVELTE Adjust",a)})})}),ht(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy()});var s=ea(),r=M(C(s)),i=M(C(r),6);i.__click=function(...o){var a;(a=t.toggle)==null||a.apply(this,o)},A(r),A(s),$(n,s),tt()}pt(["click"]);var sa=q('<div class="joystick-wrapper svelte-gruxg2"><!></div>');function ra(n){let t=U("mov");const e=i=>{i.preventDefault(),I(t,Z(m(t)==="mov"?"adj":"mov"))};var s=sa(),r=C(s);G(r,()=>m(t)==="mov",i=>{Qo(i,{toggle:e})},i=>{na(i,{toggle:e})}),A(s),$(n,s)}function jn(n){return typeof n=="string"?n.toLowerCase().trim().replaceAll("ä","ae").replaceAll("ö","oe").replaceAll("ü","ue").replaceAll("ß","ss").replace(/\W+/g,"_").replace(/^_|_$/g,""):null}const js={fid:"",geo:{addr:"",lat:53.6,lon:9.9},base:[{id:"home",name:"Primary target",pos:{x:-23900,y:0,f:500}},{id:"polaris",name:"Polaris",pos:{x:0,y:11912,f:600}}]};function ia(n,t){const e={...js.geo,addr:t},s=[];for(let r of js.base)s.push({...r,pos:{...r.pos}});return{fid:n,geo:e,base:s}}var oa=(n,t)=>{I(t,!1)},aa=q('<header><input type="text" id="address" placeholder="Address"></header> <div class="flexbox"><input type="text" id="latitude" placeholder="Latitude"> <input type="text" id="longitude" placeholder="Longitude"></div> <button class="button button-small">Save location</button> <button class="button">Cancel</button>',1),ca=(n,t)=>{I(t,!0)},la=q('<header> <button class="edit-button icon-edit" aria-label="Edit"></button></header>'),ua=q("<div> </div>"),ha=q("<!> <!>",1),fa=(n,t,e)=>t(n,`/navi/position/${m(e).id}`),da=(n,t,e)=>t(m(e).id),pa=q('<button class="delete-button icon-delete" aria-label="Delete" title="Delete"></button>'),va=q("<li><button> </button> <!></li>"),ma=q('<div class="nav-add"><label for="new-name">Save/update current position as ...</label> <input type="text" id="new-name" class="input" placeholder="Enter position name"> <div class="margin-bottom"><sub> </sub></div> <button class="button button-small">Save target</button></div>'),ga=q('<div class="nav-selector"><button class="button button-small">Change location</button></div>'),_a=q('<div class="content-card"><div class="nav-curr-pos"><!></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function ya(n,t){Q(t,!0);const e=Dt(),s=()=>Ot(mt,"$positions",e),r=()=>Ot(Ue,"$arduinoSettings",e);let i=U(!1),o=U(""),a=Xt(()=>jn(m(o))),h=U(""),f=U(""),c=U(""),l=U(Z([]));const u=mt.subscribe(S=>{S!=null&&S.fid&&(I(h,Z(S.geo.addr)),I(f,Z(S.geo.lat)),I(c,Z(S.geo.lon)),I(l,Z([...S.base])))});ht(()=>{u&&u()});const p=()=>{const S={...s()};Vn(`/navi/position/update/${S.fid}`,S,T=>{console.log("SVELTE saved",T)})},d=()=>{const S={addr:m(h),lat:parseFloat(m(f)),lon:parseFloat(m(c))};mt.update(T=>({...T,geo:S})),p(),I(i,!1)},b=()=>{const S=jn(m(o));if(S){let T=!1;const k=(({x:j,y:N,f:_})=>({x:j,y:N,f:_}))(r());let P=m(l).map(j=>j.id!==S?j:(T=!0,{...j,pos:k}));T||P.push({id:S,name:m(o),pos:k}),mt.update(j=>({...j,base:P})),p(),I(o,"")}I(i,!1)},y=S=>S==="home"?"icon-home":S==="polaris"?"icon-star":"icon-target",w=S=>{if(confirm(`Do you really want to delete position: "${S}"`)){const T=[...s().base].filter(k=>k.id!==S);mt.update(k=>({...k,base:T})),p(),I(i,!1)}},x=(S,T)=>{S.preventDefault(),st(T,k=>{console.log("SVELTE position",k)})};var v=_a(),g=C(v),E=C(g);G(E,()=>m(i),S=>{var T=aa(),k=vt(T),P=C(k);zt(P),A(k);var j=M(k,2),N=C(j);zt(N);var _=M(N,2);zt(_),A(j);var L=M(j,2);L.__click=d;var z=M(L,2);z.__click=[oa,i],Ut(P,()=>m(h),W=>I(h,W)),Ut(N,()=>m(f),W=>I(f,W)),Ut(_,()=>m(c),W=>I(c,W)),$(S,T)},S=>{var T=ha(),k=vt(T);G(k,()=>m(h),j=>{var N=la(),_=C(N),L=M(_);L.__click=[ca,i],A(N),nt(()=>dt(_,`${m(h)??""} `)),$(j,N)});var P=M(k,2);G(P,()=>m(f)&&m(c),j=>{var N=ua(),_=C(N);A(N),nt(()=>dt(_,`${m(f)??""}°, ${m(c)??""}°`)),$(j,N)}),$(S,T)}),A(g);var R=M(g,2),B=C(R);Mt(B,21,()=>m(l),Kt,(S,T)=>{var k=va(),P=C(k);const j=Xt(()=>`nav-button ${y(m(T).id)??""}`);P.__click=[fa,x,T];var N=C(P,!0);A(P);var _=M(P,2);G(_,()=>m(i)&&m(T).id!=="home"&&m(T).id!=="polaris",L=>{var z=pa();z.__click=[da,w,T],$(L,z)}),A(k),nt(()=>{Bt(P,m(j)),dt(N,m(T).name)}),$(S,k)}),A(B),A(R);var O=M(R,2);G(O,()=>m(i),S=>{var T=ma(),k=M(C(T),2);zt(k);var P=M(k,2),j=C(P),N=C(j);A(j),A(P);var _=M(P,2);_.__click=b,A(T),nt(()=>{dt(N,`ID: ${m(a)??""}`),_.disabled=m(a).length<3}),Ut(k,()=>m(o),L=>I(o,L)),$(S,T)},S=>{var T=ga(),k=C(T);k.__click=function(...P){var j;(j=t.toggleAdmin)==null||j.apply(this,P)},A(T),$(S,T)}),A(v),$(n,v),tt()}pt(["click"]);const xa=(n,t)=>{I(t,!m(t))};var wa=(n,t,e)=>t(m(e).fid),ba=(n,t,e)=>t(m(e).fid),Ea=q('<button class="delete-button icon-delete" aria-label="Delete"></button>'),ka=q('<li><button class="nav-button icon-location"> </button> <!></li>'),Sa=(n,t)=>t(),Ta=q('<div class="nav-add"><input type="text" id="new-location" class="input" placeholder="Enter new location name"> <button class="button">+&nbsp;Add</button></div> <div> </div>',1),Aa=q('<div class="nav-selector"><button class="button button-small">&laquo;&nbsp;Back</button></div>'),Ca=q('<div class="content-card"><header>Locations <button aria-label="Edit"></button></header> <div class="nav-curr-pos"><div><p>The location is the place where your telescope is placed.</p></div></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function Ra(n,t){Q(t,!0);const e=Dt(),s=()=>Ot(_e,"$locations",e);let r=U("");const i=mt.subscribe(x=>{I(r,Z(x.fid))});ht(()=>{i&&i()});let o=U(!1),a=U(""),h=Xt(()=>jn(m(a)));const f=x=>{x!==m(r)&&st(`/navi/location/${x}`,v=>{(v==null?void 0:v.fid)===x&&(mt.update(g=>({...v})),console.log("Loaded location"))})},c=()=>{if(m(h).length>=3){const x=ia(m(h),m(a));Vn(`/navi/position/update/${m(h)}`,x,v=>{mt.update(g=>x),_e.update(g=>[...g,{fid:m(h),addr:m(a)}]),I(a,""),console.log("Added new location",v)})}else console.error("ID is too short. At least 3 char are required.")},l=x=>{confirm(`Do you really want to delete location: "${x}"`)?st(`/navi/location/delete/${x}`,v=>{v.response===200&&(_e.update(g=>g.filter(E=>E.fid!==x)),alert(`Location "${x}" deleted`))}):alert(`Deletion of "${x}" canceled.`)};me(()=>{s().length===0&&st("/navi/location-list",x=>{_e.update(v=>[...x]),console.log("Loaded location list")})});var u=Ca(),p=C(u),d=M(C(p));d.__click=[xa,o],A(p);var b=M(p,4),y=C(b);Mt(y,5,s,Kt,(x,v)=>{var g=ka(),E=C(g);E.__click=[wa,f,v];var R=C(E,!0);A(E);var B=M(E,2);G(B,()=>m(o)&&m(v).fid!==m(r)&&m(v).fid!=="index",O=>{var S=Ea();S.__click=[ba,l,v],$(O,S)}),A(g),nt(()=>{Bt(g,m(v).fid===m(r)?"active":""),dt(R,m(v).addr)}),$(x,g)}),A(y),A(b);var w=M(b,2);G(w,()=>m(o),x=>{var v=Ta(),g=vt(v),E=C(g);zt(E);var R=M(E,2);R.__click=[Sa,c],A(g);var B=M(g,2),O=C(B,!0);A(B),nt(()=>dt(O,m(h))),Ut(E,()=>m(a),S=>I(a,S)),$(x,v)},x=>{var v=Aa(),g=C(v);g.__click=function(...E){var R;(R=t.toggleAdmin)==null||R.apply(this,E)},A(v),$(x,v)}),A(u),nt(()=>Bt(d,`edit-button icon-edit${(m(o)?" active":"")??""}`)),$(n,u),tt()}pt(["click"]);function Oa(n,t){Q(t,!0);const e=Dt(),s=()=>Ot(mt,"$positions",e);let r=U(!1);const i=()=>{I(r,!m(r))};me(()=>{var h;(h=s())!=null&&h.fid||st("/navi/location/index",f=>{(f==null?void 0:f.fid)==="index"&&mt.update(c=>({...f}))})});var o=Lt(),a=vt(o);G(a,()=>m(r),h=>{Ra(h,{toggleAdmin:i})},h=>{ya(h,{toggleAdmin:i})}),$(n,o),tt()}var Na=(n,t,e)=>{t.callback(t.id,e())},ja=q('<div class="slider-wrapper svelte-1eb8x9l"><label class="svelte-1eb8x9l"> </label> <input type="range" class="svelte-1eb8x9l"></div>');function wr(n,t){Q(t,!0);let e=qt(t,"value",7,0),s=qt(t,"minValue",3,0),r=qt(t,"maxValue",3,10),i=qt(t,"steps",3,1);var o=ja(),a=C(o),h=C(a,!0);A(a);var f=M(a,2);zt(f),f.__change=[Na,t,e],A(o),nt(()=>{K(a,"for","slider_slide_"+t.id),dt(h,t.name),K(f,"id","slider_slide_"+t.id),K(f,"min",s()),K(f,"max",r()),K(f,"step",i())}),Ut(f,e),$(n,o),tt()}pt(["change"]);var La=q('<div class="camera-options svelte-1icpkjb"><!> <div class="actions-wrapper svelte-1icpkjb"><button class="svelte-1icpkjb">Reset defaults</button></div></div>');function Ma(n,t){Q(t,!1);const e=Dt(),s=()=>Ot(Qe,"$camControls",e),r=(c,l)=>{Qe.update(u=>u.map(p=>p.id===c?{...p,value:l}:{...p})),st(`/cam/ctrl/${c}/${l}`,u=>{console.log("SVELTE CamCtrl",u)})},i=()=>{Qe.update(l=>l.map(u=>({...u,value:u.defaultValue})));const c={};for(let l of s())l!=null&&l.id&&(c[l.id]=l.defaultValue);Vn("/cam/controls",c,l=>{console.log("SVELTE Cam Controls",l)})};Is();var o=La(),a=C(o);Mt(a,3,s,c=>c.name,(c,l,u)=>{wr(c,$s(()=>m(l),{get index(){return m(u)},callback:r}))});var h=M(a,2),f=C(h);f.__click=i,A(h),A(o),$(n,o),tt()}pt(["click"]);const Ba=()=>{je.update(n=>!n)};var Pa=ve('<polygon points="-15,-15 -15,15 15,15 15,-15" stroke-width="5" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),$a=ve('<polygon points="-7.5,-22.5 -7.5,22.5 20,0" stroke-width="10" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),Ia=q('<div id="video-recording" class="svelte-1utn7qk"><button aria-label="Record video" class="svelte-1utn7qk"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" preserveAspectRatio="xMinYMin slice" class="svelte-1utn7qk"><g transform="translate(42,42)"><circle r="38" fill="none" stroke="#FFF" stroke-width="5"></circle><!></g></svg></button></div>');function Da(n,t){Q(t,!0);let e=U(!1);const s=je.subscribe(f=>{if(m(e)!==f){I(e,Z(f));const c=m(e)?"start":"stop";st(`/cam/video-rec/vid/${c}`,l=>{console.log("Video recording",l)})}});ht(()=>{s&&s()});var r=Ia(),i=C(r);i.__click=[Ba];var o=C(i),a=C(o),h=M(C(a));G(h,()=>m(e),f=>{var c=Pa();$(f,c)},f=>{var c=$a();$(f,c)}),A(a),A(o),A(i),A(r),$(n,r),tt()}pt(["click"]);var Fa=q('<div class="sphere-config svelte-7nx3dy"></div>');function Va(n,t){Q(t,!0);let e=U(Z([]));const s=Le.subscribe(o=>{I(e,Z(o.map(a=>({...a}))))}),r=(o,a)=>{Le.update(h=>h.map(f=>f.id===o?{...f,value:a}:{...f}))};ht(()=>{s&&s()});var i=Fa();Mt(i,21,()=>m(e),Kt,(o,a,h)=>{wr(o,$s(()=>m(a),{index:h,callback:r}))}),A(i),$(n,i),tt()}const qa=(n,t)=>{const e=t()==="B"?"cam_b":"cam_a";st(`/cam/capture-img/image/${e}`,s=>{console.log("Capture image",s)})},za=(n,t,e,s)=>{const r=t()==="B"?"cam_b":"cam_a";st(`/cam/snail-shot/${m(e)}/${m(s)}/${r}`,i=>{console.log("Snails",i,r)})};var Ua=(n,t)=>console.log("X:",m(t)),Ya=q("<option></option>"),Ha=(n,t)=>console.log("Y:",m(t)),Wa=q("<option></option>"),Xa=q('<div id="image-capture" class="svelte-15orivu"><button aria-label="Capture image" class="svelte-15orivu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-15orivu"><g transform="translate(42,42)"><circle r="28" fill="#C00" stroke="#C00"></circle><circle r="38" fill="none" stroke="#FFF" stroke-width="5"></circle></g></svg></button> <button aria-label="Snail shot" class="svelte-15orivu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-15orivu"><g transform="translate(42,42)"><polyline points="0,0 20,0 20,15 -20,15 -20,-15 40,-15 40,30 -20,30 -12,28 -12,32 -20,30" style="fill:none;stroke:#FFF;stroke-width:3;stroke-linejoin:round;"></polyline></g></svg></button> <div class="dimensions svelte-15orivu"><label class="svelte-15orivu"><span class="svelte-15orivu">hor</span><select class="svelte-15orivu"></select></label> <label class="svelte-15orivu"><span class="svelte-15orivu">ver</span><select class="svelte-15orivu"></select></label></div></div>');function Ka(n,t){Q(t,!0);const e=Dt(),s=()=>Ot(Ae,"$swapPreview",e);let r=U(3),i=U(3);var o=Xa(),a=C(o);a.__click=[qa,s];var h=M(a,2);h.__click=[za,s,r,i];var f=M(h,2),c=C(f),l=M(C(c));l.__change=[Ua,r],Mt(l,20,()=>Array.from({length:7}),Kt,(d,b,y)=>{var w=Ya();w.value=(w.__value=y+3)==null?"":y+3,w.textContent=y+3,$(d,w)}),A(l),A(c);var u=M(c,2),p=M(C(u));p.__change=[Ha,i],Mt(p,20,()=>Array.from({length:7}),Kt,(d,b,y)=>{var w=Wa();w.value=(w.__value=y+3)==null?"":y+3,w.textContent=y+3,$(d,w)}),A(p),A(u),A(f),A(o),ss(l,()=>m(r),d=>I(r,d)),ss(p,()=>m(i),d=>I(i,d)),$(n,o),tt()}pt(["click","change"]);var Ja=q('<div class="tools svelte-1isvhs1"><!></div>');function Ga(n,t){Q(t,!0);let e=U("");const s=ln.subscribe(o=>{I(e,Z(o))});ht(()=>{s&&s()});var r=Ja(),i=C(r);G(i,()=>m(e)==="target",o=>{ra(o)},o=>{var a=Lt(),h=vt(a);G(h,()=>m(e)==="sphere",f=>{Va(f,{})},f=>{var c=Lt(),l=vt(c);G(l,()=>m(e)==="location",u=>{Oa(u,{})},u=>{var p=Lt(),d=vt(p);G(d,()=>m(e)==="adjust",b=>{Ma(b,{})},b=>{var y=Lt(),w=vt(y);G(w,()=>m(e)==="video",x=>{Da(x,{})},x=>{var v=Lt(),g=vt(v);G(g,()=>m(e)==="picture",E=>{Ka(E,{})},null,!0),$(x,v)},!0),$(b,y)},!0),$(u,p)},!0),$(f,c)},!0),$(o,a)}),A(r),$(n,r),tt()}var Za=q('<li><button><span class="svelte-wkzjji"> </span></button></li>'),Qa=q('<div id="options-menu" class="svelte-wkzjji"><ul class="svelte-wkzjji"></ul></div>');function tc(n,t){Q(t,!0);let e=U("");const s=ln.subscribe(c=>{I(e,Z(c))});let r=U(!1);const i=un.subscribe(c=>{I(r,Z(c))}),o=c=>{ln.update(l=>l===c?"":c)};ht(()=>{s&&s(),i&&i()});const a=[{id:"sphere",name:"Sphere",icon:"icon-settings",callback:()=>{o("sphere")},enabled:()=>m(e)==="sphere"},{id:"compass",name:"Compass",icon:"icon-compass",callback:()=>{un.update(c=>!c)},enabled:()=>m(r)},{id:"location",name:"Location",icon:"icon-location",callback:()=>{o("location")},enabled:()=>m(e)==="location"},{id:"target",name:"Target",icon:"icon-target",callback:()=>{o("target")},enabled:()=>m(e)==="target"},{id:"adjust",name:"Contrast",icon:"icon-adjust",callback:()=>{o("adjust")},enabled:()=>m(e)==="adjust"},{id:"video",name:"Video",icon:"icon-video",callback:()=>{o("video")},enabled:()=>m(e)==="video"},{id:"picture",name:"Picture",icon:"icon-image",callback:()=>{o("picture")},enabled:()=>m(e)==="picture"}];var h=Qa(),f=C(h);Mt(f,21,()=>a,Kt,(c,l)=>{var u=Za();const p=Xt(()=>`${(m(l).enabled()?"active":"")??""} svelte-wkzjji`);var d=C(u);d.__click=function(...w){var x;(x=m(l).callback)==null||x.apply(this,w)};var b=C(d),y=C(b,!0);A(b),A(d),A(u),nt(()=>{Bt(u,m(p)),Bt(d,`${m(l).icon??""} svelte-wkzjji`),dt(y,m(l).name)}),$(c,u)}),A(f),A(h),$(n,h),tt()}pt(["click"]);var ec=q('<div class="video-recorder svelte-tf4uvu"><button aria-label="Stop video recording" class="svelte-tf4uvu"><span class="icon-stop"></span> <span class="time"> </span></button></div>');function nc(n,t){Q(t,!0);const e={elapsedTime:0};let s=U("00:00:00");function r(l,u,p){const d=[l,u,p].map(b=>b<10?`0${b}`:b);I(s,Z(d.join(":")))}function i(){e.startTime=Date.now(),e.intervalId=setInterval(()=>{const l=Date.now()-e.startTime+e.elapsedTime,u=parseInt(l/1e3%60,10),p=parseInt(l/(1e3*60)%60,10),d=parseInt(l/(1e3*60*60)%24,10);r(d,p,u)},1e3)}function o(){e.intervalId&&(clearInterval(e.intervalId),je.update(()=>!1),I(s,"00:00:00"))}let a=U(!1);const h=je.subscribe(l=>{l!==m(a)&&(l?i():o(),I(a,Z(l)))});ht(()=>{h&&h()});var f=Lt(),c=vt(f);G(c,()=>m(a),l=>{var u=ec(),p=C(u);p.__click=o;var d=M(C(p),2),b=C(d,!0);A(d),A(p),A(u),nt(()=>dt(b,m(s))),$(l,u)}),$(n,f),tt()}pt(["click"]);var sc=q('<div class="tasks svelte-1i0wqs5"><!></div>');function rc(n){var t=sc(),e=C(t);nc(e,{}),A(t),$(n,t)}var ic=q('<div class="container svelte-dzpa42"><!> <!> <div class="controls svelte-dzpa42"><!></div> <!></div>');function vc(n){var t=ic(),e=C(t);rc(e);var s=M(e,2);Ko(s);var r=M(s,2),i=C(r);Ga(i,{}),A(r);var o=M(r,2);tc(o,{}),A(t),$(n,t)}export{vc as component};
