import{a as y,t as D,c as rt,n as st}from"../chunks/disclose-version.hMHIZg6P.js";import{x as Ke,h as Xe,k as K,B as Mt,C as Je,M as Ge,ai as Ce,P as Qe,Q as ue,R as It,l as gt,ar as Rt,N as Se,i as Le,O as Ze,an as ts,z as fe,as as te,at as de,au as ee,av as es,a4 as ss,G as pe,aw as rs,ah as ns,ax as is,j as os,ay as Re,y as as,ae as ls,a9 as cs,az as hs,ac as us,aA as fs,aB as ds,L as me,aC as ps,aD as ms,am as vs,p as ot,I as O,g as c,t as W,o as at,aE as yt,q as p,w as b,v as d,aq as H,m as Y,aF as lt,f as se}from"../chunks/runtime.CRRexT0-.js";import{a as G,d as ut,s as zt,b as bt}from"../chunks/store.B7Og_QSg.js";import{b as Et,o as Tt,i as P,a as nt,p as xt,s as gs}from"../chunks/index-client.DViTJR_y.js";import{i as At}from"../chunks/lifecycle.CZQhGp_M.js";import{w as Bt}from"../chunks/index.CkCIRN9G.js";let qt=null;function re(r,t){return t}function _s(r,t,e,s){for(var n=[],i=t.length,o=0;o<i;o++)rs(t[o].e,n,!0);var l=i>0&&n.length===0&&e!==null;if(l){var a=e.parentNode;ns(a),a.append(e),s.clear(),ct(r,t[0].prev,t[i-1].next)}is(n,()=>{for(var h=0;h<i;h++){var u=t[h];l||(s.delete(u.k),ct(r,u.prev,u.next)),os(u.e,!l)}})}function Ft(r,t,e,s,n,i=null){var o=r,l={flags:t,items:new Map,first:null},a=(t&Re)!==0;if(a){var h=r;o=K?Mt(as(h)):h.appendChild(Ke())}K&&Je();var u=null,v=!1;Xe(()=>{var f=e(),k=Ge(f)?f:f==null?[]:Ce(f),m=k.length;if(v&&m===0)return;v=m===0;let z=!1;if(K){var A=o.data===Qe;A!==(m===0)&&(o=ue(),Mt(o),It(!1),z=!0)}if(K){for(var B=null,F,S=0;S<m;S++){if(gt.nodeType===8&&gt.data===ls){o=gt,z=!0,It(!1);break}var x=k[S],g=s(x,S);F=Oe(gt,l,B,null,x,g,S,n,t),l.items.set(g,F),B=F}m>0&&Mt(ue())}if(!K){var T=cs;ys(k,l,o,n,t,(T.f&Rt)!==0,s)}i!==null&&(m===0?u?Se(u):u=Le(()=>i(o)):u!==null&&Ze(u,()=>{u=null})),z&&It(!0),e()}),K&&(o=gt)}function ys(r,t,e,s,n,i,o){var N,j,I,V;var l=(n&hs)!==0,a=(n&(te|ee))!==0,h=r.length,u=t.items,v=t.first,f=v,k,m=null,z,A=[],B=[],F,S,x,g;if(l)for(g=0;g<h;g+=1)F=r[g],S=o(F,g),x=u.get(S),x!==void 0&&((N=x.a)==null||N.measure(),(z??(z=new Set)).add(x));for(g=0;g<h;g+=1){if(F=r[g],S=o(F,g),x=u.get(S),x===void 0){var T=f?f.e.nodes_start:e;m=Oe(T,t,m,m===null?t.first:m.next,F,S,g,s,n),u.set(S,m),A=[],B=[],f=m.next;continue}if(a&&xs(x,F,g,n),x.e.f&Rt&&(Se(x.e),l&&((j=x.a)==null||j.unfix(),(z??(z=new Set)).delete(x))),x!==f){if(k!==void 0&&k.has(x)){if(A.length<B.length){var C=B[0],R;m=C.prev;var q=A[0],Q=A[A.length-1];for(R=0;R<A.length;R+=1)ve(A[R],C,e);for(R=0;R<B.length;R+=1)k.delete(B[R]);ct(t,q.prev,Q.next),ct(t,m,q),ct(t,Q,C),f=C,m=Q,g-=1,A=[],B=[]}else k.delete(x),ve(x,f,e),ct(t,x.prev,x.next),ct(t,x,m===null?t.first:m.next),ct(t,m,x),m=x;continue}for(A=[],B=[];f!==null&&f.k!==S;)(i||!(f.e.f&Rt))&&(k??(k=new Set)).add(f),B.push(f),f=f.next;if(f===null)continue;x=f}A.push(x),m=x,f=x.next}if(f!==null||k!==void 0){for(var _=k===void 0?[]:Ce(k);f!==null;)(i||!(f.e.f&Rt))&&_.push(f),f=f.next;var w=_.length;if(w>0){var L=n&Re&&h===0?e:null;if(l){for(g=0;g<w;g+=1)(I=_[g].a)==null||I.measure();for(g=0;g<w;g+=1)(V=_[g].a)==null||V.fix()}_s(t,_,L,u)}}l&&ts(()=>{var $;if(z!==void 0)for(x of z)($=x.a)==null||$.apply()}),fe.first=t.first&&t.first.e,fe.last=m&&m.e}function xs(r,t,e,s){s&te&&de(r.v,t),s&ee?de(r.i,e):r.i=e}function Oe(r,t,e,s,n,i,o,l,a){var h=qt;try{var u=(a&te)!==0,v=(a&es)===0,f=u?v?ss(n):pe(n):n,k=a&ee?pe(o):o,m={i:k,v:f,k:i,a:null,e:null,prev:e,next:s};return qt=m,m.e=Le(()=>l(r,f,k),K),m.e.prev=e&&e.e,m.e.next=s&&s.e,e===null?t.first=m:(e.next=m,e.e.next=m.e),s!==null&&(s.prev=m,s.e.prev=m.e),m}finally{qt=h}}function ve(r,t,e){for(var s=r.next?r.next.e.nodes_start:e,n=t?t.e.nodes_start:e,i=r.e.nodes_start;i!==s;){var o=us(i);n.before(i),i=o}}function ct(r,t,e){t===null?r.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}let ge=!1;function je(){ge||(ge=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var t;if(!r.defaultPrevented)for(const e of r.target.elements)(t=e.__on_r)==null||t.call(e)})},{capture:!0}))}function dt(r){if(K){var t=!1,e=()=>{if(!t){if(t=!0,r.hasAttribute("value")){var s=r.value;U(r,"value",null),r.value=s}if(r.hasAttribute("checked")){var n=r.checked;U(r,"checked",null),r.checked=n}}};r.__on_r=e,fs(e),je()}}function U(r,t,e,s){var n=r.__attributes??(r.__attributes={});K&&(n[t]=r.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&r.nodeName==="LINK")||n[t]!==(n[t]=e)&&(t==="style"&&"__styles"in r&&(r.__styles={}),t==="loading"&&(r[ds]=e),e==null?r.removeAttribute(t):typeof e!="string"&&ws(r).includes(t)?r[t]=e:r.setAttribute(t,e))}var _e=new Map;function ws(r){var t=_e.get(r.nodeName);if(t)return t;_e.set(r.nodeName,t=[]);for(var e,s=me(r),n=Element.prototype;n!==s;){e=ps(s);for(var i in e)e[i].set&&t.push(i);s=me(s)}return t}function Yt(r,t){var e=r.__className,s=ks(t);K&&r.className===s?r.__className=s:(e!==s||K&&r.className!==s)&&(t==null?r.removeAttribute("class"):r.className=s,r.__className=s)}function ks(r){return r??""}function bs(r,t,e,s=e){r.addEventListener(t,e);const n=r.__on_r;n?r.__on_r=()=>{n(),s()}:r.__on_r=s,je()}function pt(r,t,e=t){var s=ms();bs(r,"input",()=>{var n=ye(r)?xe(r.value):r.value;e(n),s&&n!==(n=t())&&(r.value=n??"")}),vs(()=>{var n=t();if(K&&r.defaultValue!==r.value){e(r.value);return}ye(r)&&n===xe(r.value)||r.type==="date"&&!n&&!r.value||n!==r.value&&(r.value=n??"")})}function ye(r){var t=r.type;return t==="number"||t==="range"}function xe(r){return r===""?null:+r}const ne=Bt({x:0,y:0,f:0,deg_x:0,deg_y:0,dx:1,dy:-1,df:1,acc:1e3,spr:8e4,mpa:2e4,minpx:-2e4,maxpx:2e4,mpf:5e3,vx:0,vy:0,va1:100,va2:1500,vf:0,vf1:100,vf2:1500}),Vt=Bt([{id:"Brightness",name:"Brightness",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.01},{id:"Contrast",name:"Contrast",defaultValue:1,value:1,minValue:0,maxValue:6,steps:.1},{id:"Saturation",name:"Saturation",defaultValue:1,value:1,minValue:0,maxValue:32,steps:.1},{id:"Sharpness",name:"Sharpness",defaultValue:1,value:1,minValue:0,maxValue:16,steps:.1},{id:"ExposureTime",name:"Exposure time (exp. 0.3ms-3.3s)",description:"Value > 0 will reduce video framerate.",defaultValue:0,value:0,minValue:-10,maxValue:10,steps:.1},{id:"AnalogueGain",name:"Analogue gain",defaultValue:1,value:1,minValue:1,maxValue:8,steps:.1}]),Ct=Bt([]),Z=Bt({});var Es=D('<div id="horizon-wrapper" class="svelte-19kj2zw"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 300"><defs><g id="sphere"><ellipse rx="100" ry="400" fill="none" stroke="#FFF4"></ellipse><ellipse rx="200" ry="400" fill="none" stroke="#FFF4"></ellipse><ellipse rx="300" ry="400" fill="none" stroke="#FFF4"></ellipse><ellipse rx="400" ry="400" fill="none" stroke="#FFF4"></ellipse><ellipse rx="550" ry="400" fill="none" stroke="#FFF4"></ellipse><ellipse rx="800" ry="400" fill="none" stroke="#FFF4"></ellipse></g><linearGradient id="floor" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#4f3922"></stop><stop offset="15%" stop-color="#785633"></stop></linearGradient></defs><defs><g id="horizon"><g transform="translate(-150,-450)"><rect width="600" height="800" y="-200" fill="#2874b2"></rect><use href="#sphere" transform="translate(300, 600)"></use><use href="#sphere" transform="translate(300, -200)"></use><g transform="translate(300, 200)"><ellipse rx="200" ry="80" fill="#2874b2" stroke="#FFF4"></ellipse><ellipse rx="400" ry=".1" fill="none" stroke="#FFF4"></ellipse><ellipse rx="400" ry="160" fill="none" stroke="#FFF4"></ellipse><ellipse rx="800" ry="240" fill="none" stroke="#FFF4"></ellipse><ellipse rx="1600" ry="320" fill="none" stroke="#FFF4"></ellipse><path d="M0,-200 0,800" fill="none" stroke="#FFF4"></path><circle r="20" fill="#2874b2" stroke="#FFF4"></circle></g><rect width="600" height="800" y="600" fill="url(#floor)"></rect><g transform="translate(300, 1000)"><circle r="10" fill="#A00" stroke="#FFF"></circle><text font-size="8" fill="#FFF" text-anchor="middle" transform="translate(0 3)">You</text></g></g></g></defs><defs><polygon id="focusArrow" points="0,400 180,65 100,65 200,35 300,65 220,65 400,400"></polygon><linearGradient id="focusArrowGradClip" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#005"></stop><stop offset="50%" stop-color="#039" stop-opacity=".8"></stop><stop offset="100%" stop-color="#07f" stop-opacity=".4"></stop></linearGradient></defs><clipPath id="arrowStripesClip"><polygon points="200,0 -390,400 -370,400 200,0 -350,400 -330,400 200,0 -310,400 -290,400 200,0 -270,400 -250,400 200,0 -230,400 -210,400 200,0 -190,400 -170,400 200,0 -150,400 -130,400 200,0 -110,400 -90,400 200,0 -70,400 -50,400 200,0 -30,400 -10,400 200,0 10,400 30,400 200,0 50,400 70,400 200,0 90,400 110,400 200,0 130,400 150,400 200,0 170,400 190,400 200,0 210,400 230,400 200,0 250,400 270,400 200,0 290,400 310,400 200,0 330,400 350,400 200,0 370,400 390,400 200,0 410,400 430,400 200,0 450,400 470,400 200,0 490,400 510,400 200,0 530,400 550,400 200,0 570,400 590,400 200,0 610,400 630,400 200,0 650,400 670,400 200,0 690,400 710,400 200,0 730,400 750,400 200,0 770,400 790,400"></polygon></clipPath><clipPath id="focusRangeMeterClip"><rect id="focus-range-meter" width="400" height="400" class="svelte-19kj2zw"></rect></clipPath><use id="azimuth-sphere" href="#horizon" class="svelte-19kj2zw"></use><g transform="translate(75 150) scale(0.375)"><use clip-path="url(#focusRangeMeterClip)" href="#focusArrow" fill="url(#focusArrowGradClip)"></use><use clip-path="url(#arrowStripesClip)" href="#focusArrow" fill="rgba(255,255,255,.5)"></use></g><g transform="translate(150 150)"><g id="altitude-visual" class="svelte-19kj2zw"><circle r="1" fill="#FFF"></circle><path d="M-70 0 -10 0 A 10 10 0 0 0 10 0 " fill="none" stroke-width="1.2" stroke="#FFF"></path><text id="altitude-text" text-anchor="middle" transform="translate(-45 -5)" fill="#FFF" font-size="15"> </text></g></g><g transform="translate(150 150)"><path d="M-10 0 A 10 10 0 0 0 10 0 L 70 0" fill="none" stroke-width="1.22" stroke="#FFF"></path><path d="M -4,-87 0,-100 4,-87z" fill="#FFF"></path><text id="azimuth-text" transform="translate(0 -70)" text-anchor="middle" fill="#FFF" font-size="15"> </text></g><g transform="translate(150 -390)"><g id="compass" class="svelte-19kj2zw"><circle r="400" class="grade svelte-19kj2zw" stroke-dasharray="1 5.98131701" stroke-width="20"></circle><circle r="400" class="grade svelte-19kj2zw" stroke-dasharray="1 33.90658504" stroke-width="30"></circle><circle r="400" class="grade svelte-19kj2zw" stroke-dasharray="1 103.71975512" stroke-width="40"></circle><circle r="400" fill="none" stroke-dasharray="1 156.07963268" stroke="#F00" stroke-width="40"></circle><text class="cmp-text svelte-19kj2zw" transform="rotate(0) translate(0 432)">N</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-15) translate(0 432)">15</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-30) translate(0 432)">30</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-45) translate(0 432)">45</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-60) translate(0 432)">60</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-75) translate(0 432)">75</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-90) translate(0 432)">E</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-105) translate(0 432)">105</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-120) translate(0 432)">120</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-135) translate(0 432)">135</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-150) translate(0 432)">150</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-165) translate(0 432)">165</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-180) translate(0 432)">S</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-195) translate(0 432)">195</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-210) translate(0 432)">210</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-225) translate(0 432)">225</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-240) translate(0 432)">240</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-255) translate(0 432)">255</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-270) translate(0 432)">W</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-285) translate(0 432)">285</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-300) translate(0 432)">300</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-315) translate(0 432)">315</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-330) translate(0 432)">330</text><text class="cmp-text svelte-19kj2zw" transform="rotate(-345) translate(0 432)">345</text><text class="cmp-text-sm left svelte-19kj2zw" transform="rotate(0) translate(0 422)">0</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-5) translate(0 422)">5</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-10) translate(0 422)">10</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-20) translate(0 422)">20</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-25) translate(0 422)">25</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-22.5) translate(0 422)">NNE</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-35) translate(0 422)">35</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-40) translate(0 422)">40</text><text class="cmp-text-sm left svelte-19kj2zw" transform="rotate(-45) translate(0 422)">NE</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-50) translate(0 422)">50</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-55) translate(0 422)">55</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-65) translate(0 422)">65</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-70) translate(0 422)">70</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-67.5) translate(0 422)">NEE</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-80) translate(0 422)">80</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-85) translate(0 422)">85</text><text class="cmp-text-sm left svelte-19kj2zw" transform="rotate(-90) translate(0 422)">90</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-95) translate(0 422)">95</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-95) translate(0 422)">95</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-100) translate(0 422)">100</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-110) translate(0 422)">110</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-112.5) translate(0 422)">SEE</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-115) translate(0 422)">115</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-125) translate(0 422)">125</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-130) translate(0 422)">130</text><text class="cmp-text-sm left svelte-19kj2zw" transform="rotate(-135) translate(0 422)">SE</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-140) translate(0 422)">140</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-145) translate(0 422)">145</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-155) translate(0 422)">155</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-157.5) translate(0 422)">SSE</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-160) translate(0 422)">160</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-170) translate(0 422)">170</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-175) translate(0 422)">175</text><text class="cmp-text-sm left svelte-19kj2zw" transform="rotate(-180) translate(0 422)">180</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-185) translate(0 422)">185</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-190) translate(0 422)">190</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-200) translate(0 422)">200</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-202.5) translate(0 422)">SSW</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-205) translate(0 422)">205</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-215) translate(0 422)">215</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-220) translate(0 422)">220</text><text class="cmp-text-sm left svelte-19kj2zw" transform="rotate(-225) translate(0 422)">SW</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-230) translate(0 422)">230</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-235) translate(0 422)">235</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-245) translate(0 422)">245</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-247.5) translate(0 422)">SWW</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-250) translate(0 422)">250</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-260) translate(0 422)">260</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-265) translate(0 422)">265</text><text class="cmp-text-sm left svelte-19kj2zw" transform="rotate(-270) translate(0 422)">270</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-275) translate(0 422)">275</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-280) translate(0 422)">280</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-290) translate(0 422)">290</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-292.5) translate(0 422)">NWW</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-295) translate(0 422)">295</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-305) translate(0 422)">305</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-310) translate(0 422)">310</text><text class="cmp-text-sm left svelte-19kj2zw" transform="rotate(-315) translate(0 422)">NW</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-320) translate(0 422)">320</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-325) translate(0 422)">325</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-335) translate(0 422)">335</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-340) translate(0 422)">340</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-350) translate(0 422)">350</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-355) translate(0 422)">355</text><text class="cmp-text-sm svelte-19kj2zw" transform="rotate(-337.5) translate(0 422)">NNW</text></g></g></svg></div>');function Ts(r,t){ot(t,!1);let e=yt(),s=yt(),n=yt(),i=yt();const o=ne.subscribe(g=>{const T=g.f+g.mpf,R=(g.mpf-g.mpf/Math.pow(1.5/g.mpf*T+1,2))/g.mpf;O(e,(1-R)*133),O(s,g.deg_x),O(n,g.deg_y),O(i,c(n)/90*400)});Et(()=>{o&&o()}),At();var l=Es(),a=p(l),h=b(p(a),4),u=p(h);d(h);var v=b(h),f=b(v,2),k=p(f),m=b(p(k),2),z=p(m);d(m),d(k),d(f);var A=b(f),B=b(p(A),2),F=p(B);d(B),d(A);var S=b(A),x=p(S);d(S),d(a),d(l),W(()=>{U(u,"style",`y:${c(e)??""}%`),U(v,"style",`transform: translate(0, ${c(i)??""}px)`),U(k,"style",`transform: rotate(${c(n)??""}deg)`),G(z,`∠ ${c(n)??""}°`),G(F,`${c(s)??""}°`),U(x,"transform",`rotate(${c(s)??""})`)}),y(r,l),at()}var As=D('<div id="camera-stream" class="svelte-nq3iur"><img id="telescope-stream" alt="Telescope stream" width="640" height="480" class="svelte-nq3iur"></div>');function Cs(r,t){ot(t,!1);let e=yt("starfield.jpg");Tt(()=>{O(e,"http://192.168.178.33:7777/stream.mjpg")}),At();var s=As(),n=p(s);d(s),W(()=>U(n,"src",c(e))),y(r,s),at()}const Ss=(r,t)=>{r.preventDefault(),O(t,nt(c(t)==="horizon"?"cam1":"horizon"))};var Ls=D('<div class="uk-card visuals svelte-dynqld"><a href="/"><!></a></div>');function Rs(r){let t=H("horizon");var e=Ls(),s=p(e);s.__click=[Ss,t];var n=p(s);P(n,()=>c(t)==="horizon",i=>{Ts(i,{})},i=>{var o=rt(),l=Y(o);P(l,()=>c(t)==="cam1",a=>{Cs(a,{})},null,!0),y(i,o)}),d(s),d(e),y(r,e)}ut(["click"]);const et=Object.create(null);et.open="0";et.close="1";et.ping="2";et.pong="3";et.message="4";et.upgrade="5";et.noop="6";const Ot=Object.create(null);Object.keys(et).forEach(r=>{Ot[et[r]]=r});const Wt={type:"error",data:"parser error"},Ne=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",ze=typeof ArrayBuffer=="function",Be=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,ie=({type:r,data:t},e,s)=>Ne&&t instanceof Blob?e?s(t):we(t,s):ze&&(t instanceof ArrayBuffer||Be(t))?e?s(t):we(new Blob([t]),s):s(et[r]+(t||"")),we=(r,t)=>{const e=new FileReader;return e.onload=function(){const s=e.result.split(",")[1];t("b"+(s||""))},e.readAsDataURL(r)};function ke(r){return r instanceof Uint8Array?r:r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}let $t;function Os(r,t){if(Ne&&r.data instanceof Blob)return r.data.arrayBuffer().then(ke).then(t);if(ze&&(r.data instanceof ArrayBuffer||Be(r.data)))return t(ke(r.data));ie(r,!1,e=>{$t||($t=new TextEncoder),t($t.encode(e))})}const be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",wt=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let r=0;r<be.length;r++)wt[be.charCodeAt(r)]=r;const js=r=>{let t=r.length*.75,e=r.length,s,n=0,i,o,l,a;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);const h=new ArrayBuffer(t),u=new Uint8Array(h);for(s=0;s<e;s+=4)i=wt[r.charCodeAt(s)],o=wt[r.charCodeAt(s+1)],l=wt[r.charCodeAt(s+2)],a=wt[r.charCodeAt(s+3)],u[n++]=i<<2|o>>4,u[n++]=(o&15)<<4|l>>2,u[n++]=(l&3)<<6|a&63;return h},Ns=typeof ArrayBuffer=="function",oe=(r,t)=>{if(typeof r!="string")return{type:"message",data:Fe(r,t)};const e=r.charAt(0);return e==="b"?{type:"message",data:zs(r.substring(1),t)}:Ot[e]?r.length>1?{type:Ot[e],data:r.substring(1)}:{type:Ot[e]}:Wt},zs=(r,t)=>{if(Ns){const e=js(r);return Fe(e,t)}else return{base64:!0,data:r}},Fe=(r,t)=>{switch(t){case"blob":return r instanceof Blob?r:new Blob([r]);case"arraybuffer":default:return r instanceof ArrayBuffer?r:r.buffer}},De="",Bs=(r,t)=>{const e=r.length,s=new Array(e);let n=0;r.forEach((i,o)=>{ie(i,!1,l=>{s[o]=l,++n===e&&t(s.join(De))})})},Fs=(r,t)=>{const e=r.split(De),s=[];for(let n=0;n<e.length;n++){const i=oe(e[n],t);if(s.push(i),i.type==="error")break}return s};function Ds(){return new TransformStream({transform(r,t){Os(r,e=>{const s=e.length;let n;if(s<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,s);else if(s<65536){n=new Uint8Array(3);const i=new DataView(n.buffer);i.setUint8(0,126),i.setUint16(1,s)}else{n=new Uint8Array(9);const i=new DataView(n.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(s))}r.data&&typeof r.data!="string"&&(n[0]|=128),t.enqueue(n),t.enqueue(e)})}})}let Ut;function St(r){return r.reduce((t,e)=>t+e.length,0)}function Lt(r,t){if(r[0].length===t)return r.shift();const e=new Uint8Array(t);let s=0;for(let n=0;n<t;n++)e[n]=r[0][s++],s===r[0].length&&(r.shift(),s=0);return r.length&&s<r[0].length&&(r[0]=r[0].slice(s)),e}function Ps(r,t){Ut||(Ut=new TextDecoder);const e=[];let s=0,n=-1,i=!1;return new TransformStream({transform(o,l){for(e.push(o);;){if(s===0){if(St(e)<1)break;const a=Lt(e,1);i=(a[0]&128)===128,n=a[0]&127,n<126?s=3:n===126?s=1:s=2}else if(s===1){if(St(e)<2)break;const a=Lt(e,2);n=new DataView(a.buffer,a.byteOffset,a.length).getUint16(0),s=3}else if(s===2){if(St(e)<8)break;const a=Lt(e,8),h=new DataView(a.buffer,a.byteOffset,a.length),u=h.getUint32(0);if(u>Math.pow(2,21)-1){l.enqueue(Wt);break}n=u*Math.pow(2,32)+h.getUint32(4),s=3}else{if(St(e)<n)break;const a=Lt(e,n);l.enqueue(oe(i?a:Ut.decode(a),t)),s=0}if(n===0||n>r){l.enqueue(Wt);break}}}})}const Pe=4;function M(r){if(r)return Ms(r)}function Ms(r){for(var t in M.prototype)r[t]=M.prototype[t];return r}M.prototype.on=M.prototype.addEventListener=function(r,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(t),this};M.prototype.once=function(r,t){function e(){this.off(r,e),t.apply(this,arguments)}return e.fn=t,this.on(r,e),this};M.prototype.off=M.prototype.removeListener=M.prototype.removeAllListeners=M.prototype.removeEventListener=function(r,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+r];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var s,n=0;n<e.length;n++)if(s=e[n],s===t||s.fn===t){e.splice(n,1);break}return e.length===0&&delete this._callbacks["$"+r],this};M.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+r],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(e){e=e.slice(0);for(var s=0,n=e.length;s<n;++s)e[s].apply(this,t)}return this};M.prototype.emitReserved=M.prototype.emit;M.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};M.prototype.hasListeners=function(r){return!!this.listeners(r).length};const Dt=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0),X=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Is="arraybuffer";function Me(r,...t){return t.reduce((e,s)=>(r.hasOwnProperty(s)&&(e[s]=r[s]),e),{})}const qs=X.setTimeout,Vs=X.clearTimeout;function Pt(r,t){t.useNativeTimers?(r.setTimeoutFn=qs.bind(X),r.clearTimeoutFn=Vs.bind(X)):(r.setTimeoutFn=X.setTimeout.bind(X),r.clearTimeoutFn=X.clearTimeout.bind(X))}const $s=1.33;function Us(r){return typeof r=="string"?Hs(r):Math.ceil((r.byteLength||r.size)*$s)}function Hs(r){let t=0,e=0;for(let s=0,n=r.length;s<n;s++)t=r.charCodeAt(s),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(s++,e+=4);return e}function Ie(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Ys(r){let t="";for(let e in r)r.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(r[e]));return t}function Ws(r){let t={},e=r.split("&");for(let s=0,n=e.length;s<n;s++){let i=e[s].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class Ks extends Error{constructor(t,e,s){super(t),this.description=e,this.context=s,this.type="TransportError"}}class ae extends M{constructor(t){super(),this.writable=!1,Pt(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,s){return super.emitReserved("error",new Ks(t,e,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=oe(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const e=Ys(t);return e.length?"?"+e:""}}class Xs extends ae{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||e()})),this.writable||(s++,this.once("drain",function(){--s||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const e=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};Fs(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Bs(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=Ie()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(t,e)}}let qe=!1;try{qe=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Js=qe;function Gs(){}class Qs extends Xs{constructor(t){if(super(t),typeof location<"u"){const e=location.protocol==="https:";let s=location.port;s||(s=e?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||s!==t.port}}doWrite(t,e){const s=this.request({method:"POST",data:t});s.on("success",e),s.on("error",(n,i)=>{this.onError("xhr post error",n,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,s)=>{this.onError("xhr poll error",e,s)}),this.pollXhr=t}}class tt extends M{constructor(t,e,s){super(),this.createRequest=t,Pt(this,s),this._opts=s,this._method=s.method||"GET",this._uri=e,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var t;const e=Me(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(e);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let n in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(n)&&s.setRequestHeader(n,this._opts.extraHeaders[n])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var n;s.readyState===3&&((n=this._opts.cookieJar)===null||n===void 0||n.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(n){this.setTimeoutFn(()=>{this._onError(n)},0);return}typeof document<"u"&&(this._index=tt.requestsCount++,tt.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Gs,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete tt.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}tt.requestsCount=0;tt.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Ee);else if(typeof addEventListener=="function"){const r="onpagehide"in X?"pagehide":"unload";addEventListener(r,Ee,!1)}}function Ee(){for(let r in tt.requests)tt.requests.hasOwnProperty(r)&&tt.requests[r].abort()}const Zs=function(){const r=Ve({xdomain:!1});return r&&r.responseType!==null}();class tr extends Qs{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=Zs&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new tt(Ve,this.uri(),t)}}function Ve(r){const t=r.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Js))return new XMLHttpRequest}catch{}if(!t)try{return new X[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const $e=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class er extends ae{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,s=$e?{}:Me(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,s)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],n=e===t.length-1;ie(s,this.supportsBinary,i=>{try{this.doWrite(s,i)}catch{}n&&Dt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=Ie()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const Ht=X.WebSocket||X.MozWebSocket;class sr extends er{createSocket(t,e,s){return $e?new Ht(t,e,s):e?new Ht(t,e):new Ht(t)}doWrite(t,e){this.ws.send(e)}}class rr extends ae{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const e=Ps(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=t.readable.pipeThrough(e).getReader(),n=Ds();n.readable.pipeTo(t.writable),this._writer=n.writable.getWriter();const i=()=>{s.read().then(({done:l,value:a})=>{l||(this.onPacket(a),i())}).catch(l=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],n=e===t.length-1;this._writer.write(s).then(()=>{n&&Dt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const nr={websocket:sr,webtransport:rr,polling:tr},ir=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,or=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Kt(r){if(r.length>8e3)throw"URI too long";const t=r,e=r.indexOf("["),s=r.indexOf("]");e!=-1&&s!=-1&&(r=r.substring(0,e)+r.substring(e,s).replace(/:/g,";")+r.substring(s,r.length));let n=ir.exec(r||""),i={},o=14;for(;o--;)i[or[o]]=n[o]||"";return e!=-1&&s!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=ar(i,i.path),i.queryKey=lr(i,i.query),i}function ar(r,t){const e=/\/{2,9}/g,s=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&s.splice(0,1),t.slice(-1)=="/"&&s.splice(s.length-1,1),s}function lr(r,t){const e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,n,i){n&&(e[n]=i)}),e}const Xt=typeof addEventListener=="function"&&typeof removeEventListener=="function",jt=[];Xt&&addEventListener("offline",()=>{jt.forEach(r=>r())},!1);class ht extends M{constructor(t,e){if(super(),this.binaryType=Is,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(e=t,t=null),t){const s=Kt(t);e.hostname=s.host,e.secure=s.protocol==="https"||s.protocol==="wss",e.port=s.port,s.query&&(e.query=s.query)}else e.host&&(e.hostname=Kt(e.host).host);Pt(this,e),this.secure=e.secure!=null?e.secure:typeof location<"u"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach(s=>{const n=s.prototype.name;this.transports.push(n),this._transportsByName[n]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Ws(this.opts.query)),Xt&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},jt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=Pe,e.transport=t,this.id&&(e.sid=this.id);const s=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&ht.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",ht.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let s=0;s<this.writeBuffer.length;s++){const n=this.writeBuffer[s].data;if(n&&(e+=Us(n)),s>0&&e>this._maxPayload)return this.writeBuffer.slice(0,s);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Dt(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,e,s){return this._sendPacket("message",t,e,s),this}send(t,e,s){return this._sendPacket("message",t,e,s),this}_sendPacket(t,e,s,n){if(typeof e=="function"&&(n=e,e=void 0),typeof s=="function"&&(n=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const i={type:t,data:e,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},s=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}_onError(t){if(ht.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Xt&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=jt.indexOf(this._offlineEventListener);s!==-1&&jt.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}ht.protocol=Pe;class cr extends ht{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),s=!1;ht.priorWebsocketSuccess=!1;const n=()=>{s||(e.send([{type:"ping",data:"probe"}]),e.once("packet",v=>{if(!s)if(v.type==="pong"&&v.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;ht.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(u(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const f=new Error("probe error");f.transport=e.name,this.emitReserved("upgradeError",f)}}))};function i(){s||(s=!0,u(),e.close(),e=null)}const o=v=>{const f=new Error("probe error: "+v);f.transport=e.name,i(),this.emitReserved("upgradeError",f)};function l(){o("transport closed")}function a(){o("socket closed")}function h(v){e&&v.name!==e.name&&i()}const u=()=>{e.removeListener("open",n),e.removeListener("error",o),e.removeListener("close",l),this.off("close",a),this.off("upgrading",h)};e.once("open",n),e.once("error",o),e.once("close",l),this.once("close",a),this.once("upgrading",h),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{s||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let s=0;s<t.length;s++)~this.transports.indexOf(t[s])&&e.push(t[s]);return e}}let hr=class extends cr{constructor(t,e={}){const s=typeof t=="object"?t:e;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(n=>nr[n]).filter(n=>!!n)),super(t,s)}};function ur(r,t="",e){let s=r;e=e||typeof location<"u"&&location,r==null&&(r=e.protocol+"//"+e.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=e.protocol+r:r=e.host+r),/^(https?|wss?):\/\//.test(r)||(typeof e<"u"?r=e.protocol+"//"+r:r="https://"+r),s=Kt(r)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const i=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+t,s.href=s.protocol+"://"+i+(e&&e.port===s.port?"":":"+s.port),s}const fr=typeof ArrayBuffer=="function",dr=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,Ue=Object.prototype.toString,pr=typeof Blob=="function"||typeof Blob<"u"&&Ue.call(Blob)==="[object BlobConstructor]",mr=typeof File=="function"||typeof File<"u"&&Ue.call(File)==="[object FileConstructor]";function le(r){return fr&&(r instanceof ArrayBuffer||dr(r))||pr&&r instanceof Blob||mr&&r instanceof File}function Nt(r,t){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let e=0,s=r.length;e<s;e++)if(Nt(r[e]))return!0;return!1}if(le(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return Nt(r.toJSON(),!0);for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e)&&Nt(r[e]))return!0;return!1}function vr(r){const t=[],e=r.data,s=r;return s.data=Jt(e,t),s.attachments=t.length,{packet:s,buffers:t}}function Jt(r,t){if(!r)return r;if(le(r)){const e={_placeholder:!0,num:t.length};return t.push(r),e}else if(Array.isArray(r)){const e=new Array(r.length);for(let s=0;s<r.length;s++)e[s]=Jt(r[s],t);return e}else if(typeof r=="object"&&!(r instanceof Date)){const e={};for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=Jt(r[s],t));return e}return r}function gr(r,t){return r.data=Gt(r.data,t),delete r.attachments,r}function Gt(r,t){if(!r)return r;if(r&&r._placeholder===!0){if(typeof r.num=="number"&&r.num>=0&&r.num<t.length)return t[r.num];throw new Error("illegal attachments")}else if(Array.isArray(r))for(let e=0;e<r.length;e++)r[e]=Gt(r[e],t);else if(typeof r=="object")for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&(r[e]=Gt(r[e],t));return r}const _r=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],yr=5;var E;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(E||(E={}));class xr{constructor(t){this.replacer=t}encode(t){return(t.type===E.EVENT||t.type===E.ACK)&&Nt(t)?this.encodeAsBinary({type:t.type===E.EVENT?E.BINARY_EVENT:E.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===E.BINARY_EVENT||t.type===E.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=vr(t),s=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(s),n}}function Te(r){return Object.prototype.toString.call(r)==="[object Object]"}class ce extends M{constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const s=e.type===E.BINARY_EVENT;s||e.type===E.BINARY_ACK?(e.type=s?E.EVENT:E.ACK,this.reconstructor=new wr(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(le(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0;const s={type:Number(t.charAt(0))};if(E[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===E.BINARY_EVENT||s.type===E.BINARY_ACK){const i=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);const o=t.substring(i,e);if(o!=Number(o)||t.charAt(e)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(t.charAt(e+1)==="/"){const i=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););s.nsp=t.substring(i,e)}else s.nsp="/";const n=t.charAt(e+1);if(n!==""&&Number(n)==n){const i=e+1;for(;++e;){const o=t.charAt(e);if(o==null||Number(o)!=o){--e;break}if(e===t.length)break}s.id=Number(t.substring(i,e+1))}if(t.charAt(++e)){const i=this.tryParse(t.substr(e));if(ce.isPayloadValid(s.type,i))s.data=i;else throw new Error("invalid payload")}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case E.CONNECT:return Te(e);case E.DISCONNECT:return e===void 0;case E.CONNECT_ERROR:return typeof e=="string"||Te(e);case E.EVENT:case E.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&_r.indexOf(e[0])===-1);case E.ACK:case E.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class wr{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const e=gr(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const kr=Object.freeze(Object.defineProperty({__proto__:null,Decoder:ce,Encoder:xr,get PacketType(){return E},protocol:yr},Symbol.toStringTag,{value:"Module"}));function J(r,t,e){return r.on(t,e),function(){r.off(t,e)}}const br=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});let He=class extends M{constructor(t,e,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[J(t,"open",this.onopen.bind(this)),J(t,"packet",this.onpacket.bind(this)),J(t,"error",this.onerror.bind(this)),J(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var s,n,i;if(br.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const o={type:E.EVENT,data:e};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const u=this.ids++,v=e.pop();this._registerAckCallback(u,v),o.id=u}const l=(n=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||n===void 0?void 0:n.writable,a=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!l||(a?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,e){var s;const n=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(n===void 0){this.acks[t]=e;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===t&&this.sendBuffer.splice(l,1);e.call(this,new Error("operation has timed out"))},n),o=(...l)=>{this.io.clearTimeoutFn(i),e.apply(this,l)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...e){return new Promise((s,n)=>{const i=(o,l)=>o?n(o):s(l);i.withError=!0,e.push(i),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((n,...i)=>s!==this._queue[0]?void 0:(n!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(n)):(this._queue.shift(),e&&e(null,...i)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:E.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(s=>String(s.id)===t)){const s=this.acks[t];delete this.acks[t],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case E.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case E.EVENT:case E.BINARY_EVENT:this.onevent(t);break;case E.ACK:case E.BINARY_ACK:this.onack(t);break;case E.DISCONNECT:this.ondisconnect();break;case E.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data,this.emitReserved("connect_error",s);break}}onevent(t){const e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const s of e)s.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let s=!1;return function(...n){s||(s=!0,e.packet({type:E.ACK,id:t,data:n}))}}onack(t){const e=this.acks[t.id];typeof e=="function"&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:E.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const s of e)s.apply(this,t.data)}}};function vt(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}vt.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*r);r=Math.floor(t*10)&1?r+e:r-e}return Math.min(r,this.max)|0};vt.prototype.reset=function(){this.attempts=0};vt.prototype.setMin=function(r){this.ms=r};vt.prototype.setMax=function(r){this.max=r};vt.prototype.setJitter=function(r){this.jitter=r};class Qt extends M{constructor(t,e){var s;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,Pt(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((s=e.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new vt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;const n=e.parser||kr;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new hr(this.uri,this.opts);const e=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const n=J(e,"open",function(){s.onopen(),t&&t()}),i=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),t?t(l):this.maybeReconnectOnOpen()},o=J(e,"error",i);if(this._timeout!==!1){const l=this._timeout,a=this.setTimeoutFn(()=>{n(),i(new Error("timeout")),e.close()},l);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}return this.subs.push(n),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(J(t,"ping",this.onping.bind(this)),J(t,"data",this.ondata.bind(this)),J(t,"error",this.onerror.bind(this)),J(t,"close",this.onclose.bind(this)),J(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){Dt(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let s=this.nsps[t];return s?this._autoConnect&&!s.active&&s.connect():(s=new He(this,t,e),this.nsps[t]=s),s}_destroy(t){const e=Object.keys(this.nsps);for(const s of e)if(this.nsps[s].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let s=0;s<e.length;s++)this.engine.write(e[s],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(n=>{n?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",n)):t.onreconnect()}))},e);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const _t={};function kt(r,t){typeof r=="object"&&(t=r,r=void 0),t=t||{};const e=ur(r,t.path||"/socket.io"),s=e.source,n=e.id,i=e.path,o=_t[n]&&i in _t[n].nsps,l=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let a;return l?a=new Qt(s,t):(_t[n]||(_t[n]=new Qt(s,t)),a=_t[n]),e.query&&!t.query&&(t.query=e.queryKey),a.socket(e.path,t)}Object.assign(kt,{Manager:Qt,Socket:He,io:kt,connect:kt});class Er{constructor(){if(this.enabled=!1,typeof kt=="function"){const t=location.origin;this.socket=kt(t),this.socket&&(this.socket.on("connect",()=>{this.enabled=!0,console.log("Connected to websocket Obelix 1.0")}),this.socket.on("update_settings",e=>{console.log("SOCKETio",e),typeof e=="object"&&!Array.isArray(e)&&e!==null&&ne.update(s=>({...s,...e}))}))}}destroy(){this.socket.offAny(),this.socket.disconnect()}emit(t){this.enabled&&this.socket.emit("message",t)}emitReply(t,e){this.enabled&&(console.log("emitReply"),this.socket.emit("message_reply",t,(s,n)=>{console.log("emitReply response",s,n),typeof e=="function"&&e(n)}))}}const Ye=new Er;function it(r,t){Ye.emit({get:"foo"}),fetch(""+r).then(s=>s.json()).then(s=>{typeof t=="function"&&t(s)})}function he(r,t,e){Ye.emitReply({post:"foo"},e),fetch(""+r,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(n=>n.json()).then(n=>{e&&e(n)})}class Tr{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=200,this.deadZone=8,this.active=!1,this.value={x:0,y:0},this.counter=0,this.prev={x:0,y:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",s=>{this._handleDown(s)}),this.stick.addEventListener("touchstart",s=>{this._handleDown(s)}),document.addEventListener("mousemove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("touchmove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("mouseup",s=>{this._handleUp(s)}),document.addEventListener("touchend",s=>{this._handleUp(s)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.clientX,y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;let e=null;if(t.changedTouches){for(let A=0;A<t.changedTouches.length;A++)this.touchId===t.changedTouches[A].identifier&&(e=A,t.clientX=t.changedTouches[A].clientX,t.clientY=t.changedTouches[A].clientY);if(e==null)return}const s=this.stick.getBoundingClientRect(),n=s?Math.round(16e3/s.width)/100:1,i=t.clientX-this.dragStart.x,o=t.clientY-this.dragStart.y,l=Math.atan2(o,i),a=Math.min(this.maxDistance,Math.hypot(i,o)*n),h=a*Math.cos(l),u=a*Math.sin(l);this.stick.style.transform=`translate(${h}px, ${u}px)`;const v=a<this.deadZone?0:this.maxDistance/(this.maxDistance-this.deadZone)*(a-this.deadZone),f=v*Math.cos(l),k=v*Math.sin(l),m=parseFloat((f/this.maxDistance).toFixed(4)),z=parseFloat((k/this.maxDistance).toFixed(4));this.value={x:m,y:z},this._loop()}_handleUp(t){this.active&&(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier||(this.stick.style.transition=".2s",this.stick.style.transform="translate3d(0px, 0px, 0px)",this.value={x:0,y:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5+this.value.x*511.5),e=Math.round(511.5+this.value.y*511.5);this.callback(`/joystick/${t}/${e}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){(this.value.x!==this.prev.x||this.value.y!==this.prev.y)&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}class Ar{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=230,this.deadZone=8,this.active=!1,this.value={f:0},this.counter=0,this.prev={f:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",s=>{this._handleDown(s)}),this.stick.addEventListener("touchstart",s=>{this._handleDown(s)}),document.addEventListener("mousemove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("touchmove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("mouseup",s=>{this._handleUp(s)}),document.addEventListener("touchend",s=>{this._handleUp(s)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{y:t.changedTouches[0].clientY}:{y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;t.preventDefault();let e=null;if(t.changedTouches){for(let a=0;a<t.changedTouches.length;a++)this.touchId===t.changedTouches[a].identifier&&(e=a,t.clientY=t.changedTouches[a].clientY);if(e==null)return}const s=this.stick.getBoundingClientRect(),n=s?Math.round(1e4/s.width)/100:1,i=t.clientY-this.dragStart.y,o=i>=0?Math.min(this.maxDistance,i*n):Math.max(-this.maxDistance,i*n);this.stick.style.transform=`translateY(${o}px)`;const l=Math.abs(o)>this.deadZone?parseFloat((o/this.maxDistance).toFixed(4)):0;this.value={f:l},this._loop()}_handleUp(t){this.active&&(t.preventDefault(),!(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier)&&(this.stick.style.transition=".2s",this.stick.style.transform="translateY(0px)",this.value={f:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5-this.value.f*511.5);this.callback(`/focus/${t}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){this.value.f!==this.prev.f&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}var Cr=st('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-1ec61be"><defs><circle id="joys-def-cir1" r="280" cy="0"></circle><circle id="joys-def-cir2" r="80" cy="0"></circle><path id="joys-def-arrow" d="M0 -120 -40 -100 40 -100z"></path><rect id="joys-def-slider" width="70" height="560" transform="translate(350 -280)" rx="15" ry="15"></rect><rect id="joys-def-slide" width="100" height="100" transform="translate(335 -50)" rx="15" ry="15"></rect></defs><g id="joys" transform="translate(320 355)" class="svelte-1ec61be"><use id="joys-plate" href="#joys-def-cir1" class="svelte-1ec61be"></use><use id="joys-arrow-top" href="#joys-def-arrow" class="svelte-1ec61be"></use><use id="joys-arrow-right" href="#joys-def-arrow" transform="rotate(90)" class="svelte-1ec61be"></use><use id="joys-arrow-left" href="#joys-def-arrow" transform="rotate(-90)" class="svelte-1ec61be"></use><use id="joys-arrow-bottom" href="#joys-def-arrow" transform="rotate(180)" class="svelte-1ec61be"></use><use id="joys-stick" href="#joys-def-cir2" style="transform: translate(0px, 0px)" class="svelte-1ec61be"></use><use id="joys-slider" href="#joys-def-slider" class="svelte-1ec61be"></use><use id="joys-slide" href="#joys-def-slide" style="transform: translateY(0px)" class="svelte-1ec61be"></use></g></svg>');function Sr(r,t){ot(t,!1);let e=null,s=null;Tt(()=>{e=new Tr(document.getElementById("joys-stick"),i=>{it(i,o=>{console.log("SVELTE Joystick",o)})}),s=new Ar(document.getElementById("joys-slide"),i=>{it(i,o=>{console.log("SVELTE Focus",o)})})}),Et(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy(),s&&s.hasOwnProperty("destroy")&&s.destroy()}),At();var n=Cr();y(r,n),at()}class Lr{constructor(t,e){if(this.adjust=t,this.adjust){this.callback=e;const s=8e4/360;this.axisSteps={lg:Math.round(s),md:Math.round(s/10),sm:Math.round(s/100)},this.adjust.addEventListener("mouseup",n=>{this.sendCommand(n.target.dataset)})}}destroy(){this.adjust.removeEventListener("mouseup",t=>{this.sendCommand(t.target.dataset)})}sendCommand(t){let e=t==null?void 0:t.dir,s=t==null?void 0:t.len;e&&s&&typeof this.axisSteps[s]=="number"&&(s=this.axisSteps[s],["closer","further"].indexOf(e)>=0&&(s=e==="closer"?-s:s,e="focus"),this.callback(`/adjust/${e}/${s}`))}}var Rr=st('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-1uguiw2"><defs><path id="arr1" d="M45 45 5 45 10 95 95 95 95 10 45 5z"></path><path id="arr2" d="M105 105 11 105 17 165 165 165 165 17 105 11z"></path><path id="arr3" d="M175 175 18 175 25 245 245 245 245 25 175 18z"></path><circle id="cir1" r="44" cy="73"></circle><path id="cir2" d="M-54 73 A 75 75 0 1 0 54 73 A 54 54 0 0 1 -54 73z"></path><path id="cir3" d="M-85 125 A 108 108 0 1 0 85 125 A 54 54 0 0 1 -85 125z"></path></defs><g id="adjust" transform="translate(355 355)" class="svelte-1uguiw2"><g transform="rotate(135)"><use href="#arr1" data-dir="left" data-len="sm" class="svelte-1uguiw2"></use><use href="#arr2" data-dir="left" data-len="md" class="svelte-1uguiw2"></use><use href="#arr3" data-dir="left" data-len="lg" class="svelte-1uguiw2"></use></g><g transform="rotate(-45)"><use href="#arr1" data-dir="right" data-len="sm" class="svelte-1uguiw2"></use><use href="#arr2" data-dir="right" data-len="md" class="svelte-1uguiw2"></use><use href="#arr3" data-dir="right" data-len="lg" class="svelte-1uguiw2"></use></g><g transform="rotate(-135)"><use href="#arr1" data-dir="up" data-len="sm" class="svelte-1uguiw2"></use><use href="#arr2" data-dir="up" data-len="md" class="svelte-1uguiw2"></use><use href="#arr3" data-dir="up" data-len="lg" class="svelte-1uguiw2"></use></g><g transform="rotate(45)"><use href="#arr1" data-dir="down" data-len="sm" class="svelte-1uguiw2"></use><use href="#arr2" data-dir="down" data-len="md" class="svelte-1uguiw2"></use><use href="#arr3" data-dir="down" data-len="lg" class="svelte-1uguiw2"></use></g><g transform="translate(360 -50) rotate(165)"><use href="#cir1" data-dir="further" data-len="sm" class="svelte-1uguiw2"></use><use href="#cir2" data-dir="further" data-len="md" class="svelte-1uguiw2"></use><use href="#cir3" data-dir="further" data-len="lg" class="svelte-1uguiw2"></use></g><g transform="translate(360 50) rotate(15)"><use href="#cir1" data-dir="closer" data-len="sm" class="svelte-1uguiw2"></use><use href="#cir2" data-dir="closer" data-len="md" class="svelte-1uguiw2"></use><use href="#cir3" data-dir="closer" data-len="lg" class="svelte-1uguiw2"></use></g></g></svg>');function Or(r,t){ot(t,!1);let e=null;Tt(()=>{e=new Lr(document.getElementById("adjust"),n=>{it(n,i=>{console.log("SVELTE Adjust",i)})})}),Et(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy()}),At();var s=Rr();y(r,s),at()}const jr=(r,t)=>{O(t,nt(c(t)==="mov"?"adj":"mov"))};var Nr=D('<div class="joystick-wrapper svelte-5x5bew"><!> <button class="button svelte-5x5bew" type="button"> </button></div>');function zr(r){let t=H("mov");var e=Nr(),s=p(e);P(s,()=>c(t)==="mov",o=>{Sr(o,{})},o=>{Or(o,{})});var n=b(s,2);n.__click=[jr,t];var i=p(n,!0);d(n),d(e),W(()=>G(i,c(t)==="mov"?"ADJ":"MOV")),y(r,e)}ut(["click"]);var Br=st('<path fill="none" stroke="#000" stroke-width="1.01" d="M10,0.5 C6.41,0.5 3.5,3.39 3.5,6.98 C3.5,11.83 10,19 10,19 C10,19 16.5,11.83 16.5,6.98 C16.5,3.39 13.59,0.5 10,0.5 L10,0.5 Z"></path><circle fill="none" stroke="#000" cx="10" cy="6.8" r="2.3"></circle>',1),Fr=st('<path fill="none" stroke="#000" d="M1,10.5 L19,10.5"></path><path fill="none" stroke="#000" d="M2.35,15.5 L17.65,15.5"></path><path fill="none" stroke="#000" d="M2.35,5.5 L17.523,5.5"></path><path fill="none" stroke="#000" d="M10,19.46 L9.98,19.46 C7.31,17.33 5.61,14.141 5.61,10.58 C5.61,7.02 7.33,3.83 10,1.7 C10.01,1.7 9.99,1.7 10,1.7 L10,1.7 C12.67,3.83 14.4,7.02 14.4,10.58 C14.4,14.141 12.67,17.33 10,19.46 L10,19.46 L10,19.46 L10,19.46 Z"></path><circle fill="none" stroke="#000" cx="10" cy="10.5" r="9"></circle>',1),Dr=st('<path fill="none" stroke="#000" d="M17.25,6.01 L7.12,16.1 L3.82,17.2 L5.02,13.9 L15.12,3.88 C15.71,3.29 16.66,3.29 17.25,3.88 C17.83,4.47 17.83,5.42 17.25,6.01 L17.25,6.01 Z"></path><path fill="none" stroke="#000" d="M15.98,7.268 L13.851,5.148"></path>',1),Pr=st('<polyline fill="none" stroke="#000" points="6.5 3 6.5 1.5 13.5 1.5 13.5 3"></polyline><polyline fill="none" stroke="#000" points="4.5 4 4.5 18.5 15.5 18.5 15.5 4"></polyline><rect width="1" height="9" x="8" y="7"></rect><rect width="1" height="9" x="11" y="7"></rect><rect width="16" height="1" x="2" y="3"></rect>',1),Mr=st('<ellipse fill="none" stroke="#000" cx="6.11" cy="3.55" rx="2.11" ry="2.15"></ellipse><ellipse fill="none" stroke="#000" cx="6.11" cy="15.55" rx="2.11" ry="2.15"></ellipse><circle fill="none" stroke="#000" cx="13.15" cy="9.55" r="2.15"></circle><rect width="3" height="1" x="1" y="3"></rect><rect width="8" height="1" x="10" y="3"></rect><rect width="8" height="1" x="1" y="9"></rect><rect width="3" height="1" x="15" y="9"></rect><rect width="3" height="1" x="1" y="15"></rect><rect width="8" height="1" x="10" y="15"></rect>',1),Ir=st('<circle fill="none" stroke="#000" cx="9.997" cy="10" r="3.31"></circle><path fill="none" stroke="#000" d="M18.488,12.285 L16.205,16.237 C15.322,15.496 14.185,15.281 13.303,15.791 C12.428,16.289 12.047,17.373 12.246,18.5 L7.735,18.5 C7.938,17.374 7.553,16.299 6.684,15.791 C5.801,15.27 4.655,15.492 3.773,16.237 L1.5,12.285 C2.573,11.871 3.317,10.999 3.317,9.991 C3.305,8.98 2.573,8.121 1.5,7.716 L3.765,3.784 C4.645,4.516 5.794,4.738 6.687,4.232 C7.555,3.722 7.939,2.637 7.735,1.5 L12.263,1.5 C12.072,2.637 12.441,3.71 13.314,4.22 C14.206,4.73 15.343,4.516 16.225,3.794 L18.487,7.714 C17.404,8.117 16.661,8.988 16.67,10.009 C16.672,11.018 17.415,11.88 18.488,12.285 L18.488,12.285 Z"></path>',1),qr=st('<circle fill="none" stroke="#000" cx="10" cy="10" r="7.5"></circle><line fill="none" stroke="#000" x1="10" x2="10" y2="8"></line><line fill="none" stroke="#000" x1="10" y1="12" x2="10" y2="20"></line><line fill="none" stroke="#000" y1="10" x2="8" y2="10"></line><line fill="none" stroke="#000" x1="12" y1="10" x2="20" y2="10"></line>',1),Vr=st('<svg viewBox="0 0 20 20"><!></svg>');function mt(r,t){let e=xt(t,"size",3,1),s=se(()=>Math.round(20*e()));var n=Vr(),i=p(n);P(i,()=>t.type==="home",o=>{var l=Br();lt(),y(o,l)},o=>{var l=rt(),a=Y(l);P(a,()=>t.type==="polaris",h=>{var u=Fr();lt(4),y(h,u)},h=>{var u=rt(),v=Y(u);P(v,()=>t.type==="edit",f=>{var k=Dr();lt(),y(f,k)},f=>{var k=rt(),m=Y(k);P(m,()=>t.type==="delete",z=>{var A=Pr();lt(4),y(z,A)},z=>{var A=rt(),B=Y(A);P(B,()=>t.type==="settings",F=>{var S=Mr();lt(8),y(F,S)},F=>{var S=rt(),x=Y(S);P(x,()=>t.type==="config",g=>{var T=Ir();lt(),y(g,T)},g=>{var T=qr();lt(4),y(g,T)},!0),y(F,S)},!0),y(z,A)},!0),y(f,k)},!0),y(h,u)},!0),y(o,l)}),d(n),W(()=>{U(n,"width",c(s)),U(n,"height",c(s))}),y(r,n)}function Zt(r){return typeof r=="string"?r.toLowerCase().trim().replaceAll("ä","ae").replaceAll("ö","oe").replaceAll("ü","ue").replaceAll("ß","ss").replace(/\W+/g,"_").replace(/^_|_$/g,""):null}const Ae={fid:"",geo:{addr:"",lat:53.6,lon:9.9},base:[{id:"home",name:"Home",pos:{x:-23900,y:0,f:500}},{id:"polaris",name:"Polaris",pos:{x:0,y:11912,f:600}}]};function $r(r,t){const e={...Ae.geo,addr:t},s=[];for(let n of Ae.base)s.push({...n,pos:{...n.pos}});return{fid:r,geo:e,base:s}}var Ur=(r,t)=>{O(t,!1)},Hr=D('<input type="text" id="address" placeholder="Address" class="uk-input uk-margin-small-bottom"> <input type="text" id="latitude" placeholder="Latitude" class="uk-input uk-margin-small-bottom"> <input type="text" id="longitude" placeholder="Longitude" class="uk-input uk-margin-small-bottom"> <button class="uk-button uk-button-small">Save</button> <button class="uk-button uk-button-small">Cancel</button>',1),Yr=(r,t)=>{O(t,!0)},Wr=D('<h4 class="svelte-15i5ty6"> <button class="edit-button svelte-15i5ty6"><!></button></h4>'),Kr=D('<div class="svelte-15i5ty6"> </div>'),Xr=D("<!> <!>",1),Jr=(r,t,e)=>t(r,`/navi/position/${c(e).id}`),Gr=(r,t,e)=>t(c(e).id),Qr=D('<button class="delete-button svelte-15i5ty6"><!></button>'),Zr=D('<li><button class="goto-button svelte-15i5ty6"><!> </button> <!></li>'),tn=D('<label for="new-name">Save/update current position as ...</label> <input type="text" id="new-name" class="uk-input" placeholder="Enter a position name"> <div class="uk-margin-bottom"><sub> </sub></div> <button class="uk-button uk-button-small">Save</button>',1),en=D('<div class="nav-grid svelte-15i5ty6"><div class="nav-curr-pos uk-padding-small svelte-15i5ty6"><h3>Navigation</h3> <!></div> <div class="nav-selector uk-padding-small svelte-15i5ty6"><button class="uk-button uk-button-small uk-align-right">location</button></div> <div class="nav-list uk-padding-small svelte-15i5ty6"><ul id="nav-nav" class="uk-iconnav uk-iconnav-vertical"></ul></div> <div class="nav-add uk-padding-small"><!></div></div>');function sn(r,t){ot(t,!0);const e=zt(),s=()=>bt(Z,"$positions",e),n=()=>bt(ne,"$arduinoSettings",e);let i=H(!1),o=H(""),l=se(()=>Zt(c(o))),a=H(""),h=H(""),u=H(""),v=H(nt([]));const f=Z.subscribe(_=>{_!=null&&_.fid&&(O(a,nt(_.geo.addr)),O(h,nt(_.geo.lat)),O(u,nt(_.geo.lon)),O(v,nt([..._.base])))});Et(()=>{f&&f()});const k=()=>{const _={...s()};he(`/navi/position/update/${_.fid}`,_,w=>{console.log("SVELTE saved",w)})},m=()=>{const _={addr:c(a),lat:parseFloat(c(h)),lon:parseFloat(c(u))};Z.update(w=>({...w,geo:_})),k(),O(i,!1)},z=()=>{const _=Zt(c(o));if(_){let w=!1;const L=(({x:j,y:I,f:V})=>({x:j,y:I,f:V}))(n());let N=c(v).map(j=>j.id!==_?j:(w=!0,{...j,pos:L}));w||N.push({id:_,name:c(o),pos:L}),Z.update(j=>({...j,base:N})),k(),O(o,"")}O(i,!1)},A=_=>{if(confirm(`Do you really want to delete position: "${_}"`)){const w=[...s().base].filter(L=>L.id!==_);Z.update(L=>({...L,base:w})),k(),O(i,!1)}},B=(_,w)=>{_.preventDefault(),it(w,L=>{console.log("SVELTE position",L)})};var F=en(),S=p(F),x=b(p(S),2);P(x,()=>c(i),_=>{var w=Hr(),L=Y(w);dt(L);var N=b(L,2);dt(N);var j=b(N,2);dt(j);var I=b(j,2);I.__click=m;var V=b(I,2);V.__click=[Ur,i],pt(L,()=>c(a),$=>O(a,$)),pt(N,()=>c(h),$=>O(h,$)),pt(j,()=>c(u),$=>O(u,$)),y(_,w)},_=>{var w=Xr(),L=Y(w);P(L,()=>c(a),j=>{var I=Wr(),V=p(I),$=b(V);$.__click=[Yr,i];var ft=p($);mt(ft,{type:"edit"}),d($),d(I),W(()=>G(V,`${c(a)??""} `)),y(j,I)});var N=b(L,2);P(N,()=>c(h)&&c(u),j=>{var I=Kr(),V=p(I);d(I),W(()=>G(V,`${c(h)??""}°, ${c(u)??""}°`)),y(j,I)}),y(_,w)}),d(S);var g=b(S,2),T=p(g);T.__click=function(..._){var w;(w=t.toggleAdmin)==null||w.apply(this,_)},d(g);var C=b(g,2),R=p(C);Ft(R,21,()=>c(v),re,(_,w)=>{var L=Zr(),N=p(L);N.__click=[Jr,B,w];var j=p(N);mt(j,{get type(){return c(w).id},size:1.35});var I=b(j);d(N);var V=b(N,2);P(V,()=>c(i)&&c(w).id!=="home"&&c(w).id!=="polaris",$=>{var ft=Qr();ft.__click=[Gr,A,w];var We=p(ft);mt(We,{type:"delete",size:.85}),d(ft),y($,ft)}),d(L),W(()=>G(I,` ${c(w).name??""}`)),y(_,L)}),d(R),d(C);var q=b(C,2),Q=p(q);P(Q,()=>c(i),_=>{var w=tn(),L=b(Y(w),2);dt(L);var N=b(L,2),j=p(N),I=p(j);d(j),d(N);var V=b(N,2);V.__click=z,W(()=>{G(I,`ID: ${c(l)??""}`),V.disabled=c(l).length<3}),pt(L,()=>c(o),$=>O(o,$)),y(_,w)}),d(q),d(F),y(r,F),at()}ut(["click"]);const rn=(r,t)=>{O(t,!c(t))};var nn=(r,t,e)=>t(c(e).fid),on=(r,t,e)=>t(c(e).fid),an=D('<button class="del-button svelte-vspp1v"><!></button>'),ln=D('<li><button class="loc-button svelte-vspp1v"><!> </button> <!></li>'),cn=(r,t)=>t(),hn=D('<div class="nav-add uk-padding-small svelte-vspp1v"><input type="text" id="new-location" class="uk-input" placeholder="Enter a location name"> <button class="uk-button uk-align-right uk-margin-remove-vertical">+&nbsp;Add</button></div> <div class="uk-padding-small uk-padding-remove-vertical"> </div>',1),un=D('<div class="nav-grid svelte-vspp1v"><div class="nav-curr-pos uk-padding-small svelte-vspp1v"><h4 class="svelte-vspp1v">Locations <button><!></button></h4> <div class="svelte-vspp1v"><p>The location is the place where your telescope is placed.</p></div></div> <div class="nav-selector uk-padding-small svelte-vspp1v"><button class="uk-button uk-button-small uk-align-right">Navigation</button></div> <div class="nav-list uk-padding-small svelte-vspp1v"><ul class="svelte-vspp1v"></ul></div> <!></div>');function fn(r,t){ot(t,!0);const e=zt(),s=()=>bt(Ct,"$locations",e);let n=H("");const i=Z.subscribe(T=>{O(n,nt(T.fid))});Et(()=>{i&&i()});let o=H(!1),l=H(""),a=se(()=>Zt(c(l)));const h=T=>{T!==c(n)&&it(`/navi/location/${T}`,C=>{(C==null?void 0:C.fid)===T&&(Z.update(R=>({...C})),console.log("Loaded location"))})},u=()=>{if(c(a).length>=3){const T=$r(c(a),c(l));he(`/navi/position/update/${c(a)}`,T,C=>{Z.update(R=>T),Ct.update(R=>[...R,{fid:c(a),addr:c(l)}]),O(l,""),console.log("Added new location",C)})}else console.error("ID is too short. At least 3 char are required.")},v=T=>{confirm(`Do you really want to delete location: "${T}"`)?it(`/navi/location/delete/${T}`,C=>{C.response===200&&(Ct.update(R=>R.filter(q=>q.fid!==T)),alert(`Location "${T}" deleted`))}):alert(`Deletion of "${T}" canceled.`)};Tt(()=>{s().length===0&&it("/navi/location-list",T=>{Ct.update(C=>[...T]),console.log("Loaded location list")})});var f=un(),k=p(f),m=p(k),z=b(p(m));z.__click=[rn,o];var A=p(z);mt(A,{type:"edit",size:1}),d(z),d(m),lt(2),d(k);var B=b(k,2),F=p(B);F.__click=function(...T){var C;(C=t.toggleAdmin)==null||C.apply(this,T)},d(B);var S=b(B,2),x=p(S);Ft(x,5,s,re,(T,C)=>{var R=ln(),q=p(R);q.__click=[nn,h,C];var Q=p(q);mt(Q,{type:"home"});var _=b(Q);d(q);var w=b(q,2);P(w,()=>c(o)&&c(C).fid!==c(n)&&c(C).fid!=="index",L=>{var N=an();N.__click=[on,v,C];var j=p(N);mt(j,{type:"delete",size:1}),d(N),y(L,N)}),d(R),W(()=>{Yt(R,`${(c(C).fid===c(n)?"active":"")??""} svelte-vspp1v`),G(_,` ${c(C).addr??""}`)}),y(T,R)}),d(x),d(S);var g=b(S,2);P(g,()=>c(o),T=>{var C=hn(),R=Y(C),q=p(R);dt(q);var Q=b(q,2);Q.__click=[cn,u],d(R);var _=b(R,2),w=p(_,!0);d(_),W(()=>G(w,c(a))),pt(q,()=>c(l),L=>O(l,L)),y(T,C)}),d(f),W(()=>Yt(z,`${"edit-button"+(c(o)?" active":"")} svelte-vspp1v`)),y(r,f),at()}ut(["click"]);function dn(r,t){ot(t,!0);const e=zt(),s=()=>bt(Z,"$positions",e);let n=H(!1);const i=()=>{O(n,!c(n))};Tt(()=>{var a;(a=s())!=null&&a.fid||it("/navi/location/index",h=>{(h==null?void 0:h.fid)==="index"&&Z.update(u=>({...h}))})});var o=rt(),l=Y(o);P(l,()=>c(n),a=>{fn(a,{toggleAdmin:i})},a=>{sn(a,{toggleAdmin:i})}),y(r,o),at()}var pn=(r,t,e)=>{t.callback(t.id,e())},mn=D('<div class="slider-wrapper svelte-4h56gf"><label class="svelte-4h56gf"> </label> <input type="range" class="svelte-4h56gf"></div>');function vn(r,t){ot(t,!0);let e=xt(t,"value",7,0),s=xt(t,"minValue",3,0),n=xt(t,"maxValue",3,10),i=xt(t,"steps",3,1);var o=mn(),l=p(o),a=p(l,!0);d(l);var h=b(l,2);dt(h),h.__change=[pn,t,e],d(o),W(()=>{U(l,"for","slider_slide_"+t.id),G(a,t.name),U(h,"id","slider_slide_"+t.id),U(h,"min",s()),U(h,"max",n()),U(h,"step",i())}),pt(h,e),y(r,o),at()}ut(["change"]);var gn=D('<div class="camera-options svelte-4mjct0"><!> <button class="uk-button uk-button-small uk-align-left uk-margin-medium">Reset defaults</button></div>');function _n(r,t){ot(t,!1);const e=zt(),s=()=>bt(Vt,"$camControls",e),n=(h,u)=>{Vt.update(v=>v.map(f=>f.id===h?{...f,value:u}:{...f})),it(`/cam/ctrl/${h}/${u}`,v=>{console.log("SVELTE CamCtrl",v)})},i=()=>{Vt.update(u=>u.map(v=>({...v,value:v.defaultValue})));const h={};for(let u of s())u!=null&&u.id&&(h[u.id]=u.defaultValue);he("/cam/controls",h,u=>{console.log("SVELTE Cam Controls",u)})};At();var o=gn(),l=p(o);Ft(l,3,s,h=>h.name,(h,u,v)=>{vn(h,gs(()=>c(u),{get index(){return c(v)},callback:n}))});var a=b(l,2);a.__click=i,d(o),y(r,o),at()}ut(["click"]);var yn=(r,t,e)=>t(r,c(e).id),xn=D('<li><a href="/"> </a></li>'),wn=D('<div class="uk-card tools-wrapper svelte-j2eej2"><ul id="tool-selector" class="uk-tab"></ul> <div class="tools svelte-j2eej2"><!></div></div>');function kn(r){const t=[{id:"manual",name:"Manual"},{id:"position",name:"Position"},{id:"camera",name:"Camera"}];let e=H("manual");const s=(a,h)=>{a.preventDefault(),O(e,nt(h))};var n=wn(),i=p(n);Ft(i,21,()=>t,re,(a,h)=>{var u=xn(),v=p(u);v.__click=[yn,s,h];var f=p(v,!0);d(v),d(u),W(()=>{Yt(u,c(e)===c(h).id?"uk-active":""),G(f,c(h).name)}),y(a,u)}),d(i);var o=b(i,2),l=p(o);P(l,()=>c(e)==="manual",a=>{zr(a)},a=>{var h=rt(),u=Y(h);P(u,()=>c(e)==="position",v=>{dn(v,{})},v=>{var f=rt(),k=Y(f);P(k,()=>c(e)==="camera",m=>{_n(m,{})},null,!0),y(v,f)},!0),y(a,h)}),d(o),d(n),y(r,n)}ut(["click"]);var bn=D('<div class="grid-container svelte-1lldtt8"><div class="svelte-1lldtt8"><!></div> <div class="svelte-1lldtt8"><!></div></div>');function jn(r){var t=bn(),e=p(t),s=p(e);Rs(s),d(e);var n=b(e,2),i=p(n);kn(i),d(n),d(t),y(r,t)}export{jn as component};
