import{b as Ge,e as ri,a as D,t as Y,n as Qt,c as Tt}from"../chunks/disclose-version.CVdQhuh4.js";import{A as ai,F as ke,U as Je,C as oi,G as We,ae as si,at as li,as as ci,T as ui,a9 as di,D as fi,aC as vi,r as hi,e as jn,H as nt,b as z,M as $,O as L,N as E,K as at,J as it,aD as Ke,a as v,aB as X,i as Et,I as ht}from"../chunks/runtime.CdqqS4Bm.js";import{a as te,b as ce,c as Gt,o as et,e as pi,f as de,s as $t,p as pt,g as we,h as ie,i as Se,v as Cn,t as Te,T as gi,d as mi}from"../chunks/Tasks.D9j1lh0R.js";import{a as _t,d as ft,s as yt,b as ot}from"../chunks/store.D6nl9me4.js";import{b as _i,a as wt,p as W,o as ee,i as J}from"../chunks/index-client.DBmkXexQ.js";import{a as yi,s as V,b as Qe,r as Rt,e as jt,i as Nt}from"../chunks/size.BnFFJ2ou.js";import{i as Ln}from"../chunks/lifecycle.Tf9ZFBZr.js";import{b as wi}from"../chunks/this.DSTkaCEA.js";import{p as Mt,s as Pn}from"../chunks/props.DaeUU8jY.js";import{g as bi,a as Si}from"../chunks/entry.OtPdBVXx.js";function Mi(e,t,i,n,r){var a=e,o="",l;ai(()=>{if(o===(o=t()??"")){ke&&Je();return}l!==void 0&&(fi(l),l=void 0),o!==""&&(l=oi(()=>{if(ke){We.data;for(var u=Je(),f=u;u!==null&&(u.nodeType!==8||u.data!=="");)f=u,u=si(u);if(u===null)throw li(),ci;Ge(We,f),a=ui(u);return}var s=o+"",c=ri(s);Ge(di(c),c.lastChild),a.before(c)}))})}function An(e,t,i,n=i){e.addEventListener(t,i);const r=e.__on_r;r?e.__on_r=()=>{r(),n()}:e.__on_r=n,yi()}function Dt(e,t,i=t){var n=vi();An(e,"input",()=>{var r=tn(e)?en(e.value):e.value;i(r),n&&r!==(r=t())&&(e.value=r??"")}),hi(()=>{var r=t();if(ke&&e.defaultValue!==e.value){i(e.value);return}tn(e)&&r===en(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function tn(e){var t=e.type;return t==="number"||t==="range"}function en(e){return e===""?null:+e}function Rn(e,t,i){if(e.multiple)return Ei(e,t);for(var n of e.options){var r=Jt(n);if(_i(r,t)){n.selected=!0;return}}(!i||t!==void 0)&&(e.selectedIndex=-1)}function xi(e,t){jn(()=>{var i=new MutationObserver(()=>{var n=e.__value;Rn(e,n)});return i.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{i.disconnect()}})}function nn(e,t,i=t){var n=!0;An(e,"change",()=>{var r;if(e.multiple)r=[].map.call(e.querySelectorAll(":checked"),Jt);else{var a=e.querySelector(":checked");r=a&&Jt(a)}i(r)}),jn(()=>{var r=t();if(Rn(e,r,n),n&&r===void 0){var a=e.querySelector(":checked");a!==null&&(r=Jt(a),i(r))}e.__value=r,n=!1}),xi(e)}function Ei(e,t){for(var i of e.options)i.selected=~t.indexOf(Jt(i))}function Jt(e){return"__value"in e?e.__value:e.value}var $i=Y('<div id="horizon-wrapper" class="svelte-14er9jv"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 220" width="220" height="220" class="svelte-14er9jv"><defs><path id="altitude" d="M32 0 108 0" stroke-width="2" stroke-linecap="round"></path><path id="altitudeText" d="M40 -4 108 -4" stroke="#000" stroke-linecap="round"></path></defs><g id="compass" transform="translate(110 110)"><circle r="32" class="compass svelte-14er9jv" stroke-width="2"></circle><circle r="30" class="compass--scale svelte-14er9jv" stroke-dasharray="2 21.5619449019" stroke-dashoffset="1" stroke-width="6"></circle><g><polygon class="compass--needle svelte-14er9jv" points="-10,10 0,-30 0,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" fill="#000"></polygon><polygon class="compass--needle svelte-14er9jv" points="10,10 0,-30 0,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" fill="#FFF"></polygon></g><g><use class="compass--alt svelte-14er9jv" href="#altitude"></use><text class="compass--text svelte-14er9jv" font-size="20"><textPath href="#altitudeText"> </textPath></text></g><text class="compass--text svelte-14er9jv" font-size="20" text-anchor="middle" y="50"> </text></g></svg></div>');function ki(e,t){nt(t,!1);let i=Ke(),n=Ke();const r=te.subscribe(y=>{z(i,y.deg_x),z(n,y.deg_y)});wt(()=>{r&&r()}),Ln();var a=$i(),o=$(a),l=L($(o)),u=L($(l),2),f=L(u),s=L($(f)),c=$(s),d=$(c);E(c),E(s),E(f);var p=L(f),h=$(p);E(p),E(l),E(o),E(a),at(()=>{V(u,"transform",`rotate(${v(i)??""})`),V(f,"transform",`rotate(${-v(n)})`),_t(d,`${v(n)??""}°`),_t(h,`${v(i)??""}°`)}),D(e,a),it()}class Ct{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const i=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const a=i[r],o=t+a,l=Math.abs(t)<Math.abs(a)?t-(o-a):a-(o-t);l&&(i[n++]=l),t=o}return i[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let i=this._n,n,r,a,o=0;if(i>0){for(o=t[--i];i>0&&(n=o,r=t[--i],o=n+r,a=r-(o-n),!a););i>0&&(a<0&&t[i-1]<0||a>0&&t[i-1]>0)&&(r=a*2,n=o+r,r==n-o&&(o=n))}return o}}function*Ti(e){for(const t of e)yield*t}function Dn(e){return Array.from(Ti(e))}function zt(e,t,i){e=+e,t=+t,i=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+i;for(var n=-1,r=Math.max(0,Math.ceil((t-e)/i))|0,a=new Array(r);++n<r;)a[n]=e+n*i;return a}var F=1e-6,ji=1e-12,q=Math.PI,ct=q/2,rn=q/4,dt=q*2,St=180/q,rt=q/180,U=Math.abs,Ci=Math.atan,Ot=Math.atan2,Z=Math.cos,re=Math.ceil,H=Math.sin,Li=Math.sign||function(e){return e>0?1:e<0?-1:0},kt=Math.sqrt;function Pi(e){return e>1?0:e<-1?q:Math.acos(e)}function Lt(e){return e>1?ct:e<-1?-ct:Math.asin(e)}function ut(){}function fe(e,t){e&&on.hasOwnProperty(e.type)&&on[e.type](e,t)}var an={Feature:function(e,t){fe(e.geometry,t)},FeatureCollection:function(e,t){for(var i=e.features,n=-1,r=i.length;++n<r;)fe(i[n].geometry,t)}},on={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)e=i[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){je(e.coordinates,t,0)},MultiLineString:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)je(i[n],t,0)},Polygon:function(e,t){sn(e.coordinates,t)},MultiPolygon:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)sn(i[n],t)},GeometryCollection:function(e,t){for(var i=e.geometries,n=-1,r=i.length;++n<r;)fe(i[n],t)}};function je(e,t,i){var n=-1,r=e.length-i,a;for(t.lineStart();++n<r;)a=e[n],t.point(a[0],a[1],a[2]);t.lineEnd()}function sn(e,t){var i=-1,n=e.length;for(t.polygonStart();++i<n;)je(e[i],t,1);t.polygonEnd()}function At(e,t){e&&an.hasOwnProperty(e.type)?an[e.type](e,t):fe(e,t)}function Ce(e){return[Ot(e[1],e[0]),Lt(e[2])]}function Ft(e){var t=e[0],i=e[1],n=Z(i);return[n*Z(t),n*H(t),H(i)]}function ae(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ve(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Me(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function oe(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Le(e){var t=kt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Pe(e,t){function i(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(i.invert=function(n,r){return n=t.invert(n,r),n&&e.invert(n[0],n[1])}),i}function Ae(e,t){return U(e)>q&&(e-=Math.round(e/dt)*dt),[e,t]}Ae.invert=Ae;function Ai(e,t,i){return(e%=dt)?t||i?Pe(cn(e),un(t,i)):cn(e):t||i?un(t,i):Ae}function ln(e){return function(t,i){return t+=e,U(t)>q&&(t-=Math.round(t/dt)*dt),[t,i]}}function cn(e){var t=ln(e);return t.invert=ln(-e),t}function un(e,t){var i=Z(e),n=H(e),r=Z(t),a=H(t);function o(l,u){var f=Z(u),s=Z(l)*f,c=H(l)*f,d=H(u),p=d*i+s*n;return[Ot(c*r-p*a,s*i-d*n),Lt(p*r+c*a)]}return o.invert=function(l,u){var f=Z(u),s=Z(l)*f,c=H(l)*f,d=H(u),p=d*r-c*a;return[Ot(c*r+d*a,s*i+p*n),Lt(p*i-s*n)]},o}function Ri(e,t,i,n,r,a){if(i){var o=Z(t),l=H(t),u=n*i;r==null?(r=t+n*dt,a=t-u/2):(r=dn(o,r),a=dn(o,a),(n>0?r<a:r>a)&&(r+=n*dt));for(var f,s=r;n>0?s>a:s<a;s-=u)f=Ce([o,-l*Z(s),-l*H(s)]),e.point(f[0],f[1])}}function dn(e,t){t=Ft(t),t[0]-=e,Le(t);var i=Pi(-t[1]);return((-t[2]<0?-i:i)+dt-F)%dt}function zn(){var e=[],t;return{point:function(i,n,r){t.push([i,n,r])},lineStart:function(){e.push(t=[])},lineEnd:ut,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function ue(e,t){return U(e[0]-t[0])<F&&U(e[1]-t[1])<F}function se(e,t,i,n){this.x=e,this.z=t,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function In(e,t,i,n,r){var a=[],o=[],l,u;if(e.forEach(function(h){if(!((y=h.length-1)<=0)){var y,w=h[0],b=h[y],_;if(ue(w,b)){if(!w[2]&&!b[2]){for(r.lineStart(),l=0;l<y;++l)r.point((w=h[l])[0],w[1]);r.lineEnd();return}b[0]+=2*F}a.push(_=new se(w,h,null,!0)),o.push(_.o=new se(w,null,_,!1)),a.push(_=new se(b,h,null,!1)),o.push(_.o=new se(b,null,_,!0))}}),!!a.length){for(o.sort(t),fn(a),fn(o),l=0,u=o.length;l<u;++l)o[l].e=i=!i;for(var f=a[0],s,c;;){for(var d=f,p=!0;d.v;)if((d=d.n)===f)return;s=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(l=0,u=s.length;l<u;++l)r.point((c=s[l])[0],c[1]);else n(d.x,d.n.x,1,r);d=d.n}else{if(p)for(s=d.p.z,l=s.length-1;l>=0;--l)r.point((c=s[l])[0],c[1]);else n(d.x,d.p.x,-1,r);d=d.p}d=d.o,s=d.z,p=!p}while(!d.v);r.lineEnd()}}}function fn(e){if(t=e.length){for(var t,i=0,n=e[0],r;++i<t;)n.n=r=e[i],r.p=n,n=r;n.n=r=e[0],r.p=n}}function xe(e){return U(e[0])<=q?e[0]:Li(e[0])*((U(e[0])+q)%dt-q)}function Di(e,t){var i=xe(t),n=t[1],r=H(n),a=[H(i),-Z(i),0],o=0,l=0,u=new Ct;r===1?n=ct+F:r===-1&&(n=-ct-F);for(var f=0,s=e.length;f<s;++f)if(d=(c=e[f]).length)for(var c,d,p=c[d-1],h=xe(p),y=p[1]/2+rn,w=H(y),b=Z(y),_=0;_<d;++_,h=S,w=j,b=I,p=g){var g=c[_],S=xe(g),T=g[1]/2+rn,j=H(T),I=Z(T),R=S-h,M=R>=0?1:-1,k=M*R,x=k>q,N=w*j;if(u.add(Ot(N*M*H(k),b*I+N*Z(k))),o+=x?R+M*dt:R,x^h>=i^S>=i){var P=ve(Ft(p),Ft(g));Le(P);var A=ve(a,P);Le(A);var m=(x^R>=0?-1:1)*Lt(A[2]);(n>m||n===m&&(P[0]||P[1]))&&(l+=x^R>=0?1:-1)}}return(o<-F||o<F&&u<-ji)^l&1}function Nn(e,t,i,n){return function(r){var a=t(r),o=zn(),l=t(o),u=!1,f,s,c,d={point:p,lineStart:y,lineEnd:w,polygonStart:function(){d.point=b,d.lineStart=_,d.lineEnd=g,s=[],f=[]},polygonEnd:function(){d.point=p,d.lineStart=y,d.lineEnd=w,s=Dn(s);var S=Di(f,n);s.length?(u||(r.polygonStart(),u=!0),In(s,Ii,S,i,r)):S&&(u||(r.polygonStart(),u=!0),r.lineStart(),i(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),s=f=null},sphere:function(){r.polygonStart(),r.lineStart(),i(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(S,T){e(S,T)&&r.point(S,T)}function h(S,T){a.point(S,T)}function y(){d.point=h,a.lineStart()}function w(){d.point=p,a.lineEnd()}function b(S,T){c.push([S,T]),l.point(S,T)}function _(){l.lineStart(),c=[]}function g(){b(c[0][0],c[0][1]),l.lineEnd();var S=l.clean(),T=o.result(),j,I=T.length,R,M,k;if(c.pop(),f.push(c),c=null,!!I){if(S&1){if(M=T[0],(R=M.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),j=0;j<R;++j)r.point((k=M[j])[0],k[1]);r.lineEnd()}return}I>1&&S&2&&T.push(T.pop().concat(T.shift())),s.push(T.filter(zi))}}return d}}function zi(e){return e.length>1}function Ii(e,t){return((e=e.x)[0]<0?e[1]-ct-F:ct-e[1])-((t=t.x)[0]<0?t[1]-ct-F:ct-t[1])}const vn=Nn(function(){return!0},Ni,Fi,[-q,-ct]);function Ni(e){var t=NaN,i=NaN,n=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(a,o){var l=a>0?q:-q,u=U(a-t);U(u-q)<F?(e.point(t,i=(i+o)/2>0?ct:-ct),e.point(n,i),e.lineEnd(),e.lineStart(),e.point(l,i),e.point(a,i),r=0):n!==l&&u>=q&&(U(t-n)<F&&(t-=n*F),U(a-l)<F&&(a-=l*F),i=Oi(t,i,a,o),e.point(n,i),e.lineEnd(),e.lineStart(),e.point(l,i),r=0),e.point(t=a,i=o),n=l},lineEnd:function(){e.lineEnd(),t=i=NaN},clean:function(){return 2-r}}}function Oi(e,t,i,n){var r,a,o=H(e-i);return U(o)>F?Ci((H(t)*(a=Z(n))*H(i)-H(n)*(r=Z(t))*H(e))/(r*a*o)):(t+n)/2}function Fi(e,t,i,n){var r;if(e==null)r=i*ct,n.point(-q,r),n.point(0,r),n.point(q,r),n.point(q,0),n.point(q,-r),n.point(0,-r),n.point(-q,-r),n.point(-q,0),n.point(-q,r);else if(U(e[0]-t[0])>F){var a=e[0]<t[0]?q:-q;r=i*a/2,n.point(-a,r),n.point(0,r),n.point(a,r)}else n.point(t[0],t[1])}function qi(e){var t=Z(e),i=2*rt,n=t>0,r=U(t)>F;function a(s,c,d,p){Ri(p,e,i,d,s,c)}function o(s,c){return Z(s)*Z(c)>t}function l(s){var c,d,p,h,y;return{lineStart:function(){h=p=!1,y=1},point:function(w,b){var _=[w,b],g,S=o(w,b),T=n?S?0:f(w,b):S?f(w+(w<0?q:-q),b):0;if(!c&&(h=p=S)&&s.lineStart(),S!==p&&(g=u(c,_),(!g||ue(c,g)||ue(_,g))&&(_[2]=1)),S!==p)y=0,S?(s.lineStart(),g=u(_,c),s.point(g[0],g[1])):(g=u(c,_),s.point(g[0],g[1],2),s.lineEnd()),c=g;else if(r&&c&&n^S){var j;!(T&d)&&(j=u(_,c,!0))&&(y=0,n?(s.lineStart(),s.point(j[0][0],j[0][1]),s.point(j[1][0],j[1][1]),s.lineEnd()):(s.point(j[1][0],j[1][1]),s.lineEnd(),s.lineStart(),s.point(j[0][0],j[0][1],3)))}S&&(!c||!ue(c,_))&&s.point(_[0],_[1]),c=_,p=S,d=T},lineEnd:function(){p&&s.lineEnd(),c=null},clean:function(){return y|(h&&p)<<1}}}function u(s,c,d){var p=Ft(s),h=Ft(c),y=[1,0,0],w=ve(p,h),b=ae(w,w),_=w[0],g=b-_*_;if(!g)return!d&&s;var S=t*b/g,T=-t*_/g,j=ve(y,w),I=oe(y,S),R=oe(w,T);Me(I,R);var M=j,k=ae(I,M),x=ae(M,M),N=k*k-x*(ae(I,I)-1);if(!(N<0)){var P=kt(N),A=oe(M,(-k-P)/x);if(Me(A,I),A=Ce(A),!d)return A;var m=s[0],C=c[0],B=s[1],G=c[1],Q;C<m&&(Q=m,m=C,C=Q);var vt=C-m,tt=U(vt-q)<F,bt=tt||vt<F;if(!tt&&G<B&&(Q=B,B=G,G=Q),bt?tt?B+G>0^A[1]<(U(A[0]-m)<F?B:G):B<=A[1]&&A[1]<=G:vt>q^(m<=A[0]&&A[0]<=C)){var O=oe(M,(-k+P)/x);return Me(O,I),[A,Ce(O)]}}}function f(s,c){var d=n?e:q-e,p=0;return s<-d?p|=1:s>d&&(p|=2),c<-d?p|=4:c>d&&(p|=8),p}return Nn(o,l,a,n?[0,-e]:[-q,e-q])}function Yi(e,t,i,n,r,a){var o=e[0],l=e[1],u=t[0],f=t[1],s=0,c=1,d=u-o,p=f-l,h;if(h=i-o,!(!d&&h>0)){if(h/=d,d<0){if(h<s)return;h<c&&(c=h)}else if(d>0){if(h>c)return;h>s&&(s=h)}if(h=r-o,!(!d&&h<0)){if(h/=d,d<0){if(h>c)return;h>s&&(s=h)}else if(d>0){if(h<s)return;h<c&&(c=h)}if(h=n-l,!(!p&&h>0)){if(h/=p,p<0){if(h<s)return;h<c&&(c=h)}else if(p>0){if(h>c)return;h>s&&(s=h)}if(h=a-l,!(!p&&h<0)){if(h/=p,p<0){if(h>c)return;h>s&&(s=h)}else if(p>0){if(h<s)return;h<c&&(c=h)}return s>0&&(e[0]=o+s*d,e[1]=l+s*p),c<1&&(t[0]=o+c*d,t[1]=l+c*p),!0}}}}}var Vt=1e9,le=-Vt;function Bi(e,t,i,n){function r(f,s){return e<=f&&f<=i&&t<=s&&s<=n}function a(f,s,c,d){var p=0,h=0;if(f==null||(p=o(f,c))!==(h=o(s,c))||u(f,s)<0^c>0)do d.point(p===0||p===3?e:i,p>1?n:t);while((p=(p+c+4)%4)!==h);else d.point(s[0],s[1])}function o(f,s){return U(f[0]-e)<F?s>0?0:3:U(f[0]-i)<F?s>0?2:1:U(f[1]-t)<F?s>0?1:0:s>0?3:2}function l(f,s){return u(f.x,s.x)}function u(f,s){var c=o(f,1),d=o(s,1);return c!==d?c-d:c===0?s[1]-f[1]:c===1?f[0]-s[0]:c===2?f[1]-s[1]:s[0]-f[0]}return function(f){var s=f,c=zn(),d,p,h,y,w,b,_,g,S,T,j,I={point:R,lineStart:N,lineEnd:P,polygonStart:k,polygonEnd:x};function R(m,C){r(m,C)&&s.point(m,C)}function M(){for(var m=0,C=0,B=p.length;C<B;++C)for(var G=p[C],Q=1,vt=G.length,tt=G[0],bt,O,st=tt[0],K=tt[1];Q<vt;++Q)bt=st,O=K,tt=G[Q],st=tt[0],K=tt[1],O<=n?K>n&&(st-bt)*(n-O)>(K-O)*(e-bt)&&++m:K<=n&&(st-bt)*(n-O)<(K-O)*(e-bt)&&--m;return m}function k(){s=c,d=[],p=[],j=!0}function x(){var m=M(),C=j&&m,B=(d=Dn(d)).length;(C||B)&&(f.polygonStart(),C&&(f.lineStart(),a(null,null,1,f),f.lineEnd()),B&&In(d,l,m,a,f),f.polygonEnd()),s=f,d=p=h=null}function N(){I.point=A,p&&p.push(h=[]),T=!0,S=!1,_=g=NaN}function P(){d&&(A(y,w),b&&S&&c.rejoin(),d.push(c.result())),I.point=R,S&&s.lineEnd()}function A(m,C){var B=r(m,C);if(p&&h.push([m,C]),T)y=m,w=C,b=B,T=!1,B&&(s.lineStart(),s.point(m,C));else if(B&&S)s.point(m,C);else{var G=[_=Math.max(le,Math.min(Vt,_)),g=Math.max(le,Math.min(Vt,g))],Q=[m=Math.max(le,Math.min(Vt,m)),C=Math.max(le,Math.min(Vt,C))];Yi(G,Q,e,t,i,n)?(S||(s.lineStart(),s.point(G[0],G[1])),s.point(Q[0],Q[1]),B||s.lineEnd(),j=!1):B&&(s.lineStart(),s.point(m,C),j=!1)}_=m,g=C,S=B}return I}}function hn(e,t,i){var n=zt(e,t-F,i).concat(t);return function(r){return n.map(function(a){return[r,a]})}}function pn(e,t,i){var n=zt(e,t-F,i).concat(t);return function(r){return n.map(function(a){return[a,r]})}}function Vi(){var e,t,i,n,r,a,o,l,u=10,f=u,s=90,c=360,d,p,h,y,w=2.5;function b(){return{type:"MultiLineString",coordinates:_()}}function _(){return zt(re(n/s)*s,i,s).map(h).concat(zt(re(l/c)*c,o,c).map(y)).concat(zt(re(t/u)*u,e,u).filter(function(g){return U(g%s)>F}).map(d)).concat(zt(re(a/f)*f,r,f).filter(function(g){return U(g%c)>F}).map(p))}return b.lines=function(){return _().map(function(g){return{type:"LineString",coordinates:g}})},b.outline=function(){return{type:"Polygon",coordinates:[h(n).concat(y(o).slice(1),h(i).reverse().slice(1),y(l).reverse().slice(1))]}},b.extent=function(g){return arguments.length?b.extentMajor(g).extentMinor(g):b.extentMinor()},b.extentMajor=function(g){return arguments.length?(n=+g[0][0],i=+g[1][0],l=+g[0][1],o=+g[1][1],n>i&&(g=n,n=i,i=g),l>o&&(g=l,l=o,o=g),b.precision(w)):[[n,l],[i,o]]},b.extentMinor=function(g){return arguments.length?(t=+g[0][0],e=+g[1][0],a=+g[0][1],r=+g[1][1],t>e&&(g=t,t=e,e=g),a>r&&(g=a,a=r,r=g),b.precision(w)):[[t,a],[e,r]]},b.step=function(g){return arguments.length?b.stepMajor(g).stepMinor(g):b.stepMinor()},b.stepMajor=function(g){return arguments.length?(s=+g[0],c=+g[1],b):[s,c]},b.stepMinor=function(g){return arguments.length?(u=+g[0],f=+g[1],b):[u,f]},b.precision=function(g){return arguments.length?(w=+g,d=hn(a,r,90),p=pn(t,e,w),h=hn(l,o,90),y=pn(n,i,w),b):w},b.extentMajor([[-180,-90+F],[180,90-F]]).extentMinor([[-180,-80-F],[180,80+F]])}const Re=e=>e;var Ee=new Ct,De=new Ct,On,Fn,ze,Ie,xt={point:ut,lineStart:ut,lineEnd:ut,polygonStart:function(){xt.lineStart=Xi,xt.lineEnd=Hi},polygonEnd:function(){xt.lineStart=xt.lineEnd=xt.point=ut,Ee.add(U(De)),De=new Ct},result:function(){var e=Ee/2;return Ee=new Ct,e}};function Xi(){xt.point=Ui}function Ui(e,t){xt.point=qn,On=ze=e,Fn=Ie=t}function qn(e,t){De.add(Ie*e-ze*t),ze=e,Ie=t}function Hi(){qn(On,Fn)}var qt=1/0,he=qt,Wt=-qt,pe=Wt,ge={point:Zi,lineStart:ut,lineEnd:ut,polygonStart:ut,polygonEnd:ut,result:function(){var e=[[qt,he],[Wt,pe]];return Wt=pe=-(he=qt=1/0),e}};function Zi(e,t){e<qt&&(qt=e),e>Wt&&(Wt=e),t<he&&(he=t),t>pe&&(pe=t)}var Ne=0,Oe=0,Xt=0,me=0,_e=0,It=0,Fe=0,qe=0,Ut=0,Yn,Bn,gt,mt,lt={point:Pt,lineStart:gn,lineEnd:mn,polygonStart:function(){lt.lineStart=Wi,lt.lineEnd=Ki},polygonEnd:function(){lt.point=Pt,lt.lineStart=gn,lt.lineEnd=mn},result:function(){var e=Ut?[Fe/Ut,qe/Ut]:It?[me/It,_e/It]:Xt?[Ne/Xt,Oe/Xt]:[NaN,NaN];return Ne=Oe=Xt=me=_e=It=Fe=qe=Ut=0,e}};function Pt(e,t){Ne+=e,Oe+=t,++Xt}function gn(){lt.point=Gi}function Gi(e,t){lt.point=Ji,Pt(gt=e,mt=t)}function Ji(e,t){var i=e-gt,n=t-mt,r=kt(i*i+n*n);me+=r*(gt+e)/2,_e+=r*(mt+t)/2,It+=r,Pt(gt=e,mt=t)}function mn(){lt.point=Pt}function Wi(){lt.point=Qi}function Ki(){Vn(Yn,Bn)}function Qi(e,t){lt.point=Vn,Pt(Yn=gt=e,Bn=mt=t)}function Vn(e,t){var i=e-gt,n=t-mt,r=kt(i*i+n*n);me+=r*(gt+e)/2,_e+=r*(mt+t)/2,It+=r,r=mt*e-gt*t,Fe+=r*(gt+e),qe+=r*(mt+t),Ut+=r*3,Pt(gt=e,mt=t)}function Xn(e){this._context=e}Xn.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,dt);break}}},result:ut};var Ye=new Ct,$e,Un,Hn,Ht,Zt,Kt={point:ut,lineStart:function(){Kt.point=tr},lineEnd:function(){$e&&Zn(Un,Hn),Kt.point=ut},polygonStart:function(){$e=!0},polygonEnd:function(){$e=null},result:function(){var e=+Ye;return Ye=new Ct,e}};function tr(e,t){Kt.point=Zn,Un=Ht=e,Hn=Zt=t}function Zn(e,t){Ht-=e,Zt-=t,Ye.add(kt(Ht*Ht+Zt*Zt)),Ht=e,Zt=t}let _n,ye,yn,wn;class bn{constructor(t){this._append=t==null?Gn:er(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,i){switch(this._point){case 0:{this._append`M${t},${i}`,this._point=1;break}case 1:{this._append`L${t},${i}`;break}default:{if(this._append`M${t},${i}`,this._radius!==yn||this._append!==ye){const n=this._radius,r=this._;this._="",this._append`m0,${n}a${n},${n} 0 1,1 0,${-2*n}a${n},${n} 0 1,1 0,${2*n}z`,yn=n,ye=this._append,wn=this._,this._=r}this._+=wn;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Gn(e){let t=1;this._+=e[0];for(const i=e.length;t<i;++t)this._+=arguments[t]+e[t]}function er(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return Gn;if(t!==_n){const i=10**t;_n=t,ye=function(r){let a=1;this._+=r[0];for(const o=r.length;a<o;++a)this._+=Math.round(arguments[a]*i)/i+r[a]}}return ye}function nr(e,t){let i=3,n=4.5,r,a;function o(l){return l&&(typeof n=="function"&&a.pointRadius(+n.apply(this,arguments)),At(l,r(a))),a.result()}return o.area=function(l){return At(l,r(xt)),xt.result()},o.measure=function(l){return At(l,r(Kt)),Kt.result()},o.bounds=function(l){return At(l,r(ge)),ge.result()},o.centroid=function(l){return At(l,r(lt)),lt.result()},o.projection=function(l){return arguments.length?(r=l==null?(e=null,Re):(e=l).stream,o):e},o.context=function(l){return arguments.length?(a=l==null?(t=null,new bn(i)):new Xn(t=l),typeof n!="function"&&a.pointRadius(n),o):t},o.pointRadius=function(l){return arguments.length?(n=typeof l=="function"?l:(a.pointRadius(+l),+l),o):n},o.digits=function(l){if(!arguments.length)return i;if(l==null)i=null;else{const u=Math.floor(l);if(!(u>=0))throw new RangeError(`invalid digits: ${l}`);i=u}return t===null&&(a=new bn(i)),o},o.projection(e).digits(i).context(t)}function Ue(e){return function(t){var i=new Be;for(var n in e)i[n]=e[n];return i.stream=t,i}}function Be(){}Be.prototype={constructor:Be,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function He(e,t,i){var n=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),n!=null&&e.clipExtent(null),At(i,e.stream(ge)),t(ge.result()),n!=null&&e.clipExtent(n),e}function Jn(e,t,i){return He(e,function(n){var r=t[1][0]-t[0][0],a=t[1][1]-t[0][1],o=Math.min(r/(n[1][0]-n[0][0]),a/(n[1][1]-n[0][1])),l=+t[0][0]+(r-o*(n[1][0]+n[0][0]))/2,u=+t[0][1]+(a-o*(n[1][1]+n[0][1]))/2;e.scale(150*o).translate([l,u])},i)}function ir(e,t,i){return Jn(e,[[0,0],t],i)}function rr(e,t,i){return He(e,function(n){var r=+t,a=r/(n[1][0]-n[0][0]),o=(r-a*(n[1][0]+n[0][0]))/2,l=-a*n[0][1];e.scale(150*a).translate([o,l])},i)}function ar(e,t,i){return He(e,function(n){var r=+t,a=r/(n[1][1]-n[0][1]),o=-a*n[0][0],l=(r-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([o,l])},i)}var Sn=16,or=Z(30*rt);function Mn(e,t){return+t?lr(e,t):sr(e)}function sr(e){return Ue({point:function(t,i){t=e(t,i),this.stream.point(t[0],t[1])}})}function lr(e,t){function i(n,r,a,o,l,u,f,s,c,d,p,h,y,w){var b=f-n,_=s-r,g=b*b+_*_;if(g>4*t&&y--){var S=o+d,T=l+p,j=u+h,I=kt(S*S+T*T+j*j),R=Lt(j/=I),M=U(U(j)-1)<F||U(a-c)<F?(a+c)/2:Ot(T,S),k=e(M,R),x=k[0],N=k[1],P=x-n,A=N-r,m=_*P-b*A;(m*m/g>t||U((b*P+_*A)/g-.5)>.3||o*d+l*p+u*h<or)&&(i(n,r,a,o,l,u,x,N,M,S/=I,T/=I,j,y,w),w.point(x,N),i(x,N,M,S,T,j,f,s,c,d,p,h,y,w))}}return function(n){var r,a,o,l,u,f,s,c,d,p,h,y,w={point:b,lineStart:_,lineEnd:S,polygonStart:function(){n.polygonStart(),w.lineStart=T},polygonEnd:function(){n.polygonEnd(),w.lineStart=_}};function b(R,M){R=e(R,M),n.point(R[0],R[1])}function _(){c=NaN,w.point=g,n.lineStart()}function g(R,M){var k=Ft([R,M]),x=e(R,M);i(c,d,s,p,h,y,c=x[0],d=x[1],s=R,p=k[0],h=k[1],y=k[2],Sn,n),n.point(c,d)}function S(){w.point=b,n.lineEnd()}function T(){_(),w.point=j,w.lineEnd=I}function j(R,M){g(r=R,M),a=c,o=d,l=p,u=h,f=y,w.point=g}function I(){i(c,d,s,p,h,y,a,o,r,l,u,f,Sn,n),w.lineEnd=S,S()}return w}}var cr=Ue({point:function(e,t){this.stream.point(e*rt,t*rt)}});function ur(e){return Ue({point:function(t,i){var n=e(t,i);return this.stream.point(n[0],n[1])}})}function dr(e,t,i,n,r){function a(o,l){return o*=n,l*=r,[t+e*o,i-e*l]}return a.invert=function(o,l){return[(o-t)/e*n,(i-l)/e*r]},a}function xn(e,t,i,n,r,a){if(!a)return dr(e,t,i,n,r);var o=Z(a),l=H(a),u=o*e,f=l*e,s=o/e,c=l/e,d=(l*i-o*t)/e,p=(l*t+o*i)/e;function h(y,w){return y*=n,w*=r,[u*y-f*w+t,i-f*y-u*w]}return h.invert=function(y,w){return[n*(s*y-c*w+d),r*(p-c*y-s*w)]},h}function fr(e){return vr(function(){return e})()}function vr(e){var t,i=150,n=480,r=250,a=0,o=0,l=0,u=0,f=0,s,c=0,d=1,p=1,h=null,y=vn,w=null,b,_,g,S=Re,T=.5,j,I,R,M,k;function x(m){return R(m[0]*rt,m[1]*rt)}function N(m){return m=R.invert(m[0],m[1]),m&&[m[0]*St,m[1]*St]}x.stream=function(m){return M&&k===m?M:M=cr(ur(s)(y(j(S(k=m)))))},x.preclip=function(m){return arguments.length?(y=m,h=void 0,A()):y},x.postclip=function(m){return arguments.length?(S=m,w=b=_=g=null,A()):S},x.clipAngle=function(m){return arguments.length?(y=+m?qi(h=m*rt):(h=null,vn),A()):h*St},x.clipExtent=function(m){return arguments.length?(S=m==null?(w=b=_=g=null,Re):Bi(w=+m[0][0],b=+m[0][1],_=+m[1][0],g=+m[1][1]),A()):w==null?null:[[w,b],[_,g]]},x.scale=function(m){return arguments.length?(i=+m,P()):i},x.translate=function(m){return arguments.length?(n=+m[0],r=+m[1],P()):[n,r]},x.center=function(m){return arguments.length?(a=m[0]%360*rt,o=m[1]%360*rt,P()):[a*St,o*St]},x.rotate=function(m){return arguments.length?(l=m[0]%360*rt,u=m[1]%360*rt,f=m.length>2?m[2]%360*rt:0,P()):[l*St,u*St,f*St]},x.angle=function(m){return arguments.length?(c=m%360*rt,P()):c*St},x.reflectX=function(m){return arguments.length?(d=m?-1:1,P()):d<0},x.reflectY=function(m){return arguments.length?(p=m?-1:1,P()):p<0},x.precision=function(m){return arguments.length?(j=Mn(I,T=m*m),A()):kt(T)},x.fitExtent=function(m,C){return Jn(x,m,C)},x.fitSize=function(m,C){return ir(x,m,C)},x.fitWidth=function(m,C){return rr(x,m,C)},x.fitHeight=function(m,C){return ar(x,m,C)};function P(){var m=xn(i,0,0,d,p,c).apply(null,t(a,o)),C=xn(i,n-m[0],r-m[1],d,p,c);return s=Ai(l,u,f),I=Pe(t,C),R=Pe(s,I),j=Mn(I,T),A()}function A(){return M=k=null,x}return function(){return t=e.apply(this,arguments),x.invert=t.invert&&N,P()}}function hr(e){return function(t,i){var n=kt(t*t+i*i),r=e(n),a=H(r),o=Z(r);return[Ot(t*a,n*o),Lt(n&&i*a/n)]}}function Wn(e,t){return[Z(t)*H(e),H(t)]}Wn.invert=hr(Lt);function pr(){return fr(Wn).scale(249.5).clipAngle(90+F)}var gr=Qt('<path fill="none" class="graticule svelte-1yv80ee" stroke-width="0.3"></path>');function En(e,t){nt(t,!0);let i=X(0),n=X(0);const r=te.subscribe(d=>{z(i,W(d.deg_x)),z(n,W(d.deg_y))});wt(()=>{r&&r()});const a=Mt(t,"scale",3,2e3),o=Mt(t,"steps",3,5),l=Mt(t,"clipAngle",3,15),u=Vi().stepMajor([45,45]).stepMinor([o(),o()]);let f=Et(()=>pr().scale(a()).rotate([-v(i),-v(n)]).translate([1080/2,810/2]).clipAngle(l())),s=Et(()=>nr().projection(v(f)));var c=gr();at(()=>V(c,"d",v(s)(u()))),D(e,c),it()}function Ve(e){return typeof e=="string"?e.toLowerCase().trim().replaceAll("ä","ae").replaceAll("ö","oe").replaceAll("ü","ue").replaceAll("ß","ss").replace(/\W+/g,"_").replace(/^_|_$/g,""):null}const $n={fid:"",geo:{addr:"",lat:53.6,lon:9.9},base:[{id:"home",name:"Primary target",pos:{x:-23900,y:0,f:500}},{id:"polaris",name:"Polaris",pos:{x:0,y:11912,f:600}}]};function mr(e,t){const i={...$n.geo,addr:t},n=[];for(let r of $n.base)n.push({...r,pos:{...r.pos}});return{fid:e,geo:i,base:n}}function kn(e){return Math.PI*e/180}function Xe(e){return e*180/Math.PI}function _r(e){const t=bi(te).spr;let i=Math.round(t*e/360);return Math.abs(i)>t/2&&(i=i>0?i-t:i+t),i}function Tn(e){const t=Xe(e);return _r(t)}var yr=(e,t)=>t("A",e),wr=(e,t)=>t("B",e),br=Y('<div id="camera-stream" class="svelte-1ryloxu"><button id="telescope-stream"><svg class="svg-img svelte-1ryloxu" preserveAspectRatio="xMidYMid slice"><foreignObject class="img-wrap svelte-1ryloxu" x="0" y="0"><img alt="Telescope" class="svg-img svelte-1ryloxu"></foreignObject><g><circle class="crosshair svelte-1ryloxu" r="1"></circle><path class="crosshair svelte-1ryloxu" d="M10 0 50 0zM-10 0 -50 0zM0 10 0 50zM0 -10 0 -50zM15 0 A15 15 0 0 0 -15 0A15 15 0 0 0 15 0"></path></g><!></svg></button> <button id="viewfinder-stream"><svg class="svg-img svelte-1ryloxu" preserveAspectRatio="xMidYMid slice"><foreignObject class="img-wrap svelte-1ryloxu" x="0" y="0"><img alt="Viewfinder" class="svg-img svelte-1ryloxu"></foreignObject><g><circle r="0.0001" fill="none" stroke="none"></circle><rect class="crosshair svelte-1ryloxu"></rect><!></g></svg></button></div>');function Sr(e,t){nt(t,!0);const i=yt(),n=()=>ot(pi,"$locHost",i),r=()=>ot(ce,"$swapPreview",i),a=()=>ot(de,"$displayCompass",i);let o=X(0),l=X(0);const u=1080,f=810;let s=X(void 0);const c=()=>{const O=v(s).getBoundingClientRect();return{x:v(d)==="B"?O.x:v(o)/2,y:v(d)==="B"?O.y:v(l)/2}};let d=X(void 0);const p=ce.subscribe(O=>{z(d,W(O))});let h=X(0),y=X(0);const w=te.subscribe(O=>{z(h,W(O.deg_x)),z(y,W(O.deg_y))}),b=(O,st)=>{if(v(d)!==O)ce.update(K=>O);else{const K=c(),Ze=Math.max(v(o)/u,v(l)/f),Yt={x:Math.round((st.clientX-K.x)/Ze),y:-1*Math.round((st.clientY-K.y)/Ze)},Qn=v(d)==="B"?_.SphereScaleVF:_.SphereScaleTel,ne=kn(v(y)),ti=kn(v(h)),be=Math.sqrt(Math.pow(Yt.x,2)+Math.pow(Yt.y,2)),Bt=Math.asin(be/Qn),ei=Math.asin(Math.cos(Bt)*Math.sin(ne)+Yt.y*Math.sin(Bt)*Math.cos(ne)/be),ni=ti+Math.atan(Yt.x*Math.sin(Bt)/(be*Math.cos(Bt)*Math.cos(ne)-Yt.y*Math.sin(Bt)*Math.sin(ne)));et(`/goto/${Tn(ni)}/${Tn(ei)}`,ii=>{console.log("GoTo cmd",ii)})}};let _=W({CrosshairSize:.4,CrosshairOffsetX:0,CrosshairOffsetY:0,SphereScaleVF:1500,SphereScaleTel:24e3}),g=Gt.subscribe(O=>{for(let st of O)_[st.id]=st.value}),S=X("starfield-zoom.jpg"),T=X("starfield.jpg"),j=Et(()=>Math.ceil(Xe(Math.asin(u/_.SphereScaleVF)))),I=Et(()=>Math.ceil(Xe(Math.asin(u/_.SphereScaleTel))));ee(()=>{z(S,`${n()}:7777/stream_a.mjpg`),z(T,`${n()}:7777/stream_b.mjpg`),et("/config/sphere/settings",O=>{console.log("MOUNT",O),Gt.update(st=>st.map(K=>K!=null&&K.id&&Object.hasOwn(O,K.id)?{...K,value:O[K.id]}:{...K}))})}),wt(()=>{p&&p(),g&&g(),w&&w()});var R=br(),M=$(R);M.__click=[yr,b];var k=$(M);V(k,"viewBox",`0 0 ${u} ${f}`);var x=$(k);V(x,"width",u),V(x,"height",f);var N=$(x);E(x);var P=L(x);V(P,"transform",`translate(${u/2} ${f/2})`);var A=L(P);J(A,a,O=>{En(O,{get scale(){return _.SphereScaleTel},steps:"0.2",get clipAngle(){return v(I)},get width(){return v(o)},get height(){return v(l)}})}),E(k),E(M);var m=L(M,2);m.__click=[wr,b];var C=$(m);V(C,"viewBox",`0 0 ${u} ${f}`);var B=$(C);V(B,"width",u),V(B,"height",f);var G=$(B);E(B);var Q=L(B),vt=$(Q);V(vt,"cx",u/2),V(vt,"cy",f/2),wi(vt,O=>z(s,O),()=>v(s));var tt=L(vt);V(tt,"x",u/2),V(tt,"y",f/2);var bt=L(tt);J(bt,a,O=>{En(O,{get scale(){return _.SphereScaleVF},steps:"5",get clipAngle(){return v(j)},get width(){return v(o)},get height(){return v(l)}})}),E(Q),E(C),E(m),E(R),at(()=>{$t(M,`stream-wrapper ${(r()==="A"?"large":"")??""} svelte-1ryloxu`),V(k,"width",v(o)),V(k,"height",v(l)),V(N,"src",v(S)),$t(m,`stream-wrapper ${(r()==="B"?"large":"")??""} svelte-1ryloxu`),V(C,"width",v(o)),V(C,"height",v(l)),V(G,"src",v(T)),V(Q,"transform",`translate(${u/4*_.CrosshairOffsetX} ${f/4*_.CrosshairOffsetY})`),V(tt,"transform",`translate(${v(o)*_.CrosshairSize*-.5} ${v(l)*_.CrosshairSize*-.5})`),V(tt,"width",v(o)*_.CrosshairSize),V(tt,"height",v(l)*_.CrosshairSize)}),Qe(R,"clientWidth",O=>z(o,O)),Qe(R,"clientHeight",O=>z(l,O)),D(e,R),it()}ft(["click"]);var Mr=Y('<div class="layer svelte-qmdbdl"><!></div>'),xr=Y('<div class="visuals svelte-qmdbdl"><!> <!></div>');function Er(e){const t=yt(),i=()=>ot(de,"$displayCompass",t);var n=xr(),r=$(n);Sr(r,{});var a=L(r,2);J(a,i,o=>{var l=Mr(),u=$(l);ki(u,{}),E(l),D(o,l)}),E(n),D(e,n)}class $r{constructor(t,i){this.stick=t,this.stick&&(this.callback=i,this.dragStart=null,this.touchId=null,this.maxDistance=200,this.deadZone=8,this.active=!1,this.value={x:0,y:0},this.counter=0,this.prev={x:0,y:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",n=>{this._handleDown(n)}),this.stick.addEventListener("touchstart",n=>{this._handleDown(n)}),document.addEventListener("mousemove",n=>{this._handleMove(n)},{passive:!1}),document.addEventListener("touchmove",n=>{this._handleMove(n)},{passive:!1}),document.addEventListener("mouseup",n=>{this._handleUp(n)}),document.addEventListener("touchend",n=>{this._handleUp(n)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.clientX,y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;let i=null;if(t.changedTouches){for(let w=0;w<t.changedTouches.length;w++)this.touchId===t.changedTouches[w].identifier&&(i=w,t.clientX=t.changedTouches[w].clientX,t.clientY=t.changedTouches[w].clientY);if(i==null)return}const n=this.stick.getBoundingClientRect(),r=n?Math.round(16e3/n.width)/100:1,a=t.clientX-this.dragStart.x,o=t.clientY-this.dragStart.y,l=Math.atan2(o,a),u=Math.min(this.maxDistance,Math.hypot(a,o)*r),f=u*Math.cos(l),s=u*Math.sin(l);this.stick.style.transform=`translate(${f}px, ${s}px)`;const c=u<this.deadZone?0:this.maxDistance/(this.maxDistance-this.deadZone)*(u-this.deadZone),d=c*Math.cos(l),p=c*Math.sin(l),h=parseFloat((d/this.maxDistance).toFixed(4)),y=parseFloat((p/this.maxDistance).toFixed(4));this.value={x:h,y},this._loop()}_handleUp(t){this.active&&(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier||(this.stick.style.transition=".2s",this.stick.style.transform="translate3d(0px, 0px, 0px)",this.value={x:0,y:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5+this.value.x*511.5),i=Math.round(511.5+this.value.y*511.5);this.callback(`/joystick/${t}/${i}`)}_debounce(t){return(...i)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...i)},this.debounceTimeout)}}_update(){(this.value.x!==this.prev.x||this.value.y!==this.prev.y)&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}class kr{constructor(t,i){this.stick=t,this.stick&&(this.callback=i,this.dragStart=null,this.touchId=null,this.maxDistance=230,this.deadZone=8,this.active=!1,this.value={f:0},this.counter=0,this.prev={f:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",n=>{this._handleDown(n)}),this.stick.addEventListener("touchstart",n=>{this._handleDown(n)}),document.addEventListener("mousemove",n=>{this._handleMove(n)},{passive:!1}),document.addEventListener("touchmove",n=>{this._handleMove(n)},{passive:!1}),document.addEventListener("mouseup",n=>{this._handleUp(n)}),document.addEventListener("touchend",n=>{this._handleUp(n)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{y:t.changedTouches[0].clientY}:{y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;t.preventDefault();let i=null;if(t.changedTouches){for(let u=0;u<t.changedTouches.length;u++)this.touchId===t.changedTouches[u].identifier&&(i=u,t.clientY=t.changedTouches[u].clientY);if(i==null)return}const n=this.stick.getBoundingClientRect(),r=n?Math.round(1e4/n.width)/100:1,a=t.clientY-this.dragStart.y,o=a>=0?Math.min(this.maxDistance,a*r):Math.max(-this.maxDistance,a*r);this.stick.style.transform=`translateY(${o}px)`;const l=Math.abs(o)>this.deadZone?parseFloat((o/this.maxDistance).toFixed(4)):0;this.value={f:l},this._loop()}_handleUp(t){this.active&&(t.preventDefault(),!(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier)&&(this.stick.style.transition=".2s",this.stick.style.transform="translateY(0px)",this.value={f:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5-this.value.f*511.5);this.callback(`/focus/${t}`)}_debounce(t){return(...i)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...i)},this.debounceTimeout)}}_update(){this.value.f!==this.prev.f&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}var Tr=Qt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-1jgdvgh"><defs><circle id="joys-def-cir2" r="80" cy="0"></circle><path id="joys-def-arrow" d="M0 -120 -40 -100 40 -100z"></path><rect id="joys-def-slide" width="100" height="100" transform="translate(335 -50)" rx="15" ry="15"></rect></defs><g id="joys" transform="translate(320 355)" class="svelte-1jgdvgh"><use id="joys-arrow-top" href="#joys-def-arrow" class="svelte-1jgdvgh"></use><use id="joys-arrow-right" href="#joys-def-arrow" transform="rotate(90)" class="svelte-1jgdvgh"></use><use id="joys-arrow-left" href="#joys-def-arrow" transform="rotate(-90)" class="svelte-1jgdvgh"></use><use id="joys-arrow-bottom" href="#joys-def-arrow" transform="rotate(180)" class="svelte-1jgdvgh"></use><use id="joys-stick" href="#joys-def-cir2" style="transform: translate(0px, 0px)" class="svelte-1jgdvgh"></use><use id="joys-arrow-top" href="#joys-def-arrow" transform="translate(385 30)" class="svelte-1jgdvgh"></use><use id="joys-arrow-top" href="#joys-def-arrow" transform="translate(385 -30) rotate(180)" class="svelte-1jgdvgh"></use><use id="joys-slide" href="#joys-def-slide" style="transform: translateY(0px)" class="svelte-1jgdvgh"></use><a href="#toggle" role="button" tabindex="0" aria-label="Change to adjustment tool"><g id="joys-swap" transform="translate(-250,250)" class="svelte-1jgdvgh"><circle class="element svelte-1jgdvgh" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M6.121 13c-.553 0-1 .448-1 1s.447 1 1 1h1.465l-3.293 3.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.414-3.414v1.707c0 .552.447 1 1 1s.879-.448.879-1v-5h-4.879zM7 11c.552 0 1-.448 1-1v-2h2c.553 0 1-.448 1-1s-.447-1-1-1h-3.999l-.001 4c0 .552.447 1 1 1zM17 13c-.553 0-1 .448-1 1v2h-2c-.553 0-1 .448-1 1s.447 1 1 1h4v-4c0-.552-.447-1-1-1zM18.293 4.293l-3.293 3.293v-1.586c0-.552-.447-1-1-1s-1 .448-1 1v5h5c.552 0 1-.448 1-1s-.447-1-1-1h-1.586l3.293-3.292c.391-.391.391-1.023 0-1.414s-1.023-.392-1.414-.001z" class="svelte-1jgdvgh"></path></g></g></a></g></svg>');function jr(e,t){nt(t,!0);let i=null,n=null;ee(()=>{i=new $r(document.getElementById("joys-stick"),l=>{et(l,u=>{console.log("SVELTE Joystick",u)})}),n=new kr(document.getElementById("joys-slide"),l=>{et(l,u=>{console.log("SVELTE Focus",u)})})}),wt(()=>{i&&i.hasOwnProperty("destroy")&&i.destroy(),n&&n.hasOwnProperty("destroy")&&n.destroy()});var r=Tr(),a=L($(r)),o=L($(a),8);o.__click=function(...l){var u;(u=t.toggle)==null||u.apply(this,l)},E(a),E(r),D(e,r),it()}ft(["click"]);class Cr{constructor(t,i){if(this.adjust=t,this.adjust){this.callback=i;const n=8e4/360;this.axisSteps={lg:Math.round(n),md:Math.round(n/10),sm:Math.round(n/100)},this.adjust.addEventListener("mouseup",r=>{this.sendCommand(r.target.dataset)})}}destroy(){this.adjust.removeEventListener("mouseup",t=>{this.sendCommand(t.target.dataset)})}sendCommand(t){let i=t==null?void 0:t.dir,n=t==null?void 0:t.len;i&&n&&typeof this.axisSteps[n]=="number"&&(n=this.axisSteps[n],["closer","further"].indexOf(i)>=0&&(n=i==="closer"?-n:n,i="focus"),this.callback(`/adjust/${i}/${n}`))}}var Lr=Qt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-cf79tv"><defs><path id="arr1" d="M0 -80 40 -60 40 0 0 -20 -40 0 -40 -60z"></path><path id="arr2" d="M95 95 70 95 70 165 165 165 165 70 95 70z"></path><path id="arr3" d="M165 165 130 165 130 245 245 245 245 130 165 130z"></path><circle id="cir1" r="40" cy="30"></circle><circle id="cir2" r="50" cy="120"></circle><circle id="cir3" r="60" cy="230"></circle><path id="cir3" d="M-85 125 A 108 108 0 1 0 85 125 A 54 54 0 0 1 -85 125z"></path></defs><g id="adjust" transform="translate(355 355)" class="svelte-cf79tv"><g transform="rotate(0)"><use href="#arr1" transform="translate(0 -50)" data-dir="up" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="up" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="up" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(90)"><use href="#arr1" transform="translate(0 -50)" data-dir="right" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="right" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="right" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(180)"><use href="#arr1" transform="translate(0 -50)" data-dir="down" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="down" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="down" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(270)"><use href="#arr1" transform="translate(0 -50)" data-dir="left" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="left" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="left" data-len="lg" class="svelte-cf79tv"></use></g><g transform="translate(360 0)"><use href="#arr1" transform="translate(0 -50)" data-dir="further" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="further" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="further" data-len="lg" class="svelte-cf79tv"></use></g><g transform="translate(360 0) rotate(180)"><use href="#arr1" transform="translate(0 -50)" data-dir="closer" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="closer" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="closer" data-len="lg" class="svelte-cf79tv"></use></g><a href="#toggle" role="button" tabindex="0" aria-label="Change to Joystick"><g id="joys-swap" transform="translate(-285,250)" class="svelte-cf79tv"><circle class="element svelte-cf79tv" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M17.707 8.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l1.293 1.293h-4.586v-4.586l1.293 1.293c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-3.707-3.707-3.707 3.707c-.391.391-.391 1.023 0 1.414s1.023.391 1.414 0l1.293-1.293v4.586h-4.586l1.293-1.293c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-3.707 3.707 3.707 3.707c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-1.293-1.293h4.586v4.586l-1.293-1.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l3.707 3.707 3.707-3.707c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-1.293 1.293v-4.586h4.586l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707z" class="svelte-cf79tv"></path></g></g></a></g></svg>');function Pr(e,t){nt(t,!0);let i=null;ee(()=>{i=new Cr(document.getElementById("adjust"),o=>{et(o,l=>{console.log("SVELTE Adjust",l)})})}),wt(()=>{i&&i.hasOwnProperty("destroy")&&i.destroy()});var n=Lr(),r=L($(n)),a=L($(r),6);a.__click=function(...o){var l;(l=t.toggle)==null||l.apply(this,o)},E(r),E(n),D(e,n),it()}ft(["click"]);var Ar=Y('<div class="joystick-wrapper svelte-gruxg2"><!></div>');function Rr(e){let t=X("mov");const i=a=>{a.preventDefault(),z(t,W(v(t)==="mov"?"adj":"mov"))};var n=Ar(),r=$(n);J(r,()=>v(t)==="mov",a=>{jr(a,{toggle:i})},a=>{Pr(a,{toggle:i})}),E(n),D(e,n)}var Dr=(e,t)=>{z(t,!1)},zr=Y('<header><input type="text" id="address" placeholder="Address"></header> <div class="flexbox"><input type="text" id="latitude" placeholder="Latitude"> <input type="text" id="longitude" placeholder="Longitude"></div> <button class="button button-small">Save location</button> <button class="button">Cancel</button>',1),Ir=(e,t)=>{z(t,!0)},Nr=Y('<header> <button class="edit-button icon-edit" aria-label="Edit"></button></header>'),Or=Y("<div> </div>"),Fr=Y("<!> <!>",1),qr=(e,t,i)=>t(e,`/navi/position/${v(i).id}`),Yr=(e,t,i)=>t(v(i).id),Br=Y('<button class="delete-button icon-delete" aria-label="Delete" title="Delete"></button>'),Vr=Y("<li><button> </button> <!></li>"),Xr=Y('<div class="nav-add"><label for="new-name">Save/update current position as ...</label> <input type="text" id="new-name" class="input" placeholder="Enter position name"> <div class="margin-bottom"><sub> </sub></div> <button class="button button-small">Save target</button></div>'),Ur=Y('<div class="nav-selector"><button class="button button-small">Change location</button></div>'),Hr=Y('<div class="content-card"><div class="nav-curr-pos"><!></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function Zr(e,t){nt(t,!0);const i=yt(),n=()=>ot(pt,"$positions",i),r=()=>ot(te,"$arduinoSettings",i);let a=X(!1),o=X(""),l=Et(()=>Ve(v(o))),u=X(""),f=X(""),s=X(""),c=X(W([]));const d=pt.subscribe(M=>{M!=null&&M.fid&&(z(u,W(M.geo.addr)),z(f,W(M.geo.lat)),z(s,W(M.geo.lon)),z(c,W([...M.base])))});wt(()=>{d&&d()});const p=()=>{const M={...n()};we(`/navi/position/update/${M.fid}`,M,k=>{console.log("SVELTE saved",k)})},h=()=>{const M={addr:v(u),lat:parseFloat(v(f)),lon:parseFloat(v(s))};pt.update(k=>({...k,geo:M})),p(),z(a,!1)},y=()=>{const M=Ve(v(o));if(M){let k=!1;const x=(({x:P,y:A,f:m})=>({x:P,y:A,f:m}))(r());let N=v(c).map(P=>P.id!==M?P:(k=!0,{...P,pos:x}));k||N.push({id:M,name:v(o),pos:x}),pt.update(P=>({...P,base:N})),p(),z(o,"")}z(a,!1)},w=M=>M==="home"?"icon-home":M==="polaris"?"icon-star":"icon-target",b=M=>{if(confirm(`Do you really want to delete position: "${M}"`)){const k=[...n().base].filter(x=>x.id!==M);pt.update(x=>({...x,base:k})),p(),z(a,!1)}},_=(M,k)=>{M.preventDefault(),et(k,x=>{console.log("SVELTE position",x)})};var g=Hr(),S=$(g),T=$(S);J(T,()=>v(a),M=>{var k=zr(),x=ht(k),N=$(x);Rt(N),E(x);var P=L(x,2),A=$(P);Rt(A);var m=L(A,2);Rt(m),E(P);var C=L(P,2);C.__click=h;var B=L(C,2);B.__click=[Dr,a],Dt(N,()=>v(u),G=>z(u,G)),Dt(A,()=>v(f),G=>z(f,G)),Dt(m,()=>v(s),G=>z(s,G)),D(M,k)},M=>{var k=Fr(),x=ht(k);J(x,()=>v(u),P=>{var A=Nr(),m=$(A),C=L(m);C.__click=[Ir,a],E(A),at(()=>_t(m,`${v(u)??""} `)),D(P,A)});var N=L(x,2);J(N,()=>v(f)&&v(s),P=>{var A=Or(),m=$(A);E(A),at(()=>_t(m,`${v(f)??""}°, ${v(s)??""}°`)),D(P,A)}),D(M,k)}),E(S);var j=L(S,2),I=$(j);jt(I,21,()=>v(c),Nt,(M,k)=>{var x=Vr(),N=$(x);const P=Et(()=>`nav-button ${w(v(k).id)??""}`);N.__click=[qr,_,k];var A=$(N,!0);E(N);var m=L(N,2);J(m,()=>v(a)&&v(k).id!=="home"&&v(k).id!=="polaris",C=>{var B=Br();B.__click=[Yr,b,k],D(C,B)}),E(x),at(()=>{$t(N,v(P)),_t(A,v(k).name)}),D(M,x)}),E(I),E(j);var R=L(j,2);J(R,()=>v(a),M=>{var k=Xr(),x=L($(k),2);Rt(x);var N=L(x,2),P=$(N),A=$(P);E(P),E(N);var m=L(N,2);m.__click=y,E(k),at(()=>{_t(A,`ID: ${v(l)??""}`),m.disabled=v(l).length<3}),Dt(x,()=>v(o),C=>z(o,C)),D(M,k)},M=>{var k=Ur(),x=$(k);x.__click=function(...N){var P;(P=t.toggleAdmin)==null||P.apply(this,N)},E(k),D(M,k)}),E(g),D(e,g),it()}ft(["click"]);const Gr=(e,t)=>{z(t,!v(t))};var Jr=(e,t,i)=>t(v(i).fid),Wr=(e,t,i)=>t(v(i).fid),Kr=Y('<button class="delete-button icon-delete" aria-label="Delete"></button>'),Qr=Y('<li><button class="nav-button icon-location"> </button> <!></li>'),ta=(e,t)=>t(),ea=Y('<div class="nav-add"><input type="text" id="new-location" class="input" placeholder="Enter new location name"> <button class="button">+&nbsp;Add</button></div> <div> </div>',1),na=Y('<div class="nav-selector"><button class="button button-small">&laquo;&nbsp;Back</button></div>'),ia=Y('<div class="content-card"><header>Locations <button aria-label="Edit"></button></header> <div class="nav-curr-pos"><div><p>The location is the place where your telescope is placed.</p></div></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function ra(e,t){nt(t,!0);const i=yt(),n=()=>ot(ie,"$locations",i);let r=X("");const a=pt.subscribe(_=>{z(r,W(_.fid))});wt(()=>{a&&a()});let o=X(!1),l=X(""),u=Et(()=>Ve(v(l)));const f=_=>{_!==v(r)&&et(`/navi/location/${_}`,g=>{(g==null?void 0:g.fid)===_&&(pt.update(S=>({...g})),console.log("Loaded location"))})},s=()=>{if(v(u).length>=3){const _=mr(v(u),v(l));we(`/navi/position/update/${v(u)}`,_,g=>{pt.update(S=>_),ie.update(S=>[...S,{fid:v(u),addr:v(l)}]),z(l,""),console.log("Added new location",g)})}else console.error("ID is too short. At least 3 char are required.")},c=_=>{confirm(`Do you really want to delete location: "${_}"`)?et(`/navi/location/delete/${_}`,g=>{g.response===200&&(ie.update(S=>S.filter(T=>T.fid!==_)),alert(`Location "${_}" deleted`))}):alert(`Deletion of "${_}" canceled.`)};ee(()=>{n().length===0&&et("/navi/location-list",_=>{ie.update(g=>[..._]),console.log("Loaded location list")})});var d=ia(),p=$(d),h=L($(p));h.__click=[Gr,o],E(p);var y=L(p,4),w=$(y);jt(w,5,n,Nt,(_,g)=>{var S=Qr(),T=$(S);T.__click=[Jr,f,g];var j=$(T,!0);E(T);var I=L(T,2);J(I,()=>v(o)&&v(g).fid!==v(r)&&v(g).fid!=="index",R=>{var M=Kr();M.__click=[Wr,c,g],D(R,M)}),E(S),at(()=>{$t(S,v(g).fid===v(r)?"active":""),_t(j,v(g).addr)}),D(_,S)}),E(w),E(y);var b=L(y,2);J(b,()=>v(o),_=>{var g=ea(),S=ht(g),T=$(S);Rt(T);var j=L(T,2);j.__click=[ta,s],E(S);var I=L(S,2),R=$(I,!0);E(I),at(()=>_t(R,v(u))),Dt(T,()=>v(l),M=>z(l,M)),D(_,g)},_=>{var g=na(),S=$(g);S.__click=function(...T){var j;(j=t.toggleAdmin)==null||j.apply(this,T)},E(g),D(_,g)}),E(d),at(()=>$t(h,`edit-button icon-edit${(v(o)?" active":"")??""}`)),D(e,d),it()}ft(["click"]);function aa(e,t){nt(t,!0);const i=yt(),n=()=>ot(pt,"$positions",i);let r=X(!1);const a=()=>{z(r,!v(r))};ee(()=>{var u;(u=n())!=null&&u.fid||et("/navi/location/index",f=>{(f==null?void 0:f.fid)==="index"&&pt.update(s=>({...f}))})});var o=Tt(),l=ht(o);J(l,()=>v(r),u=>{ra(u,{toggleAdmin:a})},u=>{Zr(u,{toggleAdmin:a})}),D(e,o),it()}var oa=(e,t,i,n)=>{t()(i.id,n())},sa=(e,t,i,n)=>{t()(i.id,n())},la=Y('<div class="slider-wrapper svelte-1qw7onx"><label class="svelte-1qw7onx"> </label> <input type="range" class="svelte-1qw7onx"></div>');function Kn(e,t){nt(t,!0);let i=Mt(t,"oninput",3,()=>{}),n=Mt(t,"onchange",3,()=>{}),r=Mt(t,"value",7,0),a=Mt(t,"minValue",3,0),o=Mt(t,"maxValue",3,10),l=Mt(t,"steps",3,1);var u=la(),f=$(u),s=$(f,!0);E(f);var c=L(f,2);Rt(c),c.__change=[oa,n,t,r],c.__input=[sa,i,t,r],E(u),at(()=>{V(f,"for","slider_slide_"+t.id),_t(s,t.name),V(c,"id","slider_slide_"+t.id),V(c,"min",a()),V(c,"max",o()),V(c,"step",l())}),Dt(c,r),D(e,u),it()}ft(["change","input"]);var ca=Y('<div class="camera-options svelte-1x08sfe"><!> <div class="actions-wrapper svelte-1x08sfe"><button class="svelte-1x08sfe">Reset defaults</button></div></div>');function ua(e,t){nt(t,!1);const i=yt(),n=()=>ot(Se,"$camControls",i),r=(s,c)=>{Se.update(d=>d.map(p=>p.id===s?{...p,value:c}:{...p})),et(`/cam/ctrl/${s}/${c}`,d=>{console.log("SVELTE CamCtrl",d)})},a=()=>{Se.update(c=>c.map(d=>({...d,value:d.defaultValue})));const s={};for(let c of n())c!=null&&c.id&&(s[c.id]=c.defaultValue);we("/cam/controls",s,c=>{console.log("SVELTE Cam Controls",c)})};Ln();var o=ca(),l=$(o);jt(l,3,n,s=>s.name,(s,c,d)=>{Kn(s,Pn(()=>v(c),{get index(){return v(d)},onchange:r}))});var u=L(l,2),f=$(u);f.__click=a,E(u),E(o),D(e,o),it()}ft(["click"]);const da=()=>{Cn.update(e=>!e)};var fa=Qt('<polygon points="-15,-15 -15,15 15,15 15,-15" stroke-width="5" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),va=Qt('<polygon points="-7.5,-22.5 -7.5,22.5 20,0" stroke-width="10" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),ha=Y('<div id="video-recording" class="svelte-1h8ia9r"><button aria-label="Record video" class="svelte-1h8ia9r"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" preserveAspectRatio="xMinYMin slice" class="svelte-1h8ia9r"><g transform="translate(42,42)"><circle r="38" stroke-width="5" class="svelte-1h8ia9r"></circle><!></g></svg></button></div>');function pa(e,t){nt(t,!0);let i=X(!1);const n=Cn.subscribe(f=>{if(v(i)!==f){z(i,W(f));const s=v(i)?"start":"stop";et(`/cam/video-rec/vid/${s}`,c=>{console.log("Video recording",c)})}});wt(()=>{n&&n()});var r=ha(),a=$(r);a.__click=[da];var o=$(a),l=$(o),u=L($(l));J(u,()=>v(i),f=>{var s=fa();D(f,s)},f=>{var s=va();D(f,s)}),E(l),E(o),E(a),E(r),D(e,r),it()}ft(["click"]);var ga=Y('<h3 class="message svelte-2mgxfn"><!></h3>'),ma=Y('<div class="sphere-config svelte-2mgxfn"><!> <!> <div class="actions-wrapper svelte-2mgxfn"><a href="/system" class="button"><span class="icon-settings"></span>System</a> <button class="button">Save settings</button></div></div>');function _a(e,t){nt(t,!0);const i=yt(),n=()=>ot(Gt,"$sphereControls",i);let r=X(void 0),a=X(W([]));const o=Gt.subscribe(h=>{z(a,W(h.map(y=>({...y}))))}),l=(h,y)=>{console.log(),Gt.update(w=>w.map(b=>b.id===h?{...b,value:y}:{...b}))},u=()=>{const h={};for(let y of n())h[y.id]=y.value;we("/config/sphere/settings",h,y=>{z(r,W((y==null?void 0:y.response)===200?'<span style="color:#090">Successfully saved settings.</span>':'<span style="color:#B00">Failed to save settings.</span>')),setTimeout(()=>{z(r,null)},5e3)})};wt(()=>{o&&o()});var f=ma(),s=$(f);J(s,()=>v(r),h=>{var y=ga(),w=$(y);Mi(w,()=>v(r)),E(y),D(h,y)});var c=L(s,2);jt(c,17,()=>v(a),Nt,(h,y,w)=>{Kn(h,Pn(()=>v(y),{index:w,oninput:l}))});var d=L(c,2),p=L($(d),2);p.__click=u,E(d),E(f),D(e,f),it()}ft(["click"]);const ya=(e,t)=>{const i=t()==="B"?"cam_b":"cam_a";et(`/cam/capture-img/image/${i}`,n=>{console.log("Capture image",n)})},wa=(e,t,i,n)=>{const r=t()==="B"?"cam_b":"cam_a";et(`/cam/snail-shot/${v(i)}/${v(n)}/${r}`,a=>{console.log("Snails",a,r)})};var ba=(e,t)=>console.log("X:",v(t)),Sa=Y("<option></option>"),Ma=(e,t)=>console.log("Y:",v(t)),xa=Y("<option></option>"),Ea=()=>Si("/images"),$a=Y('<div id="image-capture" class="svelte-nnuquw"><button class="svg-btn svelte-nnuquw" aria-label="Capture image"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-nnuquw"><g transform="translate(42,42)"><circle r="28" fill="#C00" stroke="#C00"></circle><circle r="38" class="capture-button svelte-nnuquw"></circle></g></svg></button> <button class="svg-btn svelte-nnuquw" aria-label="Snail shot"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-nnuquw"><g transform="translate(42,42)"><polyline points="0,0 20,0 20,15 -20,15 -20,-15 40,-15 40,30 -20,30 -12,28 -12,32 -20,30" class="svelte-nnuquw"></polyline></g></svg></button> <div class="dimensions svelte-nnuquw"><label class="svelte-nnuquw"><span class="svelte-nnuquw">hor</span><select class="svelte-nnuquw"></select></label> <label class="svelte-nnuquw"><span class="svelte-nnuquw">ver</span><select class="svelte-nnuquw"></select></label></div> <button class="ico-btn icon-gallery" aria-label="Image gallery"></button></div>');function ka(e,t){nt(t,!0);const i=yt(),n=()=>ot(ce,"$swapPreview",i);let r=X(3),a=X(3);var o=$a(),l=$(o);l.__click=[ya,n];var u=L(l,2);u.__click=[wa,n,r,a];var f=L(u,2),s=$(f),c=L($(s));c.__change=[ba,r],jt(c,20,()=>Array.from({length:7}),Nt,(y,w,b)=>{var _=Sa();_.value=(_.__value=b+3)==null?"":b+3,_.textContent=b+3,D(y,_)}),E(c),E(s);var d=L(s,2),p=L($(d));p.__change=[Ma,a],jt(p,20,()=>Array.from({length:7}),Nt,(y,w,b)=>{var _=xa();_.value=(_.__value=b+3)==null?"":b+3,_.textContent=b+3,D(y,_)}),E(p),E(d),E(f);var h=L(f,2);h.__click=[Ea],E(o),nn(c,()=>v(r),y=>z(r,y)),nn(p,()=>v(a),y=>z(a,y)),D(e,o),it()}ft(["click","change"]);var Ta=Y('<div class="controls svelte-bwwnlr"><div class="tools svelte-bwwnlr"><!></div></div>');function ja(e){const t=yt(),i=()=>ot(Te,"$toolTab",t);var n=Tt(),r=ht(n);J(r,i,a=>{var o=Ta(),l=$(o),u=$(l);J(u,()=>i()==="target",f=>{Rr(f)},f=>{var s=Tt(),c=ht(s);J(c,()=>i()==="sphere",d=>{_a(d,{})},d=>{var p=Tt(),h=ht(p);J(h,()=>i()==="location",y=>{aa(y,{})},y=>{var w=Tt(),b=ht(w);J(b,()=>i()==="adjust",_=>{ua(_,{})},_=>{var g=Tt(),S=ht(g);J(S,()=>i()==="video",T=>{pa(T,{})},T=>{var j=Tt(),I=ht(j);J(I,()=>i()==="picture",R=>{ka(R,{})},null,!0),D(T,j)},!0),D(_,g)},!0),D(y,w)},!0),D(d,p)},!0),D(f,s)}),E(l),E(o),D(a,o)}),D(e,n)}var Ca=Y('<li><button><span class="svelte-dso250"> </span></button></li>'),La=Y('<div id="options-menu" class="svelte-dso250"><ul class="svelte-dso250"></ul></div>');function Pa(e,t){nt(t,!0);let i=X("");const n=Te.subscribe(s=>{z(i,W(s))});let r=X(!1);const a=de.subscribe(s=>{z(r,W(s))}),o=s=>{Te.update(c=>c===s?"":s)};wt(()=>{n&&n(),a&&a()});const l=[{id:"sphere",name:"Sphere",icon:"icon-settings",callback:()=>{o("sphere")},enabled:()=>v(i)==="sphere"},{id:"compass",name:"Compass",icon:"icon-compass",callback:()=>{de.update(s=>!s)},enabled:()=>v(r)},{id:"location",name:"Location",icon:"icon-location",callback:()=>{o("location")},enabled:()=>v(i)==="location"},{id:"target",name:"Target",icon:"icon-target",callback:()=>{o("target")},enabled:()=>v(i)==="target"},{id:"adjust",name:"Contrast",icon:"icon-adjust",callback:()=>{o("adjust")},enabled:()=>v(i)==="adjust"},{id:"video",name:"Video",icon:"icon-video",callback:()=>{o("video")},enabled:()=>v(i)==="video"},{id:"picture",name:"Picture",icon:"icon-image",callback:()=>{o("picture")},enabled:()=>v(i)==="picture"}];var u=La(),f=$(u);jt(f,21,()=>l,Nt,(s,c)=>{var d=Ca();const p=Et(()=>`${(v(c).enabled()?"active":"")??""} svelte-dso250`);var h=$(d);h.__click=function(...b){var _;(_=v(c).callback)==null||_.apply(this,b)};var y=$(h),w=$(y,!0);E(y),E(h),E(d),at(()=>{$t(d,v(p)),$t(h,`${v(c).icon??""} svelte-dso250`),_t(w,v(c).name)}),D(s,d)}),E(f),E(u),D(e,u),it()}ft(["click"]);var Aa=Y("<div><!> <!> <!> <!></div>");function Va(e){const t=yt(),i=()=>ot(mi,"$daylight",t);var n=Aa(),r=$(n);gi(r);var a=L(r,2);Er(a);var o=L(a,2);ja(o);var l=L(o,2);Pa(l,{}),E(n),at(()=>$t(n,`${"container"+(i()?" daylight":"")} svelte-183uj8y`)),D(e,n)}export{Va as component};
