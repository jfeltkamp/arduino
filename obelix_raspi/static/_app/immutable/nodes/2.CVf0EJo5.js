var qs=Object.defineProperty;var ei=n=>{throw TypeError(n)};var js=(n,t,e)=>t in n?qs(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var ni=(n,t,e)=>js(n,typeof t!="symbol"?t+"":t,e),sn=(n,t,e)=>t.has(n)||ei("Cannot "+e);var Ot=(n,t,e)=>(sn(n,t,"read from private field"),e?e.call(n):t.get(n)),re=(n,t,e)=>t.has(n)?ei("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),rn=(n,t,e,i)=>(sn(n,t,"write to private field"),i?i.call(n,e):t.set(n,e),e),ii=(n,t,e)=>(sn(n,t,"access private method"),e);import{b as si,e as Fs,a as P,t as j,n as ye,c as $t}from"../chunks/disclose-version.CNLHaAqQ.js";import{S as zs,h as Xi,k as ot,K as Me,L as gn,A as Us,Q as Wi,a7 as Ys,a8 as ri,J as on,l as qt,ar as Le,a5 as Ki,i as Fn,a6 as Hs,C as oi,as as ai,at as zn,au as Xs,U as Ws,$ as ci,av as Un,aw as Ks,P as Js,ax as Zs,j as Ji,F as Zi,M as Qs,B as Gs,ab as tr,ay as Qi,az as er,G as Gi,N as nr,I as ir,aA as sr,a4 as li,aB as rr,aC as or,aD as ar,aa as cr,a9 as Yn,b as lr,p as it,V as D,q as A,w as $,v as T,t as nt,o as st,aE as ui,g,aq as U,f as Zt,m as bt}from"../chunks/runtime.CedCiwwz.js";import{a as Et,d as at,s as Rt,b as lt}from"../chunks/store.BJdxs5V9.js";import{c as ur,d as mt,a as Q,p as Bt,o as we,i as Z,b as hr,s as ts}from"../chunks/index-client.B4OvqJGf.js";import{i as es}from"../chunks/lifecycle.B-JXNPr4.js";import{w as _t,g as Je}from"../chunks/index.CtQPgalP.js";let an=null;function Qt(n,t){return t}function fr(n,t,e,i){for(var s=[],r=t.length,o=0;o<r;o++)Ks(t[o].e,s,!0);var a=r>0&&s.length===0&&e!==null;if(a){var u=e.parentNode;Js(u),u.append(e),i.clear(),Pt(n,t[0].prev,t[r-1].next)}Zs(s,()=>{for(var d=0;d<r;d++){var c=t[d];a||(i.delete(c.k),Pt(n,c.prev,c.next)),Ji(c.e,!a)}})}function jt(n,t,e,i,s,r=null){var o=n,a={flags:t,items:new Map,first:null},u=(t&Qi)!==0;if(u){var d=n;o=ot?Me(Zi(d)):d.appendChild(zs())}ot&&gn();var c=null,l=!1;Xi(()=>{var h=e(),p=Us(h)?h:h==null?[]:Wi(h),f=p.length;if(l&&f===0)return;l=f===0;let b=!1;if(ot){var _=o.data===Ys;_!==(f===0)&&(o=ri(),Me(o),on(!1),b=!0)}if(ot){for(var E=null,w,v=0;v<f;v++){if(qt.nodeType===8&&qt.data===Qs){o=qt,b=!0,on(!1);break}var y=p[v],k=i(y,v);w=ns(qt,a,E,null,y,k,v,s,t),a.items.set(k,w),E=w}f>0&&Me(ri())}if(!ot){var R=Gs;dr(p,a,o,s,t,(R.f&Le)!==0,i)}r!==null&&(f===0?c?Ki(c):c=Fn(()=>r(o)):c!==null&&Hs(c,()=>{c=null})),b&&on(!0),e()}),ot&&(o=qt)}function dr(n,t,e,i,s,r,o){var M,m,N,Y;var a=(s&er)!==0,u=(s&(zn|Un))!==0,d=n.length,c=t.items,l=t.first,h=l,p,f=null,b,_=[],E=[],w,v,y,k;if(a)for(k=0;k<d;k+=1)w=n[k],v=o(w,k),y=c.get(v),y!==void 0&&((M=y.a)==null||M.measure(),(b??(b=new Set)).add(y));for(k=0;k<d;k+=1){if(w=n[k],v=o(w,k),y=c.get(v),y===void 0){var R=h?h.e.nodes_start:e;f=ns(R,t,f,f===null?t.first:f.next,w,v,k,i,s),c.set(v,f),_=[],E=[],h=f.next;continue}if(u&&pr(y,w,k,s),y.e.f&Le&&(Ki(y.e),a&&((m=y.a)==null||m.unfix(),(b??(b=new Set)).delete(y))),y!==h){if(p!==void 0&&p.has(y)){if(_.length<E.length){var B=E[0],O;f=B.prev;var S=_[0],C=_[_.length-1];for(O=0;O<_.length;O+=1)hi(_[O],B,e);for(O=0;O<E.length;O+=1)p.delete(E[O]);Pt(t,S.prev,C.next),Pt(t,f,S),Pt(t,C,B),h=B,f=C,k-=1,_=[],E=[]}else p.delete(y),hi(y,h,e),Pt(t,y.prev,y.next),Pt(t,y,f===null?t.first:f.next),Pt(t,f,y),f=y;continue}for(_=[],E=[];h!==null&&h.k!==v;)(r||!(h.e.f&Le))&&(p??(p=new Set)).add(h),E.push(h),h=h.next;if(h===null)continue;y=h}_.push(y),f=y,h=y.next}if(h!==null||p!==void 0){for(var x=p===void 0?[]:Wi(p);h!==null;)(r||!(h.e.f&Le))&&x.push(h),h=h.next;var I=x.length;if(I>0){var L=s&Qi&&d===0?e:null;if(a){for(k=0;k<I;k+=1)(N=x[k].a)==null||N.measure();for(k=0;k<I;k+=1)(Y=x[k].a)==null||Y.fix()}fr(t,x,L,c)}}a&&tr(()=>{var H;if(b!==void 0)for(y of b)(H=y.a)==null||H.apply()}),oi.first=t.first&&t.first.e,oi.last=f&&f.e}function pr(n,t,e,i){i&zn&&ai(n.v,t),i&Un?ai(n.i,e):n.i=e}function ns(n,t,e,i,s,r,o,a,u){var d=an;try{var c=(u&zn)!==0,l=(u&Xs)===0,h=c?l?Ws(s):ci(s):s,p=u&Un?ci(o):o,f={i:p,v:h,k:r,a:null,e:null,prev:e,next:i};return an=f,f.e=Fn(()=>a(n,h,p),ot),f.e.prev=e&&e.e,f.e.next=i&&i.e,e===null?t.first=f:(e.next=f,e.e.next=f.e),i!==null&&(i.prev=f,i.e.prev=f.e),f}finally{an=d}}function hi(n,t,e){for(var i=n.next?n.next.e.nodes_start:e,s=t?t.e.nodes_start:e,r=n.e.nodes_start;r!==i;){var o=Gi(r);s.before(r),r=o}}function Pt(n,t,e){t===null?n.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function vr(n,t,e,i,s){var r=n,o="",a;Xi(()=>{if(o===(o=t()??"")){ot&&gn();return}a!==void 0&&(Ji(a),a=void 0),o!==""&&(a=Fn(()=>{if(ot){qt.data;for(var u=gn(),d=u;u!==null&&(u.nodeType!==8||u.data!=="");)d=u,u=Gi(u);if(u===null)throw nr(),ir;si(qt,d),r=Me(u);return}var c=o+"",l=Fs(c);si(Zi(l),l.lastChild),r.before(l)}))})}let fi=!1;function is(){fi||(fi=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{var t;if(!n.defaultPrevented)for(const e of n.target.elements)(t=e.__on_r)==null||t.call(e)})},{capture:!0}))}function Ht(n){if(ot){var t=!1,e=()=>{if(!t){if(t=!0,n.hasAttribute("value")){var i=n.value;X(n,"value",null),n.value=i}if(n.hasAttribute("checked")){var s=n.checked;X(n,"checked",null),n.checked=s}}};n.__on_r=e,or(e),is()}}function X(n,t,e,i){var s=n.__attributes??(n.__attributes={});ot&&(s[t]=n.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&n.nodeName==="LINK")||s[t]!==(s[t]=e)&&(t==="style"&&"__styles"in n&&(n.__styles={}),t==="loading"&&(n[sr]=e),e==null?n.removeAttribute(t):typeof e!="string"&&gr(n).includes(t)?n[t]=e:n.setAttribute(t,e))}var di=new Map;function gr(n){var t=di.get(n.nodeName);if(t)return t;di.set(n.nodeName,t=[]);for(var e,i=li(n),s=Element.prototype;s!==i;){e=rr(i);for(var r in e)e[r].set&&t.push(r);i=li(i)}return t}function At(n,t){var e=n.__className,i=mr(t);ot&&n.className===i?n.__className=i:(e!==i||ot&&n.className!==i)&&(t==null?n.removeAttribute("class"):n.className=i,n.__className=i)}function mr(n){return n??""}function ss(n,t,e,i=e){n.addEventListener(t,e);const s=n.__on_r;s?n.__on_r=()=>{s(),i()}:n.__on_r=i,is()}function Xt(n,t,e=t){var i=ar();ss(n,"input",()=>{var s=pi(n)?vi(n.value):n.value;e(s),i&&s!==(s=t())&&(n.value=s??"")}),cr(()=>{var s=t();if(ot&&n.defaultValue!==n.value){e(n.value);return}pi(n)&&s===vi(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function pi(n){var t=n.type;return t==="number"||t==="range"}function vi(n){return n===""?null:+n}function rs(n,t,e){if(n.multiple)return yr(n,t);for(var i of n.options){var s=de(i);if(ur(s,t)){i.selected=!0;return}}(!e||t!==void 0)&&(n.selectedIndex=-1)}function _r(n,t){Yn(()=>{var e=new MutationObserver(()=>{var i=n.__value;rs(n,i)});return e.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{e.disconnect()}})}function gi(n,t,e=t){var i=!0;ss(n,"change",()=>{var s;if(n.multiple)s=[].map.call(n.querySelectorAll(":checked"),de);else{var r=n.querySelector(":checked");s=r&&de(r)}e(s)}),Yn(()=>{var s=t();if(rs(n,s,i),i&&s===void 0){var r=n.querySelector(":checked");r!==null&&(s=de(r),e(s))}n.__value=s,i=!1}),_r(n)}function yr(n,t){for(var e of n.options)e.selected=~t.indexOf(de(e))}function de(n){return"__value"in n?n.__value:n.value}var Dt,Jt,_e,We,os;const Ke=class Ke{constructor(t){re(this,We);re(this,Dt,new WeakMap);re(this,Jt);re(this,_e);rn(this,_e,t)}observe(t,e){var i=Ot(this,Dt).get(t)||new Set;return i.add(e),Ot(this,Dt).set(t,i),ii(this,We,os).call(this).observe(t,Ot(this,_e)),()=>{var s=Ot(this,Dt).get(t);s.delete(e),s.size===0&&(Ot(this,Dt).delete(t),Ot(this,Jt).unobserve(t))}}};Dt=new WeakMap,Jt=new WeakMap,_e=new WeakMap,We=new WeakSet,os=function(){return Ot(this,Jt)??rn(this,Jt,new ResizeObserver(t=>{for(var e of t){Ke.entries.set(e.target,e);for(var i of Ot(this,Dt).get(e.target)||[])i(e)}}))},ni(Ke,"entries",new WeakMap);let mn=Ke;var wr=new mn({box:"border-box"});function mi(n,t,e){var i=wr.observe(n,()=>e(n[t]));Yn(()=>(lr(()=>e(n[t])),i))}const br=_t(`${location.protocol}//${location.hostname}`),Hn=_t(location.origin),ne=_t({x:0,y:0,f:0,deg_x:0,deg_y:0,dx:1,dy:-1,df:1,acc:1e3,spr:8e4,mpa:2e4,minpx:-2e4,maxpx:2e4,mpf:5e3,vx:0,vy:0,va1:100,va2:1500,vf:0,vf1:100,vf2:1500}),cn=_t([{id:"Brightness",name:"Brightness",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.01},{id:"Contrast",name:"Contrast",defaultValue:1,value:1,minValue:0,maxValue:6,steps:.1},{id:"Saturation",name:"Saturation",defaultValue:1,value:1,minValue:0,maxValue:32,steps:.1},{id:"Sharpness",name:"Sharpness",defaultValue:1,value:1,minValue:0,maxValue:16,steps:.1},{id:"ExposureTime",name:"Exposure time",description:"Value > 0 will reduce video framerate.",defaultValue:0,value:0,minValue:-10,maxValue:10,steps:.1},{id:"AnalogueGain",name:"Analogue gain",defaultValue:1,value:1,minValue:1,maxValue:8,steps:.1}]),Ee=_t([]),kt=_t({}),_n=_t(""),Ie=_t(!0),Ne=_t("B"),Xn=_t(!1),Ve=_t(!1),pe=_t([{id:"CrosshairSize",name:"Crosshair Size",defaultValue:.04,value:.04,minValue:.005,maxValue:.25,steps:.005},{id:"CrosshairOffsetX",name:"Crosshair Offset X",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.005},{id:"CrosshairOffsetY",name:"Crosshair Offset Y",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.005},{id:"SphereScaleVF",name:"Sphere Scale Viewfinder",defaultValue:1500,value:1500,minValue:1e3,maxValue:1e4,steps:10},{id:"SphereScaleTel",name:"Sphere Scale Telescope",defaultValue:24e3,value:24e3,minValue:15e3,maxValue:6e4,steps:10}]);var Er=j('<div id="horizon-wrapper" class="svelte-14er9jv"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 220" width="220" height="220" class="svelte-14er9jv"><defs><path id="altitude" d="M32 0 108 0" stroke-width="2" stroke-linecap="round"></path><path id="altitudeText" d="M40 -4 108 -4" stroke="#000" stroke-linecap="round"></path></defs><g id="compass" transform="translate(110 110)"><circle r="32" class="compass svelte-14er9jv" stroke-width="2"></circle><circle r="30" class="compass--scale svelte-14er9jv" stroke-dasharray="2 21.5619449019" stroke-dashoffset="1" stroke-width="6"></circle><g><polygon class="compass--needle svelte-14er9jv" points="-10,10 0,-30 0,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" fill="#000"></polygon><polygon class="compass--needle svelte-14er9jv" points="10,10 0,-30 0,0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" fill="#FFF"></polygon></g><g><use class="compass--alt svelte-14er9jv" href="#altitude"></use><text class="compass--text svelte-14er9jv" font-size="20"><textPath href="#altitudeText"> </textPath></text></g><text class="compass--text svelte-14er9jv" font-size="20" text-anchor="middle" y="50"> </text></g></svg></div>');function kr(n,t){it(t,!1);let e=ui(),i=ui();const s=ne.subscribe(b=>{D(e,b.deg_x),D(i,b.deg_y)});mt(()=>{s&&s()}),es();var r=Er(),o=A(r),a=$(A(o)),u=$(A(a),2),d=$(u),c=$(A(d)),l=A(c),h=A(l);T(l),T(c),T(d);var p=$(d),f=A(p);T(p),T(a),T(o),T(r),nt(()=>{X(u,"transform",`rotate(${g(e)??""})`),X(d,"transform",`rotate(-${g(i)??""})`),Et(h,`${g(i)??""}°`),Et(f,`${g(e)??""}°`)}),P(n,r),st()}const Ct=Object.create(null);Ct.open="0";Ct.close="1";Ct.ping="2";Ct.pong="3";Ct.message="4";Ct.upgrade="5";Ct.noop="6";const $e=Object.create(null);Object.keys(Ct).forEach(n=>{$e[Ct[n]]=n});const yn={type:"error",data:"parser error"},as=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",cs=typeof ArrayBuffer=="function",ls=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,Wn=({type:n,data:t},e,i)=>as&&t instanceof Blob?e?i(t):_i(t,i):cs&&(t instanceof ArrayBuffer||ls(t))?e?i(t):_i(new Blob([t]),i):i(Ct[n]+(t||"")),_i=(n,t)=>{const e=new FileReader;return e.onload=function(){const i=e.result.split(",")[1];t("b"+(i||""))},e.readAsDataURL(n)};function yi(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let ln;function Sr(n,t){if(as&&n.data instanceof Blob)return n.data.arrayBuffer().then(yi).then(t);if(cs&&(n.data instanceof ArrayBuffer||ls(n.data)))return t(yi(n.data));Wn(n,!1,e=>{ln||(ln=new TextEncoder),t(ln.encode(e))})}const wi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ae=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<wi.length;n++)ae[wi.charCodeAt(n)]=n;const xr=n=>{let t=n.length*.75,e=n.length,i,s=0,r,o,a,u;n[n.length-1]==="="&&(t--,n[n.length-2]==="="&&t--);const d=new ArrayBuffer(t),c=new Uint8Array(d);for(i=0;i<e;i+=4)r=ae[n.charCodeAt(i)],o=ae[n.charCodeAt(i+1)],a=ae[n.charCodeAt(i+2)],u=ae[n.charCodeAt(i+3)],c[s++]=r<<2|o>>4,c[s++]=(o&15)<<4|a>>2,c[s++]=(a&3)<<6|u&63;return d},Tr=typeof ArrayBuffer=="function",Kn=(n,t)=>{if(typeof n!="string")return{type:"message",data:us(n,t)};const e=n.charAt(0);return e==="b"?{type:"message",data:Ar(n.substring(1),t)}:$e[e]?n.length>1?{type:$e[e],data:n.substring(1)}:{type:$e[e]}:yn},Ar=(n,t)=>{if(Tr){const e=xr(n);return us(e,t)}else return{base64:!0,data:n}},us=(n,t)=>{switch(t){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},hs="",Cr=(n,t)=>{const e=n.length,i=new Array(e);let s=0;n.forEach((r,o)=>{Wn(r,!1,a=>{i[o]=a,++s===e&&t(i.join(hs))})})},Rr=(n,t)=>{const e=n.split(hs),i=[];for(let s=0;s<e.length;s++){const r=Kn(e[s],t);if(i.push(r),r.type==="error")break}return i};function Or(){return new TransformStream({transform(n,t){Sr(n,e=>{const i=e.length;let s;if(i<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,i);else if(i<65536){s=new Uint8Array(3);const r=new DataView(s.buffer);r.setUint8(0,126),r.setUint16(1,i)}else{s=new Uint8Array(9);const r=new DataView(s.buffer);r.setUint8(0,127),r.setBigUint64(1,BigInt(i))}n.data&&typeof n.data!="string"&&(s[0]|=128),t.enqueue(s),t.enqueue(e)})}})}let un;function ke(n){return n.reduce((t,e)=>t+e.length,0)}function Se(n,t){if(n[0].length===t)return n.shift();const e=new Uint8Array(t);let i=0;for(let s=0;s<t;s++)e[s]=n[0][i++],i===n[0].length&&(n.shift(),i=0);return n.length&&i<n[0].length&&(n[0]=n[0].slice(i)),e}function Mr(n,t){un||(un=new TextDecoder);const e=[];let i=0,s=-1,r=!1;return new TransformStream({transform(o,a){for(e.push(o);;){if(i===0){if(ke(e)<1)break;const u=Se(e,1);r=(u[0]&128)===128,s=u[0]&127,s<126?i=3:s===126?i=1:i=2}else if(i===1){if(ke(e)<2)break;const u=Se(e,2);s=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),i=3}else if(i===2){if(ke(e)<8)break;const u=Se(e,8),d=new DataView(u.buffer,u.byteOffset,u.length),c=d.getUint32(0);if(c>Math.pow(2,21)-1){a.enqueue(yn);break}s=c*Math.pow(2,32)+d.getUint32(4),i=3}else{if(ke(e)<s)break;const u=Se(e,s);a.enqueue(Kn(r?u:un.decode(u),t)),i=0}if(s===0||s>n){a.enqueue(yn);break}}}})}const fs=4;function G(n){if(n)return Lr(n)}function Lr(n){for(var t in G.prototype)n[t]=G.prototype[t];return n}G.prototype.on=G.prototype.addEventListener=function(n,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(t),this};G.prototype.once=function(n,t){function e(){this.off(n,e),t.apply(this,arguments)}return e.fn=t,this.on(n,e),this};G.prototype.off=G.prototype.removeListener=G.prototype.removeAllListeners=G.prototype.removeEventListener=function(n,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+n];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var i,s=0;s<e.length;s++)if(i=e[s],i===t||i.fn===t){e.splice(s,1);break}return e.length===0&&delete this._callbacks["$"+n],this};G.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+n],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(e){e=e.slice(0);for(var i=0,s=e.length;i<s;++i)e[i].apply(this,t)}return this};G.prototype.emitReserved=G.prototype.emit;G.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};G.prototype.hasListeners=function(n){return!!this.listeners(n).length};const Ze=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0),ft=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Nr="arraybuffer";function ds(n,...t){return t.reduce((e,i)=>(n.hasOwnProperty(i)&&(e[i]=n[i]),e),{})}const $r=ft.setTimeout,Br=ft.clearTimeout;function Qe(n,t){t.useNativeTimers?(n.setTimeoutFn=$r.bind(ft),n.clearTimeoutFn=Br.bind(ft)):(n.setTimeoutFn=ft.setTimeout.bind(ft),n.clearTimeoutFn=ft.clearTimeout.bind(ft))}const Pr=1.33;function Dr(n){return typeof n=="string"?Ir(n):Math.ceil((n.byteLength||n.size)*Pr)}function Ir(n){let t=0,e=0;for(let i=0,s=n.length;i<s;i++)t=n.charCodeAt(i),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(i++,e+=4);return e}function ps(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Vr(n){let t="";for(let e in n)n.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(n[e]));return t}function qr(n){let t={},e=n.split("&");for(let i=0,s=e.length;i<s;i++){let r=e[i].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}class jr extends Error{constructor(t,e,i){super(t),this.description=e,this.context=i,this.type="TransportError"}}class Jn extends G{constructor(t){super(),this.writable=!1,Qe(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,i){return super.emitReserved("error",new jr(t,e,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=Kn(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const e=Vr(t);return e.length?"?"+e:""}}class Fr extends Jn{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||e()})),this.writable||(i++,this.once("drain",function(){--i||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const e=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};Rr(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Cr(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=ps()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(t,e)}}let vs=!1;try{vs=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const zr=vs;function Ur(){}class Yr extends Fr{constructor(t){if(super(t),typeof location<"u"){const e=location.protocol==="https:";let i=location.port;i||(i=e?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||i!==t.port}}doWrite(t,e){const i=this.request({method:"POST",data:t});i.on("success",e),i.on("error",(s,r)=>{this.onError("xhr post error",s,r)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,i)=>{this.onError("xhr poll error",e,i)}),this.pollXhr=t}}class Tt extends G{constructor(t,e,i){super(),this.createRequest=t,Qe(this,i),this._opts=i,this._method=i.method||"GET",this._uri=e,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var t;const e=ds(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(e);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&i.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var s;i.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=Tt.requestsCount++,Tt.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Ur,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Tt.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Tt.requestsCount=0;Tt.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",bi);else if(typeof addEventListener=="function"){const n="onpagehide"in ft?"pagehide":"unload";addEventListener(n,bi,!1)}}function bi(){for(let n in Tt.requests)Tt.requests.hasOwnProperty(n)&&Tt.requests[n].abort()}const Hr=function(){const n=gs({xdomain:!1});return n&&n.responseType!==null}();class Xr extends Yr{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=Hr&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Tt(gs,this.uri(),t)}}function gs(n){const t=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||zr))return new XMLHttpRequest}catch{}if(!t)try{return new ft[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const ms=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Wr extends Jn{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,i=ms?{}:ds(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,i)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const i=t[e],s=e===t.length-1;Wn(i,this.supportsBinary,r=>{try{this.doWrite(i,r)}catch{}s&&Ze(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=ps()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const hn=ft.WebSocket||ft.MozWebSocket;class Kr extends Wr{createSocket(t,e,i){return ms?new hn(t,e,i):e?new hn(t,e):new hn(t)}doWrite(t,e){this.ws.send(e)}}class Jr extends Jn{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const e=Mr(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=t.readable.pipeThrough(e).getReader(),s=Or();s.readable.pipeTo(t.writable),this._writer=s.writable.getWriter();const r=()=>{i.read().then(({done:a,value:u})=>{a||(this.onPacket(u),r())}).catch(a=>{})};r();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const i=t[e],s=e===t.length-1;this._writer.write(i).then(()=>{s&&Ze(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const Zr={websocket:Kr,webtransport:Jr,polling:Xr},Qr=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Gr=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function wn(n){if(n.length>8e3)throw"URI too long";const t=n,e=n.indexOf("["),i=n.indexOf("]");e!=-1&&i!=-1&&(n=n.substring(0,e)+n.substring(e,i).replace(/:/g,";")+n.substring(i,n.length));let s=Qr.exec(n||""),r={},o=14;for(;o--;)r[Gr[o]]=s[o]||"";return e!=-1&&i!=-1&&(r.source=t,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=to(r,r.path),r.queryKey=eo(r,r.query),r}function to(n,t){const e=/\/{2,9}/g,i=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&i.splice(0,1),t.slice(-1)=="/"&&i.splice(i.length-1,1),i}function eo(n,t){const e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,s,r){s&&(e[s]=r)}),e}const bn=typeof addEventListener=="function"&&typeof removeEventListener=="function",Be=[];bn&&addEventListener("offline",()=>{Be.forEach(n=>n())},!1);class It extends G{constructor(t,e){if(super(),this.binaryType=Nr,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(e=t,t=null),t){const i=wn(t);e.hostname=i.host,e.secure=i.protocol==="https"||i.protocol==="wss",e.port=i.port,i.query&&(e.query=i.query)}else e.host&&(e.hostname=wn(e.host).host);Qe(this,e),this.secure=e.secure!=null?e.secure:typeof location<"u"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach(i=>{const s=i.prototype.name;this.transports.push(s),this._transportsByName[s]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=qr(this.opts.query)),bn&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Be.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=fs,e.transport=t,this.id&&(e.sid=this.id);const i=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&It.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",It.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let i=0;i<this.writeBuffer.length;i++){const s=this.writeBuffer[i].data;if(s&&(e+=Dr(s)),i>0&&e>this._maxPayload)return this.writeBuffer.slice(0,i);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Ze(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,e,i){return this._sendPacket("message",t,e,i),this}send(t,e,i){return this._sendPacket("message",t,e,i),this}_sendPacket(t,e,i,s){if(typeof e=="function"&&(s=e,e=void 0),typeof i=="function"&&(s=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const r={type:t,data:e,options:i};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),s&&this.once("flush",s),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},i=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}_onError(t){if(It.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),bn&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=Be.indexOf(this._offlineEventListener);i!==-1&&Be.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}It.protocol=fs;class no extends It{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),i=!1;It.priorWebsocketSuccess=!1;const s=()=>{i||(e.send([{type:"ping",data:"probe"}]),e.once("packet",l=>{if(!i)if(l.type==="pong"&&l.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;It.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(c(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=e.name,this.emitReserved("upgradeError",h)}}))};function r(){i||(i=!0,c(),e.close(),e=null)}const o=l=>{const h=new Error("probe error: "+l);h.transport=e.name,r(),this.emitReserved("upgradeError",h)};function a(){o("transport closed")}function u(){o("socket closed")}function d(l){e&&l.name!==e.name&&r()}const c=()=>{e.removeListener("open",s),e.removeListener("error",o),e.removeListener("close",a),this.off("close",u),this.off("upgrading",d)};e.once("open",s),e.once("error",o),e.once("close",a),this.once("close",u),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{i||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let i=0;i<t.length;i++)~this.transports.indexOf(t[i])&&e.push(t[i]);return e}}let io=class extends no{constructor(t,e={}){const i=typeof t=="object"?t:e;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(s=>Zr[s]).filter(s=>!!s)),super(t,i)}};function so(n,t="",e){let i=n;e=e||typeof location<"u"&&location,n==null&&(n=e.protocol+"//"+e.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=e.protocol+n:n=e.host+n),/^(https?|wss?):\/\//.test(n)||(typeof e<"u"?n=e.protocol+"//"+n:n="https://"+n),i=wn(n)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const r=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+r+":"+i.port+t,i.href=i.protocol+"://"+r+(e&&e.port===i.port?"":":"+i.port),i}const ro=typeof ArrayBuffer=="function",oo=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,_s=Object.prototype.toString,ao=typeof Blob=="function"||typeof Blob<"u"&&_s.call(Blob)==="[object BlobConstructor]",co=typeof File=="function"||typeof File<"u"&&_s.call(File)==="[object FileConstructor]";function Zn(n){return ro&&(n instanceof ArrayBuffer||oo(n))||ao&&n instanceof Blob||co&&n instanceof File}function Pe(n,t){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let e=0,i=n.length;e<i;e++)if(Pe(n[e]))return!0;return!1}if(Zn(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return Pe(n.toJSON(),!0);for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)&&Pe(n[e]))return!0;return!1}function lo(n){const t=[],e=n.data,i=n;return i.data=En(e,t),i.attachments=t.length,{packet:i,buffers:t}}function En(n,t){if(!n)return n;if(Zn(n)){const e={_placeholder:!0,num:t.length};return t.push(n),e}else if(Array.isArray(n)){const e=new Array(n.length);for(let i=0;i<n.length;i++)e[i]=En(n[i],t);return e}else if(typeof n=="object"&&!(n instanceof Date)){const e={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=En(n[i],t));return e}return n}function uo(n,t){return n.data=kn(n.data,t),delete n.attachments,n}function kn(n,t){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<t.length)return t[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let e=0;e<n.length;e++)n[e]=kn(n[e],t);else if(typeof n=="object")for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(n[e]=kn(n[e],t));return n}const ho=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],fo=5;var V;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(V||(V={}));class po{constructor(t){this.replacer=t}encode(t){return(t.type===V.EVENT||t.type===V.ACK)&&Pe(t)?this.encodeAsBinary({type:t.type===V.EVENT?V.BINARY_EVENT:V.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===V.BINARY_EVENT||t.type===V.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=lo(t),i=this.encodeAsString(e.packet),s=e.buffers;return s.unshift(i),s}}function Ei(n){return Object.prototype.toString.call(n)==="[object Object]"}class Qn extends G{constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const i=e.type===V.BINARY_EVENT;i||e.type===V.BINARY_ACK?(e.type=i?V.EVENT:V.ACK,this.reconstructor=new vo(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(Zn(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0;const i={type:Number(t.charAt(0))};if(V[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===V.BINARY_EVENT||i.type===V.BINARY_ACK){const r=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);const o=t.substring(r,e);if(o!=Number(o)||t.charAt(e)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(t.charAt(e+1)==="/"){const r=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););i.nsp=t.substring(r,e)}else i.nsp="/";const s=t.charAt(e+1);if(s!==""&&Number(s)==s){const r=e+1;for(;++e;){const o=t.charAt(e);if(o==null||Number(o)!=o){--e;break}if(e===t.length)break}i.id=Number(t.substring(r,e+1))}if(t.charAt(++e)){const r=this.tryParse(t.substr(e));if(Qn.isPayloadValid(i.type,r))i.data=r;else throw new Error("invalid payload")}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case V.CONNECT:return Ei(e);case V.DISCONNECT:return e===void 0;case V.CONNECT_ERROR:return typeof e=="string"||Ei(e);case V.EVENT:case V.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&ho.indexOf(e[0])===-1);case V.ACK:case V.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class vo{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const e=uo(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const go=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Qn,Encoder:po,get PacketType(){return V},protocol:fo},Symbol.toStringTag,{value:"Module"}));function wt(n,t,e){return n.on(t,e),function(){n.off(t,e)}}const mo=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});let ys=class extends G{constructor(t,e,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[wt(t,"open",this.onopen.bind(this)),wt(t,"packet",this.onpacket.bind(this)),wt(t,"error",this.onerror.bind(this)),wt(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var i,s,r;if(mo.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const o={type:V.EVENT,data:e};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const c=this.ids++,l=e.pop();this._registerAckCallback(c,l),o.id=c}const a=(s=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||s===void 0?void 0:s.writable,u=this.connected&&!(!((r=this.io.engine)===null||r===void 0)&&r._hasPingExpired());return this.flags.volatile&&!a||(u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,e){var i;const s=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(s===void 0){this.acks[t]=e;return}const r=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===t&&this.sendBuffer.splice(a,1);e.call(this,new Error("operation has timed out"))},s),o=(...a)=>{this.io.clearTimeoutFn(r),e.apply(this,a)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...e){return new Promise((i,s)=>{const r=(o,a)=>o?s(o):i(a);r.withError=!0,e.push(r),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((s,...r)=>i!==this._queue[0]?void 0:(s!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(s)):(this._queue.shift(),e&&e(null,...r)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:V.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(i=>String(i.id)===t)){const i=this.acks[t];delete this.acks[t],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case V.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case V.EVENT:case V.BINARY_EVENT:this.onevent(t);break;case V.ACK:case V.BINARY_ACK:this.onack(t);break;case V.DISCONNECT:this.ondisconnect();break;case V.CONNECT_ERROR:this.destroy();const i=new Error(t.data.message);i.data=t.data.data,this.emitReserved("connect_error",i);break}}onevent(t){const e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const i of e)i.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let i=!1;return function(...s){i||(i=!0,e.packet({type:V.ACK,id:t,data:s}))}}onack(t){const e=this.acks[t.id];typeof e=="function"&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:V.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const i of e)i.apply(this,t.data)}}};function ie(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}ie.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*n);n=Math.floor(t*10)&1?n+e:n-e}return Math.min(n,this.max)|0};ie.prototype.reset=function(){this.attempts=0};ie.prototype.setMin=function(n){this.ms=n};ie.prototype.setMax=function(n){this.max=n};ie.prototype.setJitter=function(n){this.jitter=n};class Sn extends G{constructor(t,e){var i;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,Qe(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((i=e.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new ie({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;const s=e.parser||go;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new io(this.uri,this.opts);const e=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const s=wt(e,"open",function(){i.onopen(),t&&t()}),r=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),t?t(a):this.maybeReconnectOnOpen()},o=wt(e,"error",r);if(this._timeout!==!1){const a=this._timeout,u=this.setTimeoutFn(()=>{s(),r(new Error("timeout")),e.close()},a);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(s),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(wt(t,"ping",this.onping.bind(this)),wt(t,"data",this.ondata.bind(this)),wt(t,"error",this.onerror.bind(this)),wt(t,"close",this.onclose.bind(this)),wt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){Ze(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let i=this.nsps[t];return i?this._autoConnect&&!i.active&&i.connect():(i=new ys(this,t,e),this.nsps[t]=i),i}_destroy(t){const e=Object.keys(this.nsps);for(const i of e)if(this.nsps[i].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let i=0;i<e.length;i++)this.engine.write(e[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(s=>{s?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",s)):t.onreconnect()}))},e);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const oe={};function ve(n,t){typeof n=="object"&&(t=n,n=void 0),t=t||{};const e=so(n,t.path||"/socket.io"),i=e.source,s=e.id,r=e.path,o=oe[s]&&r in oe[s].nsps,a=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let u;return a?u=new Sn(i,t):(oe[s]||(oe[s]=new Sn(i,t)),u=oe[s]),e.query&&!t.query&&(t.query=e.queryKey),u.socket(e.path,t)}Object.assign(ve,{Manager:Sn,Socket:ys,io:ve,connect:ve});class _o{constructor(){if(this.enabled=!1,typeof ve=="function"){const t=Je(Hn);this.socket=ve(t),this.socket&&(this.socket.on("connect",()=>{this.enabled=!0,console.log("Connected to websocket Obelix 1.0")}),this.socket.on("update_settings",e=>{console.log("SOCKETio",e),typeof e=="object"&&!Array.isArray(e)&&e!==null&&ne.update(i=>({...i,...e}))}))}}destroy(){this.socket.offAny(),this.socket.disconnect()}emit(t){this.enabled&&this.socket.emit("message",t)}emitReply(t,e){this.enabled&&(console.log("emitReply"),this.socket.emit("message_reply",t,(i,s)=>{console.log("emitReply response",i,s),typeof e=="function"&&e(s)}))}}const ws=new _o;function ut(n,t){ws.emit({get:"foo"}),fetch(Je(Hn)+n).then(e=>e.json()).then(e=>{typeof t=="function"&&t(e)})}function Ge(n,t,e){ws.emitReply({post:"foo"},e),fetch(Je(Hn)+n,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(i=>i.json()).then(i=>{e&&e(i)})}class Ft{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let i=0;for(let s=0;s<this._n&&s<32;s++){const r=e[s],o=t+r,a=Math.abs(t)<Math.abs(r)?t-(o-r):r-(o-t);a&&(e[i++]=a),t=o}return e[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let e=this._n,i,s,r,o=0;if(e>0){for(o=t[--e];e>0&&(i=o,s=t[--e],o=i+s,r=s-(o-i),!r););e>0&&(r<0&&t[e-1]<0||r>0&&t[e-1]>0)&&(s=r*2,i=o+s,s==i-o&&(o=i))}return o}}function*yo(n){for(const t of n)yield*t}function bs(n){return Array.from(yo(n))}function Wt(n,t,e){n=+n,t=+t,e=(s=arguments.length)<2?(t=n,n=0,1):s<3?1:+e;for(var i=-1,s=Math.max(0,Math.ceil((t-n)/e))|0,r=new Array(s);++i<s;)r[i]=n+i*e;return r}var q=1e-6,wo=1e-12,F=Math.PI,pt=F/2,ki=F/4,gt=F*2,Mt=180/F,ct=F/180,W=Math.abs,bo=Math.atan,Gt=Math.atan2,J=Math.cos,xe=Math.ceil,K=Math.sin,Eo=Math.sign||function(n){return n>0?1:n<0?-1:0},Vt=Math.sqrt;function ko(n){return n>1?0:n<-1?F:Math.acos(n)}function zt(n){return n>1?pt:n<-1?-pt:Math.asin(n)}function vt(){}function qe(n,t){n&&xi.hasOwnProperty(n.type)&&xi[n.type](n,t)}var Si={Feature:function(n,t){qe(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,i=-1,s=e.length;++i<s;)qe(e[i].geometry,t)}},xi={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,i=-1,s=e.length;++i<s;)n=e[i],t.point(n[0],n[1],n[2])},LineString:function(n,t){xn(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,i=-1,s=e.length;++i<s;)xn(e[i],t,0)},Polygon:function(n,t){Ti(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,i=-1,s=e.length;++i<s;)Ti(e[i],t)},GeometryCollection:function(n,t){for(var e=n.geometries,i=-1,s=e.length;++i<s;)qe(e[i],t)}};function xn(n,t,e){var i=-1,s=n.length-e,r;for(t.lineStart();++i<s;)r=n[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function Ti(n,t){var e=-1,i=n.length;for(t.polygonStart();++e<i;)xn(n[e],t,1);t.polygonEnd()}function Yt(n,t){n&&Si.hasOwnProperty(n.type)?Si[n.type](n,t):qe(n,t)}function Tn(n){return[Gt(n[1],n[0]),zt(n[2])]}function te(n){var t=n[0],e=n[1],i=J(e);return[i*J(t),i*K(t),K(e)]}function Te(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function je(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function fn(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function Ae(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function An(n){var t=Vt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function Cn(n,t){function e(i,s){return i=n(i,s),t(i[0],i[1])}return n.invert&&t.invert&&(e.invert=function(i,s){return i=t.invert(i,s),i&&n.invert(i[0],i[1])}),e}function Rn(n,t){return W(n)>F&&(n-=Math.round(n/gt)*gt),[n,t]}Rn.invert=Rn;function So(n,t,e){return(n%=gt)?t||e?Cn(Ci(n),Ri(t,e)):Ci(n):t||e?Ri(t,e):Rn}function Ai(n){return function(t,e){return t+=n,W(t)>F&&(t-=Math.round(t/gt)*gt),[t,e]}}function Ci(n){var t=Ai(n);return t.invert=Ai(-n),t}function Ri(n,t){var e=J(n),i=K(n),s=J(t),r=K(t);function o(a,u){var d=J(u),c=J(a)*d,l=K(a)*d,h=K(u),p=h*e+c*i;return[Gt(l*s-p*r,c*e-h*i),zt(p*s+l*r)]}return o.invert=function(a,u){var d=J(u),c=J(a)*d,l=K(a)*d,h=K(u),p=h*s-l*r;return[Gt(l*s+h*r,c*e+p*i),zt(p*e-c*i)]},o}function xo(n,t,e,i,s,r){if(e){var o=J(t),a=K(t),u=i*e;s==null?(s=t+i*gt,r=t-u/2):(s=Oi(o,s),r=Oi(o,r),(i>0?s<r:s>r)&&(s+=i*gt));for(var d,c=s;i>0?c>r:c<r;c-=u)d=Tn([o,-a*J(c),-a*K(c)]),n.point(d[0],d[1])}}function Oi(n,t){t=te(t),t[0]-=n,An(t);var e=ko(-t[1]);return((-t[2]<0?-e:e)+gt-q)%gt}function Es(){var n=[],t;return{point:function(e,i,s){t.push([e,i,s])},lineStart:function(){n.push(t=[])},lineEnd:vt,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}}function De(n,t){return W(n[0]-t[0])<q&&W(n[1]-t[1])<q}function Ce(n,t,e,i){this.x=n,this.z=t,this.o=e,this.e=i,this.v=!1,this.n=this.p=null}function ks(n,t,e,i,s){var r=[],o=[],a,u;if(n.forEach(function(f){if(!((b=f.length-1)<=0)){var b,_=f[0],E=f[b],w;if(De(_,E)){if(!_[2]&&!E[2]){for(s.lineStart(),a=0;a<b;++a)s.point((_=f[a])[0],_[1]);s.lineEnd();return}E[0]+=2*q}r.push(w=new Ce(_,f,null,!0)),o.push(w.o=new Ce(_,null,w,!1)),r.push(w=new Ce(E,f,null,!1)),o.push(w.o=new Ce(E,null,w,!0))}}),!!r.length){for(o.sort(t),Mi(r),Mi(o),a=0,u=o.length;a<u;++a)o[a].e=e=!e;for(var d=r[0],c,l;;){for(var h=d,p=!0;h.v;)if((h=h.n)===d)return;c=h.z,s.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(a=0,u=c.length;a<u;++a)s.point((l=c[a])[0],l[1]);else i(h.x,h.n.x,1,s);h=h.n}else{if(p)for(c=h.p.z,a=c.length-1;a>=0;--a)s.point((l=c[a])[0],l[1]);else i(h.x,h.p.x,-1,s);h=h.p}h=h.o,c=h.z,p=!p}while(!h.v);s.lineEnd()}}}function Mi(n){if(t=n.length){for(var t,e=0,i=n[0],s;++e<t;)i.n=s=n[e],s.p=i,i=s;i.n=s=n[0],s.p=i}}function dn(n){return W(n[0])<=F?n[0]:Eo(n[0])*((W(n[0])+F)%gt-F)}function To(n,t){var e=dn(t),i=t[1],s=K(i),r=[K(e),-J(e),0],o=0,a=0,u=new Ft;s===1?i=pt+q:s===-1&&(i=-pt-q);for(var d=0,c=n.length;d<c;++d)if(h=(l=n[d]).length)for(var l,h,p=l[h-1],f=dn(p),b=p[1]/2+ki,_=K(b),E=J(b),w=0;w<h;++w,f=y,_=R,E=B,p=v){var v=l[w],y=dn(v),k=v[1]/2+ki,R=K(k),B=J(k),O=y-f,S=O>=0?1:-1,C=S*O,x=C>F,I=_*R;if(u.add(Gt(I*S*K(C),E*B+I*J(C))),o+=x?O+S*gt:O,x^f>=e^y>=e){var L=je(te(p),te(v));An(L);var M=je(r,L);An(M);var m=(x^O>=0?-1:1)*zt(M[2]);(i>m||i===m&&(L[0]||L[1]))&&(a+=x^O>=0?1:-1)}}return(o<-q||o<q&&u<-wo)^a&1}function Ss(n,t,e,i){return function(s){var r=t(s),o=Es(),a=t(o),u=!1,d,c,l,h={point:p,lineStart:b,lineEnd:_,polygonStart:function(){h.point=E,h.lineStart=w,h.lineEnd=v,c=[],d=[]},polygonEnd:function(){h.point=p,h.lineStart=b,h.lineEnd=_,c=bs(c);var y=To(d,i);c.length?(u||(s.polygonStart(),u=!0),ks(c,Co,y,e,s)):y&&(u||(s.polygonStart(),u=!0),s.lineStart(),e(null,null,1,s),s.lineEnd()),u&&(s.polygonEnd(),u=!1),c=d=null},sphere:function(){s.polygonStart(),s.lineStart(),e(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function p(y,k){n(y,k)&&s.point(y,k)}function f(y,k){r.point(y,k)}function b(){h.point=f,r.lineStart()}function _(){h.point=p,r.lineEnd()}function E(y,k){l.push([y,k]),a.point(y,k)}function w(){a.lineStart(),l=[]}function v(){E(l[0][0],l[0][1]),a.lineEnd();var y=a.clean(),k=o.result(),R,B=k.length,O,S,C;if(l.pop(),d.push(l),l=null,!!B){if(y&1){if(S=k[0],(O=S.length-1)>0){for(u||(s.polygonStart(),u=!0),s.lineStart(),R=0;R<O;++R)s.point((C=S[R])[0],C[1]);s.lineEnd()}return}B>1&&y&2&&k.push(k.pop().concat(k.shift())),c.push(k.filter(Ao))}}return h}}function Ao(n){return n.length>1}function Co(n,t){return((n=n.x)[0]<0?n[1]-pt-q:pt-n[1])-((t=t.x)[0]<0?t[1]-pt-q:pt-t[1])}const Li=Ss(function(){return!0},Ro,Mo,[-F,-pt]);function Ro(n){var t=NaN,e=NaN,i=NaN,s;return{lineStart:function(){n.lineStart(),s=1},point:function(r,o){var a=r>0?F:-F,u=W(r-t);W(u-F)<q?(n.point(t,e=(e+o)/2>0?pt:-pt),n.point(i,e),n.lineEnd(),n.lineStart(),n.point(a,e),n.point(r,e),s=0):i!==a&&u>=F&&(W(t-i)<q&&(t-=i*q),W(r-a)<q&&(r-=a*q),e=Oo(t,e,r,o),n.point(i,e),n.lineEnd(),n.lineStart(),n.point(a,e),s=0),n.point(t=r,e=o),i=a},lineEnd:function(){n.lineEnd(),t=e=NaN},clean:function(){return 2-s}}}function Oo(n,t,e,i){var s,r,o=K(n-e);return W(o)>q?bo((K(t)*(r=J(i))*K(e)-K(i)*(s=J(t))*K(n))/(s*r*o)):(t+i)/2}function Mo(n,t,e,i){var s;if(n==null)s=e*pt,i.point(-F,s),i.point(0,s),i.point(F,s),i.point(F,0),i.point(F,-s),i.point(0,-s),i.point(-F,-s),i.point(-F,0),i.point(-F,s);else if(W(n[0]-t[0])>q){var r=n[0]<t[0]?F:-F;s=e*r/2,i.point(-r,s),i.point(0,s),i.point(r,s)}else i.point(t[0],t[1])}function Lo(n){var t=J(n),e=2*ct,i=t>0,s=W(t)>q;function r(c,l,h,p){xo(p,n,e,h,c,l)}function o(c,l){return J(c)*J(l)>t}function a(c){var l,h,p,f,b;return{lineStart:function(){f=p=!1,b=1},point:function(_,E){var w=[_,E],v,y=o(_,E),k=i?y?0:d(_,E):y?d(_+(_<0?F:-F),E):0;if(!l&&(f=p=y)&&c.lineStart(),y!==p&&(v=u(l,w),(!v||De(l,v)||De(w,v))&&(w[2]=1)),y!==p)b=0,y?(c.lineStart(),v=u(w,l),c.point(v[0],v[1])):(v=u(l,w),c.point(v[0],v[1],2),c.lineEnd()),l=v;else if(s&&l&&i^y){var R;!(k&h)&&(R=u(w,l,!0))&&(b=0,i?(c.lineStart(),c.point(R[0][0],R[0][1]),c.point(R[1][0],R[1][1]),c.lineEnd()):(c.point(R[1][0],R[1][1]),c.lineEnd(),c.lineStart(),c.point(R[0][0],R[0][1],3)))}y&&(!l||!De(l,w))&&c.point(w[0],w[1]),l=w,p=y,h=k},lineEnd:function(){p&&c.lineEnd(),l=null},clean:function(){return b|(f&&p)<<1}}}function u(c,l,h){var p=te(c),f=te(l),b=[1,0,0],_=je(p,f),E=Te(_,_),w=_[0],v=E-w*w;if(!v)return!h&&c;var y=t*E/v,k=-t*w/v,R=je(b,_),B=Ae(b,y),O=Ae(_,k);fn(B,O);var S=R,C=Te(B,S),x=Te(S,S),I=C*C-x*(Te(B,B)-1);if(!(I<0)){var L=Vt(I),M=Ae(S,(-C-L)/x);if(fn(M,B),M=Tn(M),!h)return M;var m=c[0],N=l[0],Y=c[1],H=l[1],rt;N<m&&(rt=m,m=N,N=rt);var z=N-m,et=W(z-F)<q,tt=et||z<q;if(!et&&H<Y&&(rt=Y,Y=H,H=rt),tt?et?Y+H>0^M[1]<(W(M[0]-m)<q?Y:H):Y<=M[1]&&M[1]<=H:z>F^(m<=M[0]&&M[0]<=N)){var ht=Ae(S,(-C+L)/x);return fn(ht,B),[M,Tn(ht)]}}}function d(c,l){var h=i?n:F-n,p=0;return c<-h?p|=1:c>h&&(p|=2),l<-h?p|=4:l>h&&(p|=8),p}return Ss(o,a,r,i?[0,-n]:[-F,n-F])}function No(n,t,e,i,s,r){var o=n[0],a=n[1],u=t[0],d=t[1],c=0,l=1,h=u-o,p=d-a,f;if(f=e-o,!(!h&&f>0)){if(f/=h,h<0){if(f<c)return;f<l&&(l=f)}else if(h>0){if(f>l)return;f>c&&(c=f)}if(f=s-o,!(!h&&f<0)){if(f/=h,h<0){if(f>l)return;f>c&&(c=f)}else if(h>0){if(f<c)return;f<l&&(l=f)}if(f=i-a,!(!p&&f>0)){if(f/=p,p<0){if(f<c)return;f<l&&(l=f)}else if(p>0){if(f>l)return;f>c&&(c=f)}if(f=r-a,!(!p&&f<0)){if(f/=p,p<0){if(f>l)return;f>c&&(c=f)}else if(p>0){if(f<c)return;f<l&&(l=f)}return c>0&&(n[0]=o+c*h,n[1]=a+c*p),l<1&&(t[0]=o+l*h,t[1]=a+l*p),!0}}}}}var ce=1e9,Re=-ce;function $o(n,t,e,i){function s(d,c){return n<=d&&d<=e&&t<=c&&c<=i}function r(d,c,l,h){var p=0,f=0;if(d==null||(p=o(d,l))!==(f=o(c,l))||u(d,c)<0^l>0)do h.point(p===0||p===3?n:e,p>1?i:t);while((p=(p+l+4)%4)!==f);else h.point(c[0],c[1])}function o(d,c){return W(d[0]-n)<q?c>0?0:3:W(d[0]-e)<q?c>0?2:1:W(d[1]-t)<q?c>0?1:0:c>0?3:2}function a(d,c){return u(d.x,c.x)}function u(d,c){var l=o(d,1),h=o(c,1);return l!==h?l-h:l===0?c[1]-d[1]:l===1?d[0]-c[0]:l===2?d[1]-c[1]:c[0]-d[0]}return function(d){var c=d,l=Es(),h,p,f,b,_,E,w,v,y,k,R,B={point:O,lineStart:I,lineEnd:L,polygonStart:C,polygonEnd:x};function O(m,N){s(m,N)&&c.point(m,N)}function S(){for(var m=0,N=0,Y=p.length;N<Y;++N)for(var H=p[N],rt=1,z=H.length,et=H[0],tt,ht,yt=et[0],Nt=et[1];rt<z;++rt)tt=yt,ht=Nt,et=H[rt],yt=et[0],Nt=et[1],ht<=i?Nt>i&&(yt-tt)*(i-ht)>(Nt-ht)*(n-tt)&&++m:Nt<=i&&(yt-tt)*(i-ht)<(Nt-ht)*(n-tt)&&--m;return m}function C(){c=l,h=[],p=[],R=!0}function x(){var m=S(),N=R&&m,Y=(h=bs(h)).length;(N||Y)&&(d.polygonStart(),N&&(d.lineStart(),r(null,null,1,d),d.lineEnd()),Y&&ks(h,a,m,r,d),d.polygonEnd()),c=d,h=p=f=null}function I(){B.point=M,p&&p.push(f=[]),k=!0,y=!1,w=v=NaN}function L(){h&&(M(b,_),E&&y&&l.rejoin(),h.push(l.result())),B.point=O,y&&c.lineEnd()}function M(m,N){var Y=s(m,N);if(p&&f.push([m,N]),k)b=m,_=N,E=Y,k=!1,Y&&(c.lineStart(),c.point(m,N));else if(Y&&y)c.point(m,N);else{var H=[w=Math.max(Re,Math.min(ce,w)),v=Math.max(Re,Math.min(ce,v))],rt=[m=Math.max(Re,Math.min(ce,m)),N=Math.max(Re,Math.min(ce,N))];No(H,rt,n,t,e,i)?(y||(c.lineStart(),c.point(H[0],H[1])),c.point(rt[0],rt[1]),Y||c.lineEnd(),R=!1):Y&&(c.lineStart(),c.point(m,N),R=!1)}w=m,v=N,y=Y}return B}}function Ni(n,t,e){var i=Wt(n,t-q,e).concat(t);return function(s){return i.map(function(r){return[s,r]})}}function $i(n,t,e){var i=Wt(n,t-q,e).concat(t);return function(s){return i.map(function(r){return[r,s]})}}function Bo(){var n,t,e,i,s,r,o,a,u=10,d=u,c=90,l=360,h,p,f,b,_=2.5;function E(){return{type:"MultiLineString",coordinates:w()}}function w(){return Wt(xe(i/c)*c,e,c).map(f).concat(Wt(xe(a/l)*l,o,l).map(b)).concat(Wt(xe(t/u)*u,n,u).filter(function(v){return W(v%c)>q}).map(h)).concat(Wt(xe(r/d)*d,s,d).filter(function(v){return W(v%l)>q}).map(p))}return E.lines=function(){return w().map(function(v){return{type:"LineString",coordinates:v}})},E.outline=function(){return{type:"Polygon",coordinates:[f(i).concat(b(o).slice(1),f(e).reverse().slice(1),b(a).reverse().slice(1))]}},E.extent=function(v){return arguments.length?E.extentMajor(v).extentMinor(v):E.extentMinor()},E.extentMajor=function(v){return arguments.length?(i=+v[0][0],e=+v[1][0],a=+v[0][1],o=+v[1][1],i>e&&(v=i,i=e,e=v),a>o&&(v=a,a=o,o=v),E.precision(_)):[[i,a],[e,o]]},E.extentMinor=function(v){return arguments.length?(t=+v[0][0],n=+v[1][0],r=+v[0][1],s=+v[1][1],t>n&&(v=t,t=n,n=v),r>s&&(v=r,r=s,s=v),E.precision(_)):[[t,r],[n,s]]},E.step=function(v){return arguments.length?E.stepMajor(v).stepMinor(v):E.stepMinor()},E.stepMajor=function(v){return arguments.length?(c=+v[0],l=+v[1],E):[c,l]},E.stepMinor=function(v){return arguments.length?(u=+v[0],d=+v[1],E):[u,d]},E.precision=function(v){return arguments.length?(_=+v,h=Ni(r,s,90),p=$i(t,n,_),f=Ni(a,o,90),b=$i(i,e,_),E):_},E.extentMajor([[-180,-90+q],[180,90-q]]).extentMinor([[-180,-80-q],[180,80+q]])}const On=n=>n;var pn=new Ft,Mn=new Ft,xs,Ts,Ln,Nn,Lt={point:vt,lineStart:vt,lineEnd:vt,polygonStart:function(){Lt.lineStart=Po,Lt.lineEnd=Io},polygonEnd:function(){Lt.lineStart=Lt.lineEnd=Lt.point=vt,pn.add(W(Mn)),Mn=new Ft},result:function(){var n=pn/2;return pn=new Ft,n}};function Po(){Lt.point=Do}function Do(n,t){Lt.point=As,xs=Ln=n,Ts=Nn=t}function As(n,t){Mn.add(Nn*n-Ln*t),Ln=n,Nn=t}function Io(){As(xs,Ts)}var ee=1/0,Fe=ee,ge=-ee,ze=ge,Ue={point:Vo,lineStart:vt,lineEnd:vt,polygonStart:vt,polygonEnd:vt,result:function(){var n=[[ee,Fe],[ge,ze]];return ge=ze=-(Fe=ee=1/0),n}};function Vo(n,t){n<ee&&(ee=n),n>ge&&(ge=n),t<Fe&&(Fe=t),t>ze&&(ze=t)}var $n=0,Bn=0,le=0,Ye=0,He=0,Kt=0,Pn=0,Dn=0,ue=0,Cs,Rs,St,xt,dt={point:Ut,lineStart:Bi,lineEnd:Pi,polygonStart:function(){dt.lineStart=Fo,dt.lineEnd=zo},polygonEnd:function(){dt.point=Ut,dt.lineStart=Bi,dt.lineEnd=Pi},result:function(){var n=ue?[Pn/ue,Dn/ue]:Kt?[Ye/Kt,He/Kt]:le?[$n/le,Bn/le]:[NaN,NaN];return $n=Bn=le=Ye=He=Kt=Pn=Dn=ue=0,n}};function Ut(n,t){$n+=n,Bn+=t,++le}function Bi(){dt.point=qo}function qo(n,t){dt.point=jo,Ut(St=n,xt=t)}function jo(n,t){var e=n-St,i=t-xt,s=Vt(e*e+i*i);Ye+=s*(St+n)/2,He+=s*(xt+t)/2,Kt+=s,Ut(St=n,xt=t)}function Pi(){dt.point=Ut}function Fo(){dt.point=Uo}function zo(){Os(Cs,Rs)}function Uo(n,t){dt.point=Os,Ut(Cs=St=n,Rs=xt=t)}function Os(n,t){var e=n-St,i=t-xt,s=Vt(e*e+i*i);Ye+=s*(St+n)/2,He+=s*(xt+t)/2,Kt+=s,s=xt*n-St*t,Pn+=s*(St+n),Dn+=s*(xt+t),ue+=s*3,Ut(St=n,xt=t)}function Ms(n){this._context=n}Ms.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:{this._context.moveTo(n,t),this._point=1;break}case 1:{this._context.lineTo(n,t);break}default:{this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,gt);break}}},result:vt};var In=new Ft,vn,Ls,Ns,he,fe,me={point:vt,lineStart:function(){me.point=Yo},lineEnd:function(){vn&&$s(Ls,Ns),me.point=vt},polygonStart:function(){vn=!0},polygonEnd:function(){vn=null},result:function(){var n=+In;return In=new Ft,n}};function Yo(n,t){me.point=$s,Ls=he=n,Ns=fe=t}function $s(n,t){he-=n,fe-=t,In.add(Vt(he*he+fe*fe)),he=n,fe=t}let Di,Xe,Ii,Vi;class qi{constructor(t){this._append=t==null?Bs:Ho(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:{this._append`M${t},${e}`,this._point=1;break}case 1:{this._append`L${t},${e}`;break}default:{if(this._append`M${t},${e}`,this._radius!==Ii||this._append!==Xe){const i=this._radius,s=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,Ii=i,Xe=this._append,Vi=this._,this._=s}this._+=Vi;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Bs(n){let t=1;this._+=n[0];for(const e=n.length;t<e;++t)this._+=arguments[t]+n[t]}function Ho(n){const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);if(t>15)return Bs;if(t!==Di){const e=10**t;Di=t,Xe=function(s){let r=1;this._+=s[0];for(const o=s.length;r<o;++r)this._+=Math.round(arguments[r]*e)/e+s[r]}}return Xe}function Xo(n,t){let e=3,i=4.5,s,r;function o(a){return a&&(typeof i=="function"&&r.pointRadius(+i.apply(this,arguments)),Yt(a,s(r))),r.result()}return o.area=function(a){return Yt(a,s(Lt)),Lt.result()},o.measure=function(a){return Yt(a,s(me)),me.result()},o.bounds=function(a){return Yt(a,s(Ue)),Ue.result()},o.centroid=function(a){return Yt(a,s(dt)),dt.result()},o.projection=function(a){return arguments.length?(s=a==null?(n=null,On):(n=a).stream,o):n},o.context=function(a){return arguments.length?(r=a==null?(t=null,new qi(e)):new Ms(t=a),typeof i!="function"&&r.pointRadius(i),o):t},o.pointRadius=function(a){return arguments.length?(i=typeof a=="function"?a:(r.pointRadius(+a),+a),o):i},o.digits=function(a){if(!arguments.length)return e;if(a==null)e=null;else{const u=Math.floor(a);if(!(u>=0))throw new RangeError(`invalid digits: ${a}`);e=u}return t===null&&(r=new qi(e)),o},o.projection(n).digits(e).context(t)}function Gn(n){return function(t){var e=new Vn;for(var i in n)e[i]=n[i];return e.stream=t,e}}function Vn(){}Vn.prototype={constructor:Vn,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function ti(n,t,e){var i=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),i!=null&&n.clipExtent(null),Yt(e,n.stream(Ue)),t(Ue.result()),i!=null&&n.clipExtent(i),n}function Ps(n,t,e){return ti(n,function(i){var s=t[1][0]-t[0][0],r=t[1][1]-t[0][1],o=Math.min(s/(i[1][0]-i[0][0]),r/(i[1][1]-i[0][1])),a=+t[0][0]+(s-o*(i[1][0]+i[0][0]))/2,u=+t[0][1]+(r-o*(i[1][1]+i[0][1]))/2;n.scale(150*o).translate([a,u])},e)}function Wo(n,t,e){return Ps(n,[[0,0],t],e)}function Ko(n,t,e){return ti(n,function(i){var s=+t,r=s/(i[1][0]-i[0][0]),o=(s-r*(i[1][0]+i[0][0]))/2,a=-r*i[0][1];n.scale(150*r).translate([o,a])},e)}function Jo(n,t,e){return ti(n,function(i){var s=+t,r=s/(i[1][1]-i[0][1]),o=-r*i[0][0],a=(s-r*(i[1][1]+i[0][1]))/2;n.scale(150*r).translate([o,a])},e)}var ji=16,Zo=J(30*ct);function Fi(n,t){return+t?Go(n,t):Qo(n)}function Qo(n){return Gn({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}})}function Go(n,t){function e(i,s,r,o,a,u,d,c,l,h,p,f,b,_){var E=d-i,w=c-s,v=E*E+w*w;if(v>4*t&&b--){var y=o+h,k=a+p,R=u+f,B=Vt(y*y+k*k+R*R),O=zt(R/=B),S=W(W(R)-1)<q||W(r-l)<q?(r+l)/2:Gt(k,y),C=n(S,O),x=C[0],I=C[1],L=x-i,M=I-s,m=w*L-E*M;(m*m/v>t||W((E*L+w*M)/v-.5)>.3||o*h+a*p+u*f<Zo)&&(e(i,s,r,o,a,u,x,I,S,y/=B,k/=B,R,b,_),_.point(x,I),e(x,I,S,y,k,R,d,c,l,h,p,f,b,_))}}return function(i){var s,r,o,a,u,d,c,l,h,p,f,b,_={point:E,lineStart:w,lineEnd:y,polygonStart:function(){i.polygonStart(),_.lineStart=k},polygonEnd:function(){i.polygonEnd(),_.lineStart=w}};function E(O,S){O=n(O,S),i.point(O[0],O[1])}function w(){l=NaN,_.point=v,i.lineStart()}function v(O,S){var C=te([O,S]),x=n(O,S);e(l,h,c,p,f,b,l=x[0],h=x[1],c=O,p=C[0],f=C[1],b=C[2],ji,i),i.point(l,h)}function y(){_.point=E,i.lineEnd()}function k(){w(),_.point=R,_.lineEnd=B}function R(O,S){v(s=O,S),r=l,o=h,a=p,u=f,d=b,_.point=v}function B(){e(l,h,c,p,f,b,r,o,s,a,u,d,ji,i),_.lineEnd=y,y()}return _}}var ta=Gn({point:function(n,t){this.stream.point(n*ct,t*ct)}});function ea(n){return Gn({point:function(t,e){var i=n(t,e);return this.stream.point(i[0],i[1])}})}function na(n,t,e,i,s){function r(o,a){return o*=i,a*=s,[t+n*o,e-n*a]}return r.invert=function(o,a){return[(o-t)/n*i,(e-a)/n*s]},r}function zi(n,t,e,i,s,r){if(!r)return na(n,t,e,i,s);var o=J(r),a=K(r),u=o*n,d=a*n,c=o/n,l=a/n,h=(a*e-o*t)/n,p=(a*t+o*e)/n;function f(b,_){return b*=i,_*=s,[u*b-d*_+t,e-d*b-u*_]}return f.invert=function(b,_){return[i*(c*b-l*_+h),s*(p-l*b-c*_)]},f}function ia(n){return sa(function(){return n})()}function sa(n){var t,e=150,i=480,s=250,r=0,o=0,a=0,u=0,d=0,c,l=0,h=1,p=1,f=null,b=Li,_=null,E,w,v,y=On,k=.5,R,B,O,S,C;function x(m){return O(m[0]*ct,m[1]*ct)}function I(m){return m=O.invert(m[0],m[1]),m&&[m[0]*Mt,m[1]*Mt]}x.stream=function(m){return S&&C===m?S:S=ta(ea(c)(b(R(y(C=m)))))},x.preclip=function(m){return arguments.length?(b=m,f=void 0,M()):b},x.postclip=function(m){return arguments.length?(y=m,_=E=w=v=null,M()):y},x.clipAngle=function(m){return arguments.length?(b=+m?Lo(f=m*ct):(f=null,Li),M()):f*Mt},x.clipExtent=function(m){return arguments.length?(y=m==null?(_=E=w=v=null,On):$o(_=+m[0][0],E=+m[0][1],w=+m[1][0],v=+m[1][1]),M()):_==null?null:[[_,E],[w,v]]},x.scale=function(m){return arguments.length?(e=+m,L()):e},x.translate=function(m){return arguments.length?(i=+m[0],s=+m[1],L()):[i,s]},x.center=function(m){return arguments.length?(r=m[0]%360*ct,o=m[1]%360*ct,L()):[r*Mt,o*Mt]},x.rotate=function(m){return arguments.length?(a=m[0]%360*ct,u=m[1]%360*ct,d=m.length>2?m[2]%360*ct:0,L()):[a*Mt,u*Mt,d*Mt]},x.angle=function(m){return arguments.length?(l=m%360*ct,L()):l*Mt},x.reflectX=function(m){return arguments.length?(h=m?-1:1,L()):h<0},x.reflectY=function(m){return arguments.length?(p=m?-1:1,L()):p<0},x.precision=function(m){return arguments.length?(R=Fi(B,k=m*m),M()):Vt(k)},x.fitExtent=function(m,N){return Ps(x,m,N)},x.fitSize=function(m,N){return Wo(x,m,N)},x.fitWidth=function(m,N){return Ko(x,m,N)},x.fitHeight=function(m,N){return Jo(x,m,N)};function L(){var m=zi(e,0,0,h,p,l).apply(null,t(r,o)),N=zi(e,i-m[0],s-m[1],h,p,l);return c=So(a,u,d),B=Cn(t,N),O=Cn(c,B),R=Fi(B,k),M()}function M(){return S=C=null,x}return function(){return t=n.apply(this,arguments),x.invert=t.invert&&I,L()}}function ra(n){return function(t,e){var i=Vt(t*t+e*e),s=n(i),r=K(s),o=J(s);return[Gt(t*r,i*o),zt(i&&e*r/i)]}}function Ds(n,t){return[J(t)*K(n),K(t)]}Ds.invert=ra(zt);function oa(){return ia(Ds).scale(249.5).clipAngle(90+q)}var aa=ye('<path fill="none" class="graticule svelte-1yv80ee" stroke-width="0.3"></path>');function Ui(n,t){it(t,!0);let e=U(0),i=U(0);const s=ne.subscribe(l=>{D(e,Q(l.deg_x)),D(i,Q(l.deg_y))});mt(()=>{s&&s()});const r=Bt(t,"scale",3,2e3),o=Bt(t,"steps",3,5),a=Bo().stepMajor([45,45]).stepMinor([o(),o()]);let u=Zt(()=>oa().scale(r()).rotate([-g(e),-g(i)]).translate([1080/2,810/2]).clipAngle(40)),d=Zt(()=>Xo().projection(g(u)));var c=aa();nt(()=>X(c,"d",g(d)(a()))),P(n,c),st()}function qn(n){return typeof n=="string"?n.toLowerCase().trim().replaceAll("ä","ae").replaceAll("ö","oe").replaceAll("ü","ue").replaceAll("ß","ss").replace(/\W+/g,"_").replace(/^_|_$/g,""):null}const Yi={fid:"",geo:{addr:"",lat:53.6,lon:9.9},base:[{id:"home",name:"Primary target",pos:{x:-23900,y:0,f:500}},{id:"polaris",name:"Polaris",pos:{x:0,y:11912,f:600}}]};function ca(n,t){const e={...Yi.geo,addr:t},i=[];for(let s of Yi.base)i.push({...s,pos:{...s.pos}});return{fid:n,geo:e,base:i}}function Hi(n){return Math.PI*n/180}function jn(n){return n*180/Math.PI}function la(n){const t=Je(ne).spr;let e=Math.round(t*n/360);return Math.abs(e)>t/2&&(e=e>0?e-t:e+t),e}function Oe(n){const t=jn(n);return la(t)}var ua=(n,t)=>t("A",n),ha=(n,t)=>t("B",n),fa=j('<div id="camera-stream" class="svelte-zqlhxu"><button id="telescope-stream"><svg class="svg-img svelte-zqlhxu" preserveAspectRatio="xMidYMid slice"><foreignObject class="img-wrap svelte-zqlhxu" x="0" y="0"><img alt="Telescope" class="svg-img svelte-zqlhxu"></foreignObject><!></svg></button> <button id="viewfinder-stream"><svg class="svg-img svelte-zqlhxu" preserveAspectRatio="xMidYMid slice"><foreignObject class="img-wrap svelte-zqlhxu" x="0" y="0"><img alt="Viewfinder" class="svg-img svelte-zqlhxu"></foreignObject><g><circle r="0.0001" fill="none" stroke="none"></circle><rect class="crosshair svelte-zqlhxu"></rect><!></g></svg></button></div>');function da(n,t){it(t,!0);const e=Rt(),i=()=>lt(br,"$locHost",e),s=()=>lt(Ne,"$swapPreview",e),r=()=>lt(Ie,"$displayCompass",e);let o=U(0),a=U(0);const u=1080,d=810;let c=U(void 0);const l=()=>{const z=g(c).getBoundingClientRect();return{x:g(h)==="B"?z.x:g(o)/2,y:g(h)==="B"?z.y:g(a)/2}};let h=U(void 0);const p=Ne.subscribe(z=>{D(h,Q(z))});let f=U(0),b=U(0);const _=ne.subscribe(z=>{D(f,Q(z.deg_x)),D(b,Q(z.deg_y))}),E=(z,et)=>{if(g(h)!==z)Ne.update(tt=>z);else{const tt=l(),ht=Math.max(g(o)/u,g(a)/d),yt={x:Math.round((et.clientX-tt.x)/ht),y:-1*Math.round((et.clientY-tt.y)/ht)},Nt=g(h)==="B"?w.SphereScaleVF:w.SphereScaleTel,be=Hi(g(b)),Vs=Hi(g(f)),tn=Math.sqrt(Math.pow(yt.x,2)+Math.pow(yt.y,2)),se=Math.asin(tn/Nt),en=Math.asin(Math.cos(se)*Math.sin(be)+yt.y*Math.sin(se)*Math.cos(be)/tn),nn=Vs+Math.atan(yt.x*Math.sin(se)/(tn*Math.cos(se)*Math.cos(be)-yt.y*Math.sin(se)*Math.sin(be)));console.log(`/goto/${Oe(nn)}/${Oe(en)}`),console.log("POS:",yt,jn(en),jn(nn),Oe(nn),Oe(en))}};let w=Q({CrosshairSize:.4,CrosshairOffsetX:0,CrosshairOffsetY:0,SphereScaleVF:1500,SphereScaleTel:24e3}),v=pe.subscribe(z=>{for(let et of z)w[et.id]=et.value}),y=U("starfield-zoom.jpg"),k=U("starfield.jpg");we(()=>{D(y,`${i()}:7777/stream_a.mjpg`),D(k,`${i()}:7777/stream_b.mjpg`),ut("/config/sphere/settings",z=>{console.log("MOUNT ",z),pe.update(et=>et.map(tt=>tt!=null&&tt.id&&Object.hasOwn(z,tt.id)?{...tt,value:z[tt.id]}:{...tt}))})}),mt(()=>{p&&p(),v&&v(),_&&_()});var R=fa(),B=A(R);B.__click=[ua,E];var O=A(B);X(O,"viewBox",`0 0 ${u} ${d}`);var S=A(O);X(S,"width",u),X(S,"height",d);var C=A(S);T(S);var x=$(S);Z(x,r,z=>{Ui(z,{get scale(){return w.SphereScaleTel},steps:"1",get width(){return g(o)},get height(){return g(a)}})}),T(O),T(B);var I=$(B,2);I.__click=[ha,E];var L=A(I);X(L,"viewBox",`0 0 ${u} ${d}`);var M=A(L);X(M,"width",u),X(M,"height",d);var m=A(M);T(M);var N=$(M),Y=A(N);X(Y,"cx",u/2),X(Y,"cy",d/2),hr(Y,z=>D(c,z),()=>g(c));var H=$(Y);X(H,"x",u/2),X(H,"y",d/2);var rt=$(H);Z(rt,r,z=>{Ui(z,{get scale(){return w.SphereScaleVF},steps:"5",get width(){return g(o)},get height(){return g(a)}})}),T(N),T(L),T(I),T(R),nt(()=>{At(B,`stream-wrapper ${(s()==="A"?"large":"")??""} svelte-zqlhxu`),X(O,"width",g(o)),X(O,"height",g(a)),X(C,"src",g(y)),At(I,`stream-wrapper ${(s()==="B"?"large":"")??""} svelte-zqlhxu`),X(L,"width",g(o)),X(L,"height",g(a)),X(m,"src",g(k)),X(N,"transform",`translate(${u/4*w.CrosshairOffsetX} ${d/4*w.CrosshairOffsetY})`),X(H,"transform",`translate(${g(o)*w.CrosshairSize*-.5} ${g(a)*w.CrosshairSize*-.5})`),X(H,"width",g(o)*w.CrosshairSize),X(H,"height",g(a)*w.CrosshairSize)}),mi(R,"clientWidth",z=>D(o,z)),mi(R,"clientHeight",z=>D(a,z)),P(n,R),st()}at(["click"]);var pa=j('<div class="layer svelte-qmdbdl"><!></div>'),va=j('<div class="visuals svelte-qmdbdl"><!> <!></div>');function ga(n){const t=Rt(),e=()=>lt(Ie,"$displayCompass",t);var i=va(),s=A(i);da(s,{});var r=$(s,2);Z(r,e,o=>{var a=pa(),u=A(a);kr(u,{}),T(a),P(o,a)}),T(i),P(n,i)}class ma{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=200,this.deadZone=8,this.active=!1,this.value={x:0,y:0},this.counter=0,this.prev={x:0,y:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",i=>{this._handleDown(i)}),this.stick.addEventListener("touchstart",i=>{this._handleDown(i)}),document.addEventListener("mousemove",i=>{this._handleMove(i)},{passive:!1}),document.addEventListener("touchmove",i=>{this._handleMove(i)},{passive:!1}),document.addEventListener("mouseup",i=>{this._handleUp(i)}),document.addEventListener("touchend",i=>{this._handleUp(i)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.clientX,y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;let e=null;if(t.changedTouches){for(let _=0;_<t.changedTouches.length;_++)this.touchId===t.changedTouches[_].identifier&&(e=_,t.clientX=t.changedTouches[_].clientX,t.clientY=t.changedTouches[_].clientY);if(e==null)return}const i=this.stick.getBoundingClientRect(),s=i?Math.round(16e3/i.width)/100:1,r=t.clientX-this.dragStart.x,o=t.clientY-this.dragStart.y,a=Math.atan2(o,r),u=Math.min(this.maxDistance,Math.hypot(r,o)*s),d=u*Math.cos(a),c=u*Math.sin(a);this.stick.style.transform=`translate(${d}px, ${c}px)`;const l=u<this.deadZone?0:this.maxDistance/(this.maxDistance-this.deadZone)*(u-this.deadZone),h=l*Math.cos(a),p=l*Math.sin(a),f=parseFloat((h/this.maxDistance).toFixed(4)),b=parseFloat((p/this.maxDistance).toFixed(4));this.value={x:f,y:b},this._loop()}_handleUp(t){this.active&&(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier||(this.stick.style.transition=".2s",this.stick.style.transform="translate3d(0px, 0px, 0px)",this.value={x:0,y:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5+this.value.x*511.5),e=Math.round(511.5+this.value.y*511.5);this.callback(`/joystick/${t}/${e}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){(this.value.x!==this.prev.x||this.value.y!==this.prev.y)&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}class _a{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=230,this.deadZone=8,this.active=!1,this.value={f:0},this.counter=0,this.prev={f:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",i=>{this._handleDown(i)}),this.stick.addEventListener("touchstart",i=>{this._handleDown(i)}),document.addEventListener("mousemove",i=>{this._handleMove(i)},{passive:!1}),document.addEventListener("touchmove",i=>{this._handleMove(i)},{passive:!1}),document.addEventListener("mouseup",i=>{this._handleUp(i)}),document.addEventListener("touchend",i=>{this._handleUp(i)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{y:t.changedTouches[0].clientY}:{y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;t.preventDefault();let e=null;if(t.changedTouches){for(let u=0;u<t.changedTouches.length;u++)this.touchId===t.changedTouches[u].identifier&&(e=u,t.clientY=t.changedTouches[u].clientY);if(e==null)return}const i=this.stick.getBoundingClientRect(),s=i?Math.round(1e4/i.width)/100:1,r=t.clientY-this.dragStart.y,o=r>=0?Math.min(this.maxDistance,r*s):Math.max(-this.maxDistance,r*s);this.stick.style.transform=`translateY(${o}px)`;const a=Math.abs(o)>this.deadZone?parseFloat((o/this.maxDistance).toFixed(4)):0;this.value={f:a},this._loop()}_handleUp(t){this.active&&(t.preventDefault(),!(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier)&&(this.stick.style.transition=".2s",this.stick.style.transform="translateY(0px)",this.value={f:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5-this.value.f*511.5);this.callback(`/focus/${t}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){this.value.f!==this.prev.f&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}var ya=ye('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-1jgdvgh"><defs><circle id="joys-def-cir2" r="80" cy="0"></circle><path id="joys-def-arrow" d="M0 -120 -40 -100 40 -100z"></path><rect id="joys-def-slide" width="100" height="100" transform="translate(335 -50)" rx="15" ry="15"></rect></defs><g id="joys" transform="translate(320 355)" class="svelte-1jgdvgh"><use id="joys-arrow-top" href="#joys-def-arrow" class="svelte-1jgdvgh"></use><use id="joys-arrow-right" href="#joys-def-arrow" transform="rotate(90)" class="svelte-1jgdvgh"></use><use id="joys-arrow-left" href="#joys-def-arrow" transform="rotate(-90)" class="svelte-1jgdvgh"></use><use id="joys-arrow-bottom" href="#joys-def-arrow" transform="rotate(180)" class="svelte-1jgdvgh"></use><use id="joys-stick" href="#joys-def-cir2" style="transform: translate(0px, 0px)" class="svelte-1jgdvgh"></use><use id="joys-arrow-top" href="#joys-def-arrow" transform="translate(385 30)" class="svelte-1jgdvgh"></use><use id="joys-arrow-top" href="#joys-def-arrow" transform="translate(385 -30) rotate(180)" class="svelte-1jgdvgh"></use><use id="joys-slide" href="#joys-def-slide" style="transform: translateY(0px)" class="svelte-1jgdvgh"></use><a href="#toggle" role="button" tabindex="0" aria-label="Change to adjustment tool"><g id="joys-swap" transform="translate(-250,250)" class="svelte-1jgdvgh"><circle class="element svelte-1jgdvgh" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M6.121 13c-.553 0-1 .448-1 1s.447 1 1 1h1.465l-3.293 3.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.414-3.414v1.707c0 .552.447 1 1 1s.879-.448.879-1v-5h-4.879zM7 11c.552 0 1-.448 1-1v-2h2c.553 0 1-.448 1-1s-.447-1-1-1h-3.999l-.001 4c0 .552.447 1 1 1zM17 13c-.553 0-1 .448-1 1v2h-2c-.553 0-1 .448-1 1s.447 1 1 1h4v-4c0-.552-.447-1-1-1zM18.293 4.293l-3.293 3.293v-1.586c0-.552-.447-1-1-1s-1 .448-1 1v5h5c.552 0 1-.448 1-1s-.447-1-1-1h-1.586l3.293-3.292c.391-.391.391-1.023 0-1.414s-1.023-.392-1.414-.001z" class="svelte-1jgdvgh"></path></g></g></a></g></svg>');function wa(n,t){it(t,!0);let e=null,i=null;we(()=>{e=new ma(document.getElementById("joys-stick"),a=>{ut(a,u=>{console.log("SVELTE Joystick",u)})}),i=new _a(document.getElementById("joys-slide"),a=>{ut(a,u=>{console.log("SVELTE Focus",u)})})}),mt(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy(),i&&i.hasOwnProperty("destroy")&&i.destroy()});var s=ya(),r=$(A(s)),o=$(A(r),8);o.__click=function(...a){var u;(u=t.toggle)==null||u.apply(this,a)},T(r),T(s),P(n,s),st()}at(["click"]);class ba{constructor(t,e){if(this.adjust=t,this.adjust){this.callback=e;const i=8e4/360;this.axisSteps={lg:Math.round(i),md:Math.round(i/10),sm:Math.round(i/100)},this.adjust.addEventListener("mouseup",s=>{this.sendCommand(s.target.dataset)})}}destroy(){this.adjust.removeEventListener("mouseup",t=>{this.sendCommand(t.target.dataset)})}sendCommand(t){let e=t==null?void 0:t.dir,i=t==null?void 0:t.len;e&&i&&typeof this.axisSteps[i]=="number"&&(i=this.axisSteps[i],["closer","further"].indexOf(e)>=0&&(i=e==="closer"?-i:i,e="focus"),this.callback(`/adjust/${e}/${i}`))}}var Ea=ye('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-cf79tv"><defs><path id="arr1" d="M0 -80 40 -60 40 0 0 -20 -40 0 -40 -60z"></path><path id="arr2" d="M95 95 70 95 70 165 165 165 165 70 95 70z"></path><path id="arr3" d="M165 165 130 165 130 245 245 245 245 130 165 130z"></path><circle id="cir1" r="40" cy="30"></circle><circle id="cir2" r="50" cy="120"></circle><circle id="cir3" r="60" cy="230"></circle><path id="cir3" d="M-85 125 A 108 108 0 1 0 85 125 A 54 54 0 0 1 -85 125z"></path></defs><g id="adjust" transform="translate(355 355)" class="svelte-cf79tv"><g transform="rotate(0)"><use href="#arr1" transform="translate(0 -50)" data-dir="up" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="up" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="up" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(90)"><use href="#arr1" transform="translate(0 -50)" data-dir="right" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="right" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="right" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(180)"><use href="#arr1" transform="translate(0 -50)" data-dir="down" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="down" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="down" data-len="lg" class="svelte-cf79tv"></use></g><g transform="rotate(270)"><use href="#arr1" transform="translate(0 -50)" data-dir="left" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="left" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="left" data-len="lg" class="svelte-cf79tv"></use></g><g transform="translate(360 0)"><use href="#arr1" transform="translate(0 -50)" data-dir="further" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="further" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="further" data-len="lg" class="svelte-cf79tv"></use></g><g transform="translate(360 0) rotate(180)"><use href="#arr1" transform="translate(0 -50)" data-dir="closer" data-len="sm" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -120)" data-dir="closer" data-len="md" class="svelte-cf79tv"></use><use href="#arr1" transform="translate(0 -190)" data-dir="closer" data-len="lg" class="svelte-cf79tv"></use></g><a href="#toggle" role="button" tabindex="0" aria-label="Change to Joystick"><g id="joys-swap" transform="translate(-285,250)" class="svelte-cf79tv"><circle class="element svelte-cf79tv" r="36"></circle><g transform="translate(-30,-30) scale(2.5)"><path id="joys-swap" d="M17.707 8.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l1.293 1.293h-4.586v-4.586l1.293 1.293c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-3.707-3.707-3.707 3.707c-.391.391-.391 1.023 0 1.414s1.023.391 1.414 0l1.293-1.293v4.586h-4.586l1.293-1.293c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-3.707 3.707 3.707 3.707c.195.195.451.293.707.293s.512-.098.707-.293c.391-.391.391-1.023 0-1.414l-1.293-1.293h4.586v4.586l-1.293-1.293c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l3.707 3.707 3.707-3.707c.391-.391.391-1.023 0-1.414s-1.023-.391-1.414 0l-1.293 1.293v-4.586h4.586l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707z" class="svelte-cf79tv"></path></g></g></a></g></svg>');function ka(n,t){it(t,!0);let e=null;we(()=>{e=new ba(document.getElementById("adjust"),o=>{ut(o,a=>{console.log("SVELTE Adjust",a)})})}),mt(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy()});var i=Ea(),s=$(A(i)),r=$(A(s),6);r.__click=function(...o){var a;(a=t.toggle)==null||a.apply(this,o)},T(s),T(i),P(n,i),st()}at(["click"]);var Sa=j('<div class="joystick-wrapper svelte-gruxg2"><!></div>');function xa(n){let t=U("mov");const e=r=>{r.preventDefault(),D(t,Q(g(t)==="mov"?"adj":"mov"))};var i=Sa(),s=A(i);Z(s,()=>g(t)==="mov",r=>{wa(r,{toggle:e})},r=>{ka(r,{toggle:e})}),T(i),P(n,i)}var Ta=(n,t)=>{D(t,!1)},Aa=j('<header><input type="text" id="address" placeholder="Address"></header> <div class="flexbox"><input type="text" id="latitude" placeholder="Latitude"> <input type="text" id="longitude" placeholder="Longitude"></div> <button class="button button-small">Save location</button> <button class="button">Cancel</button>',1),Ca=(n,t)=>{D(t,!0)},Ra=j('<header> <button class="edit-button icon-edit" aria-label="Edit"></button></header>'),Oa=j("<div> </div>"),Ma=j("<!> <!>",1),La=(n,t,e)=>t(n,`/navi/position/${g(e).id}`),Na=(n,t,e)=>t(g(e).id),$a=j('<button class="delete-button icon-delete" aria-label="Delete" title="Delete"></button>'),Ba=j("<li><button> </button> <!></li>"),Pa=j('<div class="nav-add"><label for="new-name">Save/update current position as ...</label> <input type="text" id="new-name" class="input" placeholder="Enter position name"> <div class="margin-bottom"><sub> </sub></div> <button class="button button-small">Save target</button></div>'),Da=j('<div class="nav-selector"><button class="button button-small">Change location</button></div>'),Ia=j('<div class="content-card"><div class="nav-curr-pos"><!></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function Va(n,t){it(t,!0);const e=Rt(),i=()=>lt(kt,"$positions",e),s=()=>lt(ne,"$arduinoSettings",e);let r=U(!1),o=U(""),a=Zt(()=>qn(g(o))),u=U(""),d=U(""),c=U(""),l=U(Q([]));const h=kt.subscribe(S=>{S!=null&&S.fid&&(D(u,Q(S.geo.addr)),D(d,Q(S.geo.lat)),D(c,Q(S.geo.lon)),D(l,Q([...S.base])))});mt(()=>{h&&h()});const p=()=>{const S={...i()};Ge(`/navi/position/update/${S.fid}`,S,C=>{console.log("SVELTE saved",C)})},f=()=>{const S={addr:g(u),lat:parseFloat(g(d)),lon:parseFloat(g(c))};kt.update(C=>({...C,geo:S})),p(),D(r,!1)},b=()=>{const S=qn(g(o));if(S){let C=!1;const x=(({x:L,y:M,f:m})=>({x:L,y:M,f:m}))(s());let I=g(l).map(L=>L.id!==S?L:(C=!0,{...L,pos:x}));C||I.push({id:S,name:g(o),pos:x}),kt.update(L=>({...L,base:I})),p(),D(o,"")}D(r,!1)},_=S=>S==="home"?"icon-home":S==="polaris"?"icon-star":"icon-target",E=S=>{if(confirm(`Do you really want to delete position: "${S}"`)){const C=[...i().base].filter(x=>x.id!==S);kt.update(x=>({...x,base:C})),p(),D(r,!1)}},w=(S,C)=>{S.preventDefault(),ut(C,x=>{console.log("SVELTE position",x)})};var v=Ia(),y=A(v),k=A(y);Z(k,()=>g(r),S=>{var C=Aa(),x=bt(C),I=A(x);Ht(I),T(x);var L=$(x,2),M=A(L);Ht(M);var m=$(M,2);Ht(m),T(L);var N=$(L,2);N.__click=f;var Y=$(N,2);Y.__click=[Ta,r],Xt(I,()=>g(u),H=>D(u,H)),Xt(M,()=>g(d),H=>D(d,H)),Xt(m,()=>g(c),H=>D(c,H)),P(S,C)},S=>{var C=Ma(),x=bt(C);Z(x,()=>g(u),L=>{var M=Ra(),m=A(M),N=$(m);N.__click=[Ca,r],T(M),nt(()=>Et(m,`${g(u)??""} `)),P(L,M)});var I=$(x,2);Z(I,()=>g(d)&&g(c),L=>{var M=Oa(),m=A(M);T(M),nt(()=>Et(m,`${g(d)??""}°, ${g(c)??""}°`)),P(L,M)}),P(S,C)}),T(y);var R=$(y,2),B=A(R);jt(B,21,()=>g(l),Qt,(S,C)=>{var x=Ba(),I=A(x);const L=Zt(()=>`nav-button ${_(g(C).id)??""}`);I.__click=[La,w,C];var M=A(I,!0);T(I);var m=$(I,2);Z(m,()=>g(r)&&g(C).id!=="home"&&g(C).id!=="polaris",N=>{var Y=$a();Y.__click=[Na,E,C],P(N,Y)}),T(x),nt(()=>{At(I,g(L)),Et(M,g(C).name)}),P(S,x)}),T(B),T(R);var O=$(R,2);Z(O,()=>g(r),S=>{var C=Pa(),x=$(A(C),2);Ht(x);var I=$(x,2),L=A(I),M=A(L);T(L),T(I);var m=$(I,2);m.__click=b,T(C),nt(()=>{Et(M,`ID: ${g(a)??""}`),m.disabled=g(a).length<3}),Xt(x,()=>g(o),N=>D(o,N)),P(S,C)},S=>{var C=Da(),x=A(C);x.__click=function(...I){var L;(L=t.toggleAdmin)==null||L.apply(this,I)},T(C),P(S,C)}),T(v),P(n,v),st()}at(["click"]);const qa=(n,t)=>{D(t,!g(t))};var ja=(n,t,e)=>t(g(e).fid),Fa=(n,t,e)=>t(g(e).fid),za=j('<button class="delete-button icon-delete" aria-label="Delete"></button>'),Ua=j('<li><button class="nav-button icon-location"> </button> <!></li>'),Ya=(n,t)=>t(),Ha=j('<div class="nav-add"><input type="text" id="new-location" class="input" placeholder="Enter new location name"> <button class="button">+&nbsp;Add</button></div> <div> </div>',1),Xa=j('<div class="nav-selector"><button class="button button-small">&laquo;&nbsp;Back</button></div>'),Wa=j('<div class="content-card"><header>Locations <button aria-label="Edit"></button></header> <div class="nav-curr-pos"><div><p>The location is the place where your telescope is placed.</p></div></div> <div class="nav-list"><ul class="icon-nav"></ul></div> <!></div>');function Ka(n,t){it(t,!0);const e=Rt(),i=()=>lt(Ee,"$locations",e);let s=U("");const r=kt.subscribe(w=>{D(s,Q(w.fid))});mt(()=>{r&&r()});let o=U(!1),a=U(""),u=Zt(()=>qn(g(a)));const d=w=>{w!==g(s)&&ut(`/navi/location/${w}`,v=>{(v==null?void 0:v.fid)===w&&(kt.update(y=>({...v})),console.log("Loaded location"))})},c=()=>{if(g(u).length>=3){const w=ca(g(u),g(a));Ge(`/navi/position/update/${g(u)}`,w,v=>{kt.update(y=>w),Ee.update(y=>[...y,{fid:g(u),addr:g(a)}]),D(a,""),console.log("Added new location",v)})}else console.error("ID is too short. At least 3 char are required.")},l=w=>{confirm(`Do you really want to delete location: "${w}"`)?ut(`/navi/location/delete/${w}`,v=>{v.response===200&&(Ee.update(y=>y.filter(k=>k.fid!==w)),alert(`Location "${w}" deleted`))}):alert(`Deletion of "${w}" canceled.`)};we(()=>{i().length===0&&ut("/navi/location-list",w=>{Ee.update(v=>[...w]),console.log("Loaded location list")})});var h=Wa(),p=A(h),f=$(A(p));f.__click=[qa,o],T(p);var b=$(p,4),_=A(b);jt(_,5,i,Qt,(w,v)=>{var y=Ua(),k=A(y);k.__click=[ja,d,v];var R=A(k,!0);T(k);var B=$(k,2);Z(B,()=>g(o)&&g(v).fid!==g(s)&&g(v).fid!=="index",O=>{var S=za();S.__click=[Fa,l,v],P(O,S)}),T(y),nt(()=>{At(y,g(v).fid===g(s)?"active":""),Et(R,g(v).addr)}),P(w,y)}),T(_),T(b);var E=$(b,2);Z(E,()=>g(o),w=>{var v=Ha(),y=bt(v),k=A(y);Ht(k);var R=$(k,2);R.__click=[Ya,c],T(y);var B=$(y,2),O=A(B,!0);T(B),nt(()=>Et(O,g(u))),Xt(k,()=>g(a),S=>D(a,S)),P(w,v)},w=>{var v=Xa(),y=A(v);y.__click=function(...k){var R;(R=t.toggleAdmin)==null||R.apply(this,k)},T(v),P(w,v)}),T(h),nt(()=>At(f,`edit-button icon-edit${(g(o)?" active":"")??""}`)),P(n,h),st()}at(["click"]);function Ja(n,t){it(t,!0);const e=Rt(),i=()=>lt(kt,"$positions",e);let s=U(!1);const r=()=>{D(s,!g(s))};we(()=>{var u;(u=i())!=null&&u.fid||ut("/navi/location/index",d=>{(d==null?void 0:d.fid)==="index"&&kt.update(c=>({...d}))})});var o=$t(),a=bt(o);Z(a,()=>g(s),u=>{Ka(u,{toggleAdmin:r})},u=>{Va(u,{toggleAdmin:r})}),P(n,o),st()}var Za=(n,t,e,i)=>{t()(e.id,i())},Qa=(n,t,e,i)=>{t()(e.id,i())},Ga=j('<div class="slider-wrapper svelte-1qw7onx"><label class="svelte-1qw7onx"> </label> <input type="range" class="svelte-1qw7onx"></div>');function Is(n,t){it(t,!0);let e=Bt(t,"oninput",3,()=>{}),i=Bt(t,"onchange",3,()=>{}),s=Bt(t,"value",7,0),r=Bt(t,"minValue",3,0),o=Bt(t,"maxValue",3,10),a=Bt(t,"steps",3,1);var u=Ga(),d=A(u),c=A(d,!0);T(d);var l=$(d,2);Ht(l),l.__change=[Za,i,t,s],l.__input=[Qa,e,t,s],T(u),nt(()=>{X(d,"for","slider_slide_"+t.id),Et(c,t.name),X(l,"id","slider_slide_"+t.id),X(l,"min",r()),X(l,"max",o()),X(l,"step",a())}),Xt(l,s),P(n,u),st()}at(["change","input"]);var tc=j('<div class="camera-options svelte-1x08sfe"><!> <div class="actions-wrapper svelte-1x08sfe"><button class="svelte-1x08sfe">Reset defaults</button></div></div>');function ec(n,t){it(t,!1);const e=Rt(),i=()=>lt(cn,"$camControls",e),s=(c,l)=>{cn.update(h=>h.map(p=>p.id===c?{...p,value:l}:{...p})),ut(`/cam/ctrl/${c}/${l}`,h=>{console.log("SVELTE CamCtrl",h)})},r=()=>{cn.update(l=>l.map(h=>({...h,value:h.defaultValue})));const c={};for(let l of i())l!=null&&l.id&&(c[l.id]=l.defaultValue);Ge("/cam/controls",c,l=>{console.log("SVELTE Cam Controls",l)})};es();var o=tc(),a=A(o);jt(a,3,i,c=>c.name,(c,l,h)=>{Is(c,ts(()=>g(l),{get index(){return g(h)},onchange:s}))});var u=$(a,2),d=A(u);d.__click=r,T(u),T(o),P(n,o),st()}at(["click"]);const nc=()=>{Ve.update(n=>!n)};var ic=ye('<polygon points="-15,-15 -15,15 15,15 15,-15" stroke-width="5" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),sc=ye('<polygon points="-7.5,-22.5 -7.5,22.5 20,0" stroke-width="10" fill="#C00" stroke="#C00" stroke-linejoin="round"></polygon>'),rc=j('<div id="video-recording" class="svelte-1h8ia9r"><button aria-label="Record video" class="svelte-1h8ia9r"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" preserveAspectRatio="xMinYMin slice" class="svelte-1h8ia9r"><g transform="translate(42,42)"><circle r="38" stroke-width="5" class="svelte-1h8ia9r"></circle><!></g></svg></button></div>');function oc(n,t){it(t,!0);let e=U(!1);const i=Ve.subscribe(d=>{if(g(e)!==d){D(e,Q(d));const c=g(e)?"start":"stop";ut(`/cam/video-rec/vid/${c}`,l=>{console.log("Video recording",l)})}});mt(()=>{i&&i()});var s=rc(),r=A(s);r.__click=[nc];var o=A(r),a=A(o),u=$(A(a));Z(u,()=>g(e),d=>{var c=ic();P(d,c)},d=>{var c=sc();P(d,c)}),T(a),T(o),T(r),T(s),P(n,s),st()}at(["click"]);var ac=j('<h3 class="message svelte-kc30aj"><!></h3>'),cc=j('<div class="sphere-config svelte-kc30aj"><!> <!> <div class="actions-wrapper svelte-kc30aj"><button class="svelte-kc30aj">Save settings</button></div></div>');function lc(n,t){it(t,!0);const e=Rt(),i=()=>lt(pe,"$sphereControls",e);let s=U(void 0),r=U(Q([]));const o=pe.subscribe(f=>{D(r,Q(f.map(b=>({...b}))))}),a=(f,b)=>{console.log(),pe.update(_=>_.map(E=>E.id===f?{...E,value:b}:{...E}))},u=()=>{const f={};for(let b of i())f[b.id]=b.value;Ge("/config/sphere/settings",f,b=>{D(s,Q((b==null?void 0:b.response)===200?'<span style="color:#090">Successfully saved settings.</span>':'<span style="color:#B00">Failed to save settings.</span>')),setTimeout(()=>{D(s,null)},5e3)})};mt(()=>{o&&o()});var d=cc(),c=A(d);Z(c,()=>g(s),f=>{var b=ac(),_=A(b);vr(_,()=>g(s)),T(b),P(f,b)});var l=$(c,2);jt(l,17,()=>g(r),Qt,(f,b,_)=>{Is(f,ts(()=>g(b),{index:_,oninput:a}))});var h=$(l,2),p=A(h);p.__click=u,T(h),T(d),P(n,d),st()}at(["click"]);const uc=(n,t)=>{const e=t()==="B"?"cam_b":"cam_a";ut(`/cam/capture-img/image/${e}`,i=>{console.log("Capture image",i)})},hc=(n,t,e,i)=>{const s=t()==="B"?"cam_b":"cam_a";ut(`/cam/snail-shot/${g(e)}/${g(i)}/${s}`,r=>{console.log("Snails",r,s)})};var fc=(n,t)=>console.log("X:",g(t)),dc=j("<option></option>"),pc=(n,t)=>console.log("Y:",g(t)),vc=j("<option></option>"),gc=j('<div id="image-capture" class="svelte-2mcnnf"><button aria-label="Capture image" class="svelte-2mcnnf"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-2mcnnf"><g transform="translate(42,42)"><circle r="28" fill="#C00" stroke="#C00"></circle><circle r="38" class="capture-button svelte-2mcnnf"></circle></g></svg></button> <button aria-label="Snail shot" class="svelte-2mcnnf"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 84" height="84" width="84" class="svelte-2mcnnf"><g transform="translate(42,42)"><polyline points="0,0 20,0 20,15 -20,15 -20,-15 40,-15 40,30 -20,30 -12,28 -12,32 -20,30" class="svelte-2mcnnf"></polyline></g></svg></button> <div class="dimensions svelte-2mcnnf"><label class="svelte-2mcnnf"><span class="svelte-2mcnnf">hor</span><select class="svelte-2mcnnf"></select></label> <label class="svelte-2mcnnf"><span class="svelte-2mcnnf">ver</span><select class="svelte-2mcnnf"></select></label></div></div>');function mc(n,t){it(t,!0);const e=Rt(),i=()=>lt(Ne,"$swapPreview",e);let s=U(3),r=U(3);var o=gc(),a=A(o);a.__click=[uc,i];var u=$(a,2);u.__click=[hc,i,s,r];var d=$(u,2),c=A(d),l=$(A(c));l.__change=[fc,s],jt(l,20,()=>Array.from({length:7}),Qt,(f,b,_)=>{var E=dc();E.value=(E.__value=_+3)==null?"":_+3,E.textContent=_+3,P(f,E)}),T(l),T(c);var h=$(c,2),p=$(A(h));p.__change=[pc,r],jt(p,20,()=>Array.from({length:7}),Qt,(f,b,_)=>{var E=vc();E.value=(E.__value=_+3)==null?"":_+3,E.textContent=_+3,P(f,E)}),T(p),T(h),T(d),T(o),gi(l,()=>g(s),f=>D(s,f)),gi(p,()=>g(r),f=>D(r,f)),P(n,o),st()}at(["click","change"]);var _c=j('<div class="controls svelte-bwwnlr"><div class="tools svelte-bwwnlr"><!></div></div>');function yc(n){const t=Rt(),e=()=>lt(_n,"$toolTab",t);var i=$t(),s=bt(i);Z(s,e,r=>{var o=_c(),a=A(o),u=A(a);Z(u,()=>e()==="target",d=>{xa(d)},d=>{var c=$t(),l=bt(c);Z(l,()=>e()==="sphere",h=>{lc(h,{})},h=>{var p=$t(),f=bt(p);Z(f,()=>e()==="location",b=>{Ja(b,{})},b=>{var _=$t(),E=bt(_);Z(E,()=>e()==="adjust",w=>{ec(w,{})},w=>{var v=$t(),y=bt(v);Z(y,()=>e()==="video",k=>{oc(k,{})},k=>{var R=$t(),B=bt(R);Z(B,()=>e()==="picture",O=>{mc(O,{})},null,!0),P(k,R)},!0),P(w,v)},!0),P(b,_)},!0),P(h,p)},!0),P(d,c)}),T(a),T(o),P(r,o)}),P(n,i)}var wc=j('<li><button><span class="svelte-wkzjji"> </span></button></li>'),bc=j('<div id="options-menu" class="svelte-wkzjji"><ul class="svelte-wkzjji"></ul></div>');function Ec(n,t){it(t,!0);let e=U("");const i=_n.subscribe(c=>{D(e,Q(c))});let s=U(!1);const r=Ie.subscribe(c=>{D(s,Q(c))}),o=c=>{_n.update(l=>l===c?"":c)};mt(()=>{i&&i(),r&&r()});const a=[{id:"sphere",name:"Sphere",icon:"icon-settings",callback:()=>{o("sphere")},enabled:()=>g(e)==="sphere"},{id:"compass",name:"Compass",icon:"icon-compass",callback:()=>{Ie.update(c=>!c)},enabled:()=>g(s)},{id:"location",name:"Location",icon:"icon-location",callback:()=>{o("location")},enabled:()=>g(e)==="location"},{id:"target",name:"Target",icon:"icon-target",callback:()=>{o("target")},enabled:()=>g(e)==="target"},{id:"adjust",name:"Contrast",icon:"icon-adjust",callback:()=>{o("adjust")},enabled:()=>g(e)==="adjust"},{id:"video",name:"Video",icon:"icon-video",callback:()=>{o("video")},enabled:()=>g(e)==="video"},{id:"picture",name:"Picture",icon:"icon-image",callback:()=>{o("picture")},enabled:()=>g(e)==="picture"}];var u=bc(),d=A(u);jt(d,21,()=>a,Qt,(c,l)=>{var h=wc();const p=Zt(()=>`${(g(l).enabled()?"active":"")??""} svelte-wkzjji`);var f=A(h);f.__click=function(...E){var w;(w=g(l).callback)==null||w.apply(this,E)};var b=A(f),_=A(b,!0);T(b),T(f),T(h),nt(()=>{At(h,g(p)),At(f,`${g(l).icon??""} svelte-wkzjji`),Et(_,g(l).name)}),P(c,h)}),T(d),T(u),P(n,u),st()}at(["click"]);var kc=j('<div><button class="task--button video-recorder svelte-1btt76e" aria-label="Stop video recording"><span class="icon-stop"></span> <span class="time"> </span></button></div>');function Sc(n,t){it(t,!0);const e={elapsedTime:0};let i=U("00:00:00");function s(l,h,p){const f=[l,h,p].map(b=>b<10?`0${b}`:b);D(i,Q(f.join(":")))}function r(){e.startTime=Date.now(),e.intervalId=setInterval(()=>{const l=Date.now()-e.startTime+e.elapsedTime,h=parseInt(l/1e3%60,10),p=parseInt(l/(1e3*60)%60,10),f=parseInt(l/(1e3*60*60)%24,10);s(f,p,h)},1e3)}function o(){e.intervalId&&(clearInterval(e.intervalId),Ve.update(()=>!1),D(i,"00:00:00"))}let a=U(!1);const u=Ve.subscribe(l=>{l!==g(a)&&(l?r():o(),D(a,Q(l)))});mt(()=>{u&&u()});var d=$t(),c=bt(d);Z(c,()=>g(a),l=>{var h=kc(),p=A(h);p.__click=o;var f=$(A(p),2),b=A(f,!0);T(f),T(p),T(h),nt(()=>Et(b,g(i))),P(l,h)}),P(n,d),st()}at(["click"]);const xc=(n,t)=>{document.fullscreenElement?(document.exitFullscreen(),D(t,!1)):(document.documentElement.requestFullscreen(),D(t,!0))};var Tc=j('<button class="task--button" aria-label="Switch fullscreen mode"><span></span></button>');function Ac(n){let t=U(!1);var e=Tc();e.__click=[xc,t];var i=A(e);T(e),nt(()=>At(i,g(t)?"icon-viewport":"icon-fullscreen")),P(n,e)}at(["click"]);const Cc=()=>{Xn.update(n=>!n)};var Rc=j('<button class="task--button daylight-button svelte-192ooay" aria-label="Switch daylight mode"><span></span></button>');function Oc(n,t){it(t,!0);let e=U(!1),i=Xn.subscribe(o=>{D(e,Q(o))});mt(()=>{i&&i()});var s=Rc();s.__click=[Cc];var r=A(s);T(s),nt(()=>At(r,g(e)?"icon-dark":"icon-light")),P(n,s),st()}at(["click"]);var Mc=j('<div class="tasks svelte-1laysiz"><!> <!> <!></div>');function Lc(n){var t=Mc(),e=A(t);Sc(e,{});var i=$(e,2);Ac(i);var s=$(i,2);Oc(s,{}),T(t),P(n,t)}var Nc=j("<div><!> <!> <!> <!></div>");function zc(n){const t=Rt(),e=()=>lt(Xn,"$daylight",t);var i=Nc(),s=A(i);Lc(s);var r=$(s,2);ga(r);var o=$(r,2);yc(o);var a=$(o,2);Ec(a,{}),T(i),nt(()=>At(i,`${"container"+(e()?" daylight":"")} svelte-183uj8y`)),P(n,i)}export{zc as component};
