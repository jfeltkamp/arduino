import{a as g,t as F,n as at,c as st}from"../chunks/disclose-version.D8P440kR.js";import{x as Qe,h as Ze,k as K,B as $t,C as Ge,M as ts,ai as Re,P as es,Q as pe,R as zt,l as wt,ar as Nt,N as Oe,i as Ne,O as ss,an as rs,z as me,as as ne,at as ve,au as ie,av as ns,a4 as is,G as ge,aw as as,ah as os,ax as cs,j as ls,ay as Be,y as hs,ae as us,a9 as ds,az as fs,ac as ps,aA as ms,aB as vs,L as _e,aC as gs,aD as _s,am as xs,p as G,I as R,g as l,q as m,w as E,v as f,t as W,o as tt,aE as St,aq as $,m as Y,aF as ct,f as Mt}from"../chunks/runtime.Yc-A2pzo.js";import{b as dt,o as Ct,i as I,a as Q,p as Et,s as ys}from"../chunks/index-client._KtRbn_9.js";import{a as Z,s as xt,b as ut,d as yt}from"../chunks/store.Dpkw14Ok.js";import{i as Ft}from"../chunks/lifecycle.BcH1WlBI.js";import{w as ft}from"../chunks/index.C9kNVKuZ.js";let jt=null;function ae(r,t){return t}function bs(r,t,e,s){for(var n=[],i=t.length,a=0;a<i;a++)as(t[a].e,n,!0);var o=i>0&&n.length===0&&e!==null;if(o){var c=e.parentNode;os(c),c.append(e),s.clear(),lt(r,t[0].prev,t[i-1].next)}cs(n,()=>{for(var d=0;d<i;d++){var h=t[d];o||(s.delete(h.k),lt(r,h.prev,h.next)),ls(h.e,!o)}})}function It(r,t,e,s,n,i=null){var a=r,o={flags:t,items:new Map,first:null},c=(t&Be)!==0;if(c){var d=r;a=K?$t(hs(d)):d.appendChild(Qe())}K&&Ge();var h=null,_=!1;Ze(()=>{var u=e(),v=ts(u)?u:u==null?[]:Re(u),p=v.length;if(_&&p===0)return;_=p===0;let B=!1;if(K){var w=a.data===es;w!==(p===0)&&(a=pe(),$t(a),zt(!1),B=!0)}if(K){for(var L=null,P,C=0;C<p;C++){if(wt.nodeType===8&&wt.data===us){a=wt,B=!0,zt(!1);break}var x=v[C],y=s(x,C);P=Pe(wt,o,L,null,x,y,C,n,t),o.items.set(y,P),L=P}p>0&&$t(pe())}if(!K){var A=ds;ws(v,o,a,n,t,(A.f&Nt)!==0,s)}i!==null&&(p===0?h?Oe(h):h=Ne(()=>i(a)):h!==null&&ss(h,()=>{h=null})),B&&zt(!0),e()}),K&&(a=wt)}function ws(r,t,e,s,n,i,a){var M,D,V,j;var o=(n&fs)!==0,c=(n&(ne|ie))!==0,d=r.length,h=t.items,_=t.first,u=_,v,p=null,B,w=[],L=[],P,C,x,y;if(o)for(y=0;y<d;y+=1)P=r[y],C=a(P,y),x=h.get(C),x!==void 0&&((M=x.a)==null||M.measure(),(B??(B=new Set)).add(x));for(y=0;y<d;y+=1){if(P=r[y],C=a(P,y),x=h.get(C),x===void 0){var A=u?u.e.nodes_start:e;p=Pe(A,t,p,p===null?t.first:p.next,P,C,y,s,n),h.set(C,p),w=[],L=[],u=p.next;continue}if(c&&ks(x,P,y,n),x.e.f&Nt&&(Oe(x.e),o&&((D=x.a)==null||D.unfix(),(B??(B=new Set)).delete(x))),x!==u){if(v!==void 0&&v.has(x)){if(w.length<L.length){var S=L[0],N;p=S.prev;var z=w[0],et=w[w.length-1];for(N=0;N<w.length;N+=1)xe(w[N],S,e);for(N=0;N<L.length;N+=1)v.delete(L[N]);lt(t,z.prev,et.next),lt(t,p,z),lt(t,et,S),u=S,p=et,y-=1,w=[],L=[]}else v.delete(x),xe(x,u,e),lt(t,x.prev,x.next),lt(t,x,p===null?t.first:p.next),lt(t,p,x),p=x;continue}for(w=[],L=[];u!==null&&u.k!==C;)(i||!(u.e.f&Nt))&&(v??(v=new Set)).add(u),L.push(u),u=u.next;if(u===null)continue;x=u}w.push(x),p=x,u=x.next}if(u!==null||v!==void 0){for(var b=v===void 0?[]:Re(v);u!==null;)(i||!(u.e.f&Nt))&&b.push(u),u=u.next;var k=b.length;if(k>0){var O=n&Be&&d===0?e:null;if(o){for(y=0;y<k;y+=1)(V=b[y].a)==null||V.measure();for(y=0;y<k;y+=1)(j=b[y].a)==null||j.fix()}bs(t,b,O,h)}}o&&rs(()=>{var U;if(B!==void 0)for(x of B)(U=x.a)==null||U.apply()}),me.first=t.first&&t.first.e,me.last=p&&p.e}function ks(r,t,e,s){s&ne&&ve(r.v,t),s&ie?ve(r.i,e):r.i=e}function Pe(r,t,e,s,n,i,a,o,c){var d=jt;try{var h=(c&ne)!==0,_=(c&ns)===0,u=h?_?is(n):ge(n):n,v=c&ie?ge(a):a,p={i:v,v:u,k:i,a:null,e:null,prev:e,next:s};return jt=p,p.e=Ne(()=>o(r,u,v),K),p.e.prev=e&&e.e,p.e.next=s&&s.e,e===null?t.first=p:(e.next=p,e.e.next=p.e),s!==null&&(s.prev=p,s.e.prev=p.e),p}finally{jt=d}}function xe(r,t,e){for(var s=r.next?r.next.e.nodes_start:e,n=t?t.e.nodes_start:e,i=r.e.nodes_start;i!==s;){var a=ps(i);n.before(i),i=a}}function lt(r,t,e){t===null?r.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}let ye=!1;function De(){ye||(ye=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var t;if(!r.defaultPrevented)for(const e of r.target.elements)(t=e.__on_r)==null||t.call(e)})},{capture:!0}))}function mt(r){if(K){var t=!1,e=()=>{if(!t){if(t=!0,r.hasAttribute("value")){var s=r.value;H(r,"value",null),r.value=s}if(r.hasAttribute("checked")){var n=r.checked;H(r,"checked",null),r.checked=n}}};r.__on_r=e,ms(e),De()}}function H(r,t,e,s){var n=r.__attributes??(r.__attributes={});K&&(n[t]=r.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&r.nodeName==="LINK")||n[t]!==(n[t]=e)&&(t==="style"&&"__styles"in r&&(r.__styles={}),t==="loading"&&(r[vs]=e),e==null?r.removeAttribute(t):typeof e!="string"&&Es(r).includes(t)?r[t]=e:r.setAttribute(t,e))}var be=new Map;function Es(r){var t=be.get(r.nodeName);if(t)return t;be.set(r.nodeName,t=[]);for(var e,s=_e(r),n=Element.prototype;n!==s;){e=gs(s);for(var i in e)e[i].set&&t.push(i);s=_e(s)}return t}function _t(r,t){var e=r.__className,s=Ts(t);K&&r.className===s?r.__className=s:(e!==s||K&&r.className!==s)&&(t==null?r.removeAttribute("class"):r.className=s,r.__className=s)}function Ts(r){return r??""}function As(r,t,e,s=e){r.addEventListener(t,e);const n=r.__on_r;n?r.__on_r=()=>{n(),s()}:r.__on_r=s,De()}function vt(r,t,e=t){var s=_s();As(r,"input",()=>{var n=we(r)?ke(r.value):r.value;e(n),s&&n!==(n=t())&&(r.value=n??"")}),xs(()=>{var n=t();if(K&&r.defaultValue!==r.value){e(r.value);return}we(r)&&n===ke(r.value)||r.type==="date"&&!n&&!r.value||n!==r.value&&(r.value=n??"")})}function we(r){var t=r.type;return t==="number"||t==="range"}function ke(r){return r===""?null:+r}const oe=ft({x:0,y:0,f:0,deg_x:0,deg_y:0,dx:1,dy:-1,df:1,acc:1e3,spr:8e4,mpa:2e4,minpx:-2e4,maxpx:2e4,mpf:5e3,vx:0,vy:0,va1:100,va2:1500,vf:0,vf1:100,vf2:1500}),Ut=ft([{id:"Brightness",name:"Brightness",defaultValue:0,value:0,minValue:-1,maxValue:1,steps:.01},{id:"Contrast",name:"Contrast",defaultValue:1,value:1,minValue:0,maxValue:6,steps:.1},{id:"Saturation",name:"Saturation",defaultValue:1,value:1,minValue:0,maxValue:32,steps:.1},{id:"Sharpness",name:"Sharpness",defaultValue:1,value:1,minValue:0,maxValue:16,steps:.1},{id:"ExposureTime",name:"Exposure time (exp. 0.3ms-3.3s)",description:"Value > 0 will reduce video framerate.",defaultValue:0,value:0,minValue:-10,maxValue:10,steps:.1},{id:"AnalogueGain",name:"Analogue gain",defaultValue:1,value:1,minValue:1,maxValue:8,steps:.1}]),Lt=ft([]),rt=ft({}),Kt=ft(""),Xt=ft(!1),Jt=ft(!1);var Cs=F('<div id="horizon-wrapper" class="svelte-1gx25as"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 300" preserveAspectRatio="xMinYMin slice" class="svelte-1gx25as"><defs><g id="horizon"><line x1="0" x2="0" y1="-600" y2="600" stroke="#FFF" stroke-dashoffset="6.75" stroke-dasharray="0.5,44" stroke-width="10"></line><line x1="-200" x2="200" y1="150" y2="150" stroke="#FFF" stroke-dashoffset="30" stroke-dasharray="40.5,9.5,0.5,9.5" stroke-width=".5"></line></g></defs><defs><polygon id="focusArrow" points="0,400 180,65 100,65 200,35 300,65 220,65 400,400"></polygon><linearGradient id="focusArrowGradClip" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#005"></stop><stop offset="50%" stop-color="#039" stop-opacity=".8"></stop><stop offset="100%" stop-color="#07f" stop-opacity=".4"></stop></linearGradient></defs><clipPath id="arrowStripesClip"><polygon points="200,0 -390,400 -370,400 200,0 -350,400 -330,400 200,0 -310,400 -290,400 200,0 -270,400 -250,400 200,0 -230,400 -210,400 200,0 -190,400 -170,400 200,0 -150,400 -130,400 200,0 -110,400 -90,400 200,0 -70,400 -50,400 200,0 -30,400 -10,400 200,0 10,400 30,400 200,0 50,400 70,400 200,0 90,400 110,400 200,0 130,400 150,400 200,0 170,400 190,400 200,0 210,400 230,400 200,0 250,400 270,400 200,0 290,400 310,400 200,0 330,400 350,400 200,0 370,400 390,400 200,0 410,400 430,400 200,0 450,400 470,400 200,0 490,400 510,400 200,0 530,400 550,400 200,0 570,400 590,400 200,0 610,400 630,400 200,0 650,400 670,400 200,0 690,400 710,400 200,0 730,400 750,400 200,0 770,400 790,400"></polygon></clipPath><clipPath id="focusRangeMeterClip"><rect id="focus-range-meter" width="400" height="400" class="svelte-1gx25as"></rect></clipPath><use id="azimuth-sphere" href="#horizon" class="svelte-1gx25as"></use><g transform="translate(200 150)"><g id="altitude-visual" class="svelte-1gx25as"><circle r="1" fill="#FFF"></circle><path d="M-70 0 -10 0 A 10 10 0 0 0 10 0 " fill="none" stroke-width="1.2" stroke="#FFF"></path><text id="altitude-text" text-anchor="middle" transform="translate(-45 -5)" fill="#FFF" font-size="15"> </text></g></g><g transform="translate(200 150)"><path d="M-10 0 A 10 10 0 0 0 10 0 L 70 0" fill="none" stroke-width="1.22" stroke="#FFF"></path><path d="M -4,-87 0,-100 4,-87z" fill="#FFF"></path><text id="azimuth-text" transform="translate(0 -70)" text-anchor="middle" fill="#FFF" font-size="15"> </text></g><g transform="translate(200 -390)"><g id="compass" class="svelte-1gx25as"><circle r="400" class="grade svelte-1gx25as" stroke-dasharray="1 5.98131701" stroke-width="20"></circle><circle r="400" class="grade svelte-1gx25as" stroke-dasharray="1 33.90658504" stroke-width="30"></circle><circle r="400" class="grade svelte-1gx25as" stroke-dasharray="1 103.71975512" stroke-width="40"></circle><circle r="400" fill="none" stroke-dasharray="1 156.07963268" stroke="#F00" stroke-width="40"></circle><text class="cmp-text svelte-1gx25as" transform="rotate(0) translate(0 432)">N</text><text class="cmp-text svelte-1gx25as" transform="rotate(-15) translate(0 432)">15</text><text class="cmp-text svelte-1gx25as" transform="rotate(-30) translate(0 432)">30</text><text class="cmp-text svelte-1gx25as" transform="rotate(-45) translate(0 432)">45</text><text class="cmp-text svelte-1gx25as" transform="rotate(-60) translate(0 432)">60</text><text class="cmp-text svelte-1gx25as" transform="rotate(-75) translate(0 432)">75</text><text class="cmp-text svelte-1gx25as" transform="rotate(-90) translate(0 432)">E</text><text class="cmp-text svelte-1gx25as" transform="rotate(-105) translate(0 432)">105</text><text class="cmp-text svelte-1gx25as" transform="rotate(-120) translate(0 432)">120</text><text class="cmp-text svelte-1gx25as" transform="rotate(-135) translate(0 432)">135</text><text class="cmp-text svelte-1gx25as" transform="rotate(-150) translate(0 432)">150</text><text class="cmp-text svelte-1gx25as" transform="rotate(-165) translate(0 432)">165</text><text class="cmp-text svelte-1gx25as" transform="rotate(-180) translate(0 432)">S</text><text class="cmp-text svelte-1gx25as" transform="rotate(-195) translate(0 432)">195</text><text class="cmp-text svelte-1gx25as" transform="rotate(-210) translate(0 432)">210</text><text class="cmp-text svelte-1gx25as" transform="rotate(-225) translate(0 432)">225</text><text class="cmp-text svelte-1gx25as" transform="rotate(-240) translate(0 432)">240</text><text class="cmp-text svelte-1gx25as" transform="rotate(-255) translate(0 432)">255</text><text class="cmp-text svelte-1gx25as" transform="rotate(-270) translate(0 432)">W</text><text class="cmp-text svelte-1gx25as" transform="rotate(-285) translate(0 432)">285</text><text class="cmp-text svelte-1gx25as" transform="rotate(-300) translate(0 432)">300</text><text class="cmp-text svelte-1gx25as" transform="rotate(-315) translate(0 432)">315</text><text class="cmp-text svelte-1gx25as" transform="rotate(-330) translate(0 432)">330</text><text class="cmp-text svelte-1gx25as" transform="rotate(-345) translate(0 432)">345</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(0) translate(0 422)">0</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-5) translate(0 422)">5</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-10) translate(0 422)">10</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-20) translate(0 422)">20</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-25) translate(0 422)">25</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-22.5) translate(0 422)">NNE</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-35) translate(0 422)">35</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-40) translate(0 422)">40</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(-45) translate(0 422)">NE</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-50) translate(0 422)">50</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-55) translate(0 422)">55</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-65) translate(0 422)">65</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-70) translate(0 422)">70</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-67.5) translate(0 422)">NEE</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-80) translate(0 422)">80</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-85) translate(0 422)">85</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(-90) translate(0 422)">90</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-95) translate(0 422)">95</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-95) translate(0 422)">95</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-100) translate(0 422)">100</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-110) translate(0 422)">110</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-112.5) translate(0 422)">SEE</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-115) translate(0 422)">115</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-125) translate(0 422)">125</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-130) translate(0 422)">130</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(-135) translate(0 422)">SE</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-140) translate(0 422)">140</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-145) translate(0 422)">145</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-155) translate(0 422)">155</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-157.5) translate(0 422)">SSE</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-160) translate(0 422)">160</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-170) translate(0 422)">170</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-175) translate(0 422)">175</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(-180) translate(0 422)">180</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-185) translate(0 422)">185</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-190) translate(0 422)">190</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-200) translate(0 422)">200</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-202.5) translate(0 422)">SSW</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-205) translate(0 422)">205</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-215) translate(0 422)">215</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-220) translate(0 422)">220</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(-225) translate(0 422)">SW</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-230) translate(0 422)">230</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-235) translate(0 422)">235</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-245) translate(0 422)">245</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-247.5) translate(0 422)">SWW</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-250) translate(0 422)">250</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-260) translate(0 422)">260</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-265) translate(0 422)">265</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(-270) translate(0 422)">270</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-275) translate(0 422)">275</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-280) translate(0 422)">280</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-290) translate(0 422)">290</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-292.5) translate(0 422)">NWW</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-295) translate(0 422)">295</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-305) translate(0 422)">305</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-310) translate(0 422)">310</text><text class="cmp-text-sm left svelte-1gx25as" transform="rotate(-315) translate(0 422)">NW</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-320) translate(0 422)">320</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-325) translate(0 422)">325</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-335) translate(0 422)">335</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-340) translate(0 422)">340</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-350) translate(0 422)">350</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-355) translate(0 422)">355</text><text class="cmp-text-sm svelte-1gx25as" transform="rotate(-337.5) translate(0 422)">NNW</text></g></g></svg></div>');function Ss(r,t){G(t,!1);let e=St(),s=St(),n=St(),i=St();const a=oe.subscribe(y=>{const A=y.f+y.mpf,N=(y.mpf-y.mpf/Math.pow(1.5/y.mpf*A+1,2))/y.mpf;R(e,(1-N)*133),R(s,y.deg_x),R(n,y.deg_y),R(i,l(n)/90*400)});dt(()=>{a&&a()}),Ft();var o=Cs(),c=m(o),d=E(m(c),3),h=m(d);f(d);var _=E(d),u=E(_),v=m(u),p=E(m(v),2),B=m(p);f(p),f(v),f(u);var w=E(u),L=E(m(w),2),P=m(L);f(L),f(w);var C=E(w),x=m(C);f(C),f(c),f(o),W(()=>{H(h,"style",`y:${l(e)??""}%`),H(_,"style",`transform: translate(200px, ${l(i)??""}px)`),H(v,"style",`transform: rotate(${l(n)??""}deg)`),Z(B,`∠ ${l(n)??""}°`),Z(P,`${l(s)??""}°`),H(x,"transform",`rotate(${l(s)??""})`)}),g(r,o),tt()}var Ls=F('<div id="camera-stream" class="svelte-1pq33zz"><div id="telescope-stream"><img id="stream-object" alt="Telescope stream" width="1080" height="810" class="svelte-1pq33zz"></div> <div id="viewfinder-stream"><img id="stream-object" alt="Viewfinder stream" width="1080" height="810" class="svelte-1pq33zz"></div></div>');function Rs(r,t){G(t,!0);const e=xt(),s=()=>ut(Jt,"$swapPreview",e);let n=$("starfield.jpg"),i=$("starfield.jpg");Ct(()=>{R(n,"http://192.168.178.33:7777/stream_a.mjpg"),R(i,"http://192.168.178.33:7777/stream_b.mjpg")});var a=Ls(),o=m(a),c=m(o);f(o);var d=E(o,2),h=m(d);f(d),f(a),W(()=>{_t(o,`${(s()?"stream-wrapper":"stream-wrapper large")??""} svelte-1pq33zz`),H(c,"src",l(n)),_t(d,`${(s()?"stream-wrapper large":"stream-wrapper")??""} svelte-1pq33zz`),H(h,"src",l(i))}),g(r,a),tt()}var Os=F('<div class="layer svelte-qmdbdl"><!></div>'),Ns=F('<div class="visuals svelte-qmdbdl"><!> <!></div>');function Bs(r){const t=xt(),e=()=>ut(Xt,"$displayCompass",t);var s=Ns(),n=m(s);Rs(n,{});var i=E(n,2);I(i,e,a=>{var o=Os(),c=m(o);Ss(c,{}),f(o),g(a,o)}),f(s),g(r,s)}const it=Object.create(null);it.open="0";it.close="1";it.ping="2";it.pong="3";it.message="4";it.upgrade="5";it.noop="6";const Bt=Object.create(null);Object.keys(it).forEach(r=>{Bt[it[r]]=r});const Qt={type:"error",data:"parser error"},Me=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Fe=typeof ArrayBuffer=="function",Ie=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,ce=({type:r,data:t},e,s)=>Me&&t instanceof Blob?e?s(t):Ee(t,s):Fe&&(t instanceof ArrayBuffer||Ie(t))?e?s(t):Ee(new Blob([t]),s):s(it[r]+(t||"")),Ee=(r,t)=>{const e=new FileReader;return e.onload=function(){const s=e.result.split(",")[1];t("b"+(s||""))},e.readAsDataURL(r)};function Te(r){return r instanceof Uint8Array?r:r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}let Ht;function Ps(r,t){if(Me&&r.data instanceof Blob)return r.data.arrayBuffer().then(Te).then(t);if(Fe&&(r.data instanceof ArrayBuffer||Ie(r.data)))return t(Te(r.data));ce(r,!1,e=>{Ht||(Ht=new TextEncoder),t(Ht.encode(e))})}const Ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Tt=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let r=0;r<Ae.length;r++)Tt[Ae.charCodeAt(r)]=r;const Ds=r=>{let t=r.length*.75,e=r.length,s,n=0,i,a,o,c;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);const d=new ArrayBuffer(t),h=new Uint8Array(d);for(s=0;s<e;s+=4)i=Tt[r.charCodeAt(s)],a=Tt[r.charCodeAt(s+1)],o=Tt[r.charCodeAt(s+2)],c=Tt[r.charCodeAt(s+3)],h[n++]=i<<2|a>>4,h[n++]=(a&15)<<4|o>>2,h[n++]=(o&3)<<6|c&63;return d},Ms=typeof ArrayBuffer=="function",le=(r,t)=>{if(typeof r!="string")return{type:"message",data:qe(r,t)};const e=r.charAt(0);return e==="b"?{type:"message",data:Fs(r.substring(1),t)}:Bt[e]?r.length>1?{type:Bt[e],data:r.substring(1)}:{type:Bt[e]}:Qt},Fs=(r,t)=>{if(Ms){const e=Ds(r);return qe(e,t)}else return{base64:!0,data:r}},qe=(r,t)=>{switch(t){case"blob":return r instanceof Blob?r:new Blob([r]);case"arraybuffer":default:return r instanceof ArrayBuffer?r:r.buffer}},Ve="",Is=(r,t)=>{const e=r.length,s=new Array(e);let n=0;r.forEach((i,a)=>{ce(i,!1,o=>{s[a]=o,++n===e&&t(s.join(Ve))})})},qs=(r,t)=>{const e=r.split(Ve),s=[];for(let n=0;n<e.length;n++){const i=le(e[n],t);if(s.push(i),i.type==="error")break}return s};function Vs(){return new TransformStream({transform(r,t){Ps(r,e=>{const s=e.length;let n;if(s<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,s);else if(s<65536){n=new Uint8Array(3);const i=new DataView(n.buffer);i.setUint8(0,126),i.setUint16(1,s)}else{n=new Uint8Array(9);const i=new DataView(n.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(s))}r.data&&typeof r.data!="string"&&(n[0]|=128),t.enqueue(n),t.enqueue(e)})}})}let Yt;function Rt(r){return r.reduce((t,e)=>t+e.length,0)}function Ot(r,t){if(r[0].length===t)return r.shift();const e=new Uint8Array(t);let s=0;for(let n=0;n<t;n++)e[n]=r[0][s++],s===r[0].length&&(r.shift(),s=0);return r.length&&s<r[0].length&&(r[0]=r[0].slice(s)),e}function $s(r,t){Yt||(Yt=new TextDecoder);const e=[];let s=0,n=-1,i=!1;return new TransformStream({transform(a,o){for(e.push(a);;){if(s===0){if(Rt(e)<1)break;const c=Ot(e,1);i=(c[0]&128)===128,n=c[0]&127,n<126?s=3:n===126?s=1:s=2}else if(s===1){if(Rt(e)<2)break;const c=Ot(e,2);n=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),s=3}else if(s===2){if(Rt(e)<8)break;const c=Ot(e,8),d=new DataView(c.buffer,c.byteOffset,c.length),h=d.getUint32(0);if(h>Math.pow(2,21)-1){o.enqueue(Qt);break}n=h*Math.pow(2,32)+d.getUint32(4),s=3}else{if(Rt(e)<n)break;const c=Ot(e,n);o.enqueue(le(i?c:Yt.decode(c),t)),s=0}if(n===0||n>r){o.enqueue(Qt);break}}}})}const $e=4;function q(r){if(r)return zs(r)}function zs(r){for(var t in q.prototype)r[t]=q.prototype[t];return r}q.prototype.on=q.prototype.addEventListener=function(r,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(t),this};q.prototype.once=function(r,t){function e(){this.off(r,e),t.apply(this,arguments)}return e.fn=t,this.on(r,e),this};q.prototype.off=q.prototype.removeListener=q.prototype.removeAllListeners=q.prototype.removeEventListener=function(r,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+r];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var s,n=0;n<e.length;n++)if(s=e[n],s===t||s.fn===t){e.splice(n,1);break}return e.length===0&&delete this._callbacks["$"+r],this};q.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+r],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(e){e=e.slice(0);for(var s=0,n=e.length;s<n;++s)e[s].apply(this,t)}return this};q.prototype.emitReserved=q.prototype.emit;q.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};q.prototype.hasListeners=function(r){return!!this.listeners(r).length};const qt=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0),X=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),js="arraybuffer";function ze(r,...t){return t.reduce((e,s)=>(r.hasOwnProperty(s)&&(e[s]=r[s]),e),{})}const Us=X.setTimeout,Hs=X.clearTimeout;function Vt(r,t){t.useNativeTimers?(r.setTimeoutFn=Us.bind(X),r.clearTimeoutFn=Hs.bind(X)):(r.setTimeoutFn=X.setTimeout.bind(X),r.clearTimeoutFn=X.clearTimeout.bind(X))}const Ys=1.33;function Ws(r){return typeof r=="string"?Ks(r):Math.ceil((r.byteLength||r.size)*Ys)}function Ks(r){let t=0,e=0;for(let s=0,n=r.length;s<n;s++)t=r.charCodeAt(s),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(s++,e+=4);return e}function je(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Xs(r){let t="";for(let e in r)r.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(r[e]));return t}function Js(r){let t={},e=r.split("&");for(let s=0,n=e.length;s<n;s++){let i=e[s].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class Qs extends Error{constructor(t,e,s){super(t),this.description=e,this.context=s,this.type="TransportError"}}class he extends q{constructor(t){super(),this.writable=!1,Vt(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,s){return super.emitReserved("error",new Qs(t,e,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=le(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const e=Xs(t);return e.length?"?"+e:""}}class Zs extends he{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||e()})),this.writable||(s++,this.once("drain",function(){--s||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const e=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};qs(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Is(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=je()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(t,e)}}let Ue=!1;try{Ue=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Gs=Ue;function tr(){}class er extends Zs{constructor(t){if(super(t),typeof location<"u"){const e=location.protocol==="https:";let s=location.port;s||(s=e?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||s!==t.port}}doWrite(t,e){const s=this.request({method:"POST",data:t});s.on("success",e),s.on("error",(n,i)=>{this.onError("xhr post error",n,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,s)=>{this.onError("xhr poll error",e,s)}),this.pollXhr=t}}class nt extends q{constructor(t,e,s){super(),this.createRequest=t,Vt(this,s),this._opts=s,this._method=s.method||"GET",this._uri=e,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var t;const e=ze(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(e);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let n in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(n)&&s.setRequestHeader(n,this._opts.extraHeaders[n])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var n;s.readyState===3&&((n=this._opts.cookieJar)===null||n===void 0||n.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(n){this.setTimeoutFn(()=>{this._onError(n)},0);return}typeof document<"u"&&(this._index=nt.requestsCount++,nt.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=tr,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete nt.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}nt.requestsCount=0;nt.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Ce);else if(typeof addEventListener=="function"){const r="onpagehide"in X?"pagehide":"unload";addEventListener(r,Ce,!1)}}function Ce(){for(let r in nt.requests)nt.requests.hasOwnProperty(r)&&nt.requests[r].abort()}const sr=function(){const r=He({xdomain:!1});return r&&r.responseType!==null}();class rr extends er{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=sr&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new nt(He,this.uri(),t)}}function He(r){const t=r.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Gs))return new XMLHttpRequest}catch{}if(!t)try{return new X[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Ye=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class nr extends he{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,s=Ye?{}:ze(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,s)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],n=e===t.length-1;ce(s,this.supportsBinary,i=>{try{this.doWrite(s,i)}catch{}n&&qt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=je()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const Wt=X.WebSocket||X.MozWebSocket;class ir extends nr{createSocket(t,e,s){return Ye?new Wt(t,e,s):e?new Wt(t,e):new Wt(t)}doWrite(t,e){this.ws.send(e)}}class ar extends he{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const e=$s(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=t.readable.pipeThrough(e).getReader(),n=Vs();n.readable.pipeTo(t.writable),this._writer=n.writable.getWriter();const i=()=>{s.read().then(({done:o,value:c})=>{o||(this.onPacket(c),i())}).catch(o=>{})};i();const a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],n=e===t.length-1;this._writer.write(s).then(()=>{n&&qt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const or={websocket:ir,webtransport:ar,polling:rr},cr=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,lr=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Zt(r){if(r.length>8e3)throw"URI too long";const t=r,e=r.indexOf("["),s=r.indexOf("]");e!=-1&&s!=-1&&(r=r.substring(0,e)+r.substring(e,s).replace(/:/g,";")+r.substring(s,r.length));let n=cr.exec(r||""),i={},a=14;for(;a--;)i[lr[a]]=n[a]||"";return e!=-1&&s!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=hr(i,i.path),i.queryKey=ur(i,i.query),i}function hr(r,t){const e=/\/{2,9}/g,s=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&s.splice(0,1),t.slice(-1)=="/"&&s.splice(s.length-1,1),s}function ur(r,t){const e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,n,i){n&&(e[n]=i)}),e}const Gt=typeof addEventListener=="function"&&typeof removeEventListener=="function",Pt=[];Gt&&addEventListener("offline",()=>{Pt.forEach(r=>r())},!1);class ht extends q{constructor(t,e){if(super(),this.binaryType=js,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(e=t,t=null),t){const s=Zt(t);e.hostname=s.host,e.secure=s.protocol==="https"||s.protocol==="wss",e.port=s.port,s.query&&(e.query=s.query)}else e.host&&(e.hostname=Zt(e.host).host);Vt(this,e),this.secure=e.secure!=null?e.secure:typeof location<"u"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach(s=>{const n=s.prototype.name;this.transports.push(n),this._transportsByName[n]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Js(this.opts.query)),Gt&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Pt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=$e,e.transport=t,this.id&&(e.sid=this.id);const s=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&ht.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",ht.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let s=0;s<this.writeBuffer.length;s++){const n=this.writeBuffer[s].data;if(n&&(e+=Ws(n)),s>0&&e>this._maxPayload)return this.writeBuffer.slice(0,s);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,qt(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,e,s){return this._sendPacket("message",t,e,s),this}send(t,e,s){return this._sendPacket("message",t,e,s),this}_sendPacket(t,e,s,n){if(typeof e=="function"&&(n=e,e=void 0),typeof s=="function"&&(n=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const i={type:t,data:e,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},s=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}_onError(t){if(ht.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Gt&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=Pt.indexOf(this._offlineEventListener);s!==-1&&Pt.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}ht.protocol=$e;class dr extends ht{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),s=!1;ht.priorWebsocketSuccess=!1;const n=()=>{s||(e.send([{type:"ping",data:"probe"}]),e.once("packet",_=>{if(!s)if(_.type==="pong"&&_.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;ht.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(h(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const u=new Error("probe error");u.transport=e.name,this.emitReserved("upgradeError",u)}}))};function i(){s||(s=!0,h(),e.close(),e=null)}const a=_=>{const u=new Error("probe error: "+_);u.transport=e.name,i(),this.emitReserved("upgradeError",u)};function o(){a("transport closed")}function c(){a("socket closed")}function d(_){e&&_.name!==e.name&&i()}const h=()=>{e.removeListener("open",n),e.removeListener("error",a),e.removeListener("close",o),this.off("close",c),this.off("upgrading",d)};e.once("open",n),e.once("error",a),e.once("close",o),this.once("close",c),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{s||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let s=0;s<t.length;s++)~this.transports.indexOf(t[s])&&e.push(t[s]);return e}}let fr=class extends dr{constructor(t,e={}){const s=typeof t=="object"?t:e;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(n=>or[n]).filter(n=>!!n)),super(t,s)}};function pr(r,t="",e){let s=r;e=e||typeof location<"u"&&location,r==null&&(r=e.protocol+"//"+e.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=e.protocol+r:r=e.host+r),/^(https?|wss?):\/\//.test(r)||(typeof e<"u"?r=e.protocol+"//"+r:r="https://"+r),s=Zt(r)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const i=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+t,s.href=s.protocol+"://"+i+(e&&e.port===s.port?"":":"+s.port),s}const mr=typeof ArrayBuffer=="function",vr=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,We=Object.prototype.toString,gr=typeof Blob=="function"||typeof Blob<"u"&&We.call(Blob)==="[object BlobConstructor]",_r=typeof File=="function"||typeof File<"u"&&We.call(File)==="[object FileConstructor]";function ue(r){return mr&&(r instanceof ArrayBuffer||vr(r))||gr&&r instanceof Blob||_r&&r instanceof File}function Dt(r,t){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let e=0,s=r.length;e<s;e++)if(Dt(r[e]))return!0;return!1}if(ue(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return Dt(r.toJSON(),!0);for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e)&&Dt(r[e]))return!0;return!1}function xr(r){const t=[],e=r.data,s=r;return s.data=te(e,t),s.attachments=t.length,{packet:s,buffers:t}}function te(r,t){if(!r)return r;if(ue(r)){const e={_placeholder:!0,num:t.length};return t.push(r),e}else if(Array.isArray(r)){const e=new Array(r.length);for(let s=0;s<r.length;s++)e[s]=te(r[s],t);return e}else if(typeof r=="object"&&!(r instanceof Date)){const e={};for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=te(r[s],t));return e}return r}function yr(r,t){return r.data=ee(r.data,t),delete r.attachments,r}function ee(r,t){if(!r)return r;if(r&&r._placeholder===!0){if(typeof r.num=="number"&&r.num>=0&&r.num<t.length)return t[r.num];throw new Error("illegal attachments")}else if(Array.isArray(r))for(let e=0;e<r.length;e++)r[e]=ee(r[e],t);else if(typeof r=="object")for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&(r[e]=ee(r[e],t));return r}const br=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],wr=5;var T;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(T||(T={}));class kr{constructor(t){this.replacer=t}encode(t){return(t.type===T.EVENT||t.type===T.ACK)&&Dt(t)?this.encodeAsBinary({type:t.type===T.EVENT?T.BINARY_EVENT:T.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===T.BINARY_EVENT||t.type===T.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=xr(t),s=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(s),n}}function Se(r){return Object.prototype.toString.call(r)==="[object Object]"}class de extends q{constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const s=e.type===T.BINARY_EVENT;s||e.type===T.BINARY_ACK?(e.type=s?T.EVENT:T.ACK,this.reconstructor=new Er(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(ue(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0;const s={type:Number(t.charAt(0))};if(T[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===T.BINARY_EVENT||s.type===T.BINARY_ACK){const i=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);const a=t.substring(i,e);if(a!=Number(a)||t.charAt(e)!=="-")throw new Error("Illegal attachments");s.attachments=Number(a)}if(t.charAt(e+1)==="/"){const i=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););s.nsp=t.substring(i,e)}else s.nsp="/";const n=t.charAt(e+1);if(n!==""&&Number(n)==n){const i=e+1;for(;++e;){const a=t.charAt(e);if(a==null||Number(a)!=a){--e;break}if(e===t.length)break}s.id=Number(t.substring(i,e+1))}if(t.charAt(++e)){const i=this.tryParse(t.substr(e));if(de.isPayloadValid(s.type,i))s.data=i;else throw new Error("invalid payload")}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case T.CONNECT:return Se(e);case T.DISCONNECT:return e===void 0;case T.CONNECT_ERROR:return typeof e=="string"||Se(e);case T.EVENT:case T.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&br.indexOf(e[0])===-1);case T.ACK:case T.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Er{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const e=yr(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Tr=Object.freeze(Object.defineProperty({__proto__:null,Decoder:de,Encoder:kr,get PacketType(){return T},protocol:wr},Symbol.toStringTag,{value:"Module"}));function J(r,t,e){return r.on(t,e),function(){r.off(t,e)}}const Ar=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});let Ke=class extends q{constructor(t,e,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[J(t,"open",this.onopen.bind(this)),J(t,"packet",this.onpacket.bind(this)),J(t,"error",this.onerror.bind(this)),J(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var s,n,i;if(Ar.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const a={type:T.EVENT,data:e};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const h=this.ids++,_=e.pop();this._registerAckCallback(h,_),a.id=h}const o=(n=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||n===void 0?void 0:n.writable,c=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!o||(c?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(t,e){var s;const n=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(n===void 0){this.acks[t]=e;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===t&&this.sendBuffer.splice(o,1);e.call(this,new Error("operation has timed out"))},n),a=(...o)=>{this.io.clearTimeoutFn(i),e.apply(this,o)};a.withError=!0,this.acks[t]=a}emitWithAck(t,...e){return new Promise((s,n)=>{const i=(a,o)=>a?n(a):s(o);i.withError=!0,e.push(i),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((n,...i)=>s!==this._queue[0]?void 0:(n!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(n)):(this._queue.shift(),e&&e(null,...i)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:T.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(s=>String(s.id)===t)){const s=this.acks[t];delete this.acks[t],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case T.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case T.EVENT:case T.BINARY_EVENT:this.onevent(t);break;case T.ACK:case T.BINARY_ACK:this.onack(t);break;case T.DISCONNECT:this.ondisconnect();break;case T.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data,this.emitReserved("connect_error",s);break}}onevent(t){const e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const s of e)s.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let s=!1;return function(...n){s||(s=!0,e.packet({type:T.ACK,id:t,data:n}))}}onack(t){const e=this.acks[t.id];typeof e=="function"&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:T.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const s of e)s.apply(this,t.data)}}};function bt(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}bt.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*r);r=Math.floor(t*10)&1?r+e:r-e}return Math.min(r,this.max)|0};bt.prototype.reset=function(){this.attempts=0};bt.prototype.setMin=function(r){this.ms=r};bt.prototype.setMax=function(r){this.max=r};bt.prototype.setJitter=function(r){this.jitter=r};class se extends q{constructor(t,e){var s;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,Vt(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((s=e.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new bt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;const n=e.parser||Tr;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new fr(this.uri,this.opts);const e=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const n=J(e,"open",function(){s.onopen(),t&&t()}),i=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),t?t(o):this.maybeReconnectOnOpen()},a=J(e,"error",i);if(this._timeout!==!1){const o=this._timeout,c=this.setTimeoutFn(()=>{n(),i(new Error("timeout")),e.close()},o);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(n),this.subs.push(a),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(J(t,"ping",this.onping.bind(this)),J(t,"data",this.ondata.bind(this)),J(t,"error",this.onerror.bind(this)),J(t,"close",this.onclose.bind(this)),J(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){qt(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let s=this.nsps[t];return s?this._autoConnect&&!s.active&&s.connect():(s=new Ke(this,t,e),this.nsps[t]=s),s}_destroy(t){const e=Object.keys(this.nsps);for(const s of e)if(this.nsps[s].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let s=0;s<e.length;s++)this.engine.write(e[s],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(n=>{n?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",n)):t.onreconnect()}))},e);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const kt={};function At(r,t){typeof r=="object"&&(t=r,r=void 0),t=t||{};const e=pr(r,t.path||"/socket.io"),s=e.source,n=e.id,i=e.path,a=kt[n]&&i in kt[n].nsps,o=t.forceNew||t["force new connection"]||t.multiplex===!1||a;let c;return o?c=new se(s,t):(kt[n]||(kt[n]=new se(s,t)),c=kt[n]),e.query&&!t.query&&(t.query=e.queryKey),c.socket(e.path,t)}Object.assign(At,{Manager:se,Socket:Ke,io:At,connect:At});class Cr{constructor(){if(this.enabled=!1,typeof At=="function"){const t=location.origin;this.socket=At(t),this.socket&&(this.socket.on("connect",()=>{this.enabled=!0,console.log("Connected to websocket Obelix 1.0")}),this.socket.on("update_settings",e=>{console.log("SOCKETio",e),typeof e=="object"&&!Array.isArray(e)&&e!==null&&oe.update(s=>({...s,...e}))}))}}destroy(){this.socket.offAny(),this.socket.disconnect()}emit(t){this.enabled&&this.socket.emit("message",t)}emitReply(t,e){this.enabled&&(console.log("emitReply"),this.socket.emit("message_reply",t,(s,n)=>{console.log("emitReply response",s,n),typeof e=="function"&&e(n)}))}}const Xe=new Cr;function ot(r,t){Xe.emit({get:"foo"}),fetch(""+r).then(s=>s.json()).then(s=>{typeof t=="function"&&t(s)})}function fe(r,t,e){Xe.emitReply({post:"foo"},e),fetch(""+r,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(n=>n.json()).then(n=>{e&&e(n)})}class Sr{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=200,this.deadZone=8,this.active=!1,this.value={x:0,y:0},this.counter=0,this.prev={x:0,y:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",s=>{this._handleDown(s)}),this.stick.addEventListener("touchstart",s=>{this._handleDown(s)}),document.addEventListener("mousemove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("touchmove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("mouseup",s=>{this._handleUp(s)}),document.addEventListener("touchend",s=>{this._handleUp(s)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.clientX,y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;let e=null;if(t.changedTouches){for(let w=0;w<t.changedTouches.length;w++)this.touchId===t.changedTouches[w].identifier&&(e=w,t.clientX=t.changedTouches[w].clientX,t.clientY=t.changedTouches[w].clientY);if(e==null)return}const s=this.stick.getBoundingClientRect(),n=s?Math.round(16e3/s.width)/100:1,i=t.clientX-this.dragStart.x,a=t.clientY-this.dragStart.y,o=Math.atan2(a,i),c=Math.min(this.maxDistance,Math.hypot(i,a)*n),d=c*Math.cos(o),h=c*Math.sin(o);this.stick.style.transform=`translate(${d}px, ${h}px)`;const _=c<this.deadZone?0:this.maxDistance/(this.maxDistance-this.deadZone)*(c-this.deadZone),u=_*Math.cos(o),v=_*Math.sin(o),p=parseFloat((u/this.maxDistance).toFixed(4)),B=parseFloat((v/this.maxDistance).toFixed(4));this.value={x:p,y:B},this._loop()}_handleUp(t){this.active&&(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier||(this.stick.style.transition=".2s",this.stick.style.transform="translate3d(0px, 0px, 0px)",this.value={x:0,y:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5+this.value.x*511.5),e=Math.round(511.5+this.value.y*511.5);this.callback(`/joystick/${t}/${e}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){(this.value.x!==this.prev.x||this.value.y!==this.prev.y)&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}class Lr{constructor(t,e){this.stick=t,this.stick&&(this.callback=e,this.dragStart=null,this.touchId=null,this.maxDistance=230,this.deadZone=8,this.active=!1,this.value={f:0},this.counter=0,this.prev={f:0},this.debounceTimer=null,this.debounceTimeout=50,this.stick.addEventListener("mousedown",s=>{this._handleDown(s)}),this.stick.addEventListener("touchstart",s=>{this._handleDown(s)}),document.addEventListener("mousemove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("touchmove",s=>{this._handleMove(s)},{passive:!1}),document.addEventListener("mouseup",s=>{this._handleUp(s)}),document.addEventListener("touchend",s=>{this._handleUp(s)}))}destroy(){this.stick.removeEventListener("mousedown",t=>{this._handleDown(t)}),this.stick.removeEventListener("touchstart",t=>{this._handleDown(t)}),document.removeEventListener("mousemove",t=>{this._handleMove(t)}),document.removeEventListener("touchmove",t=>{this._handleMove(t)}),document.removeEventListener("mouseup",t=>{this._handleUp(t)}),document.removeEventListener("touchend",t=>{this._handleUp(t)})}_handleDown(t){this.active=!0,this.stick.style.transition="0s",t.preventDefault(),this.dragStart=t.changedTouches?{y:t.changedTouches[0].clientY}:{y:t.clientY},t.changedTouches&&(this.touchId=t.changedTouches[0].identifier)}_handleMove(t){if(!this.active)return;t.preventDefault();let e=null;if(t.changedTouches){for(let c=0;c<t.changedTouches.length;c++)this.touchId===t.changedTouches[c].identifier&&(e=c,t.clientY=t.changedTouches[c].clientY);if(e==null)return}const s=this.stick.getBoundingClientRect(),n=s?Math.round(1e4/s.width)/100:1,i=t.clientY-this.dragStart.y,a=i>=0?Math.min(this.maxDistance,i*n):Math.max(-this.maxDistance,i*n);this.stick.style.transform=`translateY(${a}px)`;const o=Math.abs(a)>this.deadZone?parseFloat((a/this.maxDistance).toFixed(4)):0;this.value={f:o},this._loop()}_handleUp(t){this.active&&(t.preventDefault(),!(t.changedTouches&&this.touchId!==t.changedTouches[0].identifier)&&(this.stick.style.transition=".2s",this.stick.style.transform="translateY(0px)",this.value={f:0},this.touchId=null,this.active=!1))}_sendUpdate(){const t=Math.round(511.5-this.value.f*511.5);this.callback(`/focus/${t}`)}_debounce(t){return(...e)=>{clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{t(...e)},this.debounceTimeout)}}_update(){this.value.f!==this.prev.f&&(this.prev={...this.value},this._debounce(()=>{this._sendUpdate()})())}_loop(){this.active?this.frame=requestAnimationFrame(()=>{this._loop()}):cancelAnimationFrame(this.frame),this._update()}}var Rr=at('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-16xuj0f"><defs><circle id="joys-def-cir1" r="280" cy="0"></circle><circle id="joys-def-cir2" r="80" cy="0"></circle><path id="joys-def-arrow" d="M0 -120 -40 -100 40 -100z"></path><rect id="joys-def-slider" width="70" height="560" transform="translate(350 -280)" rx="15" ry="15"></rect><rect id="joys-def-slide" width="100" height="100" transform="translate(335 -50)" rx="15" ry="15"></rect></defs><g id="joys" transform="translate(320 355)" class="svelte-16xuj0f"><use id="joys-plate" href="#joys-def-cir1" class="svelte-16xuj0f"></use><use id="joys-arrow-top" href="#joys-def-arrow" class="svelte-16xuj0f"></use><use id="joys-arrow-right" href="#joys-def-arrow" transform="rotate(90)" class="svelte-16xuj0f"></use><use id="joys-arrow-left" href="#joys-def-arrow" transform="rotate(-90)" class="svelte-16xuj0f"></use><use id="joys-arrow-bottom" href="#joys-def-arrow" transform="rotate(180)" class="svelte-16xuj0f"></use><use id="joys-stick" href="#joys-def-cir2" style="transform: translate(0px, 0px)" class="svelte-16xuj0f"></use><use id="joys-slider" href="#joys-def-slider" class="svelte-16xuj0f"></use><use id="joys-slide" href="#joys-def-slide" style="transform: translateY(0px)" class="svelte-16xuj0f"></use></g></svg>');function Or(r,t){G(t,!1);let e=null,s=null;Ct(()=>{e=new Sr(document.getElementById("joys-stick"),i=>{ot(i,a=>{console.log("SVELTE Joystick",a)})}),s=new Lr(document.getElementById("joys-slide"),i=>{ot(i,a=>{console.log("SVELTE Focus",a)})})}),dt(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy(),s&&s.hasOwnProperty("destroy")&&s.destroy()}),Ft();var n=Rr();g(r,n),tt()}class Nr{constructor(t,e){if(this.adjust=t,this.adjust){this.callback=e;const s=8e4/360;this.axisSteps={lg:Math.round(s),md:Math.round(s/10),sm:Math.round(s/100)},this.adjust.addEventListener("mouseup",n=>{this.sendCommand(n.target.dataset)})}}destroy(){this.adjust.removeEventListener("mouseup",t=>{this.sendCommand(t.target.dataset)})}sendCommand(t){let e=t==null?void 0:t.dir,s=t==null?void 0:t.len;e&&s&&typeof this.axisSteps[s]=="number"&&(s=this.axisSteps[s],["closer","further"].indexOf(e)>=0&&(s=e==="closer"?-s:s,e="focus"),this.callback(`/adjust/${e}/${s}`))}}var Br=at('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 781 710" class="svelte-uzo82b"><defs><path id="arr1" d="M45 45 5 45 10 95 95 95 95 10 45 5z"></path><path id="arr2" d="M105 105 11 105 17 165 165 165 165 17 105 11z"></path><path id="arr3" d="M175 175 18 175 25 245 245 245 245 25 175 18z"></path><circle id="cir1" r="44" cy="73"></circle><path id="cir2" d="M-54 73 A 75 75 0 1 0 54 73 A 54 54 0 0 1 -54 73z"></path><path id="cir3" d="M-85 125 A 108 108 0 1 0 85 125 A 54 54 0 0 1 -85 125z"></path></defs><g id="adjust" transform="translate(355 355)" class="svelte-uzo82b"><g transform="rotate(135)"><use href="#arr1" data-dir="left" data-len="sm" class="svelte-uzo82b"></use><use href="#arr2" data-dir="left" data-len="md" class="svelte-uzo82b"></use><use href="#arr3" data-dir="left" data-len="lg" class="svelte-uzo82b"></use></g><g transform="rotate(-45)"><use href="#arr1" data-dir="right" data-len="sm" class="svelte-uzo82b"></use><use href="#arr2" data-dir="right" data-len="md" class="svelte-uzo82b"></use><use href="#arr3" data-dir="right" data-len="lg" class="svelte-uzo82b"></use></g><g transform="rotate(-135)"><use href="#arr1" data-dir="up" data-len="sm" class="svelte-uzo82b"></use><use href="#arr2" data-dir="up" data-len="md" class="svelte-uzo82b"></use><use href="#arr3" data-dir="up" data-len="lg" class="svelte-uzo82b"></use></g><g transform="rotate(45)"><use href="#arr1" data-dir="down" data-len="sm" class="svelte-uzo82b"></use><use href="#arr2" data-dir="down" data-len="md" class="svelte-uzo82b"></use><use href="#arr3" data-dir="down" data-len="lg" class="svelte-uzo82b"></use></g><g transform="translate(360 -50) rotate(165)"><use href="#cir1" data-dir="further" data-len="sm" class="svelte-uzo82b"></use><use href="#cir2" data-dir="further" data-len="md" class="svelte-uzo82b"></use><use href="#cir3" data-dir="further" data-len="lg" class="svelte-uzo82b"></use></g><g transform="translate(360 50) rotate(15)"><use href="#cir1" data-dir="closer" data-len="sm" class="svelte-uzo82b"></use><use href="#cir2" data-dir="closer" data-len="md" class="svelte-uzo82b"></use><use href="#cir3" data-dir="closer" data-len="lg" class="svelte-uzo82b"></use></g></g></svg>');function Pr(r,t){G(t,!1);let e=null;Ct(()=>{e=new Nr(document.getElementById("adjust"),n=>{ot(n,i=>{console.log("SVELTE Adjust",i)})})}),dt(()=>{e&&e.hasOwnProperty("destroy")&&e.destroy()}),Ft();var s=Br();g(r,s),tt()}const Dr=(r,t)=>{R(t,Q(l(t)==="mov"?"adj":"mov"))};var Mr=F('<div class="joystick-wrapper svelte-5x5bew"><!> <button class="button svelte-5x5bew" type="button"> </button></div>');function Fr(r){let t=$("mov");var e=Mr(),s=m(e);I(s,()=>l(t)==="mov",a=>{Or(a,{})},a=>{Pr(a,{})});var n=E(s,2);n.__click=[Dr,t];var i=m(n,!0);f(n),f(e),W(()=>Z(i,l(t)==="mov"?"ADJ":"MOV")),g(r,e)}yt(["click"]);var Ir=at('<path fill="none" stroke="#000" stroke-width="1.01" d="M10,0.5 C6.41,0.5 3.5,3.39 3.5,6.98 C3.5,11.83 10,19 10,19 C10,19 16.5,11.83 16.5,6.98 C16.5,3.39 13.59,0.5 10,0.5 L10,0.5 Z"></path><circle fill="none" stroke="#000" cx="10" cy="6.8" r="2.3"></circle>',1),qr=at('<path fill="none" stroke="#000" d="M1,10.5 L19,10.5"></path><path fill="none" stroke="#000" d="M2.35,15.5 L17.65,15.5"></path><path fill="none" stroke="#000" d="M2.35,5.5 L17.523,5.5"></path><path fill="none" stroke="#000" d="M10,19.46 L9.98,19.46 C7.31,17.33 5.61,14.141 5.61,10.58 C5.61,7.02 7.33,3.83 10,1.7 C10.01,1.7 9.99,1.7 10,1.7 L10,1.7 C12.67,3.83 14.4,7.02 14.4,10.58 C14.4,14.141 12.67,17.33 10,19.46 L10,19.46 L10,19.46 L10,19.46 Z"></path><circle fill="none" stroke="#000" cx="10" cy="10.5" r="9"></circle>',1),Vr=at('<path fill="none" stroke="#000" d="M17.25,6.01 L7.12,16.1 L3.82,17.2 L5.02,13.9 L15.12,3.88 C15.71,3.29 16.66,3.29 17.25,3.88 C17.83,4.47 17.83,5.42 17.25,6.01 L17.25,6.01 Z"></path><path fill="none" stroke="#000" d="M15.98,7.268 L13.851,5.148"></path>',1),$r=at('<polyline fill="none" stroke="#000" points="6.5 3 6.5 1.5 13.5 1.5 13.5 3"></polyline><polyline fill="none" stroke="#000" points="4.5 4 4.5 18.5 15.5 18.5 15.5 4"></polyline><rect width="1" height="9" x="8" y="7"></rect><rect width="1" height="9" x="11" y="7"></rect><rect width="16" height="1" x="2" y="3"></rect>',1),zr=at('<ellipse fill="none" stroke="#000" cx="6.11" cy="3.55" rx="2.11" ry="2.15"></ellipse><ellipse fill="none" stroke="#000" cx="6.11" cy="15.55" rx="2.11" ry="2.15"></ellipse><circle fill="none" stroke="#000" cx="13.15" cy="9.55" r="2.15"></circle><rect width="3" height="1" x="1" y="3"></rect><rect width="8" height="1" x="10" y="3"></rect><rect width="8" height="1" x="1" y="9"></rect><rect width="3" height="1" x="15" y="9"></rect><rect width="3" height="1" x="1" y="15"></rect><rect width="8" height="1" x="10" y="15"></rect>',1),jr=at('<circle fill="none" stroke="#000" cx="9.997" cy="10" r="3.31"></circle><path fill="none" stroke="#000" d="M18.488,12.285 L16.205,16.237 C15.322,15.496 14.185,15.281 13.303,15.791 C12.428,16.289 12.047,17.373 12.246,18.5 L7.735,18.5 C7.938,17.374 7.553,16.299 6.684,15.791 C5.801,15.27 4.655,15.492 3.773,16.237 L1.5,12.285 C2.573,11.871 3.317,10.999 3.317,9.991 C3.305,8.98 2.573,8.121 1.5,7.716 L3.765,3.784 C4.645,4.516 5.794,4.738 6.687,4.232 C7.555,3.722 7.939,2.637 7.735,1.5 L12.263,1.5 C12.072,2.637 12.441,3.71 13.314,4.22 C14.206,4.73 15.343,4.516 16.225,3.794 L18.487,7.714 C17.404,8.117 16.661,8.988 16.67,10.009 C16.672,11.018 17.415,11.88 18.488,12.285 L18.488,12.285 Z"></path>',1),Ur=at('<circle fill="none" stroke="#000" cx="10" cy="10" r="7.5"></circle><line fill="none" stroke="#000" x1="10" x2="10" y2="8"></line><line fill="none" stroke="#000" x1="10" y1="12" x2="10" y2="20"></line><line fill="none" stroke="#000" y1="10" x2="8" y2="10"></line><line fill="none" stroke="#000" x1="12" y1="10" x2="20" y2="10"></line>',1),Hr=at('<svg viewBox="0 0 20 20"><!></svg>');function gt(r,t){let e=Et(t,"size",3,1),s=Mt(()=>Math.round(20*e()));var n=Hr(),i=m(n);I(i,()=>t.type==="home",a=>{var o=Ir();ct(),g(a,o)},a=>{var o=st(),c=Y(o);I(c,()=>t.type==="polaris",d=>{var h=qr();ct(4),g(d,h)},d=>{var h=st(),_=Y(h);I(_,()=>t.type==="edit",u=>{var v=Vr();ct(),g(u,v)},u=>{var v=st(),p=Y(v);I(p,()=>t.type==="delete",B=>{var w=$r();ct(4),g(B,w)},B=>{var w=st(),L=Y(w);I(L,()=>t.type==="settings",P=>{var C=zr();ct(8),g(P,C)},P=>{var C=st(),x=Y(C);I(x,()=>t.type==="config",y=>{var A=jr();ct(),g(y,A)},y=>{var A=Ur();ct(4),g(y,A)},!0),g(P,C)},!0),g(B,w)},!0),g(u,v)},!0),g(d,h)},!0),g(a,o)}),f(n),W(()=>{H(n,"width",l(s)),H(n,"height",l(s))}),g(r,n)}function re(r){return typeof r=="string"?r.toLowerCase().trim().replaceAll("ä","ae").replaceAll("ö","oe").replaceAll("ü","ue").replaceAll("ß","ss").replace(/\W+/g,"_").replace(/^_|_$/g,""):null}const Le={fid:"",geo:{addr:"",lat:53.6,lon:9.9},base:[{id:"home",name:"Home",pos:{x:-23900,y:0,f:500}},{id:"polaris",name:"Polaris",pos:{x:0,y:11912,f:600}}]};function Yr(r,t){const e={...Le.geo,addr:t},s=[];for(let n of Le.base)s.push({...n,pos:{...n.pos}});return{fid:r,geo:e,base:s}}var Wr=(r,t)=>{R(t,!1)},Kr=F('<input type="text" id="address" placeholder="Address" class="input"> <input type="text" id="latitude" placeholder="Latitude" class="input"> <input type="text" id="longitude" placeholder="Longitude" class="input"> <button class="button button-small">Save</button> <button class="button">Cancel</button>',1),Xr=(r,t)=>{R(t,!0)},Jr=F('<h4 class="svelte-15i5ty6"> <button class="edit-button svelte-15i5ty6"><!></button></h4>'),Qr=F('<div class="svelte-15i5ty6"> </div>'),Zr=F("<!> <!>",1),Gr=(r,t,e)=>t(r,`/navi/position/${l(e).id}`),tn=(r,t,e)=>t(l(e).id),en=F('<button class="delete-button svelte-15i5ty6"><!></button>'),sn=F('<li><button class="goto-button svelte-15i5ty6"><!> </button> <!></li>'),rn=F('<label for="new-name">Save/update current position as ...</label> <input type="text" id="new-name" class="input" placeholder="Enter a position name"> <div class="margin-bottom"><sub> </sub></div> <button class="button button-small">Save</button>',1),nn=F('<div class="nav-grid svelte-15i5ty6"><div class="nav-curr-pos svelte-15i5ty6"><h3>Navigation</h3> <!></div> <div class="nav-selector svelte-15i5ty6"><button class="button button-small">location</button></div> <div class="nav-list svelte-15i5ty6"><ul id="nav-nav" class="iconnav iconnav-vertical"></ul></div> <div class="nav-add"><!></div></div>');function an(r,t){G(t,!0);const e=xt(),s=()=>ut(rt,"$positions",e),n=()=>ut(oe,"$arduinoSettings",e);let i=$(!1),a=$(""),o=Mt(()=>re(l(a))),c=$(""),d=$(""),h=$(""),_=$(Q([]));const u=rt.subscribe(b=>{b!=null&&b.fid&&(R(c,Q(b.geo.addr)),R(d,Q(b.geo.lat)),R(h,Q(b.geo.lon)),R(_,Q([...b.base])))});dt(()=>{u&&u()});const v=()=>{const b={...s()};fe(`/navi/position/update/${b.fid}`,b,k=>{console.log("SVELTE saved",k)})},p=()=>{const b={addr:l(c),lat:parseFloat(l(d)),lon:parseFloat(l(h))};rt.update(k=>({...k,geo:b})),v(),R(i,!1)},B=()=>{const b=re(l(a));if(b){let k=!1;const O=(({x:D,y:V,f:j})=>({x:D,y:V,f:j}))(n());let M=l(_).map(D=>D.id!==b?D:(k=!0,{...D,pos:O}));k||M.push({id:b,name:l(a),pos:O}),rt.update(D=>({...D,base:M})),v(),R(a,"")}R(i,!1)},w=b=>{if(confirm(`Do you really want to delete position: "${b}"`)){const k=[...s().base].filter(O=>O.id!==b);rt.update(O=>({...O,base:k})),v(),R(i,!1)}},L=(b,k)=>{b.preventDefault(),ot(k,O=>{console.log("SVELTE position",O)})};var P=nn(),C=m(P),x=E(m(C),2);I(x,()=>l(i),b=>{var k=Kr(),O=Y(k);mt(O);var M=E(O,2);mt(M);var D=E(M,2);mt(D);var V=E(D,2);V.__click=p;var j=E(V,2);j.__click=[Wr,i],vt(O,()=>l(c),U=>R(c,U)),vt(M,()=>l(d),U=>R(d,U)),vt(D,()=>l(h),U=>R(h,U)),g(b,k)},b=>{var k=Zr(),O=Y(k);I(O,()=>l(c),D=>{var V=Jr(),j=m(V),U=E(j);U.__click=[Xr,i];var pt=m(U);gt(pt,{type:"edit"}),f(U),f(V),W(()=>Z(j,`${l(c)??""} `)),g(D,V)});var M=E(O,2);I(M,()=>l(d)&&l(h),D=>{var V=Qr(),j=m(V);f(V),W(()=>Z(j,`${l(d)??""}°, ${l(h)??""}°`)),g(D,V)}),g(b,k)}),f(C);var y=E(C,2),A=m(y);A.__click=function(...b){var k;(k=t.toggleAdmin)==null||k.apply(this,b)},f(y);var S=E(y,2),N=m(S);It(N,21,()=>l(_),ae,(b,k)=>{var O=sn(),M=m(O);M.__click=[Gr,L,k];var D=m(M);gt(D,{get type(){return l(k).id},size:1.35});var V=E(D);f(M);var j=E(M,2);I(j,()=>l(i)&&l(k).id!=="home"&&l(k).id!=="polaris",U=>{var pt=en();pt.__click=[tn,w,k];var Je=m(pt);gt(Je,{type:"delete",size:.85}),f(pt),g(U,pt)}),f(O),W(()=>Z(V,` ${l(k).name??""}`)),g(b,O)}),f(N),f(S);var z=E(S,2),et=m(z);I(et,()=>l(i),b=>{var k=rn(),O=E(Y(k),2);mt(O);var M=E(O,2),D=m(M),V=m(D);f(D),f(M);var j=E(M,2);j.__click=B,W(()=>{Z(V,`ID: ${l(o)??""}`),j.disabled=l(o).length<3}),vt(O,()=>l(a),U=>R(a,U)),g(b,k)}),f(z),f(P),g(r,P),tt()}yt(["click"]);const on=(r,t)=>{R(t,!l(t))};var cn=(r,t,e)=>t(l(e).fid),ln=(r,t,e)=>t(l(e).fid),hn=F('<button class="del-button svelte-vspp1v"><!></button>'),un=F('<li><button class="loc-button svelte-vspp1v"><!> </button> <!></li>'),dn=(r,t)=>t(),fn=F('<div class="nav-add svelte-vspp1v"><input type="text" id="new-location" class="input" placeholder="Enter a location name"> <button class="button">+&nbsp;Add</button></div> <div> </div>',1),pn=F('<div class="nav-grid svelte-vspp1v"><div class="nav-curr-pos svelte-vspp1v"><h4 class="svelte-vspp1v">Locations <button><!></button></h4> <div class="svelte-vspp1v"><p>The location is the place where your telescope is placed.</p></div></div> <div class="nav-selector svelte-vspp1v"><button class="button button-small">Navigation</button></div> <div class="nav-list svelte-vspp1v"><ul class="svelte-vspp1v"></ul></div> <!></div>');function mn(r,t){G(t,!0);const e=xt(),s=()=>ut(Lt,"$locations",e);let n=$("");const i=rt.subscribe(A=>{R(n,Q(A.fid))});dt(()=>{i&&i()});let a=$(!1),o=$(""),c=Mt(()=>re(l(o)));const d=A=>{A!==l(n)&&ot(`/navi/location/${A}`,S=>{(S==null?void 0:S.fid)===A&&(rt.update(N=>({...S})),console.log("Loaded location"))})},h=()=>{if(l(c).length>=3){const A=Yr(l(c),l(o));fe(`/navi/position/update/${l(c)}`,A,S=>{rt.update(N=>A),Lt.update(N=>[...N,{fid:l(c),addr:l(o)}]),R(o,""),console.log("Added new location",S)})}else console.error("ID is too short. At least 3 char are required.")},_=A=>{confirm(`Do you really want to delete location: "${A}"`)?ot(`/navi/location/delete/${A}`,S=>{S.response===200&&(Lt.update(N=>N.filter(z=>z.fid!==A)),alert(`Location "${A}" deleted`))}):alert(`Deletion of "${A}" canceled.`)};Ct(()=>{s().length===0&&ot("/navi/location-list",A=>{Lt.update(S=>[...A]),console.log("Loaded location list")})});var u=pn(),v=m(u),p=m(v),B=E(m(p));B.__click=[on,a];var w=m(B);gt(w,{type:"edit",size:1}),f(B),f(p),ct(2),f(v);var L=E(v,2),P=m(L);P.__click=function(...A){var S;(S=t.toggleAdmin)==null||S.apply(this,A)},f(L);var C=E(L,2),x=m(C);It(x,5,s,ae,(A,S)=>{var N=un(),z=m(N);z.__click=[cn,d,S];var et=m(z);gt(et,{type:"home"});var b=E(et);f(z);var k=E(z,2);I(k,()=>l(a)&&l(S).fid!==l(n)&&l(S).fid!=="index",O=>{var M=hn();M.__click=[ln,_,S];var D=m(M);gt(D,{type:"delete",size:1}),f(M),g(O,M)}),f(N),W(()=>{_t(N,`${(l(S).fid===l(n)?"active":"")??""} svelte-vspp1v`),Z(b,` ${l(S).addr??""}`)}),g(A,N)}),f(x),f(C);var y=E(C,2);I(y,()=>l(a),A=>{var S=fn(),N=Y(S),z=m(N);mt(z);var et=E(z,2);et.__click=[dn,h],f(N);var b=E(N,2),k=m(b,!0);f(b),W(()=>Z(k,l(c))),vt(z,()=>l(o),O=>R(o,O)),g(A,S)}),f(u),W(()=>_t(B,`${"edit-button"+(l(a)?" active":"")} svelte-vspp1v`)),g(r,u),tt()}yt(["click"]);function vn(r,t){G(t,!0);const e=xt(),s=()=>ut(rt,"$positions",e);let n=$(!1);const i=()=>{R(n,!l(n))};Ct(()=>{var c;(c=s())!=null&&c.fid||ot("/navi/location/index",d=>{(d==null?void 0:d.fid)==="index"&&rt.update(h=>({...d}))})});var a=st(),o=Y(a);I(o,()=>l(n),c=>{mn(c,{toggleAdmin:i})},c=>{an(c,{toggleAdmin:i})}),g(r,a),tt()}var gn=(r,t,e)=>{t.callback(t.id,e())},_n=F('<div class="slider-wrapper svelte-1h9at92"><label class="svelte-1h9at92"> </label> <input type="range" class="svelte-1h9at92"></div>');function xn(r,t){G(t,!0);let e=Et(t,"value",7,0),s=Et(t,"minValue",3,0),n=Et(t,"maxValue",3,10),i=Et(t,"steps",3,1);var a=_n(),o=m(a),c=m(o,!0);f(o);var d=E(o,2);mt(d),d.__change=[gn,t,e],f(a),W(()=>{H(o,"for","slider_slide_"+t.id),Z(c,t.name),H(d,"id","slider_slide_"+t.id),H(d,"min",s()),H(d,"max",n()),H(d,"step",i())}),vt(d,e),g(r,a),tt()}yt(["change"]);var yn=F('<div class="camera-options svelte-4mjct0"><!> <button class="button button-small">Reset defaults</button></div>');function bn(r,t){G(t,!1);const e=xt(),s=()=>ut(Ut,"$camControls",e),n=(d,h)=>{Ut.update(_=>_.map(u=>u.id===d?{...u,value:h}:{...u})),ot(`/cam/ctrl/${d}/${h}`,_=>{console.log("SVELTE CamCtrl",_)})},i=()=>{Ut.update(h=>h.map(_=>({..._,value:_.defaultValue})));const d={};for(let h of s())h!=null&&h.id&&(d[h.id]=h.defaultValue);fe("/cam/controls",d,h=>{console.log("SVELTE Cam Controls",h)})};Ft();var a=yn(),o=m(a);It(o,3,s,d=>d.name,(d,h,_)=>{xn(d,ys(()=>l(h),{get index(){return l(_)},callback:n}))});var c=E(o,2);c.__click=i,f(a),g(r,a),tt()}yt(["click"]);var wn=F("<h1>Video</h1>"),kn=F("<h1>Picture</h1>"),En=F('<div class="tools-wrapper svelte-wjuvrt"><div class="tools svelte-wjuvrt"><!></div></div>');function Tn(r,t){G(t,!0);let e=$("");const s=Kt.subscribe(o=>{R(e,Q(o))});dt(()=>{s&&s()});var n=En(),i=m(n),a=m(i);I(a,()=>l(e)==="target",o=>{Fr(o)},o=>{var c=st(),d=Y(c);I(d,()=>l(e)==="location",h=>{vn(h,{})},h=>{var _=st(),u=Y(_);I(u,()=>l(e)==="adjust",v=>{bn(v,{})},v=>{var p=st(),B=Y(p);I(B,()=>l(e)==="video",w=>{var L=wn();g(w,L)},w=>{var L=st(),P=Y(L);I(P,()=>l(e)==="picture",C=>{var x=kn();g(C,x)},null,!0),g(w,L)},!0),g(v,p)},!0),g(h,_)},!0),g(o,c)}),f(i),f(n),g(r,n),tt()}var An=F('<li><button><span class="svelte-wkzjji"> </span></button></li>'),Cn=F('<div id="options-menu" class="svelte-wkzjji"><ul class="svelte-wkzjji"></ul></div>');function Sn(r,t){G(t,!0);let e=$("");const s=Kt.subscribe(u=>{R(e,Q(u))});let n=$(!1);const i=Xt.subscribe(u=>{R(n,Q(u))});let a=$(!1);const o=Jt.subscribe(u=>{R(a,Q(u))}),c=u=>{Kt.update(v=>v===u?"":u)};dt(()=>{s&&s(),i&&i(),o&&o()});const d=[{id:"compass",name:"Compass",icon:"icon-compass",callback:()=>{Xt.update(u=>!u)},enabled:()=>l(n)},{id:"location",name:"Location",icon:"icon-location",callback:()=>{c("location")},enabled:()=>l(e)==="location"},{id:"target",name:"Target",icon:"icon-target",callback:()=>{c("target")},enabled:()=>l(e)==="target"},{id:"swap",name:"Swap",icon:"icon-swap",callback:()=>{Jt.update(u=>!u)},enabled:()=>l(a)},{id:"adjust",name:"Contrast",icon:"icon-adjust",callback:()=>{c("adjust")},enabled:()=>l(e)==="adjust"},{id:"video",name:"Video",icon:"icon-video",callback:()=>{c("video")},enabled:()=>l(e)==="video"},{id:"picture",name:"Picture",icon:"icon-image",callback:()=>{c("picture")},enabled:()=>l(e)==="picture"}];var h=Cn(),_=m(h);It(_,21,()=>d,ae,(u,v)=>{var p=An();const B=Mt(()=>`${(l(v).enabled()?"active":"")??""} svelte-wkzjji`);var w=m(p);w.__click=function(...C){var x;(x=l(v).callback)==null||x.apply(this,C)};var L=m(w),P=m(L,!0);f(L),f(w),f(p),W(()=>{_t(p,l(B)),_t(w,`${l(v).icon??""} svelte-wkzjji`),Z(P,l(v).name)}),g(u,p)}),f(_),f(h),g(r,h),tt()}yt(["click"]);var Ln=F('<div class="container svelte-kwwc8n"><!> <div class="controls svelte-kwwc8n"><!></div> <!></div>');function In(r){var t=Ln(),e=m(t);Bs(e);var s=E(e,2),n=m(s);Tn(n,{}),f(s);var i=E(s,2);Sn(i,{}),f(t),g(r,t)}export{In as component};
